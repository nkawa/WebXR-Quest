/*! For license information please see main.3d91abd3.js.LICENSE.txt */
!function(){var e={694:function(e,t){var n;!function(){"use strict";var r={}.hasOwnProperty;function a(){for(var e=[],t=0;t<arguments.length;t++){var n=arguments[t];if(n){var i=typeof n;if("string"===i||"number"===i)e.push(n);else if(Array.isArray(n)){if(n.length){var s=a.apply(null,n);s&&e.push(s)}}else if("object"===i)if(n.toString===Object.prototype.toString)for(var o in n)r.call(n,o)&&n[o]&&e.push(o);else e.push(n.toString())}}return e.join(" ")}e.exports?(a.default=a,e.exports=a):void 0===(n=function(){return a}.apply(t,[]))||(e.exports=n)}()},176:function(e){"use strict";e.exports=function(e,t,n,r,a,i,s,o){if(!e){var c;if(void 0===t)c=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var u=[n,r,a,i,s,o],l=0;(c=new Error(t.replace(/%s/g,(function(){return u[l++]})))).name="Invariant Violation"}throw c.framesToPop=1,c}}},573:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];function r(){for(var e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];var a=null;return t.forEach((function(e){if(null==a){var t=e.apply(void 0,n);null!=t&&(a=t)}})),a}return(0,i.default)(r)};var r,a=n(54),i=(r=a)&&r.__esModule?r:{default:r};e.exports=t.default},54:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){function t(t,n,r,a,i,s){var o=a||"<<anonymous>>",c=s||r;if(null==n[r])return t?new Error("Required "+i+" `"+c+"` was not specified in `"+o+"`."):null;for(var u=arguments.length,l=Array(u>6?u-6:0),d=6;d<u;d++)l[d-6]=arguments[d];return e.apply(void 0,[n,r,o,i,c].concat(l))}var n=t.bind(null,!1);return n.isRequired=t.bind(null,!0),n},e.exports=t.default},888:function(e,t,n){"use strict";var r=n(47);function a(){}function i(){}i.resetWarningCache=a,e.exports=function(){function e(e,t,n,a,i,s){if(s!==r){var o=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw o.name="Invariant Violation",o}}function t(){return e}e.isRequired=e;var n={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:i,resetWarningCache:a};return n.PropTypes=n,n}},7:function(e,t,n){e.exports=n(888)()},47:function(e){"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},463:function(e,t,n){"use strict";var r=n(791),a=n(296);function i(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var s=new Set,o={};function c(e,t){u(e,t),u(e+"Capture",t)}function u(e,t){for(o[e]=t,e=0;e<t.length;e++)s.add(t[e])}var l=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),d=Object.prototype.hasOwnProperty,p=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,f={},h={};function m(e,t,n,r,a,i,s){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=r,this.attributeNamespace=a,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=s}var v={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){v[e]=new m(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];v[t]=new m(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){v[e]=new m(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){v[e]=new m(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){v[e]=new m(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){v[e]=new m(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){v[e]=new m(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){v[e]=new m(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){v[e]=new m(e,5,!1,e.toLowerCase(),null,!1,!1)}));var g=/[\-:]([a-z])/g;function b(e){return e[1].toUpperCase()}function y(e,t,n,r){var a=v.hasOwnProperty(t)?v[t]:null;(null!==a?0!==a.type:r||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,n,r){if(null===t||"undefined"===typeof t||function(e,t,n,r){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,a,r)&&(n=null),r||null===a?function(e){return!!d.call(h,e)||!d.call(f,e)&&(p.test(e)?h[e]=!0:(f[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):a.mustUseProperty?e[a.propertyName]=null===n?3!==a.type&&"":n:(t=a.attributeName,r=a.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(a=a.type)||4===a&&!0===n?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(g,b);v[t]=new m(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(g,b);v[t]=new m(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(g,b);v[t]=new m(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){v[e]=new m(e,1,!1,e.toLowerCase(),null,!1,!1)})),v.xlinkHref=new m("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){v[e]=new m(e,1,!1,e.toLowerCase(),null,!0,!0)}));var _=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,w=Symbol.for("react.element"),k=Symbol.for("react.portal"),x=Symbol.for("react.fragment"),S=Symbol.for("react.strict_mode"),R=Symbol.for("react.profiler"),P=Symbol.for("react.provider"),C=Symbol.for("react.context"),T=Symbol.for("react.forward_ref"),E=Symbol.for("react.suspense"),O=Symbol.for("react.suspense_list"),M=Symbol.for("react.memo"),I=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var D=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var j=Symbol.iterator;function L(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=j&&e[j]||e["@@iterator"])?e:null}var A,F=Object.assign;function N(e){if(void 0===A)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);A=t&&t[1]||""}return"\n"+A+e}var B=!1;function U(e,t){if(!e||B)return"";B=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(u){var r=u}Reflect.construct(e,[],t)}else{try{t.call()}catch(u){r=u}e.call(t.prototype)}else{try{throw Error()}catch(u){r=u}e()}}catch(u){if(u&&r&&"string"===typeof u.stack){for(var a=u.stack.split("\n"),i=r.stack.split("\n"),s=a.length-1,o=i.length-1;1<=s&&0<=o&&a[s]!==i[o];)o--;for(;1<=s&&0<=o;s--,o--)if(a[s]!==i[o]){if(1!==s||1!==o)do{if(s--,0>--o||a[s]!==i[o]){var c="\n"+a[s].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}}while(1<=s&&0<=o);break}}}finally{B=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?N(e):""}function z(e){switch(e.tag){case 5:return N(e.type);case 16:return N("Lazy");case 13:return N("Suspense");case 19:return N("SuspenseList");case 0:case 2:case 15:return e=U(e.type,!1);case 11:return e=U(e.type.render,!1);case 1:return e=U(e.type,!0);default:return""}}function V(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case x:return"Fragment";case k:return"Portal";case R:return"Profiler";case S:return"StrictMode";case E:return"Suspense";case O:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case C:return(e.displayName||"Context")+".Consumer";case P:return(e._context.displayName||"Context")+".Provider";case T:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case M:return null!==(t=e.displayName||null)?t:V(e.type)||"Memo";case I:t=e._payload,e=e._init;try{return V(e(t))}catch(n){}}return null}function H(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return V(t);case 8:return t===S?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function W(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function q(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function G(e){e._valueTracker||(e._valueTracker=function(e){var t=q(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var a=n.get,i=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(e){r=""+e,i.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function K(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=q(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function X(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function Q(e,t){var n=t.checked;return F({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function $(e,t){var n=null==t.defaultValue?"":t.defaultValue,r=null!=t.checked?t.checked:t.defaultChecked;n=W(null!=t.value?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function J(e,t){null!=(t=t.checked)&&y(e,"checked",t,!1)}function Y(e,t){J(e,t);var n=W(t.value),r=t.type;if(null!=n)"number"===r?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===r||"reset"===r)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,n):t.hasOwnProperty("defaultValue")&&ee(e,t.type,W(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function Z(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!("submit"!==r&&"reset"!==r||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function ee(e,t,n){"number"===t&&X(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var te=Array.isArray;function ne(e,t,n,r){if(e=e.options,t){t={};for(var a=0;a<n.length;a++)t["$"+n[a]]=!0;for(n=0;n<e.length;n++)a=t.hasOwnProperty("$"+e[n].value),e[n].selected!==a&&(e[n].selected=a),a&&r&&(e[n].defaultSelected=!0)}else{for(n=""+W(n),t=null,a=0;a<e.length;a++){if(e[a].value===n)return e[a].selected=!0,void(r&&(e[a].defaultSelected=!0));null!==t||e[a].disabled||(t=e[a])}null!==t&&(t.selected=!0)}}function re(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(i(91));return F({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ae(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(i(92));if(te(n)){if(1<n.length)throw Error(i(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:W(n)}}function ie(e,t){var n=W(t.value),r=W(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=r&&(e.defaultValue=""+r)}function se(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function oe(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ce(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?oe(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ue,le,de=(le=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ue=ue||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ue.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,r){MSApp.execUnsafeLocalFunction((function(){return le(e,t)}))}:le);function pe(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var fe={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},he=["Webkit","ms","Moz","O"];function me(e,t,n){return null==t||"boolean"===typeof t||""===t?"":n||"number"!==typeof t||0===t||fe.hasOwnProperty(e)&&fe[e]?(""+t).trim():t+"px"}function ve(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var r=0===n.indexOf("--"),a=me(n,t[n],r);"float"===n&&(n="cssFloat"),r?e.setProperty(n,a):e[n]=a}}Object.keys(fe).forEach((function(e){he.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),fe[t]=fe[e]}))}));var ge=F({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function be(e,t){if(t){if(ge[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(i(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(i(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(i(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(i(62))}}function ye(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var _e=null;function we(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var ke=null,xe=null,Se=null;function Re(e){if(e=ya(e)){if("function"!==typeof ke)throw Error(i(280));var t=e.stateNode;t&&(t=wa(t),ke(e.stateNode,e.type,t))}}function Pe(e){xe?Se?Se.push(e):Se=[e]:xe=e}function Ce(){if(xe){var e=xe,t=Se;if(Se=xe=null,Re(e),t)for(e=0;e<t.length;e++)Re(t[e])}}function Te(e,t){return e(t)}function Ee(){}var Oe=!1;function Me(e,t,n){if(Oe)return e(t,n);Oe=!0;try{return Te(e,t,n)}finally{Oe=!1,(null!==xe||null!==Se)&&(Ee(),Ce())}}function Ie(e,t){var n=e.stateNode;if(null===n)return null;var r=wa(n);if(null===r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(i(231,t,typeof n));return n}var De=!1;if(l)try{var je={};Object.defineProperty(je,"passive",{get:function(){De=!0}}),window.addEventListener("test",je,je),window.removeEventListener("test",je,je)}catch(le){De=!1}function Le(e,t,n,r,a,i,s,o,c){var u=Array.prototype.slice.call(arguments,3);try{t.apply(n,u)}catch(l){this.onError(l)}}var Ae=!1,Fe=null,Ne=!1,Be=null,Ue={onError:function(e){Ae=!0,Fe=e}};function ze(e,t,n,r,a,i,s,o,c){Ae=!1,Fe=null,Le.apply(Ue,arguments)}function Ve(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function He(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function We(e){if(Ve(e)!==e)throw Error(i(188))}function qe(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=Ve(e)))throw Error(i(188));return t!==e?null:e}for(var n=e,r=t;;){var a=n.return;if(null===a)break;var s=a.alternate;if(null===s){if(null!==(r=a.return)){n=r;continue}break}if(a.child===s.child){for(s=a.child;s;){if(s===n)return We(a),e;if(s===r)return We(a),t;s=s.sibling}throw Error(i(188))}if(n.return!==r.return)n=a,r=s;else{for(var o=!1,c=a.child;c;){if(c===n){o=!0,n=a,r=s;break}if(c===r){o=!0,r=a,n=s;break}c=c.sibling}if(!o){for(c=s.child;c;){if(c===n){o=!0,n=s,r=a;break}if(c===r){o=!0,r=s,n=a;break}c=c.sibling}if(!o)throw Error(i(189))}}if(n.alternate!==r)throw Error(i(190))}if(3!==n.tag)throw Error(i(188));return n.stateNode.current===n?e:t}(e))?Ge(e):null}function Ge(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=Ge(e);if(null!==t)return t;e=e.sibling}return null}var Ke=a.unstable_scheduleCallback,Xe=a.unstable_cancelCallback,Qe=a.unstable_shouldYield,$e=a.unstable_requestPaint,Je=a.unstable_now,Ye=a.unstable_getCurrentPriorityLevel,Ze=a.unstable_ImmediatePriority,et=a.unstable_UserBlockingPriority,tt=a.unstable_NormalPriority,nt=a.unstable_LowPriority,rt=a.unstable_IdlePriority,at=null,it=null;var st=Math.clz32?Math.clz32:function(e){return 0===(e>>>=0)?32:31-(ot(e)/ct|0)|0},ot=Math.log,ct=Math.LN2;var ut=64,lt=4194304;function dt(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function pt(e,t){var n=e.pendingLanes;if(0===n)return 0;var r=0,a=e.suspendedLanes,i=e.pingedLanes,s=268435455&n;if(0!==s){var o=s&~a;0!==o?r=dt(o):0!==(i&=s)&&(r=dt(i))}else 0!==(s=n&~a)?r=dt(s):0!==i&&(r=dt(i));if(0===r)return 0;if(0!==t&&t!==r&&0===(t&a)&&((a=r&-r)>=(i=t&-t)||16===a&&0!==(4194240&i)))return t;if(0!==(4&r)&&(r|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=r;0<t;)a=1<<(n=31-st(t)),r|=e[n],t&=~a;return r}function ft(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function ht(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function mt(){var e=ut;return 0===(4194240&(ut<<=1))&&(ut=64),e}function vt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function gt(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-st(t)]=n}function bt(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-st(n),a=1<<r;a&t|e[r]&t&&(e[r]|=t),n&=~a}}var yt=0;function _t(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var wt,kt,xt,St,Rt,Pt=!1,Ct=[],Tt=null,Et=null,Ot=null,Mt=new Map,It=new Map,Dt=[],jt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Lt(e,t){switch(e){case"focusin":case"focusout":Tt=null;break;case"dragenter":case"dragleave":Et=null;break;case"mouseover":case"mouseout":Ot=null;break;case"pointerover":case"pointerout":Mt.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":It.delete(t.pointerId)}}function At(e,t,n,r,a,i){return null===e||e.nativeEvent!==i?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[a]},null!==t&&(null!==(t=ya(t))&&kt(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==a&&-1===t.indexOf(a)&&t.push(a),e)}function Ft(e){var t=ba(e.target);if(null!==t){var n=Ve(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=He(n)))return e.blockedOn=t,void Rt(e.priority,(function(){xt(n)}))}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function Nt(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Qt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=ya(n))&&kt(t),e.blockedOn=n,!1;var r=new(n=e.nativeEvent).constructor(n.type,n);_e=r,n.target.dispatchEvent(r),_e=null,t.shift()}return!0}function Bt(e,t,n){Nt(e)&&n.delete(t)}function Ut(){Pt=!1,null!==Tt&&Nt(Tt)&&(Tt=null),null!==Et&&Nt(Et)&&(Et=null),null!==Ot&&Nt(Ot)&&(Ot=null),Mt.forEach(Bt),It.forEach(Bt)}function zt(e,t){e.blockedOn===t&&(e.blockedOn=null,Pt||(Pt=!0,a.unstable_scheduleCallback(a.unstable_NormalPriority,Ut)))}function Vt(e){function t(t){return zt(t,e)}if(0<Ct.length){zt(Ct[0],e);for(var n=1;n<Ct.length;n++){var r=Ct[n];r.blockedOn===e&&(r.blockedOn=null)}}for(null!==Tt&&zt(Tt,e),null!==Et&&zt(Et,e),null!==Ot&&zt(Ot,e),Mt.forEach(t),It.forEach(t),n=0;n<Dt.length;n++)(r=Dt[n]).blockedOn===e&&(r.blockedOn=null);for(;0<Dt.length&&null===(n=Dt[0]).blockedOn;)Ft(n),null===n.blockedOn&&Dt.shift()}var Ht=_.ReactCurrentBatchConfig,Wt=!0;function qt(e,t,n,r){var a=yt,i=Ht.transition;Ht.transition=null;try{yt=1,Kt(e,t,n,r)}finally{yt=a,Ht.transition=i}}function Gt(e,t,n,r){var a=yt,i=Ht.transition;Ht.transition=null;try{yt=4,Kt(e,t,n,r)}finally{yt=a,Ht.transition=i}}function Kt(e,t,n,r){if(Wt){var a=Qt(e,t,n,r);if(null===a)Wr(e,t,r,Xt,n),Lt(e,r);else if(function(e,t,n,r,a){switch(t){case"focusin":return Tt=At(Tt,e,t,n,r,a),!0;case"dragenter":return Et=At(Et,e,t,n,r,a),!0;case"mouseover":return Ot=At(Ot,e,t,n,r,a),!0;case"pointerover":var i=a.pointerId;return Mt.set(i,At(Mt.get(i)||null,e,t,n,r,a)),!0;case"gotpointercapture":return i=a.pointerId,It.set(i,At(It.get(i)||null,e,t,n,r,a)),!0}return!1}(a,e,t,n,r))r.stopPropagation();else if(Lt(e,r),4&t&&-1<jt.indexOf(e)){for(;null!==a;){var i=ya(a);if(null!==i&&wt(i),null===(i=Qt(e,t,n,r))&&Wr(e,t,r,Xt,n),i===a)break;a=i}null!==a&&r.stopPropagation()}else Wr(e,t,r,null,n)}}var Xt=null;function Qt(e,t,n,r){if(Xt=null,null!==(e=ba(e=we(r))))if(null===(t=Ve(e)))e=null;else if(13===(n=t.tag)){if(null!==(e=He(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Xt=e,null}function $t(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Ye()){case Ze:return 1;case et:return 4;case tt:case nt:return 16;case rt:return 536870912;default:return 16}default:return 16}}var Jt=null,Yt=null,Zt=null;function en(){if(Zt)return Zt;var e,t,n=Yt,r=n.length,a="value"in Jt?Jt.value:Jt.textContent,i=a.length;for(e=0;e<r&&n[e]===a[e];e++);var s=r-e;for(t=1;t<=s&&n[r-t]===a[i-t];t++);return Zt=a.slice(e,1<t?1-t:void 0)}function tn(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function nn(){return!0}function rn(){return!1}function an(e){function t(t,n,r,a,i){for(var s in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=a,this.target=i,this.currentTarget=null,e)e.hasOwnProperty(s)&&(t=e[s],this[s]=t?t(a):a[s]);return this.isDefaultPrevented=(null!=a.defaultPrevented?a.defaultPrevented:!1===a.returnValue)?nn:rn,this.isPropagationStopped=rn,this}return F(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=nn)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=nn)},persist:function(){},isPersistent:nn}),t}var sn,on,cn,un={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ln=an(un),dn=F({},un,{view:0,detail:0}),pn=an(dn),fn=F({},dn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Rn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==cn&&(cn&&"mousemove"===e.type?(sn=e.screenX-cn.screenX,on=e.screenY-cn.screenY):on=sn=0,cn=e),sn)},movementY:function(e){return"movementY"in e?e.movementY:on}}),hn=an(fn),mn=an(F({},fn,{dataTransfer:0})),vn=an(F({},dn,{relatedTarget:0})),gn=an(F({},un,{animationName:0,elapsedTime:0,pseudoElement:0})),bn=F({},un,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),yn=an(bn),_n=an(F({},un,{data:0})),wn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},kn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},xn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Sn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=xn[e])&&!!t[e]}function Rn(){return Sn}var Pn=F({},dn,{key:function(e){if(e.key){var t=wn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=tn(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?kn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Rn,charCode:function(e){return"keypress"===e.type?tn(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?tn(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),Cn=an(Pn),Tn=an(F({},fn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),En=an(F({},dn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Rn})),On=an(F({},un,{propertyName:0,elapsedTime:0,pseudoElement:0})),Mn=F({},fn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),In=an(Mn),Dn=[9,13,27,32],jn=l&&"CompositionEvent"in window,Ln=null;l&&"documentMode"in document&&(Ln=document.documentMode);var An=l&&"TextEvent"in window&&!Ln,Fn=l&&(!jn||Ln&&8<Ln&&11>=Ln),Nn=String.fromCharCode(32),Bn=!1;function Un(e,t){switch(e){case"keyup":return-1!==Dn.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function zn(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Vn=!1;var Hn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Wn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Hn[e.type]:"textarea"===t}function qn(e,t,n,r){Pe(r),0<(t=Gr(t,"onChange")).length&&(n=new ln("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Gn=null,Kn=null;function Xn(e){Nr(e,0)}function Qn(e){if(K(_a(e)))return e}function $n(e,t){if("change"===e)return t}var Jn=!1;if(l){var Yn;if(l){var Zn="oninput"in document;if(!Zn){var er=document.createElement("div");er.setAttribute("oninput","return;"),Zn="function"===typeof er.oninput}Yn=Zn}else Yn=!1;Jn=Yn&&(!document.documentMode||9<document.documentMode)}function tr(){Gn&&(Gn.detachEvent("onpropertychange",nr),Kn=Gn=null)}function nr(e){if("value"===e.propertyName&&Qn(Kn)){var t=[];qn(t,Kn,e,we(e)),Me(Xn,t)}}function rr(e,t,n){"focusin"===e?(tr(),Kn=n,(Gn=t).attachEvent("onpropertychange",nr)):"focusout"===e&&tr()}function ar(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Qn(Kn)}function ir(e,t){if("click"===e)return Qn(t)}function sr(e,t){if("input"===e||"change"===e)return Qn(t)}var or="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function cr(e,t){if(or(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var a=n[r];if(!d.call(t,a)||!or(e[a],t[a]))return!1}return!0}function ur(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function lr(e,t){var n,r=ur(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=ur(r)}}function dr(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?dr(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function pr(){for(var e=window,t=X();t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(r){n=!1}if(!n)break;t=X((e=t.contentWindow).document)}return t}function fr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function hr(e){var t=pr(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&dr(n.ownerDocument.documentElement,n)){if(null!==r&&fr(n))if(t=r.start,void 0===(e=r.end)&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if((e=(t=n.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var a=n.textContent.length,i=Math.min(r.start,a);r=void 0===r.end?i:Math.min(r.end,a),!e.extend&&i>r&&(a=r,r=i,i=a),a=lr(n,i);var s=lr(n,r);a&&s&&(1!==e.rangeCount||e.anchorNode!==a.node||e.anchorOffset!==a.offset||e.focusNode!==s.node||e.focusOffset!==s.offset)&&((t=t.createRange()).setStart(a.node,a.offset),e.removeAllRanges(),i>r?(e.addRange(t),e.extend(s.node,s.offset)):(t.setEnd(s.node,s.offset),e.addRange(t)))}for(t=[],e=n;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof n.focus&&n.focus(),n=0;n<t.length;n++)(e=t[n]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var mr=l&&"documentMode"in document&&11>=document.documentMode,vr=null,gr=null,br=null,yr=!1;function _r(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;yr||null==vr||vr!==X(r)||("selectionStart"in(r=vr)&&fr(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},br&&cr(br,r)||(br=r,0<(r=Gr(gr,"onSelect")).length&&(t=new ln("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=vr)))}function wr(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var kr={animationend:wr("Animation","AnimationEnd"),animationiteration:wr("Animation","AnimationIteration"),animationstart:wr("Animation","AnimationStart"),transitionend:wr("Transition","TransitionEnd")},xr={},Sr={};function Rr(e){if(xr[e])return xr[e];if(!kr[e])return e;var t,n=kr[e];for(t in n)if(n.hasOwnProperty(t)&&t in Sr)return xr[e]=n[t];return e}l&&(Sr=document.createElement("div").style,"AnimationEvent"in window||(delete kr.animationend.animation,delete kr.animationiteration.animation,delete kr.animationstart.animation),"TransitionEvent"in window||delete kr.transitionend.transition);var Pr=Rr("animationend"),Cr=Rr("animationiteration"),Tr=Rr("animationstart"),Er=Rr("transitionend"),Or=new Map,Mr="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ir(e,t){Or.set(e,t),c(t,[e])}for(var Dr=0;Dr<Mr.length;Dr++){var jr=Mr[Dr];Ir(jr.toLowerCase(),"on"+(jr[0].toUpperCase()+jr.slice(1)))}Ir(Pr,"onAnimationEnd"),Ir(Cr,"onAnimationIteration"),Ir(Tr,"onAnimationStart"),Ir("dblclick","onDoubleClick"),Ir("focusin","onFocus"),Ir("focusout","onBlur"),Ir(Er,"onTransitionEnd"),u("onMouseEnter",["mouseout","mouseover"]),u("onMouseLeave",["mouseout","mouseover"]),u("onPointerEnter",["pointerout","pointerover"]),u("onPointerLeave",["pointerout","pointerover"]),c("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),c("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),c("onBeforeInput",["compositionend","keypress","textInput","paste"]),c("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),c("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),c("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Lr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Ar=new Set("cancel close invalid load scroll toggle".split(" ").concat(Lr));function Fr(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,r,a,s,o,c,u){if(ze.apply(this,arguments),Ae){if(!Ae)throw Error(i(198));var l=Fe;Ae=!1,Fe=null,Ne||(Ne=!0,Be=l)}}(r,t,void 0,e),e.currentTarget=null}function Nr(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var r=e[n],a=r.event;r=r.listeners;e:{var i=void 0;if(t)for(var s=r.length-1;0<=s;s--){var o=r[s],c=o.instance,u=o.currentTarget;if(o=o.listener,c!==i&&a.isPropagationStopped())break e;Fr(a,o,u),i=c}else for(s=0;s<r.length;s++){if(c=(o=r[s]).instance,u=o.currentTarget,o=o.listener,c!==i&&a.isPropagationStopped())break e;Fr(a,o,u),i=c}}}if(Ne)throw e=Be,Ne=!1,Be=null,e}function Br(e,t){var n=t[ma];void 0===n&&(n=t[ma]=new Set);var r=e+"__bubble";n.has(r)||(Hr(t,e,2,!1),n.add(r))}function Ur(e,t,n){var r=0;t&&(r|=4),Hr(n,e,r,t)}var zr="_reactListening"+Math.random().toString(36).slice(2);function Vr(e){if(!e[zr]){e[zr]=!0,s.forEach((function(t){"selectionchange"!==t&&(Ar.has(t)||Ur(t,!1,e),Ur(t,!0,e))}));var t=9===e.nodeType?e:e.ownerDocument;null===t||t[zr]||(t[zr]=!0,Ur("selectionchange",!1,t))}}function Hr(e,t,n,r){switch($t(t)){case 1:var a=qt;break;case 4:a=Gt;break;default:a=Kt}n=a.bind(null,t,n,e),a=void 0,!De||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(a=!0),r?void 0!==a?e.addEventListener(t,n,{capture:!0,passive:a}):e.addEventListener(t,n,!0):void 0!==a?e.addEventListener(t,n,{passive:a}):e.addEventListener(t,n,!1)}function Wr(e,t,n,r,a){var i=r;if(0===(1&t)&&0===(2&t)&&null!==r)e:for(;;){if(null===r)return;var s=r.tag;if(3===s||4===s){var o=r.stateNode.containerInfo;if(o===a||8===o.nodeType&&o.parentNode===a)break;if(4===s)for(s=r.return;null!==s;){var c=s.tag;if((3===c||4===c)&&((c=s.stateNode.containerInfo)===a||8===c.nodeType&&c.parentNode===a))return;s=s.return}for(;null!==o;){if(null===(s=ba(o)))return;if(5===(c=s.tag)||6===c){r=i=s;continue e}o=o.parentNode}}r=r.return}Me((function(){var r=i,a=we(n),s=[];e:{var o=Or.get(e);if(void 0!==o){var c=ln,u=e;switch(e){case"keypress":if(0===tn(n))break e;case"keydown":case"keyup":c=Cn;break;case"focusin":u="focus",c=vn;break;case"focusout":u="blur",c=vn;break;case"beforeblur":case"afterblur":c=vn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":c=hn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":c=mn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":c=En;break;case Pr:case Cr:case Tr:c=gn;break;case Er:c=On;break;case"scroll":c=pn;break;case"wheel":c=In;break;case"copy":case"cut":case"paste":c=yn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":c=Tn}var l=0!==(4&t),d=!l&&"scroll"===e,p=l?null!==o?o+"Capture":null:o;l=[];for(var f,h=r;null!==h;){var m=(f=h).stateNode;if(5===f.tag&&null!==m&&(f=m,null!==p&&(null!=(m=Ie(h,p))&&l.push(qr(h,m,f)))),d)break;h=h.return}0<l.length&&(o=new c(o,u,null,n,a),s.push({event:o,listeners:l}))}}if(0===(7&t)){if(c="mouseout"===e||"pointerout"===e,(!(o="mouseover"===e||"pointerover"===e)||n===_e||!(u=n.relatedTarget||n.fromElement)||!ba(u)&&!u[ha])&&(c||o)&&(o=a.window===a?a:(o=a.ownerDocument)?o.defaultView||o.parentWindow:window,c?(c=r,null!==(u=(u=n.relatedTarget||n.toElement)?ba(u):null)&&(u!==(d=Ve(u))||5!==u.tag&&6!==u.tag)&&(u=null)):(c=null,u=r),c!==u)){if(l=hn,m="onMouseLeave",p="onMouseEnter",h="mouse","pointerout"!==e&&"pointerover"!==e||(l=Tn,m="onPointerLeave",p="onPointerEnter",h="pointer"),d=null==c?o:_a(c),f=null==u?o:_a(u),(o=new l(m,h+"leave",c,n,a)).target=d,o.relatedTarget=f,m=null,ba(a)===r&&((l=new l(p,h+"enter",u,n,a)).target=f,l.relatedTarget=d,m=l),d=m,c&&u)e:{for(p=u,h=0,f=l=c;f;f=Kr(f))h++;for(f=0,m=p;m;m=Kr(m))f++;for(;0<h-f;)l=Kr(l),h--;for(;0<f-h;)p=Kr(p),f--;for(;h--;){if(l===p||null!==p&&l===p.alternate)break e;l=Kr(l),p=Kr(p)}l=null}else l=null;null!==c&&Xr(s,o,c,l,!1),null!==u&&null!==d&&Xr(s,d,u,l,!0)}if("select"===(c=(o=r?_a(r):window).nodeName&&o.nodeName.toLowerCase())||"input"===c&&"file"===o.type)var v=$n;else if(Wn(o))if(Jn)v=sr;else{v=ar;var g=rr}else(c=o.nodeName)&&"input"===c.toLowerCase()&&("checkbox"===o.type||"radio"===o.type)&&(v=ir);switch(v&&(v=v(e,r))?qn(s,v,n,a):(g&&g(e,o,r),"focusout"===e&&(g=o._wrapperState)&&g.controlled&&"number"===o.type&&ee(o,"number",o.value)),g=r?_a(r):window,e){case"focusin":(Wn(g)||"true"===g.contentEditable)&&(vr=g,gr=r,br=null);break;case"focusout":br=gr=vr=null;break;case"mousedown":yr=!0;break;case"contextmenu":case"mouseup":case"dragend":yr=!1,_r(s,n,a);break;case"selectionchange":if(mr)break;case"keydown":case"keyup":_r(s,n,a)}var b;if(jn)e:{switch(e){case"compositionstart":var y="onCompositionStart";break e;case"compositionend":y="onCompositionEnd";break e;case"compositionupdate":y="onCompositionUpdate";break e}y=void 0}else Vn?Un(e,n)&&(y="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(y="onCompositionStart");y&&(Fn&&"ko"!==n.locale&&(Vn||"onCompositionStart"!==y?"onCompositionEnd"===y&&Vn&&(b=en()):(Yt="value"in(Jt=a)?Jt.value:Jt.textContent,Vn=!0)),0<(g=Gr(r,y)).length&&(y=new _n(y,e,null,n,a),s.push({event:y,listeners:g}),b?y.data=b:null!==(b=zn(n))&&(y.data=b))),(b=An?function(e,t){switch(e){case"compositionend":return zn(t);case"keypress":return 32!==t.which?null:(Bn=!0,Nn);case"textInput":return(e=t.data)===Nn&&Bn?null:e;default:return null}}(e,n):function(e,t){if(Vn)return"compositionend"===e||!jn&&Un(e,t)?(e=en(),Zt=Yt=Jt=null,Vn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Fn&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(r=Gr(r,"onBeforeInput")).length&&(a=new _n("onBeforeInput","beforeinput",null,n,a),s.push({event:a,listeners:r}),a.data=b))}Nr(s,t)}))}function qr(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Gr(e,t){for(var n=t+"Capture",r=[];null!==e;){var a=e,i=a.stateNode;5===a.tag&&null!==i&&(a=i,null!=(i=Ie(e,n))&&r.unshift(qr(e,i,a)),null!=(i=Ie(e,t))&&r.push(qr(e,i,a))),e=e.return}return r}function Kr(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Xr(e,t,n,r,a){for(var i=t._reactName,s=[];null!==n&&n!==r;){var o=n,c=o.alternate,u=o.stateNode;if(null!==c&&c===r)break;5===o.tag&&null!==u&&(o=u,a?null!=(c=Ie(n,i))&&s.unshift(qr(n,c,o)):a||null!=(c=Ie(n,i))&&s.push(qr(n,c,o))),n=n.return}0!==s.length&&e.push({event:t,listeners:s})}var Qr=/\r\n?/g,$r=/\u0000|\uFFFD/g;function Jr(e){return("string"===typeof e?e:""+e).replace(Qr,"\n").replace($r,"")}function Yr(e,t,n){if(t=Jr(t),Jr(e)!==t&&n)throw Error(i(425))}function Zr(){}var ea=null,ta=null;function na(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var ra="function"===typeof setTimeout?setTimeout:void 0,aa="function"===typeof clearTimeout?clearTimeout:void 0,ia="function"===typeof Promise?Promise:void 0,sa="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof ia?function(e){return ia.resolve(null).then(e).catch(oa)}:ra;function oa(e){setTimeout((function(){throw e}))}function ca(e,t){var n=t,r=0;do{var a=n.nextSibling;if(e.removeChild(n),a&&8===a.nodeType)if("/$"===(n=a.data)){if(0===r)return e.removeChild(a),void Vt(t);r--}else"$"!==n&&"$?"!==n&&"$!"!==n||r++;n=a}while(n);Vt(t)}function ua(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function la(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var da=Math.random().toString(36).slice(2),pa="__reactFiber$"+da,fa="__reactProps$"+da,ha="__reactContainer$"+da,ma="__reactEvents$"+da,va="__reactListeners$"+da,ga="__reactHandles$"+da;function ba(e){var t=e[pa];if(t)return t;for(var n=e.parentNode;n;){if(t=n[ha]||n[pa]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=la(e);null!==e;){if(n=e[pa])return n;e=la(e)}return t}n=(e=n).parentNode}return null}function ya(e){return!(e=e[pa]||e[ha])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function _a(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(i(33))}function wa(e){return e[fa]||null}var ka=[],xa=-1;function Sa(e){return{current:e}}function Ra(e){0>xa||(e.current=ka[xa],ka[xa]=null,xa--)}function Pa(e,t){xa++,ka[xa]=e.current,e.current=t}var Ca={},Ta=Sa(Ca),Ea=Sa(!1),Oa=Ca;function Ma(e,t){var n=e.type.contextTypes;if(!n)return Ca;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var a,i={};for(a in n)i[a]=t[a];return r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function Ia(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Da(){Ra(Ea),Ra(Ta)}function ja(e,t,n){if(Ta.current!==Ca)throw Error(i(168));Pa(Ta,t),Pa(Ea,n)}function La(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,"function"!==typeof r.getChildContext)return n;for(var a in r=r.getChildContext())if(!(a in t))throw Error(i(108,H(e)||"Unknown",a));return F({},n,r)}function Aa(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Ca,Oa=Ta.current,Pa(Ta,e),Pa(Ea,Ea.current),!0}function Fa(e,t,n){var r=e.stateNode;if(!r)throw Error(i(169));n?(e=La(e,t,Oa),r.__reactInternalMemoizedMergedChildContext=e,Ra(Ea),Ra(Ta),Pa(Ta,e)):Ra(Ea),Pa(Ea,n)}var Na=null,Ba=!1,Ua=!1;function za(e){null===Na?Na=[e]:Na.push(e)}function Va(){if(!Ua&&null!==Na){Ua=!0;var e=0,t=yt;try{var n=Na;for(yt=1;e<n.length;e++){var r=n[e];do{r=r(!0)}while(null!==r)}Na=null,Ba=!1}catch(a){throw null!==Na&&(Na=Na.slice(e+1)),Ke(Ze,Va),a}finally{yt=t,Ua=!1}}return null}var Ha=[],Wa=0,qa=null,Ga=0,Ka=[],Xa=0,Qa=null,$a=1,Ja="";function Ya(e,t){Ha[Wa++]=Ga,Ha[Wa++]=qa,qa=e,Ga=t}function Za(e,t,n){Ka[Xa++]=$a,Ka[Xa++]=Ja,Ka[Xa++]=Qa,Qa=e;var r=$a;e=Ja;var a=32-st(r)-1;r&=~(1<<a),n+=1;var i=32-st(t)+a;if(30<i){var s=a-a%5;i=(r&(1<<s)-1).toString(32),r>>=s,a-=s,$a=1<<32-st(t)+a|n<<a|r,Ja=i+e}else $a=1<<i|n<<a|r,Ja=e}function ei(e){null!==e.return&&(Ya(e,1),Za(e,1,0))}function ti(e){for(;e===qa;)qa=Ha[--Wa],Ha[Wa]=null,Ga=Ha[--Wa],Ha[Wa]=null;for(;e===Qa;)Qa=Ka[--Xa],Ka[Xa]=null,Ja=Ka[--Xa],Ka[Xa]=null,$a=Ka[--Xa],Ka[Xa]=null}var ni=null,ri=null,ai=!1,ii=null;function si(e,t){var n=Mu(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function oi(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,ni=e,ri=ua(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,ni=e,ri=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(n=null!==Qa?{id:$a,overflow:Ja}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=Mu(18,null,null,0)).stateNode=t,n.return=e,e.child=n,ni=e,ri=null,!0);default:return!1}}function ci(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function ui(e){if(ai){var t=ri;if(t){var n=t;if(!oi(e,t)){if(ci(e))throw Error(i(418));t=ua(n.nextSibling);var r=ni;t&&oi(e,t)?si(r,n):(e.flags=-4097&e.flags|2,ai=!1,ni=e)}}else{if(ci(e))throw Error(i(418));e.flags=-4097&e.flags|2,ai=!1,ni=e}}}function li(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;ni=e}function di(e){if(e!==ni)return!1;if(!ai)return li(e),ai=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!na(e.type,e.memoizedProps)),t&&(t=ri)){if(ci(e))throw pi(),Error(i(418));for(;t;)si(e,t),t=ua(t.nextSibling)}if(li(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(i(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){ri=ua(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}ri=null}}else ri=ni?ua(e.stateNode.nextSibling):null;return!0}function pi(){for(var e=ri;e;)e=ua(e.nextSibling)}function fi(){ri=ni=null,ai=!1}function hi(e){null===ii?ii=[e]:ii.push(e)}var mi=_.ReactCurrentBatchConfig;function vi(e,t){if(e&&e.defaultProps){for(var n in t=F({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}var gi=Sa(null),bi=null,yi=null,_i=null;function wi(){_i=yi=bi=null}function ki(e){var t=gi.current;Ra(gi),e._currentValue=t}function xi(e,t,n){for(;null!==e;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==r&&(r.childLanes|=t)):null!==r&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Si(e,t){bi=e,_i=yi=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(_o=!0),e.firstContext=null)}function Ri(e){var t=e._currentValue;if(_i!==e)if(e={context:e,memoizedValue:t,next:null},null===yi){if(null===bi)throw Error(i(308));yi=e,bi.dependencies={lanes:0,firstContext:e}}else yi=yi.next=e;return t}var Pi=null;function Ci(e){null===Pi?Pi=[e]:Pi.push(e)}function Ti(e,t,n,r){var a=t.interleaved;return null===a?(n.next=n,Ci(t)):(n.next=a.next,a.next=n),t.interleaved=n,Ei(e,r)}function Ei(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}var Oi=!1;function Mi(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Ii(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Di(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function ji(e,t,n){var r=e.updateQueue;if(null===r)return null;if(r=r.shared,0!==(2&Tc)){var a=r.pending;return null===a?t.next=t:(t.next=a.next,a.next=t),r.pending=t,Ei(e,n)}return null===(a=r.interleaved)?(t.next=t,Ci(r)):(t.next=a.next,a.next=t),r.interleaved=t,Ei(e,n)}function Li(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&n))){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,bt(e,n)}}function Ai(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var a=null,i=null;if(null!==(n=n.firstBaseUpdate)){do{var s={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===i?a=i=s:i=i.next=s,n=n.next}while(null!==n);null===i?a=i=t:i=i.next=t}else a=i=t;return n={baseState:r.baseState,firstBaseUpdate:a,lastBaseUpdate:i,shared:r.shared,effects:r.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Fi(e,t,n,r){var a=e.updateQueue;Oi=!1;var i=a.firstBaseUpdate,s=a.lastBaseUpdate,o=a.shared.pending;if(null!==o){a.shared.pending=null;var c=o,u=c.next;c.next=null,null===s?i=u:s.next=u,s=c;var l=e.alternate;null!==l&&((o=(l=l.updateQueue).lastBaseUpdate)!==s&&(null===o?l.firstBaseUpdate=u:o.next=u,l.lastBaseUpdate=c))}if(null!==i){var d=a.baseState;for(s=0,l=u=c=null,o=i;;){var p=o.lane,f=o.eventTime;if((r&p)===p){null!==l&&(l=l.next={eventTime:f,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var h=e,m=o;switch(p=t,f=n,m.tag){case 1:if("function"===typeof(h=m.payload)){d=h.call(f,d,p);break e}d=h;break e;case 3:h.flags=-65537&h.flags|128;case 0:if(null===(p="function"===typeof(h=m.payload)?h.call(f,d,p):h)||void 0===p)break e;d=F({},d,p);break e;case 2:Oi=!0}}null!==o.callback&&0!==o.lane&&(e.flags|=64,null===(p=a.effects)?a.effects=[o]:p.push(o))}else f={eventTime:f,lane:p,tag:o.tag,payload:o.payload,callback:o.callback,next:null},null===l?(u=l=f,c=d):l=l.next=f,s|=p;if(null===(o=o.next)){if(null===(o=a.shared.pending))break;o=(p=o).next,p.next=null,a.lastBaseUpdate=p,a.shared.pending=null}}if(null===l&&(c=d),a.baseState=c,a.firstBaseUpdate=u,a.lastBaseUpdate=l,null!==(t=a.shared.interleaved)){a=t;do{s|=a.lane,a=a.next}while(a!==t)}else null===i&&(a.shared.lanes=0);Ac|=s,e.lanes=s,e.memoizedState=d}}function Ni(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var r=e[t],a=r.callback;if(null!==a){if(r.callback=null,r=n,"function"!==typeof a)throw Error(i(191,a));a.call(r)}}}var Bi=(new r.Component).refs;function Ui(e,t,n,r){n=null===(n=n(r,t=e.memoizedState))||void 0===n?t:F({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var zi={isMounted:function(e){return!!(e=e._reactInternals)&&Ve(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=eu(),a=tu(e),i=Di(r,a);i.payload=t,void 0!==n&&null!==n&&(i.callback=n),null!==(t=ji(e,i,a))&&(nu(t,e,a,r),Li(t,e,a))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=eu(),a=tu(e),i=Di(r,a);i.tag=1,i.payload=t,void 0!==n&&null!==n&&(i.callback=n),null!==(t=ji(e,i,a))&&(nu(t,e,a,r),Li(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=eu(),r=tu(e),a=Di(n,r);a.tag=2,void 0!==t&&null!==t&&(a.callback=t),null!==(t=ji(e,a,r))&&(nu(t,e,r,n),Li(t,e,r))}};function Vi(e,t,n,r,a,i,s){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,i,s):!t.prototype||!t.prototype.isPureReactComponent||(!cr(n,r)||!cr(a,i))}function Hi(e,t,n){var r=!1,a=Ca,i=t.contextType;return"object"===typeof i&&null!==i?i=Ri(i):(a=Ia(t)?Oa:Ta.current,i=(r=null!==(r=t.contextTypes)&&void 0!==r)?Ma(e,a):Ca),t=new t(n,i),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=zi,e.stateNode=t,t._reactInternals=e,r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=i),t}function Wi(e,t,n,r){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&zi.enqueueReplaceState(t,t.state,null)}function qi(e,t,n,r){var a=e.stateNode;a.props=n,a.state=e.memoizedState,a.refs=Bi,Mi(e);var i=t.contextType;"object"===typeof i&&null!==i?a.context=Ri(i):(i=Ia(t)?Oa:Ta.current,a.context=Ma(e,i)),a.state=e.memoizedState,"function"===typeof(i=t.getDerivedStateFromProps)&&(Ui(e,t,i,n),a.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof a.getSnapshotBeforeUpdate||"function"!==typeof a.UNSAFE_componentWillMount&&"function"!==typeof a.componentWillMount||(t=a.state,"function"===typeof a.componentWillMount&&a.componentWillMount(),"function"===typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount(),t!==a.state&&zi.enqueueReplaceState(a,a.state,null),Fi(e,n,a,r),a.state=e.memoizedState),"function"===typeof a.componentDidMount&&(e.flags|=4194308)}function Gi(e,t,n){if(null!==(e=n.ref)&&"function"!==typeof e&&"object"!==typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(i(309));var r=n.stateNode}if(!r)throw Error(i(147,e));var a=r,s=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===s?t.ref:(t=function(e){var t=a.refs;t===Bi&&(t=a.refs={}),null===e?delete t[s]:t[s]=e},t._stringRef=s,t)}if("string"!==typeof e)throw Error(i(284));if(!n._owner)throw Error(i(290,e))}return e}function Ki(e,t){throw e=Object.prototype.toString.call(t),Error(i(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Xi(e){return(0,e._init)(e._payload)}function Qi(e){function t(t,n){if(e){var r=t.deletions;null===r?(t.deletions=[n],t.flags|=16):r.push(n)}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function a(e,t){return(e=Du(e,t)).index=0,e.sibling=null,e}function s(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags|=2,n):r:(t.flags|=2,n):(t.flags|=1048576,n)}function o(t){return e&&null===t.alternate&&(t.flags|=2),t}function c(e,t,n,r){return null===t||6!==t.tag?((t=Fu(n,e.mode,r)).return=e,t):((t=a(t,n)).return=e,t)}function u(e,t,n,r){var i=n.type;return i===x?d(e,t,n.props.children,r,n.key):null!==t&&(t.elementType===i||"object"===typeof i&&null!==i&&i.$$typeof===I&&Xi(i)===t.type)?((r=a(t,n.props)).ref=Gi(e,t,n),r.return=e,r):((r=ju(n.type,n.key,n.props,null,e.mode,r)).ref=Gi(e,t,n),r.return=e,r)}function l(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Nu(n,e.mode,r)).return=e,t):((t=a(t,n.children||[])).return=e,t)}function d(e,t,n,r,i){return null===t||7!==t.tag?((t=Lu(n,e.mode,r,i)).return=e,t):((t=a(t,n)).return=e,t)}function p(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=Fu(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case w:return(n=ju(t.type,t.key,t.props,null,e.mode,n)).ref=Gi(e,null,t),n.return=e,n;case k:return(t=Nu(t,e.mode,n)).return=e,t;case I:return p(e,(0,t._init)(t._payload),n)}if(te(t)||L(t))return(t=Lu(t,e.mode,n,null)).return=e,t;Ki(e,t)}return null}function f(e,t,n,r){var a=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n)return null!==a?null:c(e,t,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case w:return n.key===a?u(e,t,n,r):null;case k:return n.key===a?l(e,t,n,r):null;case I:return f(e,t,(a=n._init)(n._payload),r)}if(te(n)||L(n))return null!==a?null:d(e,t,n,r,null);Ki(e,n)}return null}function h(e,t,n,r,a){if("string"===typeof r&&""!==r||"number"===typeof r)return c(t,e=e.get(n)||null,""+r,a);if("object"===typeof r&&null!==r){switch(r.$$typeof){case w:return u(t,e=e.get(null===r.key?n:r.key)||null,r,a);case k:return l(t,e=e.get(null===r.key?n:r.key)||null,r,a);case I:return h(e,t,n,(0,r._init)(r._payload),a)}if(te(r)||L(r))return d(t,e=e.get(n)||null,r,a,null);Ki(t,r)}return null}function m(a,i,o,c){for(var u=null,l=null,d=i,m=i=0,v=null;null!==d&&m<o.length;m++){d.index>m?(v=d,d=null):v=d.sibling;var g=f(a,d,o[m],c);if(null===g){null===d&&(d=v);break}e&&d&&null===g.alternate&&t(a,d),i=s(g,i,m),null===l?u=g:l.sibling=g,l=g,d=v}if(m===o.length)return n(a,d),ai&&Ya(a,m),u;if(null===d){for(;m<o.length;m++)null!==(d=p(a,o[m],c))&&(i=s(d,i,m),null===l?u=d:l.sibling=d,l=d);return ai&&Ya(a,m),u}for(d=r(a,d);m<o.length;m++)null!==(v=h(d,a,m,o[m],c))&&(e&&null!==v.alternate&&d.delete(null===v.key?m:v.key),i=s(v,i,m),null===l?u=v:l.sibling=v,l=v);return e&&d.forEach((function(e){return t(a,e)})),ai&&Ya(a,m),u}function v(a,o,c,u){var l=L(c);if("function"!==typeof l)throw Error(i(150));if(null==(c=l.call(c)))throw Error(i(151));for(var d=l=null,m=o,v=o=0,g=null,b=c.next();null!==m&&!b.done;v++,b=c.next()){m.index>v?(g=m,m=null):g=m.sibling;var y=f(a,m,b.value,u);if(null===y){null===m&&(m=g);break}e&&m&&null===y.alternate&&t(a,m),o=s(y,o,v),null===d?l=y:d.sibling=y,d=y,m=g}if(b.done)return n(a,m),ai&&Ya(a,v),l;if(null===m){for(;!b.done;v++,b=c.next())null!==(b=p(a,b.value,u))&&(o=s(b,o,v),null===d?l=b:d.sibling=b,d=b);return ai&&Ya(a,v),l}for(m=r(a,m);!b.done;v++,b=c.next())null!==(b=h(m,a,v,b.value,u))&&(e&&null!==b.alternate&&m.delete(null===b.key?v:b.key),o=s(b,o,v),null===d?l=b:d.sibling=b,d=b);return e&&m.forEach((function(e){return t(a,e)})),ai&&Ya(a,v),l}return function e(r,i,s,c){if("object"===typeof s&&null!==s&&s.type===x&&null===s.key&&(s=s.props.children),"object"===typeof s&&null!==s){switch(s.$$typeof){case w:e:{for(var u=s.key,l=i;null!==l;){if(l.key===u){if((u=s.type)===x){if(7===l.tag){n(r,l.sibling),(i=a(l,s.props.children)).return=r,r=i;break e}}else if(l.elementType===u||"object"===typeof u&&null!==u&&u.$$typeof===I&&Xi(u)===l.type){n(r,l.sibling),(i=a(l,s.props)).ref=Gi(r,l,s),i.return=r,r=i;break e}n(r,l);break}t(r,l),l=l.sibling}s.type===x?((i=Lu(s.props.children,r.mode,c,s.key)).return=r,r=i):((c=ju(s.type,s.key,s.props,null,r.mode,c)).ref=Gi(r,i,s),c.return=r,r=c)}return o(r);case k:e:{for(l=s.key;null!==i;){if(i.key===l){if(4===i.tag&&i.stateNode.containerInfo===s.containerInfo&&i.stateNode.implementation===s.implementation){n(r,i.sibling),(i=a(i,s.children||[])).return=r,r=i;break e}n(r,i);break}t(r,i),i=i.sibling}(i=Nu(s,r.mode,c)).return=r,r=i}return o(r);case I:return e(r,i,(l=s._init)(s._payload),c)}if(te(s))return m(r,i,s,c);if(L(s))return v(r,i,s,c);Ki(r,s)}return"string"===typeof s&&""!==s||"number"===typeof s?(s=""+s,null!==i&&6===i.tag?(n(r,i.sibling),(i=a(i,s)).return=r,r=i):(n(r,i),(i=Fu(s,r.mode,c)).return=r,r=i),o(r)):n(r,i)}}var $i=Qi(!0),Ji=Qi(!1),Yi={},Zi=Sa(Yi),es=Sa(Yi),ts=Sa(Yi);function ns(e){if(e===Yi)throw Error(i(174));return e}function rs(e,t){switch(Pa(ts,t),Pa(es,e),Pa(Zi,Yi),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:ce(null,"");break;default:t=ce(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}Ra(Zi),Pa(Zi,t)}function as(){Ra(Zi),Ra(es),Ra(ts)}function is(e){ns(ts.current);var t=ns(Zi.current),n=ce(t,e.type);t!==n&&(Pa(es,e),Pa(Zi,n))}function ss(e){es.current===e&&(Ra(Zi),Ra(es))}var os=Sa(0);function cs(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var us=[];function ls(){for(var e=0;e<us.length;e++)us[e]._workInProgressVersionPrimary=null;us.length=0}var ds=_.ReactCurrentDispatcher,ps=_.ReactCurrentBatchConfig,fs=0,hs=null,ms=null,vs=null,gs=!1,bs=!1,ys=0,_s=0;function ws(){throw Error(i(321))}function ks(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!or(e[n],t[n]))return!1;return!0}function xs(e,t,n,r,a,s){if(fs=s,hs=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,ds.current=null===e||null===e.memoizedState?so:oo,e=n(r,a),bs){s=0;do{if(bs=!1,ys=0,25<=s)throw Error(i(301));s+=1,vs=ms=null,t.updateQueue=null,ds.current=co,e=n(r,a)}while(bs)}if(ds.current=io,t=null!==ms&&null!==ms.next,fs=0,vs=ms=hs=null,gs=!1,t)throw Error(i(300));return e}function Ss(){var e=0!==ys;return ys=0,e}function Rs(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===vs?hs.memoizedState=vs=e:vs=vs.next=e,vs}function Ps(){if(null===ms){var e=hs.alternate;e=null!==e?e.memoizedState:null}else e=ms.next;var t=null===vs?hs.memoizedState:vs.next;if(null!==t)vs=t,ms=e;else{if(null===e)throw Error(i(310));e={memoizedState:(ms=e).memoizedState,baseState:ms.baseState,baseQueue:ms.baseQueue,queue:ms.queue,next:null},null===vs?hs.memoizedState=vs=e:vs=vs.next=e}return vs}function Cs(e,t){return"function"===typeof t?t(e):t}function Ts(e){var t=Ps(),n=t.queue;if(null===n)throw Error(i(311));n.lastRenderedReducer=e;var r=ms,a=r.baseQueue,s=n.pending;if(null!==s){if(null!==a){var o=a.next;a.next=s.next,s.next=o}r.baseQueue=a=s,n.pending=null}if(null!==a){s=a.next,r=r.baseState;var c=o=null,u=null,l=s;do{var d=l.lane;if((fs&d)===d)null!==u&&(u=u.next={lane:0,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null}),r=l.hasEagerState?l.eagerState:e(r,l.action);else{var p={lane:d,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null};null===u?(c=u=p,o=r):u=u.next=p,hs.lanes|=d,Ac|=d}l=l.next}while(null!==l&&l!==s);null===u?o=r:u.next=c,or(r,t.memoizedState)||(_o=!0),t.memoizedState=r,t.baseState=o,t.baseQueue=u,n.lastRenderedState=r}if(null!==(e=n.interleaved)){a=e;do{s=a.lane,hs.lanes|=s,Ac|=s,a=a.next}while(a!==e)}else null===a&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function Es(e){var t=Ps(),n=t.queue;if(null===n)throw Error(i(311));n.lastRenderedReducer=e;var r=n.dispatch,a=n.pending,s=t.memoizedState;if(null!==a){n.pending=null;var o=a=a.next;do{s=e(s,o.action),o=o.next}while(o!==a);or(s,t.memoizedState)||(_o=!0),t.memoizedState=s,null===t.baseQueue&&(t.baseState=s),n.lastRenderedState=s}return[s,r]}function Os(){}function Ms(e,t){var n=hs,r=Ps(),a=t(),s=!or(r.memoizedState,a);if(s&&(r.memoizedState=a,_o=!0),r=r.queue,Hs(js.bind(null,n,r,e),[e]),r.getSnapshot!==t||s||null!==vs&&1&vs.memoizedState.tag){if(n.flags|=2048,Ns(9,Ds.bind(null,n,r,a,t),void 0,null),null===Ec)throw Error(i(349));0!==(30&fs)||Is(n,t,a)}return a}function Is(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=hs.updateQueue)?(t={lastEffect:null,stores:null},hs.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function Ds(e,t,n,r){t.value=n,t.getSnapshot=r,Ls(t)&&As(e)}function js(e,t,n){return n((function(){Ls(t)&&As(e)}))}function Ls(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!or(e,n)}catch(r){return!0}}function As(e){var t=Ei(e,1);null!==t&&nu(t,e,1,-1)}function Fs(e){var t=Rs();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Cs,lastRenderedState:e},t.queue=e,e=e.dispatch=to.bind(null,hs,e),[t.memoizedState,e]}function Ns(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},null===(t=hs.updateQueue)?(t={lastEffect:null,stores:null},hs.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function Bs(){return Ps().memoizedState}function Us(e,t,n,r){var a=Rs();hs.flags|=e,a.memoizedState=Ns(1|t,n,void 0,void 0===r?null:r)}function zs(e,t,n,r){var a=Ps();r=void 0===r?null:r;var i=void 0;if(null!==ms){var s=ms.memoizedState;if(i=s.destroy,null!==r&&ks(r,s.deps))return void(a.memoizedState=Ns(t,n,i,r))}hs.flags|=e,a.memoizedState=Ns(1|t,n,i,r)}function Vs(e,t){return Us(8390656,8,e,t)}function Hs(e,t){return zs(2048,8,e,t)}function Ws(e,t){return zs(4,2,e,t)}function qs(e,t){return zs(4,4,e,t)}function Gs(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Ks(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,zs(4,4,Gs.bind(null,t,e),n)}function Xs(){}function Qs(e,t){var n=Ps();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&ks(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function $s(e,t){var n=Ps();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&ks(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function Js(e,t,n){return 0===(21&fs)?(e.baseState&&(e.baseState=!1,_o=!0),e.memoizedState=n):(or(n,t)||(n=mt(),hs.lanes|=n,Ac|=n,e.baseState=!0),t)}function Ys(e,t){var n=yt;yt=0!==n&&4>n?n:4,e(!0);var r=ps.transition;ps.transition={};try{e(!1),t()}finally{yt=n,ps.transition=r}}function Zs(){return Ps().memoizedState}function eo(e,t,n){var r=tu(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},no(e))ro(t,n);else if(null!==(n=Ti(e,t,n,r))){nu(n,e,r,eu()),ao(n,t,r)}}function to(e,t,n){var r=tu(e),a={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(no(e))ro(t,a);else{var i=e.alternate;if(0===e.lanes&&(null===i||0===i.lanes)&&null!==(i=t.lastRenderedReducer))try{var s=t.lastRenderedState,o=i(s,n);if(a.hasEagerState=!0,a.eagerState=o,or(o,s)){var c=t.interleaved;return null===c?(a.next=a,Ci(t)):(a.next=c.next,c.next=a),void(t.interleaved=a)}}catch(u){}null!==(n=Ti(e,t,a,r))&&(nu(n,e,r,a=eu()),ao(n,t,r))}}function no(e){var t=e.alternate;return e===hs||null!==t&&t===hs}function ro(e,t){bs=gs=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function ao(e,t,n){if(0!==(4194240&n)){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,bt(e,n)}}var io={readContext:Ri,useCallback:ws,useContext:ws,useEffect:ws,useImperativeHandle:ws,useInsertionEffect:ws,useLayoutEffect:ws,useMemo:ws,useReducer:ws,useRef:ws,useState:ws,useDebugValue:ws,useDeferredValue:ws,useTransition:ws,useMutableSource:ws,useSyncExternalStore:ws,useId:ws,unstable_isNewReconciler:!1},so={readContext:Ri,useCallback:function(e,t){return Rs().memoizedState=[e,void 0===t?null:t],e},useContext:Ri,useEffect:Vs,useImperativeHandle:function(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Us(4194308,4,Gs.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Us(4194308,4,e,t)},useInsertionEffect:function(e,t){return Us(4,2,e,t)},useMemo:function(e,t){var n=Rs();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=Rs();return t=void 0!==n?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=eo.bind(null,hs,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},Rs().memoizedState=e},useState:Fs,useDebugValue:Xs,useDeferredValue:function(e){return Rs().memoizedState=e},useTransition:function(){var e=Fs(!1),t=e[0];return e=Ys.bind(null,e[1]),Rs().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=hs,a=Rs();if(ai){if(void 0===n)throw Error(i(407));n=n()}else{if(n=t(),null===Ec)throw Error(i(349));0!==(30&fs)||Is(r,t,n)}a.memoizedState=n;var s={value:n,getSnapshot:t};return a.queue=s,Vs(js.bind(null,r,s,e),[e]),r.flags|=2048,Ns(9,Ds.bind(null,r,s,n,t),void 0,null),n},useId:function(){var e=Rs(),t=Ec.identifierPrefix;if(ai){var n=Ja;t=":"+t+"R"+(n=($a&~(1<<32-st($a)-1)).toString(32)+n),0<(n=ys++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=_s++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},oo={readContext:Ri,useCallback:Qs,useContext:Ri,useEffect:Hs,useImperativeHandle:Ks,useInsertionEffect:Ws,useLayoutEffect:qs,useMemo:$s,useReducer:Ts,useRef:Bs,useState:function(){return Ts(Cs)},useDebugValue:Xs,useDeferredValue:function(e){return Js(Ps(),ms.memoizedState,e)},useTransition:function(){return[Ts(Cs)[0],Ps().memoizedState]},useMutableSource:Os,useSyncExternalStore:Ms,useId:Zs,unstable_isNewReconciler:!1},co={readContext:Ri,useCallback:Qs,useContext:Ri,useEffect:Hs,useImperativeHandle:Ks,useInsertionEffect:Ws,useLayoutEffect:qs,useMemo:$s,useReducer:Es,useRef:Bs,useState:function(){return Es(Cs)},useDebugValue:Xs,useDeferredValue:function(e){var t=Ps();return null===ms?t.memoizedState=e:Js(t,ms.memoizedState,e)},useTransition:function(){return[Es(Cs)[0],Ps().memoizedState]},useMutableSource:Os,useSyncExternalStore:Ms,useId:Zs,unstable_isNewReconciler:!1};function uo(e,t){try{var n="",r=t;do{n+=z(r),r=r.return}while(r);var a=n}catch(i){a="\nError generating stack: "+i.message+"\n"+i.stack}return{value:e,source:t,stack:a,digest:null}}function lo(e,t,n){return{value:e,source:null,stack:null!=n?n:null,digest:null!=t?t:null}}function po(e,t){try{console.error(t.value)}catch(n){setTimeout((function(){throw n}))}}var fo="function"===typeof WeakMap?WeakMap:Map;function ho(e,t,n){(n=Di(-1,n)).tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){Wc||(Wc=!0,qc=r),po(0,t)},n}function mo(e,t,n){(n=Di(-1,n)).tag=3;var r=e.type.getDerivedStateFromError;if("function"===typeof r){var a=t.value;n.payload=function(){return r(a)},n.callback=function(){po(0,t)}}var i=e.stateNode;return null!==i&&"function"===typeof i.componentDidCatch&&(n.callback=function(){po(0,t),"function"!==typeof r&&(null===Gc?Gc=new Set([this]):Gc.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function vo(e,t,n){var r=e.pingCache;if(null===r){r=e.pingCache=new fo;var a=new Set;r.set(t,a)}else void 0===(a=r.get(t))&&(a=new Set,r.set(t,a));a.has(n)||(a.add(n),e=Ru.bind(null,e,t,n),t.then(e,e))}function go(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function bo(e,t,n,r,a){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=Di(-1,1)).tag=2,ji(n,t,1))),n.lanes|=1),e):(e.flags|=65536,e.lanes=a,e)}var yo=_.ReactCurrentOwner,_o=!1;function wo(e,t,n,r){t.child=null===e?Ji(t,null,n,r):$i(t,e.child,n,r)}function ko(e,t,n,r,a){n=n.render;var i=t.ref;return Si(t,a),r=xs(e,t,n,r,i,a),n=Ss(),null===e||_o?(ai&&n&&ei(t),t.flags|=1,wo(e,t,r,a),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Wo(e,t,a))}function xo(e,t,n,r,a){if(null===e){var i=n.type;return"function"!==typeof i||Iu(i)||void 0!==i.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=ju(n.type,null,r,t,t.mode,a)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=i,So(e,t,i,r,a))}if(i=e.child,0===(e.lanes&a)){var s=i.memoizedProps;if((n=null!==(n=n.compare)?n:cr)(s,r)&&e.ref===t.ref)return Wo(e,t,a)}return t.flags|=1,(e=Du(i,r)).ref=t.ref,e.return=t,t.child=e}function So(e,t,n,r,a){if(null!==e){var i=e.memoizedProps;if(cr(i,r)&&e.ref===t.ref){if(_o=!1,t.pendingProps=r=i,0===(e.lanes&a))return t.lanes=e.lanes,Wo(e,t,a);0!==(131072&e.flags)&&(_o=!0)}}return Co(e,t,n,r,a)}function Ro(e,t,n){var r=t.pendingProps,a=r.children,i=null!==e?e.memoizedState:null;if("hidden"===r.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Pa(Dc,Ic),Ic|=n;else{if(0===(1073741824&n))return e=null!==i?i.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Pa(Dc,Ic),Ic|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=null!==i?i.baseLanes:n,Pa(Dc,Ic),Ic|=r}else null!==i?(r=i.baseLanes|n,t.memoizedState=null):r=n,Pa(Dc,Ic),Ic|=r;return wo(e,t,a,n),t.child}function Po(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Co(e,t,n,r,a){var i=Ia(n)?Oa:Ta.current;return i=Ma(t,i),Si(t,a),n=xs(e,t,n,r,i,a),r=Ss(),null===e||_o?(ai&&r&&ei(t),t.flags|=1,wo(e,t,n,a),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Wo(e,t,a))}function To(e,t,n,r,a){if(Ia(n)){var i=!0;Aa(t)}else i=!1;if(Si(t,a),null===t.stateNode)Ho(e,t),Hi(t,n,r),qi(t,n,r,a),r=!0;else if(null===e){var s=t.stateNode,o=t.memoizedProps;s.props=o;var c=s.context,u=n.contextType;"object"===typeof u&&null!==u?u=Ri(u):u=Ma(t,u=Ia(n)?Oa:Ta.current);var l=n.getDerivedStateFromProps,d="function"===typeof l||"function"===typeof s.getSnapshotBeforeUpdate;d||"function"!==typeof s.UNSAFE_componentWillReceiveProps&&"function"!==typeof s.componentWillReceiveProps||(o!==r||c!==u)&&Wi(t,s,r,u),Oi=!1;var p=t.memoizedState;s.state=p,Fi(t,r,s,a),c=t.memoizedState,o!==r||p!==c||Ea.current||Oi?("function"===typeof l&&(Ui(t,n,l,r),c=t.memoizedState),(o=Oi||Vi(t,n,o,r,p,c,u))?(d||"function"!==typeof s.UNSAFE_componentWillMount&&"function"!==typeof s.componentWillMount||("function"===typeof s.componentWillMount&&s.componentWillMount(),"function"===typeof s.UNSAFE_componentWillMount&&s.UNSAFE_componentWillMount()),"function"===typeof s.componentDidMount&&(t.flags|=4194308)):("function"===typeof s.componentDidMount&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=c),s.props=r,s.state=c,s.context=u,r=o):("function"===typeof s.componentDidMount&&(t.flags|=4194308),r=!1)}else{s=t.stateNode,Ii(e,t),o=t.memoizedProps,u=t.type===t.elementType?o:vi(t.type,o),s.props=u,d=t.pendingProps,p=s.context,"object"===typeof(c=n.contextType)&&null!==c?c=Ri(c):c=Ma(t,c=Ia(n)?Oa:Ta.current);var f=n.getDerivedStateFromProps;(l="function"===typeof f||"function"===typeof s.getSnapshotBeforeUpdate)||"function"!==typeof s.UNSAFE_componentWillReceiveProps&&"function"!==typeof s.componentWillReceiveProps||(o!==d||p!==c)&&Wi(t,s,r,c),Oi=!1,p=t.memoizedState,s.state=p,Fi(t,r,s,a);var h=t.memoizedState;o!==d||p!==h||Ea.current||Oi?("function"===typeof f&&(Ui(t,n,f,r),h=t.memoizedState),(u=Oi||Vi(t,n,u,r,p,h,c)||!1)?(l||"function"!==typeof s.UNSAFE_componentWillUpdate&&"function"!==typeof s.componentWillUpdate||("function"===typeof s.componentWillUpdate&&s.componentWillUpdate(r,h,c),"function"===typeof s.UNSAFE_componentWillUpdate&&s.UNSAFE_componentWillUpdate(r,h,c)),"function"===typeof s.componentDidUpdate&&(t.flags|=4),"function"===typeof s.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof s.componentDidUpdate||o===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),"function"!==typeof s.getSnapshotBeforeUpdate||o===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=h),s.props=r,s.state=h,s.context=c,r=u):("function"!==typeof s.componentDidUpdate||o===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),"function"!==typeof s.getSnapshotBeforeUpdate||o===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),r=!1)}return Eo(e,t,n,r,i,a)}function Eo(e,t,n,r,a,i){Po(e,t);var s=0!==(128&t.flags);if(!r&&!s)return a&&Fa(t,n,!1),Wo(e,t,i);r=t.stateNode,yo.current=t;var o=s&&"function"!==typeof n.getDerivedStateFromError?null:r.render();return t.flags|=1,null!==e&&s?(t.child=$i(t,e.child,null,i),t.child=$i(t,null,o,i)):wo(e,t,o,i),t.memoizedState=r.state,a&&Fa(t,n,!0),t.child}function Oo(e){var t=e.stateNode;t.pendingContext?ja(0,t.pendingContext,t.pendingContext!==t.context):t.context&&ja(0,t.context,!1),rs(e,t.containerInfo)}function Mo(e,t,n,r,a){return fi(),hi(a),t.flags|=256,wo(e,t,n,r),t.child}var Io,Do,jo,Lo={dehydrated:null,treeContext:null,retryLane:0};function Ao(e){return{baseLanes:e,cachePool:null,transitions:null}}function Fo(e,t,n){var r,a=t.pendingProps,s=os.current,o=!1,c=0!==(128&t.flags);if((r=c)||(r=(null===e||null!==e.memoizedState)&&0!==(2&s)),r?(o=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(s|=1),Pa(os,1&s),null===e)return ui(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(c=a.children,e=a.fallback,o?(a=t.mode,o=t.child,c={mode:"hidden",children:c},0===(1&a)&&null!==o?(o.childLanes=0,o.pendingProps=c):o=Au(c,a,0,null),e=Lu(e,a,n,null),o.return=t,e.return=t,o.sibling=e,t.child=o,t.child.memoizedState=Ao(n),t.memoizedState=Lo,e):No(t,c));if(null!==(s=e.memoizedState)&&null!==(r=s.dehydrated))return function(e,t,n,r,a,s,o){if(n)return 256&t.flags?(t.flags&=-257,Bo(e,t,o,r=lo(Error(i(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(s=r.fallback,a=t.mode,r=Au({mode:"visible",children:r.children},a,0,null),(s=Lu(s,a,o,null)).flags|=2,r.return=t,s.return=t,r.sibling=s,t.child=r,0!==(1&t.mode)&&$i(t,e.child,null,o),t.child.memoizedState=Ao(o),t.memoizedState=Lo,s);if(0===(1&t.mode))return Bo(e,t,o,null);if("$!"===a.data){if(r=a.nextSibling&&a.nextSibling.dataset)var c=r.dgst;return r=c,Bo(e,t,o,r=lo(s=Error(i(419)),r,void 0))}if(c=0!==(o&e.childLanes),_o||c){if(null!==(r=Ec)){switch(o&-o){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}0!==(a=0!==(a&(r.suspendedLanes|o))?0:a)&&a!==s.retryLane&&(s.retryLane=a,Ei(e,a),nu(r,e,a,-1))}return mu(),Bo(e,t,o,r=lo(Error(i(421))))}return"$?"===a.data?(t.flags|=128,t.child=e.child,t=Cu.bind(null,e),a._reactRetry=t,null):(e=s.treeContext,ri=ua(a.nextSibling),ni=t,ai=!0,ii=null,null!==e&&(Ka[Xa++]=$a,Ka[Xa++]=Ja,Ka[Xa++]=Qa,$a=e.id,Ja=e.overflow,Qa=t),(t=No(t,r.children)).flags|=4096,t)}(e,t,c,a,r,s,n);if(o){o=a.fallback,c=t.mode,r=(s=e.child).sibling;var u={mode:"hidden",children:a.children};return 0===(1&c)&&t.child!==s?((a=t.child).childLanes=0,a.pendingProps=u,t.deletions=null):(a=Du(s,u)).subtreeFlags=14680064&s.subtreeFlags,null!==r?o=Du(r,o):(o=Lu(o,c,n,null)).flags|=2,o.return=t,a.return=t,a.sibling=o,t.child=a,a=o,o=t.child,c=null===(c=e.child.memoizedState)?Ao(n):{baseLanes:c.baseLanes|n,cachePool:null,transitions:c.transitions},o.memoizedState=c,o.childLanes=e.childLanes&~n,t.memoizedState=Lo,a}return e=(o=e.child).sibling,a=Du(o,{mode:"visible",children:a.children}),0===(1&t.mode)&&(a.lanes=n),a.return=t,a.sibling=null,null!==e&&(null===(n=t.deletions)?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=a,t.memoizedState=null,a}function No(e,t){return(t=Au({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function Bo(e,t,n,r){return null!==r&&hi(r),$i(t,e.child,null,n),(e=No(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function Uo(e,t,n){e.lanes|=t;var r=e.alternate;null!==r&&(r.lanes|=t),xi(e.return,t,n)}function zo(e,t,n,r,a){var i=e.memoizedState;null===i?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:a}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=a)}function Vo(e,t,n){var r=t.pendingProps,a=r.revealOrder,i=r.tail;if(wo(e,t,r.children,n),0!==(2&(r=os.current)))r=1&r|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Uo(e,n,t);else if(19===e.tag)Uo(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Pa(os,r),0===(1&t.mode))t.memoizedState=null;else switch(a){case"forwards":for(n=t.child,a=null;null!==n;)null!==(e=n.alternate)&&null===cs(e)&&(a=n),n=n.sibling;null===(n=a)?(a=t.child,t.child=null):(a=n.sibling,n.sibling=null),zo(t,!1,a,n,i);break;case"backwards":for(n=null,a=t.child,t.child=null;null!==a;){if(null!==(e=a.alternate)&&null===cs(e)){t.child=a;break}e=a.sibling,a.sibling=n,n=a,a=e}zo(t,!0,n,null,i);break;case"together":zo(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Ho(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Wo(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Ac|=t.lanes,0===(n&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(i(153));if(null!==t.child){for(n=Du(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Du(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function qo(e,t){if(!ai)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function Go(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,r=0;if(t)for(var a=e.child;null!==a;)n|=a.lanes|a.childLanes,r|=14680064&a.subtreeFlags,r|=14680064&a.flags,a.return=e,a=a.sibling;else for(a=e.child;null!==a;)n|=a.lanes|a.childLanes,r|=a.subtreeFlags,r|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function Ko(e,t,n){var r=t.pendingProps;switch(ti(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Go(t),null;case 1:case 17:return Ia(t.type)&&Da(),Go(t),null;case 3:return r=t.stateNode,as(),Ra(Ea),Ra(Ta),ls(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==e&&null!==e.child||(di(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==ii&&(su(ii),ii=null))),Go(t),null;case 5:ss(t);var a=ns(ts.current);if(n=t.type,null!==e&&null!=t.stateNode)Do(e,t,n,r),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(null===t.stateNode)throw Error(i(166));return Go(t),null}if(e=ns(Zi.current),di(t)){r=t.stateNode,n=t.type;var s=t.memoizedProps;switch(r[pa]=t,r[fa]=s,e=0!==(1&t.mode),n){case"dialog":Br("cancel",r),Br("close",r);break;case"iframe":case"object":case"embed":Br("load",r);break;case"video":case"audio":for(a=0;a<Lr.length;a++)Br(Lr[a],r);break;case"source":Br("error",r);break;case"img":case"image":case"link":Br("error",r),Br("load",r);break;case"details":Br("toggle",r);break;case"input":$(r,s),Br("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},Br("invalid",r);break;case"textarea":ae(r,s),Br("invalid",r)}for(var c in be(n,s),a=null,s)if(s.hasOwnProperty(c)){var u=s[c];"children"===c?"string"===typeof u?r.textContent!==u&&(!0!==s.suppressHydrationWarning&&Yr(r.textContent,u,e),a=["children",u]):"number"===typeof u&&r.textContent!==""+u&&(!0!==s.suppressHydrationWarning&&Yr(r.textContent,u,e),a=["children",""+u]):o.hasOwnProperty(c)&&null!=u&&"onScroll"===c&&Br("scroll",r)}switch(n){case"input":G(r),Z(r,s,!0);break;case"textarea":G(r),se(r);break;case"select":case"option":break;default:"function"===typeof s.onClick&&(r.onclick=Zr)}r=a,t.updateQueue=r,null!==r&&(t.flags|=4)}else{c=9===a.nodeType?a:a.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=oe(n)),"http://www.w3.org/1999/xhtml"===e?"script"===n?((e=c.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof r.is?e=c.createElement(n,{is:r.is}):(e=c.createElement(n),"select"===n&&(c=e,r.multiple?c.multiple=!0:r.size&&(c.size=r.size))):e=c.createElementNS(e,n),e[pa]=t,e[fa]=r,Io(e,t),t.stateNode=e;e:{switch(c=ye(n,r),n){case"dialog":Br("cancel",e),Br("close",e),a=r;break;case"iframe":case"object":case"embed":Br("load",e),a=r;break;case"video":case"audio":for(a=0;a<Lr.length;a++)Br(Lr[a],e);a=r;break;case"source":Br("error",e),a=r;break;case"img":case"image":case"link":Br("error",e),Br("load",e),a=r;break;case"details":Br("toggle",e),a=r;break;case"input":$(e,r),a=Q(e,r),Br("invalid",e);break;case"option":default:a=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},a=F({},r,{value:void 0}),Br("invalid",e);break;case"textarea":ae(e,r),a=re(e,r),Br("invalid",e)}for(s in be(n,a),u=a)if(u.hasOwnProperty(s)){var l=u[s];"style"===s?ve(e,l):"dangerouslySetInnerHTML"===s?null!=(l=l?l.__html:void 0)&&de(e,l):"children"===s?"string"===typeof l?("textarea"!==n||""!==l)&&pe(e,l):"number"===typeof l&&pe(e,""+l):"suppressContentEditableWarning"!==s&&"suppressHydrationWarning"!==s&&"autoFocus"!==s&&(o.hasOwnProperty(s)?null!=l&&"onScroll"===s&&Br("scroll",e):null!=l&&y(e,s,l,c))}switch(n){case"input":G(e),Z(e,r,!1);break;case"textarea":G(e),se(e);break;case"option":null!=r.value&&e.setAttribute("value",""+W(r.value));break;case"select":e.multiple=!!r.multiple,null!=(s=r.value)?ne(e,!!r.multiple,s,!1):null!=r.defaultValue&&ne(e,!!r.multiple,r.defaultValue,!0);break;default:"function"===typeof a.onClick&&(e.onclick=Zr)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return Go(t),null;case 6:if(e&&null!=t.stateNode)jo(0,t,e.memoizedProps,r);else{if("string"!==typeof r&&null===t.stateNode)throw Error(i(166));if(n=ns(ts.current),ns(Zi.current),di(t)){if(r=t.stateNode,n=t.memoizedProps,r[pa]=t,(s=r.nodeValue!==n)&&null!==(e=ni))switch(e.tag){case 3:Yr(r.nodeValue,n,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Yr(r.nodeValue,n,0!==(1&e.mode))}s&&(t.flags|=4)}else(r=(9===n.nodeType?n:n.ownerDocument).createTextNode(r))[pa]=t,t.stateNode=r}return Go(t),null;case 13:if(Ra(os),r=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(ai&&null!==ri&&0!==(1&t.mode)&&0===(128&t.flags))pi(),fi(),t.flags|=98560,s=!1;else if(s=di(t),null!==r&&null!==r.dehydrated){if(null===e){if(!s)throw Error(i(318));if(!(s=null!==(s=t.memoizedState)?s.dehydrated:null))throw Error(i(317));s[pa]=t}else fi(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;Go(t),s=!1}else null!==ii&&(su(ii),ii=null),s=!0;if(!s)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=n,t):((r=null!==r)!==(null!==e&&null!==e.memoizedState)&&r&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&os.current)?0===jc&&(jc=3):mu())),null!==t.updateQueue&&(t.flags|=4),Go(t),null);case 4:return as(),null===e&&Vr(t.stateNode.containerInfo),Go(t),null;case 10:return ki(t.type._context),Go(t),null;case 19:if(Ra(os),null===(s=t.memoizedState))return Go(t),null;if(r=0!==(128&t.flags),null===(c=s.rendering))if(r)qo(s,!1);else{if(0!==jc||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(c=cs(e))){for(t.flags|=128,qo(s,!1),null!==(r=c.updateQueue)&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;null!==n;)e=r,(s=n).flags&=14680066,null===(c=s.alternate)?(s.childLanes=0,s.lanes=e,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=c.childLanes,s.lanes=c.lanes,s.child=c.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=c.memoizedProps,s.memoizedState=c.memoizedState,s.updateQueue=c.updateQueue,s.type=c.type,e=c.dependencies,s.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Pa(os,1&os.current|2),t.child}e=e.sibling}null!==s.tail&&Je()>Vc&&(t.flags|=128,r=!0,qo(s,!1),t.lanes=4194304)}else{if(!r)if(null!==(e=cs(c))){if(t.flags|=128,r=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),qo(s,!0),null===s.tail&&"hidden"===s.tailMode&&!c.alternate&&!ai)return Go(t),null}else 2*Je()-s.renderingStartTime>Vc&&1073741824!==n&&(t.flags|=128,r=!0,qo(s,!1),t.lanes=4194304);s.isBackwards?(c.sibling=t.child,t.child=c):(null!==(n=s.last)?n.sibling=c:t.child=c,s.last=c)}return null!==s.tail?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=Je(),t.sibling=null,n=os.current,Pa(os,r?1&n|2:1&n),t):(Go(t),null);case 22:case 23:return du(),r=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==r&&(t.flags|=8192),r&&0!==(1&t.mode)?0!==(1073741824&Ic)&&(Go(t),6&t.subtreeFlags&&(t.flags|=8192)):Go(t),null;case 24:case 25:return null}throw Error(i(156,t.tag))}function Xo(e,t){switch(ti(t),t.tag){case 1:return Ia(t.type)&&Da(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return as(),Ra(Ea),Ra(Ta),ls(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return ss(t),null;case 13:if(Ra(os),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(i(340));fi()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return Ra(os),null;case 4:return as(),null;case 10:return ki(t.type._context),null;case 22:case 23:return du(),null;default:return null}}Io=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Do=function(e,t,n,r){var a=e.memoizedProps;if(a!==r){e=t.stateNode,ns(Zi.current);var i,s=null;switch(n){case"input":a=Q(e,a),r=Q(e,r),s=[];break;case"select":a=F({},a,{value:void 0}),r=F({},r,{value:void 0}),s=[];break;case"textarea":a=re(e,a),r=re(e,r),s=[];break;default:"function"!==typeof a.onClick&&"function"===typeof r.onClick&&(e.onclick=Zr)}for(l in be(n,r),n=null,a)if(!r.hasOwnProperty(l)&&a.hasOwnProperty(l)&&null!=a[l])if("style"===l){var c=a[l];for(i in c)c.hasOwnProperty(i)&&(n||(n={}),n[i]="")}else"dangerouslySetInnerHTML"!==l&&"children"!==l&&"suppressContentEditableWarning"!==l&&"suppressHydrationWarning"!==l&&"autoFocus"!==l&&(o.hasOwnProperty(l)?s||(s=[]):(s=s||[]).push(l,null));for(l in r){var u=r[l];if(c=null!=a?a[l]:void 0,r.hasOwnProperty(l)&&u!==c&&(null!=u||null!=c))if("style"===l)if(c){for(i in c)!c.hasOwnProperty(i)||u&&u.hasOwnProperty(i)||(n||(n={}),n[i]="");for(i in u)u.hasOwnProperty(i)&&c[i]!==u[i]&&(n||(n={}),n[i]=u[i])}else n||(s||(s=[]),s.push(l,n)),n=u;else"dangerouslySetInnerHTML"===l?(u=u?u.__html:void 0,c=c?c.__html:void 0,null!=u&&c!==u&&(s=s||[]).push(l,u)):"children"===l?"string"!==typeof u&&"number"!==typeof u||(s=s||[]).push(l,""+u):"suppressContentEditableWarning"!==l&&"suppressHydrationWarning"!==l&&(o.hasOwnProperty(l)?(null!=u&&"onScroll"===l&&Br("scroll",e),s||c===u||(s=[])):(s=s||[]).push(l,u))}n&&(s=s||[]).push("style",n);var l=s;(t.updateQueue=l)&&(t.flags|=4)}},jo=function(e,t,n,r){n!==r&&(t.flags|=4)};var Qo=!1,$o=!1,Jo="function"===typeof WeakSet?WeakSet:Set,Yo=null;function Zo(e,t){var n=e.ref;if(null!==n)if("function"===typeof n)try{n(null)}catch(r){Su(e,t,r)}else n.current=null}function ec(e,t,n){try{n()}catch(r){Su(e,t,r)}}var tc=!1;function nc(e,t,n){var r=t.updateQueue;if(null!==(r=null!==r?r.lastEffect:null)){var a=r=r.next;do{if((a.tag&e)===e){var i=a.destroy;a.destroy=void 0,void 0!==i&&ec(t,n,i)}a=a.next}while(a!==r)}}function rc(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function ac(e){var t=e.ref;if(null!==t){var n=e.stateNode;e.tag,e=n,"function"===typeof t?t(e):t.current=e}}function ic(e){var t=e.alternate;null!==t&&(e.alternate=null,ic(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[pa],delete t[fa],delete t[ma],delete t[va],delete t[ga])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function sc(e){return 5===e.tag||3===e.tag||4===e.tag}function oc(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||sc(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function cc(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=Zr));else if(4!==r&&null!==(e=e.child))for(cc(e,t,n),e=e.sibling;null!==e;)cc(e,t,n),e=e.sibling}function uc(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&null!==(e=e.child))for(uc(e,t,n),e=e.sibling;null!==e;)uc(e,t,n),e=e.sibling}var lc=null,dc=!1;function pc(e,t,n){for(n=n.child;null!==n;)fc(e,t,n),n=n.sibling}function fc(e,t,n){if(it&&"function"===typeof it.onCommitFiberUnmount)try{it.onCommitFiberUnmount(at,n)}catch(o){}switch(n.tag){case 5:$o||Zo(n,t);case 6:var r=lc,a=dc;lc=null,pc(e,t,n),dc=a,null!==(lc=r)&&(dc?(e=lc,n=n.stateNode,8===e.nodeType?e.parentNode.removeChild(n):e.removeChild(n)):lc.removeChild(n.stateNode));break;case 18:null!==lc&&(dc?(e=lc,n=n.stateNode,8===e.nodeType?ca(e.parentNode,n):1===e.nodeType&&ca(e,n),Vt(e)):ca(lc,n.stateNode));break;case 4:r=lc,a=dc,lc=n.stateNode.containerInfo,dc=!0,pc(e,t,n),lc=r,dc=a;break;case 0:case 11:case 14:case 15:if(!$o&&(null!==(r=n.updateQueue)&&null!==(r=r.lastEffect))){a=r=r.next;do{var i=a,s=i.destroy;i=i.tag,void 0!==s&&(0!==(2&i)||0!==(4&i))&&ec(n,t,s),a=a.next}while(a!==r)}pc(e,t,n);break;case 1:if(!$o&&(Zo(n,t),"function"===typeof(r=n.stateNode).componentWillUnmount))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(o){Su(n,t,o)}pc(e,t,n);break;case 21:pc(e,t,n);break;case 22:1&n.mode?($o=(r=$o)||null!==n.memoizedState,pc(e,t,n),$o=r):pc(e,t,n);break;default:pc(e,t,n)}}function hc(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new Jo),t.forEach((function(t){var r=Tu.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))}))}}function mc(e,t){var n=t.deletions;if(null!==n)for(var r=0;r<n.length;r++){var a=n[r];try{var s=e,o=t,c=o;e:for(;null!==c;){switch(c.tag){case 5:lc=c.stateNode,dc=!1;break e;case 3:case 4:lc=c.stateNode.containerInfo,dc=!0;break e}c=c.return}if(null===lc)throw Error(i(160));fc(s,o,a),lc=null,dc=!1;var u=a.alternate;null!==u&&(u.return=null),a.return=null}catch(l){Su(a,t,l)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)vc(t,e),t=t.sibling}function vc(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(mc(t,e),gc(e),4&r){try{nc(3,e,e.return),rc(3,e)}catch(v){Su(e,e.return,v)}try{nc(5,e,e.return)}catch(v){Su(e,e.return,v)}}break;case 1:mc(t,e),gc(e),512&r&&null!==n&&Zo(n,n.return);break;case 5:if(mc(t,e),gc(e),512&r&&null!==n&&Zo(n,n.return),32&e.flags){var a=e.stateNode;try{pe(a,"")}catch(v){Su(e,e.return,v)}}if(4&r&&null!=(a=e.stateNode)){var s=e.memoizedProps,o=null!==n?n.memoizedProps:s,c=e.type,u=e.updateQueue;if(e.updateQueue=null,null!==u)try{"input"===c&&"radio"===s.type&&null!=s.name&&J(a,s),ye(c,o);var l=ye(c,s);for(o=0;o<u.length;o+=2){var d=u[o],p=u[o+1];"style"===d?ve(a,p):"dangerouslySetInnerHTML"===d?de(a,p):"children"===d?pe(a,p):y(a,d,p,l)}switch(c){case"input":Y(a,s);break;case"textarea":ie(a,s);break;case"select":var f=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!s.multiple;var h=s.value;null!=h?ne(a,!!s.multiple,h,!1):f!==!!s.multiple&&(null!=s.defaultValue?ne(a,!!s.multiple,s.defaultValue,!0):ne(a,!!s.multiple,s.multiple?[]:"",!1))}a[fa]=s}catch(v){Su(e,e.return,v)}}break;case 6:if(mc(t,e),gc(e),4&r){if(null===e.stateNode)throw Error(i(162));a=e.stateNode,s=e.memoizedProps;try{a.nodeValue=s}catch(v){Su(e,e.return,v)}}break;case 3:if(mc(t,e),gc(e),4&r&&null!==n&&n.memoizedState.isDehydrated)try{Vt(t.containerInfo)}catch(v){Su(e,e.return,v)}break;case 4:default:mc(t,e),gc(e);break;case 13:mc(t,e),gc(e),8192&(a=e.child).flags&&(s=null!==a.memoizedState,a.stateNode.isHidden=s,!s||null!==a.alternate&&null!==a.alternate.memoizedState||(zc=Je())),4&r&&hc(e);break;case 22:if(d=null!==n&&null!==n.memoizedState,1&e.mode?($o=(l=$o)||d,mc(t,e),$o=l):mc(t,e),gc(e),8192&r){if(l=null!==e.memoizedState,(e.stateNode.isHidden=l)&&!d&&0!==(1&e.mode))for(Yo=e,d=e.child;null!==d;){for(p=Yo=d;null!==Yo;){switch(h=(f=Yo).child,f.tag){case 0:case 11:case 14:case 15:nc(4,f,f.return);break;case 1:Zo(f,f.return);var m=f.stateNode;if("function"===typeof m.componentWillUnmount){r=f,n=f.return;try{t=r,m.props=t.memoizedProps,m.state=t.memoizedState,m.componentWillUnmount()}catch(v){Su(r,n,v)}}break;case 5:Zo(f,f.return);break;case 22:if(null!==f.memoizedState){wc(p);continue}}null!==h?(h.return=f,Yo=h):wc(p)}d=d.sibling}e:for(d=null,p=e;;){if(5===p.tag){if(null===d){d=p;try{a=p.stateNode,l?"function"===typeof(s=a.style).setProperty?s.setProperty("display","none","important"):s.display="none":(c=p.stateNode,o=void 0!==(u=p.memoizedProps.style)&&null!==u&&u.hasOwnProperty("display")?u.display:null,c.style.display=me("display",o))}catch(v){Su(e,e.return,v)}}}else if(6===p.tag){if(null===d)try{p.stateNode.nodeValue=l?"":p.memoizedProps}catch(v){Su(e,e.return,v)}}else if((22!==p.tag&&23!==p.tag||null===p.memoizedState||p===e)&&null!==p.child){p.child.return=p,p=p.child;continue}if(p===e)break e;for(;null===p.sibling;){if(null===p.return||p.return===e)break e;d===p&&(d=null),p=p.return}d===p&&(d=null),p.sibling.return=p.return,p=p.sibling}}break;case 19:mc(t,e),gc(e),4&r&&hc(e);case 21:}}function gc(e){var t=e.flags;if(2&t){try{e:{for(var n=e.return;null!==n;){if(sc(n)){var r=n;break e}n=n.return}throw Error(i(160))}switch(r.tag){case 5:var a=r.stateNode;32&r.flags&&(pe(a,""),r.flags&=-33),uc(e,oc(e),a);break;case 3:case 4:var s=r.stateNode.containerInfo;cc(e,oc(e),s);break;default:throw Error(i(161))}}catch(o){Su(e,e.return,o)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function bc(e,t,n){Yo=e,yc(e,t,n)}function yc(e,t,n){for(var r=0!==(1&e.mode);null!==Yo;){var a=Yo,i=a.child;if(22===a.tag&&r){var s=null!==a.memoizedState||Qo;if(!s){var o=a.alternate,c=null!==o&&null!==o.memoizedState||$o;o=Qo;var u=$o;if(Qo=s,($o=c)&&!u)for(Yo=a;null!==Yo;)c=(s=Yo).child,22===s.tag&&null!==s.memoizedState?kc(a):null!==c?(c.return=s,Yo=c):kc(a);for(;null!==i;)Yo=i,yc(i,t,n),i=i.sibling;Yo=a,Qo=o,$o=u}_c(e)}else 0!==(8772&a.subtreeFlags)&&null!==i?(i.return=a,Yo=i):_c(e)}}function _c(e){for(;null!==Yo;){var t=Yo;if(0!==(8772&t.flags)){var n=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:$o||rc(5,t);break;case 1:var r=t.stateNode;if(4&t.flags&&!$o)if(null===n)r.componentDidMount();else{var a=t.elementType===t.type?n.memoizedProps:vi(t.type,n.memoizedProps);r.componentDidUpdate(a,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=t.updateQueue;null!==s&&Ni(t,s,r);break;case 3:var o=t.updateQueue;if(null!==o){if(n=null,null!==t.child)switch(t.child.tag){case 5:case 1:n=t.child.stateNode}Ni(t,o,n)}break;case 5:var c=t.stateNode;if(null===n&&4&t.flags){n=c;var u=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&n.focus();break;case"img":u.src&&(n.src=u.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var l=t.alternate;if(null!==l){var d=l.memoizedState;if(null!==d){var p=d.dehydrated;null!==p&&Vt(p)}}}break;default:throw Error(i(163))}$o||512&t.flags&&ac(t)}catch(f){Su(t,t.return,f)}}if(t===e){Yo=null;break}if(null!==(n=t.sibling)){n.return=t.return,Yo=n;break}Yo=t.return}}function wc(e){for(;null!==Yo;){var t=Yo;if(t===e){Yo=null;break}var n=t.sibling;if(null!==n){n.return=t.return,Yo=n;break}Yo=t.return}}function kc(e){for(;null!==Yo;){var t=Yo;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{rc(4,t)}catch(c){Su(t,n,c)}break;case 1:var r=t.stateNode;if("function"===typeof r.componentDidMount){var a=t.return;try{r.componentDidMount()}catch(c){Su(t,a,c)}}var i=t.return;try{ac(t)}catch(c){Su(t,i,c)}break;case 5:var s=t.return;try{ac(t)}catch(c){Su(t,s,c)}}}catch(c){Su(t,t.return,c)}if(t===e){Yo=null;break}var o=t.sibling;if(null!==o){o.return=t.return,Yo=o;break}Yo=t.return}}var xc,Sc=Math.ceil,Rc=_.ReactCurrentDispatcher,Pc=_.ReactCurrentOwner,Cc=_.ReactCurrentBatchConfig,Tc=0,Ec=null,Oc=null,Mc=0,Ic=0,Dc=Sa(0),jc=0,Lc=null,Ac=0,Fc=0,Nc=0,Bc=null,Uc=null,zc=0,Vc=1/0,Hc=null,Wc=!1,qc=null,Gc=null,Kc=!1,Xc=null,Qc=0,$c=0,Jc=null,Yc=-1,Zc=0;function eu(){return 0!==(6&Tc)?Je():-1!==Yc?Yc:Yc=Je()}function tu(e){return 0===(1&e.mode)?1:0!==(2&Tc)&&0!==Mc?Mc&-Mc:null!==mi.transition?(0===Zc&&(Zc=mt()),Zc):0!==(e=yt)?e:e=void 0===(e=window.event)?16:$t(e.type)}function nu(e,t,n,r){if(50<$c)throw $c=0,Jc=null,Error(i(185));gt(e,n,r),0!==(2&Tc)&&e===Ec||(e===Ec&&(0===(2&Tc)&&(Fc|=n),4===jc&&ou(e,Mc)),ru(e,r),1===n&&0===Tc&&0===(1&t.mode)&&(Vc=Je()+500,Ba&&Va()))}function ru(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,a=e.expirationTimes,i=e.pendingLanes;0<i;){var s=31-st(i),o=1<<s,c=a[s];-1===c?0!==(o&n)&&0===(o&r)||(a[s]=ft(o,t)):c<=t&&(e.expiredLanes|=o),i&=~o}}(e,t);var r=pt(e,e===Ec?Mc:0);if(0===r)null!==n&&Xe(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(null!=n&&Xe(n),1===t)0===e.tag?function(e){Ba=!0,za(e)}(cu.bind(null,e)):za(cu.bind(null,e)),sa((function(){0===(6&Tc)&&Va()})),n=null;else{switch(_t(r)){case 1:n=Ze;break;case 4:n=et;break;case 16:default:n=tt;break;case 536870912:n=rt}n=Eu(n,au.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function au(e,t){if(Yc=-1,Zc=0,0!==(6&Tc))throw Error(i(327));var n=e.callbackNode;if(ku()&&e.callbackNode!==n)return null;var r=pt(e,e===Ec?Mc:0);if(0===r)return null;if(0!==(30&r)||0!==(r&e.expiredLanes)||t)t=vu(e,r);else{t=r;var a=Tc;Tc|=2;var s=hu();for(Ec===e&&Mc===t||(Hc=null,Vc=Je()+500,pu(e,t));;)try{bu();break}catch(c){fu(e,c)}wi(),Rc.current=s,Tc=a,null!==Oc?t=0:(Ec=null,Mc=0,t=jc)}if(0!==t){if(2===t&&(0!==(a=ht(e))&&(r=a,t=iu(e,a))),1===t)throw n=Lc,pu(e,0),ou(e,r),ru(e,Je()),n;if(6===t)ou(e,r);else{if(a=e.current.alternate,0===(30&r)&&!function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var r=0;r<n.length;r++){var a=n[r],i=a.getSnapshot;a=a.value;try{if(!or(i(),a))return!1}catch(o){return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(a)&&(2===(t=vu(e,r))&&(0!==(s=ht(e))&&(r=s,t=iu(e,s))),1===t))throw n=Lc,pu(e,0),ou(e,r),ru(e,Je()),n;switch(e.finishedWork=a,e.finishedLanes=r,t){case 0:case 1:throw Error(i(345));case 2:case 5:wu(e,Uc,Hc);break;case 3:if(ou(e,r),(130023424&r)===r&&10<(t=zc+500-Je())){if(0!==pt(e,0))break;if(((a=e.suspendedLanes)&r)!==r){eu(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=ra(wu.bind(null,e,Uc,Hc),t);break}wu(e,Uc,Hc);break;case 4:if(ou(e,r),(4194240&r)===r)break;for(t=e.eventTimes,a=-1;0<r;){var o=31-st(r);s=1<<o,(o=t[o])>a&&(a=o),r&=~s}if(r=a,10<(r=(120>(r=Je()-r)?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Sc(r/1960))-r)){e.timeoutHandle=ra(wu.bind(null,e,Uc,Hc),r);break}wu(e,Uc,Hc);break;default:throw Error(i(329))}}}return ru(e,Je()),e.callbackNode===n?au.bind(null,e):null}function iu(e,t){var n=Bc;return e.current.memoizedState.isDehydrated&&(pu(e,t).flags|=256),2!==(e=vu(e,t))&&(t=Uc,Uc=n,null!==t&&su(t)),e}function su(e){null===Uc?Uc=e:Uc.push.apply(Uc,e)}function ou(e,t){for(t&=~Nc,t&=~Fc,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-st(t),r=1<<n;e[n]=-1,t&=~r}}function cu(e){if(0!==(6&Tc))throw Error(i(327));ku();var t=pt(e,0);if(0===(1&t))return ru(e,Je()),null;var n=vu(e,t);if(0!==e.tag&&2===n){var r=ht(e);0!==r&&(t=r,n=iu(e,r))}if(1===n)throw n=Lc,pu(e,0),ou(e,t),ru(e,Je()),n;if(6===n)throw Error(i(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,wu(e,Uc,Hc),ru(e,Je()),null}function uu(e,t){var n=Tc;Tc|=1;try{return e(t)}finally{0===(Tc=n)&&(Vc=Je()+500,Ba&&Va())}}function lu(e){null!==Xc&&0===Xc.tag&&0===(6&Tc)&&ku();var t=Tc;Tc|=1;var n=Cc.transition,r=yt;try{if(Cc.transition=null,yt=1,e)return e()}finally{yt=r,Cc.transition=n,0===(6&(Tc=t))&&Va()}}function du(){Ic=Dc.current,Ra(Dc)}function pu(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,aa(n)),null!==Oc)for(n=Oc.return;null!==n;){var r=n;switch(ti(r),r.tag){case 1:null!==(r=r.type.childContextTypes)&&void 0!==r&&Da();break;case 3:as(),Ra(Ea),Ra(Ta),ls();break;case 5:ss(r);break;case 4:as();break;case 13:case 19:Ra(os);break;case 10:ki(r.type._context);break;case 22:case 23:du()}n=n.return}if(Ec=e,Oc=e=Du(e.current,null),Mc=Ic=t,jc=0,Lc=null,Nc=Fc=Ac=0,Uc=Bc=null,null!==Pi){for(t=0;t<Pi.length;t++)if(null!==(r=(n=Pi[t]).interleaved)){n.interleaved=null;var a=r.next,i=n.pending;if(null!==i){var s=i.next;i.next=a,r.next=s}n.pending=r}Pi=null}return e}function fu(e,t){for(;;){var n=Oc;try{if(wi(),ds.current=io,gs){for(var r=hs.memoizedState;null!==r;){var a=r.queue;null!==a&&(a.pending=null),r=r.next}gs=!1}if(fs=0,vs=ms=hs=null,bs=!1,ys=0,Pc.current=null,null===n||null===n.return){jc=1,Lc=t,Oc=null;break}e:{var s=e,o=n.return,c=n,u=t;if(t=Mc,c.flags|=32768,null!==u&&"object"===typeof u&&"function"===typeof u.then){var l=u,d=c,p=d.tag;if(0===(1&d.mode)&&(0===p||11===p||15===p)){var f=d.alternate;f?(d.updateQueue=f.updateQueue,d.memoizedState=f.memoizedState,d.lanes=f.lanes):(d.updateQueue=null,d.memoizedState=null)}var h=go(o);if(null!==h){h.flags&=-257,bo(h,o,c,0,t),1&h.mode&&vo(s,l,t),u=l;var m=(t=h).updateQueue;if(null===m){var v=new Set;v.add(u),t.updateQueue=v}else m.add(u);break e}if(0===(1&t)){vo(s,l,t),mu();break e}u=Error(i(426))}else if(ai&&1&c.mode){var g=go(o);if(null!==g){0===(65536&g.flags)&&(g.flags|=256),bo(g,o,c,0,t),hi(uo(u,c));break e}}s=u=uo(u,c),4!==jc&&(jc=2),null===Bc?Bc=[s]:Bc.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,t&=-t,s.lanes|=t,Ai(s,ho(0,u,t));break e;case 1:c=u;var b=s.type,y=s.stateNode;if(0===(128&s.flags)&&("function"===typeof b.getDerivedStateFromError||null!==y&&"function"===typeof y.componentDidCatch&&(null===Gc||!Gc.has(y)))){s.flags|=65536,t&=-t,s.lanes|=t,Ai(s,mo(s,c,t));break e}}s=s.return}while(null!==s)}_u(n)}catch(_){t=_,Oc===n&&null!==n&&(Oc=n=n.return);continue}break}}function hu(){var e=Rc.current;return Rc.current=io,null===e?io:e}function mu(){0!==jc&&3!==jc&&2!==jc||(jc=4),null===Ec||0===(268435455&Ac)&&0===(268435455&Fc)||ou(Ec,Mc)}function vu(e,t){var n=Tc;Tc|=2;var r=hu();for(Ec===e&&Mc===t||(Hc=null,pu(e,t));;)try{gu();break}catch(a){fu(e,a)}if(wi(),Tc=n,Rc.current=r,null!==Oc)throw Error(i(261));return Ec=null,Mc=0,jc}function gu(){for(;null!==Oc;)yu(Oc)}function bu(){for(;null!==Oc&&!Qe();)yu(Oc)}function yu(e){var t=xc(e.alternate,e,Ic);e.memoizedProps=e.pendingProps,null===t?_u(e):Oc=t,Pc.current=null}function _u(e){var t=e;do{var n=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(n=Ko(n,t,Ic)))return void(Oc=n)}else{if(null!==(n=Xo(n,t)))return n.flags&=32767,void(Oc=n);if(null===e)return jc=6,void(Oc=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(Oc=t);Oc=t=e}while(null!==t);0===jc&&(jc=5)}function wu(e,t,n){var r=yt,a=Cc.transition;try{Cc.transition=null,yt=1,function(e,t,n,r){do{ku()}while(null!==Xc);if(0!==(6&Tc))throw Error(i(327));n=e.finishedWork;var a=e.finishedLanes;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(i(177));e.callbackNode=null,e.callbackPriority=0;var s=n.lanes|n.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var a=31-st(n),i=1<<a;t[a]=0,r[a]=-1,e[a]=-1,n&=~i}}(e,s),e===Ec&&(Oc=Ec=null,Mc=0),0===(2064&n.subtreeFlags)&&0===(2064&n.flags)||Kc||(Kc=!0,Eu(tt,(function(){return ku(),null}))),s=0!==(15990&n.flags),0!==(15990&n.subtreeFlags)||s){s=Cc.transition,Cc.transition=null;var o=yt;yt=1;var c=Tc;Tc|=4,Pc.current=null,function(e,t){if(ea=Wt,fr(e=pr())){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var r=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(r&&0!==r.rangeCount){n=r.anchorNode;var a=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch(w){n=null;break e}var o=0,c=-1,u=-1,l=0,d=0,p=e,f=null;t:for(;;){for(var h;p!==n||0!==a&&3!==p.nodeType||(c=o+a),p!==s||0!==r&&3!==p.nodeType||(u=o+r),3===p.nodeType&&(o+=p.nodeValue.length),null!==(h=p.firstChild);)f=p,p=h;for(;;){if(p===e)break t;if(f===n&&++l===a&&(c=o),f===s&&++d===r&&(u=o),null!==(h=p.nextSibling))break;f=(p=f).parentNode}p=h}n=-1===c||-1===u?null:{start:c,end:u}}else n=null}n=n||{start:0,end:0}}else n=null;for(ta={focusedElem:e,selectionRange:n},Wt=!1,Yo=t;null!==Yo;)if(e=(t=Yo).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,Yo=e;else for(;null!==Yo;){t=Yo;try{var m=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==m){var v=m.memoizedProps,g=m.memoizedState,b=t.stateNode,y=b.getSnapshotBeforeUpdate(t.elementType===t.type?v:vi(t.type,v),g);b.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var _=t.stateNode.containerInfo;1===_.nodeType?_.textContent="":9===_.nodeType&&_.documentElement&&_.removeChild(_.documentElement);break;default:throw Error(i(163))}}catch(w){Su(t,t.return,w)}if(null!==(e=t.sibling)){e.return=t.return,Yo=e;break}Yo=t.return}m=tc,tc=!1}(e,n),vc(n,e),hr(ta),Wt=!!ea,ta=ea=null,e.current=n,bc(n,e,a),$e(),Tc=c,yt=o,Cc.transition=s}else e.current=n;if(Kc&&(Kc=!1,Xc=e,Qc=a),0===(s=e.pendingLanes)&&(Gc=null),function(e){if(it&&"function"===typeof it.onCommitFiberRoot)try{it.onCommitFiberRoot(at,e,void 0,128===(128&e.current.flags))}catch(t){}}(n.stateNode),ru(e,Je()),null!==t)for(r=e.onRecoverableError,n=0;n<t.length;n++)r((a=t[n]).value,{componentStack:a.stack,digest:a.digest});if(Wc)throw Wc=!1,e=qc,qc=null,e;0!==(1&Qc)&&0!==e.tag&&ku(),0!==(1&(s=e.pendingLanes))?e===Jc?$c++:($c=0,Jc=e):$c=0,Va()}(e,t,n,r)}finally{Cc.transition=a,yt=r}return null}function ku(){if(null!==Xc){var e=_t(Qc),t=Cc.transition,n=yt;try{if(Cc.transition=null,yt=16>e?16:e,null===Xc)var r=!1;else{if(e=Xc,Xc=null,Qc=0,0!==(6&Tc))throw Error(i(331));var a=Tc;for(Tc|=4,Yo=e.current;null!==Yo;){var s=Yo,o=s.child;if(0!==(16&Yo.flags)){var c=s.deletions;if(null!==c){for(var u=0;u<c.length;u++){var l=c[u];for(Yo=l;null!==Yo;){var d=Yo;switch(d.tag){case 0:case 11:case 15:nc(8,d,s)}var p=d.child;if(null!==p)p.return=d,Yo=p;else for(;null!==Yo;){var f=(d=Yo).sibling,h=d.return;if(ic(d),d===l){Yo=null;break}if(null!==f){f.return=h,Yo=f;break}Yo=h}}}var m=s.alternate;if(null!==m){var v=m.child;if(null!==v){m.child=null;do{var g=v.sibling;v.sibling=null,v=g}while(null!==v)}}Yo=s}}if(0!==(2064&s.subtreeFlags)&&null!==o)o.return=s,Yo=o;else e:for(;null!==Yo;){if(0!==(2048&(s=Yo).flags))switch(s.tag){case 0:case 11:case 15:nc(9,s,s.return)}var b=s.sibling;if(null!==b){b.return=s.return,Yo=b;break e}Yo=s.return}}var y=e.current;for(Yo=y;null!==Yo;){var _=(o=Yo).child;if(0!==(2064&o.subtreeFlags)&&null!==_)_.return=o,Yo=_;else e:for(o=y;null!==Yo;){if(0!==(2048&(c=Yo).flags))try{switch(c.tag){case 0:case 11:case 15:rc(9,c)}}catch(k){Su(c,c.return,k)}if(c===o){Yo=null;break e}var w=c.sibling;if(null!==w){w.return=c.return,Yo=w;break e}Yo=c.return}}if(Tc=a,Va(),it&&"function"===typeof it.onPostCommitFiberRoot)try{it.onPostCommitFiberRoot(at,e)}catch(k){}r=!0}return r}finally{yt=n,Cc.transition=t}}return!1}function xu(e,t,n){e=ji(e,t=ho(0,t=uo(n,t),1),1),t=eu(),null!==e&&(gt(e,1,t),ru(e,t))}function Su(e,t,n){if(3===e.tag)xu(e,e,n);else for(;null!==t;){if(3===t.tag){xu(t,e,n);break}if(1===t.tag){var r=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===Gc||!Gc.has(r))){t=ji(t,e=mo(t,e=uo(n,e),1),1),e=eu(),null!==t&&(gt(t,1,e),ru(t,e));break}}t=t.return}}function Ru(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),t=eu(),e.pingedLanes|=e.suspendedLanes&n,Ec===e&&(Mc&n)===n&&(4===jc||3===jc&&(130023424&Mc)===Mc&&500>Je()-zc?pu(e,0):Nc|=n),ru(e,t)}function Pu(e,t){0===t&&(0===(1&e.mode)?t=1:(t=lt,0===(130023424&(lt<<=1))&&(lt=4194304)));var n=eu();null!==(e=Ei(e,t))&&(gt(e,t,n),ru(e,n))}function Cu(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),Pu(e,n)}function Tu(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,a=e.memoizedState;null!==a&&(n=a.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(i(314))}null!==r&&r.delete(t),Pu(e,n)}function Eu(e,t){return Ke(e,t)}function Ou(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Mu(e,t,n,r){return new Ou(e,t,n,r)}function Iu(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Du(e,t){var n=e.alternate;return null===n?((n=Mu(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function ju(e,t,n,r,a,s){var o=2;if(r=e,"function"===typeof e)Iu(e)&&(o=1);else if("string"===typeof e)o=5;else e:switch(e){case x:return Lu(n.children,a,s,t);case S:o=8,a|=8;break;case R:return(e=Mu(12,n,t,2|a)).elementType=R,e.lanes=s,e;case E:return(e=Mu(13,n,t,a)).elementType=E,e.lanes=s,e;case O:return(e=Mu(19,n,t,a)).elementType=O,e.lanes=s,e;case D:return Au(n,a,s,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case P:o=10;break e;case C:o=9;break e;case T:o=11;break e;case M:o=14;break e;case I:o=16,r=null;break e}throw Error(i(130,null==e?e:typeof e,""))}return(t=Mu(o,n,t,a)).elementType=e,t.type=r,t.lanes=s,t}function Lu(e,t,n,r){return(e=Mu(7,e,r,t)).lanes=n,e}function Au(e,t,n,r){return(e=Mu(22,e,r,t)).elementType=D,e.lanes=n,e.stateNode={isHidden:!1},e}function Fu(e,t,n){return(e=Mu(6,e,null,t)).lanes=n,e}function Nu(e,t,n){return(t=Mu(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Bu(e,t,n,r,a){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=vt(0),this.expirationTimes=vt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=vt(0),this.identifierPrefix=r,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function Uu(e,t,n,r,a,i,s,o,c){return e=new Bu(e,t,n,o,c),1===t?(t=1,!0===i&&(t|=8)):t=0,i=Mu(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Mi(i),e}function zu(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:k,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}function Vu(e){if(!e)return Ca;e:{if(Ve(e=e._reactInternals)!==e||1!==e.tag)throw Error(i(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Ia(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(i(171))}if(1===e.tag){var n=e.type;if(Ia(n))return La(e,n,t)}return t}function Hu(e,t,n,r,a,i,s,o,c){return(e=Uu(n,r,!0,e,0,i,0,o,c)).context=Vu(null),n=e.current,(i=Di(r=eu(),a=tu(n))).callback=void 0!==t&&null!==t?t:null,ji(n,i,a),e.current.lanes=a,gt(e,a,r),ru(e,r),e}function Wu(e,t,n,r){var a=t.current,i=eu(),s=tu(a);return n=Vu(n),null===t.context?t.context=n:t.pendingContext=n,(t=Di(i,s)).payload={element:e},null!==(r=void 0===r?null:r)&&(t.callback=r),null!==(e=ji(a,t,s))&&(nu(e,a,s,i),Li(e,a,s)),s}function qu(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function Gu(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function Ku(e,t){Gu(e,t),(e=e.alternate)&&Gu(e,t)}xc=function(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps||Ea.current)_o=!0;else{if(0===(e.lanes&n)&&0===(128&t.flags))return _o=!1,function(e,t,n){switch(t.tag){case 3:Oo(t),fi();break;case 5:is(t);break;case 1:Ia(t.type)&&Aa(t);break;case 4:rs(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,a=t.memoizedProps.value;Pa(gi,r._currentValue),r._currentValue=a;break;case 13:if(null!==(r=t.memoizedState))return null!==r.dehydrated?(Pa(os,1&os.current),t.flags|=128,null):0!==(n&t.child.childLanes)?Fo(e,t,n):(Pa(os,1&os.current),null!==(e=Wo(e,t,n))?e.sibling:null);Pa(os,1&os.current);break;case 19:if(r=0!==(n&t.childLanes),0!==(128&e.flags)){if(r)return Vo(e,t,n);t.flags|=128}if(null!==(a=t.memoizedState)&&(a.rendering=null,a.tail=null,a.lastEffect=null),Pa(os,os.current),r)break;return null;case 22:case 23:return t.lanes=0,Ro(e,t,n)}return Wo(e,t,n)}(e,t,n);_o=0!==(131072&e.flags)}else _o=!1,ai&&0!==(1048576&t.flags)&&Za(t,Ga,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;Ho(e,t),e=t.pendingProps;var a=Ma(t,Ta.current);Si(t,n),a=xs(null,t,r,e,a,n);var s=Ss();return t.flags|=1,"object"===typeof a&&null!==a&&"function"===typeof a.render&&void 0===a.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Ia(r)?(s=!0,Aa(t)):s=!1,t.memoizedState=null!==a.state&&void 0!==a.state?a.state:null,Mi(t),a.updater=zi,t.stateNode=a,a._reactInternals=t,qi(t,r,e,n),t=Eo(null,t,r,!0,s,n)):(t.tag=0,ai&&s&&ei(t),wo(null,t,a,n),t=t.child),t;case 16:r=t.elementType;e:{switch(Ho(e,t),e=t.pendingProps,r=(a=r._init)(r._payload),t.type=r,a=t.tag=function(e){if("function"===typeof e)return Iu(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===T)return 11;if(e===M)return 14}return 2}(r),e=vi(r,e),a){case 0:t=Co(null,t,r,e,n);break e;case 1:t=To(null,t,r,e,n);break e;case 11:t=ko(null,t,r,e,n);break e;case 14:t=xo(null,t,r,vi(r.type,e),n);break e}throw Error(i(306,r,""))}return t;case 0:return r=t.type,a=t.pendingProps,Co(e,t,r,a=t.elementType===r?a:vi(r,a),n);case 1:return r=t.type,a=t.pendingProps,To(e,t,r,a=t.elementType===r?a:vi(r,a),n);case 3:e:{if(Oo(t),null===e)throw Error(i(387));r=t.pendingProps,a=(s=t.memoizedState).element,Ii(e,t),Fi(t,r,null,n);var o=t.memoizedState;if(r=o.element,s.isDehydrated){if(s={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=s,t.memoizedState=s,256&t.flags){t=Mo(e,t,r,n,a=uo(Error(i(423)),t));break e}if(r!==a){t=Mo(e,t,r,n,a=uo(Error(i(424)),t));break e}for(ri=ua(t.stateNode.containerInfo.firstChild),ni=t,ai=!0,ii=null,n=Ji(t,null,r,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(fi(),r===a){t=Wo(e,t,n);break e}wo(e,t,r,n)}t=t.child}return t;case 5:return is(t),null===e&&ui(t),r=t.type,a=t.pendingProps,s=null!==e?e.memoizedProps:null,o=a.children,na(r,a)?o=null:null!==s&&na(r,s)&&(t.flags|=32),Po(e,t),wo(e,t,o,n),t.child;case 6:return null===e&&ui(t),null;case 13:return Fo(e,t,n);case 4:return rs(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=$i(t,null,r,n):wo(e,t,r,n),t.child;case 11:return r=t.type,a=t.pendingProps,ko(e,t,r,a=t.elementType===r?a:vi(r,a),n);case 7:return wo(e,t,t.pendingProps,n),t.child;case 8:case 12:return wo(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,a=t.pendingProps,s=t.memoizedProps,o=a.value,Pa(gi,r._currentValue),r._currentValue=o,null!==s)if(or(s.value,o)){if(s.children===a.children&&!Ea.current){t=Wo(e,t,n);break e}}else for(null!==(s=t.child)&&(s.return=t);null!==s;){var c=s.dependencies;if(null!==c){o=s.child;for(var u=c.firstContext;null!==u;){if(u.context===r){if(1===s.tag){(u=Di(-1,n&-n)).tag=2;var l=s.updateQueue;if(null!==l){var d=(l=l.shared).pending;null===d?u.next=u:(u.next=d.next,d.next=u),l.pending=u}}s.lanes|=n,null!==(u=s.alternate)&&(u.lanes|=n),xi(s.return,n,t),c.lanes|=n;break}u=u.next}}else if(10===s.tag)o=s.type===t.type?null:s.child;else if(18===s.tag){if(null===(o=s.return))throw Error(i(341));o.lanes|=n,null!==(c=o.alternate)&&(c.lanes|=n),xi(o,n,t),o=s.sibling}else o=s.child;if(null!==o)o.return=s;else for(o=s;null!==o;){if(o===t){o=null;break}if(null!==(s=o.sibling)){s.return=o.return,o=s;break}o=o.return}s=o}wo(e,t,a.children,n),t=t.child}return t;case 9:return a=t.type,r=t.pendingProps.children,Si(t,n),r=r(a=Ri(a)),t.flags|=1,wo(e,t,r,n),t.child;case 14:return a=vi(r=t.type,t.pendingProps),xo(e,t,r,a=vi(r.type,a),n);case 15:return So(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,a=t.pendingProps,a=t.elementType===r?a:vi(r,a),Ho(e,t),t.tag=1,Ia(r)?(e=!0,Aa(t)):e=!1,Si(t,n),Hi(t,r,a),qi(t,r,a,n),Eo(null,t,r,!0,e,n);case 19:return Vo(e,t,n);case 22:return Ro(e,t,n)}throw Error(i(156,t.tag))};var Xu="function"===typeof reportError?reportError:function(e){console.error(e)};function Qu(e){this._internalRoot=e}function $u(e){this._internalRoot=e}function Ju(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Yu(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Zu(){}function el(e,t,n,r,a){var i=n._reactRootContainer;if(i){var s=i;if("function"===typeof a){var o=a;a=function(){var e=qu(s);o.call(e)}}Wu(t,s,e,a)}else s=function(e,t,n,r,a){if(a){if("function"===typeof r){var i=r;r=function(){var e=qu(s);i.call(e)}}var s=Hu(t,r,e,0,null,!1,0,"",Zu);return e._reactRootContainer=s,e[ha]=s.current,Vr(8===e.nodeType?e.parentNode:e),lu(),s}for(;a=e.lastChild;)e.removeChild(a);if("function"===typeof r){var o=r;r=function(){var e=qu(c);o.call(e)}}var c=Uu(e,0,!1,null,0,!1,0,"",Zu);return e._reactRootContainer=c,e[ha]=c.current,Vr(8===e.nodeType?e.parentNode:e),lu((function(){Wu(t,c,n,r)})),c}(n,t,e,a,r);return qu(s)}$u.prototype.render=Qu.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(i(409));Wu(e,t,null,null)},$u.prototype.unmount=Qu.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;lu((function(){Wu(null,e,null,null)})),t[ha]=null}},$u.prototype.unstable_scheduleHydration=function(e){if(e){var t=St();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Dt.length&&0!==t&&t<Dt[n].priority;n++);Dt.splice(n,0,e),0===n&&Ft(e)}},wt=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=dt(t.pendingLanes);0!==n&&(bt(t,1|n),ru(t,Je()),0===(6&Tc)&&(Vc=Je()+500,Va()))}break;case 13:lu((function(){var t=Ei(e,1);if(null!==t){var n=eu();nu(t,e,1,n)}})),Ku(e,1)}},kt=function(e){if(13===e.tag){var t=Ei(e,134217728);if(null!==t)nu(t,e,134217728,eu());Ku(e,134217728)}},xt=function(e){if(13===e.tag){var t=tu(e),n=Ei(e,t);if(null!==n)nu(n,e,t,eu());Ku(e,t)}},St=function(){return yt},Rt=function(e,t){var n=yt;try{return yt=e,t()}finally{yt=n}},ke=function(e,t,n){switch(t){case"input":if(Y(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var a=wa(r);if(!a)throw Error(i(90));K(r),Y(r,a)}}}break;case"textarea":ie(e,n);break;case"select":null!=(t=n.value)&&ne(e,!!n.multiple,t,!1)}},Te=uu,Ee=lu;var tl={usingClientEntryPoint:!1,Events:[ya,_a,wa,Pe,Ce,uu]},nl={findFiberByHostInstance:ba,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},rl={bundleType:nl.bundleType,version:nl.version,rendererPackageName:nl.rendererPackageName,rendererConfig:nl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:_.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=qe(e))?null:e.stateNode},findFiberByHostInstance:nl.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var al=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!al.isDisabled&&al.supportsFiber)try{at=al.inject(rl),it=al}catch(le){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=tl,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Ju(t))throw Error(i(200));return zu(e,t,null,n)},t.createRoot=function(e,t){if(!Ju(e))throw Error(i(299));var n=!1,r="",a=Xu;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(r=t.identifierPrefix),void 0!==t.onRecoverableError&&(a=t.onRecoverableError)),t=Uu(e,1,!1,null,0,n,0,r,a),e[ha]=t.current,Vr(8===e.nodeType?e.parentNode:e),new Qu(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(i(188));throw e=Object.keys(e).join(","),Error(i(268,e))}return e=null===(e=qe(t))?null:e.stateNode},t.flushSync=function(e){return lu(e)},t.hydrate=function(e,t,n){if(!Yu(t))throw Error(i(200));return el(null,e,t,!0,n)},t.hydrateRoot=function(e,t,n){if(!Ju(e))throw Error(i(405));var r=null!=n&&n.hydratedSources||null,a=!1,s="",o=Xu;if(null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(a=!0),void 0!==n.identifierPrefix&&(s=n.identifierPrefix),void 0!==n.onRecoverableError&&(o=n.onRecoverableError)),t=Hu(t,null,e,1,null!=n?n:null,a,0,s,o),e[ha]=t.current,Vr(e),r)for(e=0;e<r.length;e++)a=(a=(n=r[e])._getVersion)(n._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[n,a]:t.mutableSourceEagerHydrationData.push(n,a);return new $u(t)},t.render=function(e,t,n){if(!Yu(t))throw Error(i(200));return el(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!Yu(e))throw Error(i(40));return!!e._reactRootContainer&&(lu((function(){el(null,null,e,!1,(function(){e._reactRootContainer=null,e[ha]=null}))})),!0)},t.unstable_batchedUpdates=uu,t.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!Yu(n))throw Error(i(200));if(null==e||void 0===e._reactInternals)throw Error(i(38));return el(e,t,n,!1,r)},t.version="18.2.0-next-9e3b772b8-20220608"},250:function(e,t,n){"use strict";var r=n(164);t.createRoot=r.createRoot,t.hydrateRoot=r.hydrateRoot},164:function(e,t,n){"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(463)},374:function(e,t,n){"use strict";var r=n(791),a=Symbol.for("react.element"),i=Symbol.for("react.fragment"),s=Object.prototype.hasOwnProperty,o=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,c={key:!0,ref:!0,__self:!0,__source:!0};function u(e,t,n){var r,i={},u=null,l=null;for(r in void 0!==n&&(u=""+n),void 0!==t.key&&(u=""+t.key),void 0!==t.ref&&(l=t.ref),t)s.call(t,r)&&!c.hasOwnProperty(r)&&(i[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===i[r]&&(i[r]=t[r]);return{$$typeof:a,type:e,key:u,ref:l,props:i,_owner:o.current}}t.Fragment=i,t.jsx=u,t.jsxs=u},117:function(e,t){"use strict";var n=Symbol.for("react.element"),r=Symbol.for("react.portal"),a=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),o=Symbol.for("react.provider"),c=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),l=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),f=Symbol.iterator;var h={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},m=Object.assign,v={};function g(e,t,n){this.props=e,this.context=t,this.refs=v,this.updater=n||h}function b(){}function y(e,t,n){this.props=e,this.context=t,this.refs=v,this.updater=n||h}g.prototype.isReactComponent={},g.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},g.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},b.prototype=g.prototype;var _=y.prototype=new b;_.constructor=y,m(_,g.prototype),_.isPureReactComponent=!0;var w=Array.isArray,k=Object.prototype.hasOwnProperty,x={current:null},S={key:!0,ref:!0,__self:!0,__source:!0};function R(e,t,r){var a,i={},s=null,o=null;if(null!=t)for(a in void 0!==t.ref&&(o=t.ref),void 0!==t.key&&(s=""+t.key),t)k.call(t,a)&&!S.hasOwnProperty(a)&&(i[a]=t[a]);var c=arguments.length-2;if(1===c)i.children=r;else if(1<c){for(var u=Array(c),l=0;l<c;l++)u[l]=arguments[l+2];i.children=u}if(e&&e.defaultProps)for(a in c=e.defaultProps)void 0===i[a]&&(i[a]=c[a]);return{$$typeof:n,type:e,key:s,ref:o,props:i,_owner:x.current}}function P(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var C=/\/+/g;function T(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function E(e,t,a,i,s){var o=typeof e;"undefined"!==o&&"boolean"!==o||(e=null);var c=!1;if(null===e)c=!0;else switch(o){case"string":case"number":c=!0;break;case"object":switch(e.$$typeof){case n:case r:c=!0}}if(c)return s=s(c=e),e=""===i?"."+T(c,0):i,w(s)?(a="",null!=e&&(a=e.replace(C,"$&/")+"/"),E(s,t,a,"",(function(e){return e}))):null!=s&&(P(s)&&(s=function(e,t){return{$$typeof:n,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(s,a+(!s.key||c&&c.key===s.key?"":(""+s.key).replace(C,"$&/")+"/")+e)),t.push(s)),1;if(c=0,i=""===i?".":i+":",w(e))for(var u=0;u<e.length;u++){var l=i+T(o=e[u],u);c+=E(o,t,a,l,s)}else if(l=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=f&&e[f]||e["@@iterator"])?e:null}(e),"function"===typeof l)for(e=l.call(e),u=0;!(o=e.next()).done;)c+=E(o=o.value,t,a,l=i+T(o,u++),s);else if("object"===o)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return c}function O(e,t,n){if(null==e)return e;var r=[],a=0;return E(e,r,"","",(function(e){return t.call(n,e,a++)})),r}function M(e){if(-1===e._status){var t=e._result;(t=t()).then((function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)}),(function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)})),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var I={current:null},D={transition:null},j={ReactCurrentDispatcher:I,ReactCurrentBatchConfig:D,ReactCurrentOwner:x};t.Children={map:O,forEach:function(e,t,n){O(e,(function(){t.apply(this,arguments)}),n)},count:function(e){var t=0;return O(e,(function(){t++})),t},toArray:function(e){return O(e,(function(e){return e}))||[]},only:function(e){if(!P(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=g,t.Fragment=a,t.Profiler=s,t.PureComponent=y,t.StrictMode=i,t.Suspense=l,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=j,t.cloneElement=function(e,t,r){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var a=m({},e.props),i=e.key,s=e.ref,o=e._owner;if(null!=t){if(void 0!==t.ref&&(s=t.ref,o=x.current),void 0!==t.key&&(i=""+t.key),e.type&&e.type.defaultProps)var c=e.type.defaultProps;for(u in t)k.call(t,u)&&!S.hasOwnProperty(u)&&(a[u]=void 0===t[u]&&void 0!==c?c[u]:t[u])}var u=arguments.length-2;if(1===u)a.children=r;else if(1<u){c=Array(u);for(var l=0;l<u;l++)c[l]=arguments[l+2];a.children=c}return{$$typeof:n,type:e.type,key:i,ref:s,props:a,_owner:o}},t.createContext=function(e){return(e={$$typeof:c,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:o,_context:e},e.Consumer=e},t.createElement=R,t.createFactory=function(e){var t=R.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:u,render:e}},t.isValidElement=P,t.lazy=function(e){return{$$typeof:p,_payload:{_status:-1,_result:e},_init:M}},t.memo=function(e,t){return{$$typeof:d,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=D.transition;D.transition={};try{e()}finally{D.transition=t}},t.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")},t.useCallback=function(e,t){return I.current.useCallback(e,t)},t.useContext=function(e){return I.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return I.current.useDeferredValue(e)},t.useEffect=function(e,t){return I.current.useEffect(e,t)},t.useId=function(){return I.current.useId()},t.useImperativeHandle=function(e,t,n){return I.current.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return I.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return I.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return I.current.useMemo(e,t)},t.useReducer=function(e,t,n){return I.current.useReducer(e,t,n)},t.useRef=function(e){return I.current.useRef(e)},t.useState=function(e){return I.current.useState(e)},t.useSyncExternalStore=function(e,t,n){return I.current.useSyncExternalStore(e,t,n)},t.useTransition=function(){return I.current.useTransition()},t.version="18.2.0"},791:function(e,t,n){"use strict";e.exports=n(117)},184:function(e,t,n){"use strict";e.exports=n(374)},813:function(e,t){"use strict";function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var r=n-1>>>1,a=e[r];if(!(0<i(a,t)))break e;e[r]=t,e[n]=a,n=r}}function r(e){return 0===e.length?null:e[0]}function a(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,a=e.length,s=a>>>1;r<s;){var o=2*(r+1)-1,c=e[o],u=o+1,l=e[u];if(0>i(c,n))u<a&&0>i(l,c)?(e[r]=l,e[u]=n,r=u):(e[r]=c,e[o]=n,r=o);else{if(!(u<a&&0>i(l,n)))break e;e[r]=l,e[u]=n,r=u}}}return t}function i(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,c=o.now();t.unstable_now=function(){return o.now()-c}}var u=[],l=[],d=1,p=null,f=3,h=!1,m=!1,v=!1,g="function"===typeof setTimeout?setTimeout:null,b="function"===typeof clearTimeout?clearTimeout:null,y="undefined"!==typeof setImmediate?setImmediate:null;function _(e){for(var t=r(l);null!==t;){if(null===t.callback)a(l);else{if(!(t.startTime<=e))break;a(l),t.sortIndex=t.expirationTime,n(u,t)}t=r(l)}}function w(e){if(v=!1,_(e),!m)if(null!==r(u))m=!0,D(k);else{var t=r(l);null!==t&&j(w,t.startTime-e)}}function k(e,n){m=!1,v&&(v=!1,b(P),P=-1),h=!0;var i=f;try{for(_(n),p=r(u);null!==p&&(!(p.expirationTime>n)||e&&!E());){var s=p.callback;if("function"===typeof s){p.callback=null,f=p.priorityLevel;var o=s(p.expirationTime<=n);n=t.unstable_now(),"function"===typeof o?p.callback=o:p===r(u)&&a(u),_(n)}else a(u);p=r(u)}if(null!==p)var c=!0;else{var d=r(l);null!==d&&j(w,d.startTime-n),c=!1}return c}finally{p=null,f=i,h=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var x,S=!1,R=null,P=-1,C=5,T=-1;function E(){return!(t.unstable_now()-T<C)}function O(){if(null!==R){var e=t.unstable_now();T=e;var n=!0;try{n=R(!0,e)}finally{n?x():(S=!1,R=null)}}else S=!1}if("function"===typeof y)x=function(){y(O)};else if("undefined"!==typeof MessageChannel){var M=new MessageChannel,I=M.port2;M.port1.onmessage=O,x=function(){I.postMessage(null)}}else x=function(){g(O,0)};function D(e){R=e,S||(S=!0,x())}function j(e,n){P=g((function(){e(t.unstable_now())}),n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){m||h||(m=!0,D(k))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):C=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return r(u)},t.unstable_next=function(e){switch(f){case 1:case 2:case 3:var t=3;break;default:t=f}var n=f;f=t;try{return e()}finally{f=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=f;f=e;try{return t()}finally{f=n}},t.unstable_scheduleCallback=function(e,a,i){var s=t.unstable_now();switch("object"===typeof i&&null!==i?i="number"===typeof(i=i.delay)&&0<i?s+i:s:i=s,e){case 1:var o=-1;break;case 2:o=250;break;case 5:o=1073741823;break;case 4:o=1e4;break;default:o=5e3}return e={id:d++,callback:a,priorityLevel:e,startTime:i,expirationTime:o=i+o,sortIndex:-1},i>s?(e.sortIndex=i,n(l,e),null===r(u)&&e===r(l)&&(v?(b(P),P=-1):v=!0,j(w,i-s))):(e.sortIndex=o,n(u,e),m||h||(m=!0,D(k))),e},t.unstable_shouldYield=E,t.unstable_wrapCallback=function(e){var t=f;return function(){var n=f;f=t;try{return e.apply(this,arguments)}finally{f=n}}}},296:function(e,t,n){"use strict";e.exports=n(813)},391:function(e){"use strict";var t=function(){};e.exports=t}},t={};function n(r){var a=t[r];if(void 0!==a)return a.exports;var i=t[r]={exports:{}};return e[r](i,i.exports,n),i.exports}n.m=e,n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,{a:t}),t},n.d=function(e,t){for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.f={},n.e=function(e){return Promise.all(Object.keys(n.f).reduce((function(t,r){return n.f[r](e,t),t}),[]))},n.u=function(e){return"static/js/"+e+".c65fa54d.chunk.js"},n.miniCssF=function(e){},n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){var e={},t="webxvr:";n.l=function(r,a,i,s){if(e[r])e[r].push(a);else{var o,c;if(void 0!==i)for(var u=document.getElementsByTagName("script"),l=0;l<u.length;l++){var d=u[l];if(d.getAttribute("src")==r||d.getAttribute("data-webpack")==t+i){o=d;break}}o||(c=!0,(o=document.createElement("script")).charset="utf-8",o.timeout=120,n.nc&&o.setAttribute("nonce",n.nc),o.setAttribute("data-webpack",t+i),o.src=r),e[r]=[a];var p=function(t,n){o.onerror=o.onload=null,clearTimeout(f);var a=e[r];if(delete e[r],o.parentNode&&o.parentNode.removeChild(o),a&&a.forEach((function(e){return e(n)})),t)return t(n)},f=setTimeout(p.bind(null,void 0,{type:"timeout",target:o}),12e4);o.onerror=p.bind(null,o.onerror),o.onload=p.bind(null,o.onload),c&&document.head.appendChild(o)}}}(),n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.p="/",function(){var e={179:0};n.f.j=function(t,r){var a=n.o(e,t)?e[t]:void 0;if(0!==a)if(a)r.push(a[2]);else{var i=new Promise((function(n,r){a=e[t]=[n,r]}));r.push(a[2]=i);var s=n.p+n.u(t),o=new Error;n.l(s,(function(r){if(n.o(e,t)&&(0!==(a=e[t])&&(e[t]=void 0),a)){var i=r&&("load"===r.type?"missing":r.type),s=r&&r.target&&r.target.src;o.message="Loading chunk "+t+" failed.\n("+i+": "+s+")",o.name="ChunkLoadError",o.type=i,o.request=s,a[1](o)}}),"chunk-"+t,t)}};var t=function(t,r){var a,i,s=r[0],o=r[1],c=r[2],u=0;if(s.some((function(t){return 0!==e[t]}))){for(a in o)n.o(o,a)&&(n.m[a]=o[a]);if(c)c(n)}for(t&&t(r);u<s.length;u++)i=s[u],n.o(e,i)&&e[i]&&e[i][0](),e[i]=0},r=self.webpackChunkwebxvr=self.webpackChunkwebxvr||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))}(),function(){"use strict";var e,t=n(791),r=n(250);function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function i(e,t){if(e){if("string"===typeof e)return a(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a(e,t):void 0}}function s(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,i=[],s=!0,o=!1;try{for(n=n.call(e);!(s=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);s=!0);}catch(c){o=!0,a=c}finally{try{s||null==n.return||n.return()}finally{if(o)throw a}}return i}}(e,t)||i(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(){return o=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},o.apply(this,arguments)}!function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"}(e||(e={}));var c=function(e){return e};var u="beforeunload",l="popstate";function d(t){void 0===t&&(t={});var n=t.window,r=void 0===n?document.defaultView:n,a=r.history;function i(){var e=v(r.location.hash.substr(1)),t=e.pathname,n=void 0===t?"/":t,i=e.search,s=void 0===i?"":i,o=e.hash,u=void 0===o?"":o,l=a.state||{};return[l.idx,c({pathname:n,search:s,hash:u,state:l.usr||null,key:l.key||"default"})]}var s=null;function d(){if(s)k.call(s),s=null;else{var t=e.Pop,n=i(),r=n[0],a=n[1];if(k.length){if(null!=r){var o=y-r;o&&(s={action:t,location:a,retry:function(){T(-1*o)}},T(o))}}else C(t)}}r.addEventListener(l,d),r.addEventListener("hashchange",(function(){m(i()[1])!==m(_)&&d()}));var g=e.Pop,b=i(),y=b[0],_=b[1],w=f(),k=f();function x(e){return function(){var e=document.querySelector("base"),t="";if(e&&e.getAttribute("href")){var n=r.location.href,a=n.indexOf("#");t=-1===a?n:n.slice(0,a)}return t}()+"#"+("string"===typeof e?e:m(e))}function S(e,t){return void 0===t&&(t=null),c(o({pathname:_.pathname,hash:"",search:""},"string"===typeof e?v(e):e,{state:t,key:h()}))}function R(e,t){return[{usr:e.state,key:e.key,idx:t},x(e)]}function P(e,t,n){return!k.length||(k.call({action:e,location:t,retry:n}),!1)}function C(e){g=e;var t=i();y=t[0],_=t[1],w.call({action:g,location:_})}function T(e){a.go(e)}null==y&&(y=0,a.replaceState(o({},a.state,{idx:y}),""));var E={get action(){return g},get location(){return _},createHref:x,push:function t(n,i){var s=e.Push,o=S(n,i);if(P(s,o,(function(){t(n,i)}))){var c=R(o,y+1),u=c[0],l=c[1];try{a.pushState(u,"",l)}catch(d){r.location.assign(l)}C(s)}},replace:function t(n,r){var i=e.Replace,s=S(n,r);if(P(i,s,(function(){t(n,r)}))){var o=R(s,y),c=o[0],u=o[1];a.replaceState(c,"",u),C(i)}},go:T,back:function(){T(-1)},forward:function(){T(1)},listen:function(e){return w.push(e)},block:function(e){var t=k.push(e);return 1===k.length&&r.addEventListener(u,p),function(){t(),k.length||r.removeEventListener(u,p)}}};return E}function p(e){e.preventDefault(),e.returnValue=""}function f(){var e=[];return{get length(){return e.length},push:function(t){return e.push(t),function(){e=e.filter((function(e){return e!==t}))}},call:function(t){e.forEach((function(e){return e&&e(t)}))}}}function h(){return Math.random().toString(36).substr(2,8)}function m(e){var t=e.pathname,n=void 0===t?"/":t,r=e.search,a=void 0===r?"":r,i=e.hash,s=void 0===i?"":i;return a&&"?"!==a&&(n+="?"===a.charAt(0)?a:"?"+a),s&&"#"!==s&&(n+="#"===s.charAt(0)?s:"#"+s),n}function v(e){var t={};if(e){var n=e.indexOf("#");n>=0&&(t.hash=e.substr(n),e=e.substr(0,n));var r=e.indexOf("?");r>=0&&(t.search=e.substr(r),e=e.substr(0,r)),e&&(t.pathname=e)}return t}var g=(0,t.createContext)(null);var b=(0,t.createContext)(null);var y=(0,t.createContext)({outlet:null,matches:[]});function _(e,t){if(!e)throw new Error(t)}function w(e,t,n){void 0===n&&(n="/");var r=T(("string"===typeof t?v(t):t).pathname||"/",n);if(null==r)return null;var a=k(e);!function(e){e.sort((function(e,t){return e.score!==t.score?t.score-e.score:function(e,t){var n=e.length===t.length&&e.slice(0,-1).every((function(e,n){return e===t[n]}));return n?e[e.length-1]-t[t.length-1]:0}(e.routesMeta.map((function(e){return e.childrenIndex})),t.routesMeta.map((function(e){return e.childrenIndex})))}))}(a);for(var i=null,s=0;null==i&&s<a.length;++s)i=P(a[s],r);return i}function k(e,t,n,r){return void 0===t&&(t=[]),void 0===n&&(n=[]),void 0===r&&(r=""),e.forEach((function(e,a){var i={relativePath:e.path||"",caseSensitive:!0===e.caseSensitive,childrenIndex:a,route:e};i.relativePath.startsWith("/")&&(i.relativePath.startsWith(r)||_(!1),i.relativePath=i.relativePath.slice(r.length));var s=E([r,i.relativePath]),o=n.concat(i);e.children&&e.children.length>0&&(!0===e.index&&_(!1),k(e.children,t,o,s)),(null!=e.path||e.index)&&t.push({path:s,score:R(s,e.index),routesMeta:o})})),t}var x=/^:\w+$/,S=function(e){return"*"===e};function R(e,t){var n=e.split("/"),r=n.length;return n.some(S)&&(r+=-2),t&&(r+=2),n.filter((function(e){return!S(e)})).reduce((function(e,t){return e+(x.test(t)?3:""===t?1:10)}),r)}function P(e,t){for(var n=e.routesMeta,r={},a="/",i=[],s=0;s<n.length;++s){var o=n[s],c=s===n.length-1,u="/"===a?t:t.slice(a.length)||"/",l=C({path:o.relativePath,caseSensitive:o.caseSensitive,end:c},u);if(!l)return null;Object.assign(r,l.params);var d=o.route;i.push({params:r,pathname:E([a,l.pathname]),pathnameBase:O(E([a,l.pathnameBase])),route:d}),"/"!==l.pathnameBase&&(a=E([a,l.pathnameBase]))}return i}function C(e,t){"string"===typeof e&&(e={path:e,caseSensitive:!1,end:!0});var n=function(e,t,n){void 0===t&&(t=!1);void 0===n&&(n=!0);var r=[],a="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^$?{}|()[\]]/g,"\\$&").replace(/:(\w+)/g,(function(e,t){return r.push(t),"([^\\/]+)"}));e.endsWith("*")?(r.push("*"),a+="*"===e||"/*"===e?"(.*)$":"(?:\\/(.+)|\\/*)$"):a+=n?"\\/*$":"(?:(?=[.~-]|%[0-9A-F]{2})|\\b|\\/|$)";return[new RegExp(a,t?void 0:"i"),r]}(e.path,e.caseSensitive,e.end),r=s(n,2),a=r[0],i=r[1],o=t.match(a);if(!o)return null;var c=o[0],u=c.replace(/(.)\/+$/,"$1"),l=o.slice(1);return{params:i.reduce((function(e,t,n){if("*"===t){var r=l[n]||"";u=c.slice(0,c.length-r.length).replace(/(.)\/+$/,"$1")}return e[t]=function(e,t){try{return decodeURIComponent(e)}catch(n){return e}}(l[n]||""),e}),{}),pathname:c,pathnameBase:u,pattern:e}}function T(e,t){if("/"===t)return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;var n=e.charAt(t.length);return n&&"/"!==n?null:e.slice(t.length)||"/"}var E=function(e){return e.join("/").replace(/\/\/+/g,"/")},O=function(e){return e.replace(/\/+$/,"").replace(/^\/*/,"/")};function M(){return null!=(0,t.useContext)(b)}function I(){return M()||_(!1),(0,t.useContext)(b).location}function D(e,n){return void 0===n&&(n=[]),null==e?null:e.reduceRight((function(r,a,i){return(0,t.createElement)(y.Provider,{children:void 0!==a.route.element?a.route.element:r,value:{outlet:r,matches:n.concat(e.slice(0,i+1))}})}),null)}function j(e){_(!1)}function L(n){var r=n.basename,a=void 0===r?"/":r,i=n.children,s=void 0===i?null:i,o=n.location,c=n.navigationType,u=void 0===c?e.Pop:c,l=n.navigator,d=n.static,p=void 0!==d&&d;M()&&_(!1);var f=O(a),h=(0,t.useMemo)((function(){return{basename:f,navigator:l,static:p}}),[f,l,p]);"string"===typeof o&&(o=v(o));var m=o,y=m.pathname,w=void 0===y?"/":y,k=m.search,x=void 0===k?"":k,S=m.hash,R=void 0===S?"":S,P=m.state,C=void 0===P?null:P,E=m.key,I=void 0===E?"default":E,D=(0,t.useMemo)((function(){var e=T(w,f);return null==e?null:{pathname:e,search:x,hash:R,state:C,key:I}}),[f,w,x,R,C,I]);return null==D?null:(0,t.createElement)(g.Provider,{value:h},(0,t.createElement)(b.Provider,{children:s,value:{location:D,navigationType:u}}))}function A(e){var n=e.children,r=e.location;return function(e,n){M()||_(!1);var r,a=(0,t.useContext)(y).matches,i=a[a.length-1],s=i?i.params:{},o=(i&&i.pathname,i?i.pathnameBase:"/"),c=(i&&i.route,I());if(n){var u,l="string"===typeof n?v(n):n;"/"===o||(null==(u=l.pathname)?void 0:u.startsWith(o))||_(!1),r=l}else r=c;var d=r.pathname||"/",p=w(e,{pathname:"/"===o?d:d.slice(o.length)||"/"});return D(p&&p.map((function(e){return Object.assign({},e,{params:Object.assign({},s,e.params),pathname:E([o,e.pathname]),pathnameBase:"/"===e.pathnameBase?o:E([o,e.pathnameBase])})})),a)}(F(n),r)}function F(e){var n=[];return t.Children.forEach(e,(function(e){if((0,t.isValidElement)(e))if(e.type!==t.Fragment){e.type!==j&&_(!1);var r={caseSensitive:e.props.caseSensitive,element:e.props.element,index:e.props.index,path:e.props.path};e.props.children&&(r.children=F(e.props.children)),n.push(r)}else n.push.apply(n,F(e.props.children))})),n}function N(e){var n=e.basename,r=e.children,a=e.window,i=(0,t.useRef)();null==i.current&&(i.current=d({window:a}));var o=i.current,c=s((0,t.useState)({action:o.action,location:o.location}),2),u=c[0],l=c[1];return(0,t.useLayoutEffect)((function(){return o.listen(l)}),[o]),(0,t.createElement)(L,{basename:n,children:r,location:u.location,navigationType:u.action,navigator:o})}var B=function(e){e&&e instanceof Function&&n.e(787).then(n.bind(n,787)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,i=t.getLCP,s=t.getTTFB;n(e),r(e),a(e),i(e),s(e)}))};function U(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function z(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function V(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?z(Object(n),!0).forEach((function(t){U(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):z(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function H(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}function W(e,t){if(null==e)return{};var n,r,a=H(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var q=n(694),G=n.n(q),K=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return null!=e?String(e):t||null},X=t.createContext(null);n(176);function Q(e){return"default"+e.charAt(0).toUpperCase()+e.substr(1)}function $(e){var t=function(e,t){if("object"!==typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===typeof t?t:String(t)}function J(e,n){return Object.keys(n).reduce((function(r,a){var i,s=r,c=s[Q(a)],u=s[a],l=H(s,[Q(a),a].map($)),d=n[a],p=function(e,n,r){var a=(0,t.useRef)(void 0!==e),i=(0,t.useState)(n),s=i[0],o=i[1],c=void 0!==e,u=a.current;return a.current=c,!c&&u&&s!==n&&o(n),[c?e:s,(0,t.useCallback)((function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),a=1;a<t;a++)n[a-1]=arguments[a];r&&r.apply(void 0,[e].concat(n)),o(e)}),[r])]}(u,c,e[d]),f=p[0],h=p[1];return o({},l,((i={})[a]=f,i[d]=h,i))}),e)}function Y(){var e=this.constructor.getDerivedStateFromProps(this.props,this.state);null!==e&&void 0!==e&&this.setState(e)}function Z(e){this.setState(function(t){var n=this.constructor.getDerivedStateFromProps(e,t);return null!==n&&void 0!==n?n:null}.bind(this))}function ee(e,t){try{var n=this.props,r=this.state;this.props=e,this.state=t,this.__reactInternalSnapshotFlag=!0,this.__reactInternalSnapshot=this.getSnapshotBeforeUpdate(n,r)}finally{this.props=n,this.state=r}}Y.__suppressDeprecationWarning=!0,Z.__suppressDeprecationWarning=!0,ee.__suppressDeprecationWarning=!0;var te=/-(.)/g;var ne=n(184),re=["xxl","xl","lg","md","sm","xs"],ae=t.createContext({prefixes:{},breakpoints:re});ae.Consumer,ae.Provider;function ie(e,n){var r=(0,t.useContext)(ae).prefixes;return e||r[n]||n}function se(){return(0,t.useContext)(ae).breakpoints}var oe=["className","bsPrefix","as"],ce=function(e){return e[0].toUpperCase()+(t=e,t.replace(te,(function(e,t){return t.toUpperCase()}))).slice(1);var t};function ue(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.displayName,a=void 0===r?ce(e):r,i=n.Component,s=n.defaultProps,o=t.forwardRef((function(t,n){var r=t.className,a=t.bsPrefix,s=t.as,o=void 0===s?i||"div":s,c=W(t,oe),u=ie(a,e);return(0,ne.jsx)(o,V({ref:n,className:G()(r,u)},c))}));return o.defaultProps=s,o.displayName=a,o}var le=["bsPrefix","className","as"],de=t.forwardRef((function(e,t){var n=e.bsPrefix,r=e.className,a=e.as,i=W(e,le);n=ie(n,"navbar-brand");var s=a||(i.href?"a":"span");return(0,ne.jsx)(s,V(V({},i),{},{ref:t,className:G()(r,n)}))}));de.displayName="NavbarBrand";var pe=de;function fe(e){return e&&e.ownerDocument||document}function he(e,t){return function(e){var t=fe(e);return t&&t.defaultView||window}(e).getComputedStyle(e,t)}var me=/([A-Z])/g;var ve=/^ms-/;function ge(e){return function(e){return e.replace(me,"-$1").toLowerCase()}(e).replace(ve,"-ms-")}var be=/^((translate|rotate|scale)(X|Y|Z|3d)?|matrix(3d)?|perspective|skew(X|Y)?)$/i;var ye=function(e,t){var n="",r="";if("string"===typeof t)return e.style.getPropertyValue(ge(t))||he(e).getPropertyValue(ge(t));Object.keys(t).forEach((function(a){var i=t[a];i||0===i?!function(e){return!(!e||!be.test(e))}(a)?n+=ge(a)+": "+i+";":r+=a+"("+i+") ":e.style.removeProperty(ge(a))})),r&&(n+="transform: "+r+";"),e.style.cssText+=";"+n};function _e(e,t){return _e=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},_e(e,t)}var we=n(164),ke=!1,xe=t.createContext(null),Se="unmounted",Re="exited",Pe="entering",Ce="entered",Te="exiting",Ee=function(e){var n,r;function a(t,n){var r;r=e.call(this,t,n)||this;var a,i=n&&!n.isMounting?t.enter:t.appear;return r.appearStatus=null,t.in?i?(a=Re,r.appearStatus=Pe):a=Ce:a=t.unmountOnExit||t.mountOnEnter?Se:Re,r.state={status:a},r.nextCallback=null,r}r=e,(n=a).prototype=Object.create(r.prototype),n.prototype.constructor=n,_e(n,r),a.getDerivedStateFromProps=function(e,t){return e.in&&t.status===Se?{status:Re}:null};var i=a.prototype;return i.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},i.componentDidUpdate=function(e){var t=null;if(e!==this.props){var n=this.state.status;this.props.in?n!==Pe&&n!==Ce&&(t=Pe):n!==Pe&&n!==Ce||(t=Te)}this.updateStatus(!1,t)},i.componentWillUnmount=function(){this.cancelNextCallback()},i.getTimeouts=function(){var e,t,n,r=this.props.timeout;return e=t=n=r,null!=r&&"number"!==typeof r&&(e=r.exit,t=r.enter,n=void 0!==r.appear?r.appear:t),{exit:e,enter:t,appear:n}},i.updateStatus=function(e,t){void 0===e&&(e=!1),null!==t?(this.cancelNextCallback(),t===Pe?this.performEnter(e):this.performExit()):this.props.unmountOnExit&&this.state.status===Re&&this.setState({status:Se})},i.performEnter=function(e){var t=this,n=this.props.enter,r=this.context?this.context.isMounting:e,a=this.props.nodeRef?[r]:[we.findDOMNode(this),r],i=a[0],s=a[1],o=this.getTimeouts(),c=r?o.appear:o.enter;!e&&!n||ke?this.safeSetState({status:Ce},(function(){t.props.onEntered(i)})):(this.props.onEnter(i,s),this.safeSetState({status:Pe},(function(){t.props.onEntering(i,s),t.onTransitionEnd(c,(function(){t.safeSetState({status:Ce},(function(){t.props.onEntered(i,s)}))}))})))},i.performExit=function(){var e=this,t=this.props.exit,n=this.getTimeouts(),r=this.props.nodeRef?void 0:we.findDOMNode(this);t&&!ke?(this.props.onExit(r),this.safeSetState({status:Te},(function(){e.props.onExiting(r),e.onTransitionEnd(n.exit,(function(){e.safeSetState({status:Re},(function(){e.props.onExited(r)}))}))}))):this.safeSetState({status:Re},(function(){e.props.onExited(r)}))},i.cancelNextCallback=function(){null!==this.nextCallback&&(this.nextCallback.cancel(),this.nextCallback=null)},i.safeSetState=function(e,t){t=this.setNextCallback(t),this.setState(e,t)},i.setNextCallback=function(e){var t=this,n=!0;return this.nextCallback=function(r){n&&(n=!1,t.nextCallback=null,e(r))},this.nextCallback.cancel=function(){n=!1},this.nextCallback},i.onTransitionEnd=function(e,t){this.setNextCallback(t);var n=this.props.nodeRef?this.props.nodeRef.current:we.findDOMNode(this),r=null==e&&!this.props.addEndListener;if(n&&!r){if(this.props.addEndListener){var a=this.props.nodeRef?[this.nextCallback]:[n,this.nextCallback],i=a[0],s=a[1];this.props.addEndListener(i,s)}null!=e&&setTimeout(this.nextCallback,e)}else setTimeout(this.nextCallback,0)},i.render=function(){var e=this.state.status;if(e===Se)return null;var n=this.props,r=n.children,a=(n.in,n.mountOnEnter,n.unmountOnExit,n.appear,n.enter,n.exit,n.timeout,n.addEndListener,n.onEnter,n.onEntering,n.onEntered,n.onExit,n.onExiting,n.onExited,n.nodeRef,H(n,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]));return t.createElement(xe.Provider,{value:null},"function"===typeof r?r(e,a):t.cloneElement(t.Children.only(r),a))},a}(t.Component);function Oe(){}Ee.contextType=xe,Ee.propTypes={},Ee.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:Oe,onEntering:Oe,onEntered:Oe,onExit:Oe,onExiting:Oe,onExited:Oe},Ee.UNMOUNTED=Se,Ee.EXITED=Re,Ee.ENTERING=Pe,Ee.ENTERED=Ce,Ee.EXITING=Te;var Me=Ee,Ie=!("undefined"===typeof window||!window.document||!window.document.createElement),De=!1,je=!1;try{var Le={get passive(){return De=!0},get once(){return je=De=!0}};Ie&&(window.addEventListener("test",Le,Le),window.removeEventListener("test",Le,!0))}catch(au){}var Ae=function(e,t,n,r){if(r&&"boolean"!==typeof r&&!je){var a=r.once,i=r.capture,s=n;!je&&a&&(s=n.__once||function e(r){this.removeEventListener(t,e,i),n.call(this,r)},n.__once=s),e.addEventListener(t,s,De?r:i)}e.addEventListener(t,n,r)};var Fe=function(e,t,n,r){var a=r&&"boolean"!==typeof r?r.capture:r;e.removeEventListener(t,n,a),n.__once&&e.removeEventListener(t,n.__once,a)};var Ne=function(e,t,n,r){return Ae(e,t,n,r),function(){Fe(e,t,n,r)}};function Be(e,t,n){void 0===n&&(n=5);var r=!1,a=setTimeout((function(){r||function(e,t,n,r){if(void 0===n&&(n=!1),void 0===r&&(r=!0),e){var a=document.createEvent("HTMLEvents");a.initEvent(t,n,r),e.dispatchEvent(a)}}(e,"transitionend",!0)}),t+n),i=Ne(e,"transitionend",(function(){r=!0}),{once:!0});return function(){clearTimeout(a),i()}}function Ue(e,t,n,r){null==n&&(n=function(e){var t=ye(e,"transitionDuration")||"",n=-1===t.indexOf("ms")?1e3:1;return parseFloat(t)*n}(e)||0);var a=Be(e,n,r),i=Ne(e,"transitionend",t);return function(){a(),i()}}function ze(e,t){var n=ye(e,t)||"",r=-1===n.indexOf("ms")?1e3:1;return parseFloat(n)*r}function Ve(e,t){var n=ze(e,"transitionDuration"),r=ze(e,"transitionDelay"),a=Ue(e,(function(n){n.target===e&&(a(),t(n))}),n+r)}var He=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.filter((function(e){return null!=e})).reduce((function(e,t){if("function"!==typeof t)throw new Error("Invalid Argument Type, must only provide functions, undefined, or null.");return null===e?t:function(){for(var n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];e.apply(this,r),t.apply(this,r)}}),null)};function We(e){e.offsetHeight}var qe=function(e){return e&&"function"!==typeof e?function(t){e.current=t}:e};var Ge=function(e,n){return(0,t.useMemo)((function(){return function(e,t){var n=qe(e),r=qe(t);return function(e){n&&n(e),r&&r(e)}}(e,n)}),[e,n])};var Ke,Xe=["onEnter","onEntering","onEntered","onExit","onExiting","onExited","addEndListener","children","childRef"],Qe=t.forwardRef((function(e,n){var r=e.onEnter,a=e.onEntering,i=e.onEntered,s=e.onExit,o=e.onExiting,c=e.onExited,u=e.addEndListener,l=e.children,d=e.childRef,p=W(e,Xe),f=(0,t.useRef)(null),h=Ge(f,d),m=function(e){var t;h((t=e)&&"setState"in t?we.findDOMNode(t):null!=t?t:null)},v=function(e){return function(t){e&&f.current&&e(f.current,t)}},g=(0,t.useCallback)(v(r),[r]),b=(0,t.useCallback)(v(a),[a]),y=(0,t.useCallback)(v(i),[i]),_=(0,t.useCallback)(v(s),[s]),w=(0,t.useCallback)(v(o),[o]),k=(0,t.useCallback)(v(c),[c]),x=(0,t.useCallback)(v(u),[u]);return(0,ne.jsx)(Me,V(V({ref:n},p),{},{onEnter:g,onEntered:y,onEntering:b,onExit:_,onExited:k,onExiting:w,addEndListener:x,nodeRef:f,children:"function"===typeof l?function(e,t){return l(e,V(V({},t),{},{ref:m}))}:t.cloneElement(l,{ref:m})}))})),$e=Qe,Je=["onEnter","onEntering","onEntered","onExit","onExiting","className","children","dimension","getDimensionValue"],Ye={height:["marginTop","marginBottom"],width:["marginLeft","marginRight"]};function Ze(e,t){var n=t["offset".concat(e[0].toUpperCase()).concat(e.slice(1))],r=Ye[e];return n+parseInt(ye(t,r[0]),10)+parseInt(ye(t,r[1]),10)}var et=(U(Ke={},Re,"collapse"),U(Ke,Te,"collapsing"),U(Ke,Pe,"collapsing"),U(Ke,Ce,"collapse show"),Ke),tt={in:!1,timeout:300,mountOnEnter:!1,unmountOnExit:!1,appear:!1,getDimensionValue:Ze},nt=t.forwardRef((function(e,n){var r=e.onEnter,a=e.onEntering,i=e.onEntered,s=e.onExit,o=e.onExiting,c=e.className,u=e.children,l=e.dimension,d=void 0===l?"height":l,p=e.getDimensionValue,f=void 0===p?Ze:p,h=W(e,Je),m="function"===typeof d?d():d,v=(0,t.useMemo)((function(){return He((function(e){e.style[m]="0"}),r)}),[m,r]),g=(0,t.useMemo)((function(){return He((function(e){var t="scroll".concat(m[0].toUpperCase()).concat(m.slice(1));e.style[m]="".concat(e[t],"px")}),a)}),[m,a]),b=(0,t.useMemo)((function(){return He((function(e){e.style[m]=null}),i)}),[m,i]),y=(0,t.useMemo)((function(){return He((function(e){e.style[m]="".concat(f(m,e),"px"),We(e)}),s)}),[s,f,m]),_=(0,t.useMemo)((function(){return He((function(e){e.style[m]=null}),o)}),[m,o]);return(0,ne.jsx)($e,V(V({ref:n,addEndListener:Ve},h),{},{"aria-expanded":h.role?h.in:null,onEnter:v,onEntering:g,onEntered:b,onExit:y,onExiting:_,childRef:u.ref,children:function(e,n){return t.cloneElement(u,V(V({},n),{},{className:G()(c,u.props.className,et[e],"width"===m&&"collapse-horizontal")}))}}))}));nt.defaultProps=tt;var rt=nt,at=t.createContext(null);at.displayName="NavbarContext";var it=at,st=["children","bsPrefix"],ot=t.forwardRef((function(e,n){var r=e.children,a=e.bsPrefix,i=W(e,st);a=ie(a,"navbar-collapse");var s=(0,t.useContext)(it);return(0,ne.jsx)(rt,V(V({in:!(!s||!s.expanded)},i),{},{children:(0,ne.jsx)("div",{ref:n,className:a,children:r})}))}));ot.displayName="NavbarCollapse";var ct=ot;var ut=function(e){var n=(0,t.useRef)(e);return(0,t.useEffect)((function(){n.current=e}),[e]),n};function lt(e){var n=ut(e);return(0,t.useCallback)((function(){return n.current&&n.current.apply(n,arguments)}),[n])}var dt=["bsPrefix","className","children","label","as","onClick"],pt=t.forwardRef((function(e,n){var r=e.bsPrefix,a=e.className,i=e.children,s=e.label,o=e.as,c=void 0===o?"button":o,u=e.onClick,l=W(e,dt);r=ie(r,"navbar-toggler");var d=(0,t.useContext)(it)||{},p=d.onToggle,f=d.expanded,h=lt((function(e){u&&u(e),p&&p()}));return"button"===c&&(l.type="button"),(0,ne.jsx)(c,V(V({},l),{},{ref:n,onClick:h,"aria-label":s,className:G()(a,r,!f&&"collapsed"),children:i||(0,ne.jsx)("span",{className:"".concat(r,"-icon")})}))}));pt.displayName="NavbarToggle",pt.defaultProps={label:"Toggle navigation"};var ft=pt,ht="undefined"!==typeof n.g&&n.g.navigator&&"ReactNative"===n.g.navigator.product,mt="undefined"!==typeof document||ht?t.useLayoutEffect:t.useEffect,vt=new WeakMap,gt=function(e,t){if(e&&t){var n=vt.get(t)||new Map;vt.set(t,n);var r=n.get(e);return r||((r=t.matchMedia(e)).refCount=0,n.set(r.media,r)),r}};function bt(e,n){void 0===n&&(n="undefined"===typeof window?void 0:window);var r=gt(e,n),a=(0,t.useState)((function(){return!!r&&r.matches})),i=a[0],s=a[1];return mt((function(){var t=gt(e,n);if(!t)return s(!1);var r=vt.get(n),a=function(){s(t.matches)};return t.refCount++,t.addListener(a),a(),function(){t.removeListener(a),t.refCount--,t.refCount<=0&&(null==r||r.delete(t.media)),t=void 0}}),[e]),i}var yt=function(e){var n=Object.keys(e);function r(e,t){return e===t?t:e?e+" and "+t:t}function a(t){var r=function(e){return n[Math.min(n.indexOf(e)+1,n.length-1)]}(t),a=e[r];return"(max-width: "+(a="number"===typeof a?a-.2+"px":"calc("+a+" - 0.2px)")+")"}return function(n,i,s){var o,c;"object"===typeof n?(o=n,s=i,i=!0):((c={})[n]=i=i||!0,o=c);var u=(0,t.useMemo)((function(){return Object.entries(o).reduce((function(t,n){var i=n[0],s=n[1];return"up"!==s&&!0!==s||(t=r(t,function(t){var n=e[t];return"number"===typeof n&&(n+="px"),"(min-width: "+n+")"}(i))),"down"!==s&&!0!==s||(t=r(t,a(i))),t}),"")}),[JSON.stringify(o)]);return bt(u,s)}}({xs:0,sm:576,md:768,lg:992,xl:1200,xxl:1400});function _t(e){void 0===e&&(e=fe());try{var t=e.activeElement;return t&&t.nodeName?t:null}catch(au){return e.body}}function wt(e,t){return e.contains?e.contains(t):e.compareDocumentPosition?e===t||!!(16&e.compareDocumentPosition(t)):void 0}function kt(e){var n=function(e){var n=(0,t.useRef)(e);return n.current=e,n}(e);(0,t.useEffect)((function(){return function(){return n.current()}}),[])}function xt(e){return function(e){if(Array.isArray(e))return a(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||i(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function St(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Rt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Pt(e,t,n){return t&&Rt(e.prototype,t),n&&Rt(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ct(e){return"".concat("data-rr-ui-").concat(e)}var Tt=Ct("modal-open"),Et=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.ownerDocument,r=t.handleContainerOverflow,a=void 0===r||r,i=t.isRTL,s=void 0!==i&&i;St(this,e),this.handleContainerOverflow=a,this.isRTL=s,this.modals=[],this.ownerDocument=n}return Pt(e,[{key:"getScrollbarWidth",value:function(){return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document,t=e.defaultView;return Math.abs(t.innerWidth-e.documentElement.clientWidth)}(this.ownerDocument)}},{key:"getElement",value:function(){return(this.ownerDocument||document).body}},{key:"setModalAttributes",value:function(e){}},{key:"removeModalAttributes",value:function(e){}},{key:"setContainerStyle",value:function(e){var t={overflow:"hidden"},n=this.isRTL?"paddingLeft":"paddingRight",r=this.getElement();e.style=U({overflow:r.style.overflow},n,r.style[n]),e.scrollBarWidth&&(t[n]="".concat(parseInt(ye(r,n)||"0",10)+e.scrollBarWidth,"px")),r.setAttribute(Tt,""),ye(r,t)}},{key:"reset",value:function(){var e=this;xt(this.modals).forEach((function(t){return e.remove(t)}))}},{key:"removeContainerStyle",value:function(e){var t=this.getElement();t.removeAttribute(Tt),Object.assign(t.style,e.style)}},{key:"add",value:function(e){var t=this.modals.indexOf(e);return-1!==t?t:(t=this.modals.length,this.modals.push(e),this.setModalAttributes(e),0!==t||(this.state={scrollBarWidth:this.getScrollbarWidth(),style:{}},this.handleContainerOverflow&&this.setContainerStyle(this.state)),t)}},{key:"remove",value:function(e){var t=this.modals.indexOf(e);-1!==t&&(this.modals.splice(t,1),!this.modals.length&&this.handleContainerOverflow&&this.removeContainerStyle(this.state),this.removeModalAttributes(e))}},{key:"isTopModal",value:function(e){return!!this.modals.length&&this.modals[this.modals.length-1]===e}}]),e}(),Ot=Et,Mt=(0,t.createContext)(Ie?window:void 0);Mt.Provider;function It(){return(0,t.useContext)(Mt)}var Dt=function(e,t){var n;return Ie?null==e?(t||fe()).body:("function"===typeof e&&(e=e()),e&&"current"in e&&(e=e.current),null!=(n=e)&&n.nodeType&&e||null):null};var jt,Lt=["show","role","className","style","children","backdrop","keyboard","onBackdropClick","onEscapeKeyDown","transition","backdropTransition","autoFocus","enforceFocus","restoreFocus","restoreFocusOptions","renderDialog","renderBackdrop","manager","container","onShow","onHide","onExit","onExited","onExiting","onEnter","onEntering","onEntered"];function At(e){var n=It(),r=e||function(e){return jt||(jt=new Ot({ownerDocument:null==e?void 0:e.document})),jt}(n),a=(0,t.useRef)({dialog:null,backdrop:null});return Object.assign(a.current,{add:function(){return r.add(a.current)},remove:function(){return r.remove(a.current)},isTopModal:function(){return r.isTopModal(a.current)},setDialogRef:(0,t.useCallback)((function(e){a.current.dialog=e}),[]),setBackdropRef:(0,t.useCallback)((function(e){a.current.backdrop=e}),[])})}var Ft=(0,t.forwardRef)((function(e,n){var r=e.show,a=void 0!==r&&r,i=e.role,o=void 0===i?"dialog":i,c=e.className,u=e.style,l=e.children,d=e.backdrop,p=void 0===d||d,f=e.keyboard,h=void 0===f||f,m=e.onBackdropClick,v=e.onEscapeKeyDown,g=e.transition,b=e.backdropTransition,y=e.autoFocus,_=void 0===y||y,w=e.enforceFocus,k=void 0===w||w,x=e.restoreFocus,S=void 0===x||x,R=e.restoreFocusOptions,P=e.renderDialog,C=e.renderBackdrop,T=void 0===C?function(e){return(0,ne.jsx)("div",Object.assign({},e))}:C,E=e.manager,O=e.container,M=e.onShow,I=e.onHide,D=void 0===I?function(){}:I,j=e.onExit,L=e.onExited,A=e.onExiting,F=e.onEnter,N=e.onEntering,B=e.onEntered,U=function(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,Lt),z=function(e,n){var r=It(),a=s((0,t.useState)((function(){return Dt(e,null==r?void 0:r.document)})),2),i=a[0],o=a[1];if(!i){var c=Dt(e);c&&o(c)}return(0,t.useEffect)((function(){n&&i&&n(i)}),[n,i]),(0,t.useEffect)((function(){var t=Dt(e);t!==i&&o(t)}),[e,i]),i}(O),V=At(E),H=function(){var e=(0,t.useRef)(!0),n=(0,t.useRef)((function(){return e.current}));return(0,t.useEffect)((function(){return e.current=!0,function(){e.current=!1}}),[]),n.current}(),W=function(e){var n=(0,t.useRef)(null);return(0,t.useEffect)((function(){n.current=e})),n.current}(a),q=s((0,t.useState)(!a),2),G=q[0],K=q[1],X=(0,t.useRef)(null);(0,t.useImperativeHandle)(n,(function(){return V}),[V]),Ie&&!W&&a&&(X.current=_t()),g||a||G?a&&G&&K(!1):K(!0);var Q=lt((function(){if(V.add(),te.current=Ne(document,"keydown",Z),ee.current=Ne(document,"focus",(function(){return setTimeout(J)}),!0),M&&M(),_){var e=_t(document);V.dialog&&e&&!wt(V.dialog,e)&&(X.current=e,V.dialog.focus())}})),$=lt((function(){var e;(V.remove(),null==te.current||te.current(),null==ee.current||ee.current(),S)&&(null==(e=X.current)||null==e.focus||e.focus(R),X.current=null)}));(0,t.useEffect)((function(){a&&z&&Q()}),[a,z,Q]),(0,t.useEffect)((function(){G&&$()}),[G,$]),kt((function(){$()}));var J=lt((function(){if(k&&H()&&V.isTopModal()){var e=_t();V.dialog&&e&&!wt(V.dialog,e)&&V.dialog.focus()}})),Y=lt((function(e){e.target===e.currentTarget&&(null==m||m(e),!0===p&&D())})),Z=lt((function(e){h&&27===e.keyCode&&V.isTopModal()&&(null==v||v(e),e.defaultPrevented||D())})),ee=(0,t.useRef)(),te=(0,t.useRef)(),re=g;if(!z||!(a||re&&!G))return null;var ae=Object.assign({role:o,ref:V.setDialogRef,"aria-modal":"dialog"===o||void 0},U,{style:u,className:c,tabIndex:-1}),ie=P?P(ae):(0,ne.jsx)("div",Object.assign({},ae,{children:t.cloneElement(l,{role:"document"})}));re&&(ie=(0,ne.jsx)(re,{appear:!0,unmountOnExit:!0,in:!!a,onExit:j,onExiting:A,onExited:function(){K(!0),null==L||L.apply(void 0,arguments)},onEnter:F,onEntering:N,onEntered:B,children:ie}));var se=null;if(p){var oe=b;se=T({ref:V.setBackdropRef,onClick:Y}),oe&&(se=(0,ne.jsx)(oe,{appear:!0,in:!!a,children:se}))}return(0,ne.jsx)(ne.Fragment,{children:we.createPortal((0,ne.jsxs)(ne.Fragment,{children:[se,ie]}),z)})}));Ft.displayName="Modal";var Nt,Bt=Object.assign(Ft,{Manager:Ot}),Ut=["className","children","transitionClasses"],zt=(U(Nt={},Pe,"show"),U(Nt,Ce,"show"),Nt),Vt=t.forwardRef((function(e,n){var r=e.className,a=e.children,i=e.transitionClasses,s=void 0===i?{}:i,o=W(e,Ut),c=(0,t.useCallback)((function(e,t){We(e),null==o.onEnter||o.onEnter(e,t)}),[o]);return(0,ne.jsx)($e,V(V({ref:n,addEndListener:Ve},o),{},{onEnter:c,childRef:a.ref,children:function(e,n){return t.cloneElement(a,V(V({},n),{},{className:G()("fade",r,a.props.className,zt[e],s[e])}))}}))}));Vt.defaultProps={in:!1,timeout:300,mountOnEnter:!1,unmountOnExit:!1,appear:!1},Vt.displayName="Fade";var Ht,Wt=Vt,qt=ue("offcanvas-body"),Gt=["bsPrefix","className","children"],Kt=(U(Ht={},Pe,"show"),U(Ht,Ce,"show"),Ht),Xt=t.forwardRef((function(e,n){var r=e.bsPrefix,a=e.className,i=e.children,s=W(e,Gt);return r=ie(r,"offcanvas"),(0,ne.jsx)($e,V(V({ref:n,addEndListener:Ve},s),{},{childRef:i.ref,children:function(e,n){return t.cloneElement(i,V(V({},n),{},{className:G()(a,i.props.className,(e===Pe||e===Te)&&"".concat(r,"-toggling"),Kt[e])}))}}))}));Xt.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1},Xt.displayName="OffcanvasToggling";var Qt=Xt,$t=t.createContext({onHide:function(){}}),Jt=n(7),Yt=n.n(Jt),Zt=["className","variant"],en={"aria-label":Yt().string,onClick:Yt().func,variant:Yt().oneOf(["white"])},tn=t.forwardRef((function(e,t){var n=e.className,r=e.variant,a=W(e,Zt);return(0,ne.jsx)("button",V({ref:t,type:"button",className:G()("btn-close",r&&"btn-close-".concat(r),n)},a))}));tn.displayName="CloseButton",tn.propTypes=en,tn.defaultProps={"aria-label":"Close"};var nn=tn,rn=["closeLabel","closeVariant","closeButton","onHide","children"],an=t.forwardRef((function(e,n){var r=e.closeLabel,a=e.closeVariant,i=e.closeButton,s=e.onHide,o=e.children,c=W(e,rn),u=(0,t.useContext)($t),l=lt((function(){null==u||u.onHide(),null==s||s()}));return(0,ne.jsxs)("div",V(V({ref:n},c),{},{children:[o,i&&(0,ne.jsx)(nn,{"aria-label":r,variant:a,onClick:l})]}))}));an.defaultProps={closeLabel:"Close",closeButton:!1};var sn=an,on=["bsPrefix","className"],cn=t.forwardRef((function(e,t){var n=e.bsPrefix,r=e.className,a=W(e,on);return n=ie(n,"offcanvas-header"),(0,ne.jsx)(sn,V(V({ref:t},a),{},{className:G()(r,n)}))}));cn.displayName="OffcanvasHeader",cn.defaultProps={closeLabel:"Close",closeButton:!1};var un,ln=cn,dn=ue("offcanvas-title",{Component:(un="h5",t.forwardRef((function(e,t){return(0,ne.jsx)("div",V(V({},e),{},{ref:t,className:G()(e.className,un)}))})))});function pn(e){return pn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},pn(e)}function fn(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=pn(e)););return e}function hn(){return hn="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=fn(e,t);if(r){var a=Object.getOwnPropertyDescriptor(r,t);return a.get?a.get.call(arguments.length<3?e:n):a.value}},hn.apply(this,arguments)}function mn(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_e(e,t)}function vn(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(au){return!1}}function gn(e){return gn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},gn(e)}function bn(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function yn(e,t){if(t&&("object"===gn(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return bn(e)}function _n(e){var t=vn();return function(){var n,r=pn(e);if(t){var a=pn(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return yn(this,n)}}var wn=Function.prototype.bind.call(Function.prototype.call,[].slice);function kn(e,t){return wn(e.querySelectorAll(t))}function xn(e,t){return e.replace(new RegExp("(^|\\s)"+t+"(?:\\s|$)","g"),"$1").replace(/\s+/g," ").replace(/^\s*|\s*$/g,"")}var Sn,Rn=".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",Pn=".sticky-top",Cn=".navbar-toggler",Tn=function(e){mn(n,e);var t=_n(n);function n(){return St(this,n),t.apply(this,arguments)}return Pt(n,[{key:"adjustAndStore",value:function(e,t,n){var r=t.style[e];t.dataset[e]=r,ye(t,U({},e,"".concat(parseFloat(ye(t,e))+n,"px")))}},{key:"restore",value:function(e,t){var n=t.dataset[e];void 0!==n&&(delete t.dataset[e],ye(t,U({},e,n)))}},{key:"setContainerStyle",value:function(e){var t=this;hn(pn(n.prototype),"setContainerStyle",this).call(this,e);var r=this.getElement();if(function(e,t){e.classList?e.classList.add(t):function(e,t){return e.classList?!!t&&e.classList.contains(t):-1!==(" "+(e.className.baseVal||e.className)+" ").indexOf(" "+t+" ")}(e,t)||("string"===typeof e.className?e.className=e.className+" "+t:e.setAttribute("class",(e.className&&e.className.baseVal||"")+" "+t))}(r,"modal-open"),e.scrollBarWidth){var a=this.isRTL?"paddingLeft":"paddingRight",i=this.isRTL?"marginLeft":"marginRight";kn(r,Rn).forEach((function(n){return t.adjustAndStore(a,n,e.scrollBarWidth)})),kn(r,Pn).forEach((function(n){return t.adjustAndStore(i,n,-e.scrollBarWidth)})),kn(r,Cn).forEach((function(n){return t.adjustAndStore(i,n,e.scrollBarWidth)}))}}},{key:"removeContainerStyle",value:function(e){var t=this;hn(pn(n.prototype),"removeContainerStyle",this).call(this,e);var r=this.getElement();!function(e,t){e.classList?e.classList.remove(t):"string"===typeof e.className?e.className=xn(e.className,t):e.setAttribute("class",xn(e.className&&e.className.baseVal||"",t))}(r,"modal-open");var a=this.isRTL?"paddingLeft":"paddingRight",i=this.isRTL?"marginLeft":"marginRight";kn(r,Rn).forEach((function(e){return t.restore(a,e)})),kn(r,Pn).forEach((function(e){return t.restore(i,e)})),kn(r,Cn).forEach((function(e){return t.restore(i,e)}))}}]),n}(Ot);var En=Tn,On=["bsPrefix","className","children","aria-labelledby","placement","show","backdrop","keyboard","scroll","onEscapeKeyDown","onShow","onHide","container","autoFocus","enforceFocus","restoreFocus","restoreFocusOptions","onEntered","onExit","onExiting","onEnter","onEntering","onExited","backdropClassName","manager"];function Mn(e){return(0,ne.jsx)(Qt,V({},e))}function In(e){return(0,ne.jsx)(Wt,V({},e))}var Dn=t.forwardRef((function(e,n){var r=e.bsPrefix,a=e.className,i=e.children,s=e["aria-labelledby"],o=e.placement,c=e.show,u=e.backdrop,l=e.keyboard,d=e.scroll,p=e.onEscapeKeyDown,f=e.onShow,h=e.onHide,m=e.container,v=e.autoFocus,g=e.enforceFocus,b=e.restoreFocus,y=e.restoreFocusOptions,_=e.onEntered,w=e.onExit,k=e.onExiting,x=e.onEnter,S=e.onEntering,R=e.onExited,P=e.backdropClassName,C=e.manager,T=W(e,On),E=(0,t.useRef)();r=ie(r,"offcanvas");var O=((0,t.useContext)(it)||{}).onToggle,M=lt((function(){null==O||O(),null==h||h()})),I=(0,t.useMemo)((function(){return{onHide:M}}),[M]);var D=(0,t.useCallback)((function(e){return(0,ne.jsx)("div",V(V({},e),{},{className:G()("".concat(r,"-backdrop"),P)}))}),[P,r]);return(0,ne.jsx)($t.Provider,{value:I,children:(0,ne.jsx)(Bt,{show:c,ref:n,backdrop:u,container:m,keyboard:l,autoFocus:v,enforceFocus:g&&!d,restoreFocus:b,restoreFocusOptions:y,onEscapeKeyDown:p,onShow:f,onHide:M,onEnter:function(e){e&&(e.style.visibility="visible");for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];null==x||x.apply(void 0,[e].concat(n))},onEntering:S,onEntered:_,onExit:w,onExiting:k,onExited:function(e){e&&(e.style.visibility="");for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];null==R||R.apply(void 0,n)},manager:C||(d?(E.current||(E.current=new En({handleContainerOverflow:!1})),E.current):function(e){return Sn||(Sn=new Tn(e)),Sn}()),transition:Mn,backdropTransition:In,renderBackdrop:D,renderDialog:function(e){return(0,ne.jsx)("div",V(V(V({role:"dialog"},e),T),{},{className:G()(a,r,"".concat(r,"-").concat(o)),"aria-labelledby":s,children:i}))}})})}));Dn.displayName="Offcanvas",Dn.defaultProps={show:!1,backdrop:!0,keyboard:!0,scroll:!1,autoFocus:!0,enforceFocus:!0,restoreFocus:!0,placement:"start"};var jn=Object.assign(Dn,{Body:qt,Header:ln,Title:dn}),Ln=["className","bsPrefix","backdrop","backdropClassName","keyboard","scroll","placement","autoFocus","enforceFocus","restoreFocus","restoreFocusOptions","onShow","onHide","onEscapeKeyDown","onEnter","onEntering","onEntered","onExit","onExiting","onExited"],An=t.forwardRef((function(e,n){var r=e.className,a=e.bsPrefix,i=e.backdrop,s=e.backdropClassName,o=e.keyboard,c=e.scroll,u=e.placement,l=e.autoFocus,d=e.enforceFocus,p=e.restoreFocus,f=e.restoreFocusOptions,h=e.onShow,m=e.onHide,v=e.onEscapeKeyDown,g=e.onEnter,b=e.onEntering,y=e.onEntered,_=e.onExit,w=e.onExiting,k=e.onExited,x=W(e,Ln),S=(0,t.useContext)(it);a=ie(a,"offcanvas");var R="string"===typeof(null==S?void 0:S.expand),P=yt(R?S.expand:"xs","up");return R&&P?(0,ne.jsx)("div",V(V({ref:n},x),{},{className:G()(r,a,"".concat(a,"-").concat(u))})):(0,ne.jsx)(jn,V({ref:n,show:!(null==S||!S.expanded),bsPrefix:a,backdrop:i,backdropClassName:s,keyboard:o,scroll:c,placement:u,autoFocus:l,enforceFocus:d,restoreFocus:p,restoreFocusOptions:f,onShow:h,onHide:m,onEscapeKeyDown:v,onEnter:g,onEntering:b,onEntered:y,onExit:_,onExiting:w,onExited:k},x))}));An.displayName="NavbarOffcanvas";var Fn=An,Nn=["bsPrefix","expand","variant","bg","fixed","sticky","className","as","expanded","onToggle","onSelect","collapseOnSelect"],Bn=ue("navbar-text",{Component:"span"}),Un=t.forwardRef((function(e,n){var r=J(e,{expanded:"onToggle"}),a=r.bsPrefix,i=r.expand,s=r.variant,o=r.bg,c=r.fixed,u=r.sticky,l=r.className,d=r.as,p=void 0===d?"nav":d,f=r.expanded,h=r.onToggle,m=r.onSelect,v=r.collapseOnSelect,g=W(r,Nn),b=ie(a,"navbar"),y=(0,t.useCallback)((function(){null==m||m.apply(void 0,arguments),v&&f&&(null==h||h(!1))}),[m,v,f,h]);void 0===g.role&&"nav"!==p&&(g.role="navigation");var _="".concat(b,"-expand");"string"===typeof i&&(_="".concat(_,"-").concat(i));var w=(0,t.useMemo)((function(){return{onToggle:function(){return null==h?void 0:h(!f)},bsPrefix:b,expanded:!!f,expand:i}}),[b,f,i,h]);return(0,ne.jsx)(it.Provider,{value:w,children:(0,ne.jsx)(X.Provider,{value:y,children:(0,ne.jsx)(p,V(V({ref:n},g),{},{className:G()(l,b,i&&_,s&&"".concat(b,"-").concat(s),o&&"bg-".concat(o),u&&"sticky-".concat(u),c&&"fixed-".concat(c))}))})})}));Un.defaultProps={expand:!0,variant:"light",collapseOnSelect:!1},Un.displayName="Navbar";var zn=Object.assign(Un,{Brand:pe,Collapse:ct,Offcanvas:Fn,Text:Bn,Toggle:ft}),Vn=["bsPrefix","fluid","as","className"],Hn=t.forwardRef((function(e,t){var n=e.bsPrefix,r=e.fluid,a=e.as,i=void 0===a?"div":a,s=e.className,o=W(e,Vn),c=ie(n,"container"),u="string"===typeof r?"-".concat(r):"-fluid";return(0,ne.jsx)(i,V(V({ref:t},o),{},{className:G()(s,r?"".concat(c).concat(u):c)}))}));Hn.displayName="Container",Hn.defaultProps={fluid:!1};var Wn=Hn;n(573);var qn=t.createContext(null);qn.displayName="NavContext";var Gn=qn,Kn=t.createContext(null),Xn=["as","disabled"];function Qn(e){var t=e.tagName,n=e.disabled,r=e.href,a=e.target,i=e.rel,s=e.onClick,o=e.tabIndex,c=void 0===o?0:o,u=e.type;t||(t=null!=r||null!=a||null!=i?"a":"button");var l={tagName:t};if("button"===t)return[{type:u||"button",disabled:n},l];var d=function(e){(n||"a"===t&&function(e){return!e||"#"===e.trim()}(r))&&e.preventDefault(),n?e.stopPropagation():null==s||s(e)};return"a"===t&&(r||(r="#"),n&&(r=void 0)),[{role:"button",disabled:void 0,tabIndex:n?void 0:c,href:r,target:"a"===t?a:void 0,"aria-disabled":n||void 0,rel:"a"===t?i:void 0,onClick:d,onKeyDown:function(e){" "===e.key&&(e.preventDefault(),d(e))}},l]}var $n=t.forwardRef((function(e,t){var n=e.as,r=e.disabled,a=function(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,Xn),i=s(Qn(Object.assign({tagName:n,disabled:r},a)),2),o=i[0],c=i[1].tagName;return(0,ne.jsx)(c,Object.assign({},a,o,{ref:t}))}));$n.displayName="Button";var Jn=$n,Yn=["as","active","eventKey"];function Zn(e){var n=e.key,r=e.onClick,a=e.active,i=e.id,s=e.role,o=e.disabled,c=(0,t.useContext)(X),u=(0,t.useContext)(Gn),l=(0,t.useContext)(Kn),d=a,p={role:s};if(u){s||"tablist"!==u.role||(p.role="tab");var f=u.getControllerId(null!=n?n:null),h=u.getControlledId(null!=n?n:null);p[Ct("event-key")]=n,p.id=f||i,!(d=null==a&&null!=n?u.activeKey===n:a)&&(null!=l&&l.unmountOnExit||null!=l&&l.mountOnEnter)||(p["aria-controls"]=h)}return"tab"===p.role&&(p["aria-selected"]=d,d||(p.tabIndex=-1),o&&(p.tabIndex=-1,p["aria-disabled"]=!0)),p.onClick=lt((function(e){o||(null==r||r(e),null!=n&&c&&!e.isPropagationStopped()&&c(n,e))})),[p,{isActive:d}]}var er=t.forwardRef((function(e,t){var n=e.as,r=void 0===n?Jn:n,a=e.active,i=e.eventKey,o=function(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,Yn),c=s(Zn(Object.assign({key:K(i,o.href),active:a},o)),2),u=c[0],l=c[1];return u[Ct("active")]=l.isActive,(0,ne.jsx)(r,Object.assign({},o,u,{ref:t}))}));er.displayName="NavItem";var tr=er,nr=["as","onSelect","activeKey","role","onKeyDown"];var rr=function(){},ar=Ct("event-key"),ir=t.forwardRef((function(e,n){var r,a,i=e.as,s=void 0===i?"div":i,o=e.onSelect,c=e.activeKey,u=e.role,l=e.onKeyDown,d=function(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,nr),p=(0,t.useReducer)((function(e){return!e}),!1)[1],f=(0,t.useRef)(!1),h=(0,t.useContext)(X),m=(0,t.useContext)(Kn);m&&(u=u||"tablist",c=m.activeKey,r=m.getControlledId,a=m.getControllerId);var v=(0,t.useRef)(null),g=function(e){var t=v.current;if(!t)return null;var n=kn(t,"[".concat(ar,"]:not([aria-disabled=true])")),r=t.querySelector("[aria-selected=true]");if(!r||r!==document.activeElement)return null;var a=n.indexOf(r);if(-1===a)return null;var i=a+e;return i>=n.length&&(i=0),i<0&&(i=n.length-1),n[i]},b=function(e,t){null!=e&&(null==o||o(e,t),null==h||h(e,t))};(0,t.useEffect)((function(){if(v.current&&f.current){var e=v.current.querySelector("[".concat(ar,"][aria-selected=true]"));null==e||e.focus()}f.current=!1}));var y=Ge(n,v);return(0,ne.jsx)(X.Provider,{value:b,children:(0,ne.jsx)(Gn.Provider,{value:{role:u,activeKey:K(c),getControlledId:r||rr,getControllerId:a||rr},children:(0,ne.jsx)(s,Object.assign({},d,{onKeyDown:function(e){if(null==l||l(e),m){var t,n;switch(e.key){case"ArrowLeft":case"ArrowUp":t=g(-1);break;case"ArrowRight":case"ArrowDown":t=g(1);break;default:return}if(t)e.preventDefault(),b(t.dataset[(n="EventKey","".concat("rrUi").concat(n))]||null,e),f.current=!0,p()}},ref:y,role:u}))})})}));ir.displayName="Nav";var sr=Object.assign(ir,{Item:tr}),or=t.createContext(null);or.displayName="CardHeaderContext";var cr=or,ur=ue("nav-item");new WeakMap;var lr=["onKeyDown"];var dr=t.forwardRef((function(e,t){var n,r=e.onKeyDown,a=function(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,lr),i=s(Qn(Object.assign({tagName:"a"},a)),1)[0],o=lt((function(e){i.onKeyDown(e),null==r||r(e)}));return((n=a.href)&&"#"!==n.trim()||a.role)&&"button"!==a.role?(0,ne.jsx)("a",Object.assign({ref:t},a,{onKeyDown:r})):(0,ne.jsx)("a",Object.assign({ref:t},a,i,{onKeyDown:o}))}));dr.displayName="Anchor";var pr=dr,fr=["bsPrefix","className","as","active","eventKey"],hr=t.forwardRef((function(e,t){var n=e.bsPrefix,r=e.className,a=e.as,i=void 0===a?pr:a,o=e.active,c=e.eventKey,u=W(e,fr);n=ie(n,"nav-link");var l=s(Zn(V({key:K(c,u.href),active:o},u)),2),d=l[0],p=l[1];return(0,ne.jsx)(i,V(V(V({},u),d),{},{ref:t,className:G()(r,n,u.disabled&&"disabled",p.isActive&&"active")}))}));hr.displayName="NavLink",hr.defaultProps={disabled:!1};var mr=hr,vr=["as","bsPrefix","variant","fill","justify","navbar","navbarScroll","className","activeKey"],gr=t.forwardRef((function(e,n){var r,a,i,s=J(e,{activeKey:"onSelect"}),o=s.as,c=void 0===o?"div":o,u=s.bsPrefix,l=s.variant,d=s.fill,p=s.justify,f=s.navbar,h=s.navbarScroll,m=s.className,v=s.activeKey,g=W(s,vr),b=ie(u,"nav"),y=!1,_=(0,t.useContext)(it),w=(0,t.useContext)(cr);return _?(a=_.bsPrefix,y=null==f||f):w&&(i=w.cardHeaderBsPrefix),(0,ne.jsx)(sr,V({as:c,ref:n,activeKey:v,className:G()(m,(r={},U(r,b,!y),U(r,"".concat(a,"-nav"),y),U(r,"".concat(a,"-nav-scroll"),y&&h),U(r,"".concat(i,"-").concat(l),!!i),U(r,"".concat(b,"-").concat(l),!!l),U(r,"".concat(b,"-fill"),d),U(r,"".concat(b,"-justified"),p),r))},g))}));gr.displayName="Nav",gr.defaultProps={justify:!1,fill:!1};var br=Object.assign(gr,{Item:ur,Link:mr}),yr=function(e){return(0,ne.jsx)(zn,{bg:"dark",variant:"dark",expand:"md",children:(0,ne.jsxs)(Wn,{children:[(0,ne.jsx)(zn.Brand,{href:"/#/home",children:" WebXVR "}),(0,ne.jsx)(zn.Toggle,{"aria-controls":"basic-navbar-nav"}),(0,ne.jsx)(zn.Collapse,{id:"basic-navbar-nav",children:(0,ne.jsxs)(br,{className:"me-auto",children:[(0,ne.jsx)(br.Link,{href:"/#/autovr",children:" AutoVR "}),(0,ne.jsx)(br.Link,{href:"/#/skyway",children:" Skyway "}),(0,ne.jsx)(br.Link,{href:"/#/swrecv",children:" Recv "}),(0,ne.jsx)(br.Link,{href:"/#/autosend",children:" AutoSend "}),(0,ne.jsx)(br.Link,{href:"/#/autorecv",children:" AutoRecv "})]})})]})})},_r=function(e){return(0,ne.jsxs)(ne.Fragment,{children:[(0,ne.jsx)(yr,{}),"\u3000\u3000\u3000\u3088\u3046\u3053\u305d Web XVR \u306e\u4e16\u754c\u3078\uff01 \u3000\u3000\u3000\u3000\u3000",(0,ne.jsx)("center",{children:"  VR \u3067\u898b\u308b\u306b\u306f\u300cAutoVR\u300d\u3092\u9078\u629e \u2191"})]})};function wr(){wr=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},a=r.iterator||"@@iterator",i=r.asyncIterator||"@@asyncIterator",s=r.toStringTag||"@@toStringTag";function o(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{o({},"")}catch(P){o=function(e,t,n){return e[t]=n}}function c(e,t,n,r){var a=t&&t.prototype instanceof d?t:d,i=Object.create(a.prototype),s=new x(r||[]);return i._invoke=function(e,t,n){var r="suspendedStart";return function(a,i){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===a)throw i;return R()}for(n.method=a,n.arg=i;;){var s=n.delegate;if(s){var o=_(s,n);if(o){if(o===l)continue;return o}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var c=u(e,t,n);if("normal"===c.type){if(r=n.done?"completed":"suspendedYield",c.arg===l)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(r="completed",n.method="throw",n.arg=c.arg)}}}(e,n,s),i}function u(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(P){return{type:"throw",arg:P}}}e.wrap=c;var l={};function d(){}function p(){}function f(){}var h={};o(h,a,(function(){return this}));var m=Object.getPrototypeOf,v=m&&m(m(S([])));v&&v!==t&&n.call(v,a)&&(h=v);var g=f.prototype=d.prototype=Object.create(h);function b(e){["next","throw","return"].forEach((function(t){o(e,t,(function(e){return this._invoke(t,e)}))}))}function y(e,t){function r(a,i,s,o){var c=u(e[a],e,i);if("throw"!==c.type){var l=c.arg,d=l.value;return d&&"object"==gn(d)&&n.call(d,"__await")?t.resolve(d.__await).then((function(e){r("next",e,s,o)}),(function(e){r("throw",e,s,o)})):t.resolve(d).then((function(e){l.value=e,s(l)}),(function(e){return r("throw",e,s,o)}))}o(c.arg)}var a;this._invoke=function(e,n){function i(){return new t((function(t,a){r(e,n,t,a)}))}return a=a?a.then(i,i):i()}}function _(e,t){var n=e.iterator[t.method];if(void 0===n){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,_(e,t),"throw"===t.method))return l;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return l}var r=u(n,e.iterator,t.arg);if("throw"===r.type)return t.method="throw",t.arg=r.arg,t.delegate=null,l;var a=r.arg;return a?a.done?(t[e.resultName]=a.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,l):a:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,l)}function w(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function k(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function x(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(w,this),this.reset(!0)}function S(e){if(e){var t=e[a];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,i=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return i.next=i}}return{next:R}}function R(){return{value:void 0,done:!0}}return p.prototype=f,o(g,"constructor",f),o(f,"constructor",p),p.displayName=o(f,s,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===p||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,o(e,s,"GeneratorFunction")),e.prototype=Object.create(g),e},e.awrap=function(e){return{__await:e}},b(y.prototype),o(y.prototype,i,(function(){return this})),e.AsyncIterator=y,e.async=function(t,n,r,a,i){void 0===i&&(i=Promise);var s=new y(c(t,n,r,a),i);return e.isGeneratorFunction(n)?s:s.next().then((function(e){return e.done?e.value:s.next()}))},b(g),o(g,s,"Generator"),o(g,a,(function(){return this})),o(g,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var r=t.pop();if(r in e)return n.value=r,n.done=!1,n}return n.done=!0,n}},e.values=S,x.prototype={constructor:x,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(k),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return s.type="throw",s.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],s=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var o=n.call(i,"catchLoc"),c=n.call(i,"finallyLoc");if(o&&c){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(o){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var a=this.tryEntries[r];if(a.tryLoc<=this.prev&&n.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var i=a;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var s=i?i.completion:{};return s.type=e,s.arg=t,i?(this.method="next",this.next=i.finallyLoc,l):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),l},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),k(n),l}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var a=r.arg;k(n)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:S(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),l}},e}function kr(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=i(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,o=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){c=!0,s=e},f:function(){try{o||null==n.return||n.return()}finally{if(c)throw s}}}}function xr(e,t,n,r,a,i,s){try{var o=e[i](s),c=o.value}catch(u){return void n(u)}o.done?t(c):Promise.resolve(c).then(r,a)}function Sr(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var i=e.apply(t,n);function s(e){xr(i,r,a,s,o,"next",e)}function o(e){xr(i,r,a,s,o,"throw",e)}s(void 0)}))}}function Rr(e){throw new TypeError('"'+e+'" is read-only')}var Pr=.8,Cr={},Tr=function(e){var t=e.height/3;e.injectCSS&&(Cr[e.cssprefix]||(!function(e){var t=document.createElement("style");t.innerHTML=e;var n=document.getElementsByTagName("head")[0];n.insertBefore(t,n.firstChild)}(Mr(e,t)),Cr[e.cssprefix]=!0));var n=document.createElement("div");return n.innerHTML=function(e,t){var n=t*Pr,r=Er(e,n)+Or(e,n);return'<button class="'.concat(e,'-button">\n          <div class="').concat(e,'-title"></div>\n          <div class="').concat(e,'-logo" >').concat(r,"</div>\n        </button>")}(e.cssprefix,t),n.firstChild},Er=function(e,t){return'<svg class="'.concat(e,'-svg" version="1.1" x="0px" y="0px"\n        width="').concat(28/18*t,'px" height="').concat(t,'px" viewBox="0 0 28 18" xml:space="preserve">\n        <path d="M26.8,1.1C26.1,0.4,25.1,0,24.2,0H3.4c-1,0-1.7,0.4-2.4,1.1C0.3,1.7,0,2.7,0,3.6v10.7\n        c0,1,0.3,1.9,0.9,2.6C1.6,17.6,2.4,18,3.4,18h5c0.7,0,1.3-0.2,1.8-0.5c0.6-0.3,1-0.8,1.3-1.4l\n        1.5-2.6C13.2,13.1,13,13,14,13v0h-0.2 h0c0.3,0,0.7,0.1,0.8,0.5l1.4,2.6c0.3,0.6,0.8,1.1,1.3,\n        1.4c0.6,0.3,1.2,0.5,1.8,0.5h5c1,0,2-0.4,2.7-1.1c0.7-0.7,1.2-1.6,1.2-2.6 V3.6C28,2.7,27.5,\n        1.7,26.8,1.1z M7.4,11.8c-1.6,0-2.8-1.3-2.8-2.8c0-1.6,1.3-2.8,2.8-2.8c1.6,0,2.8,1.3,2.8,2.8\n        C10.2,10.5,8.9,11.8,7.4,11.8z M20.1,11.8c-1.6,0-2.8-1.3-2.8-2.8c0-1.6,1.3-2.8,2.8-2.8C21.7\n        ,6.2,23,7.4,23,9 C23,10.5,21.7,11.8,20.1,11.8z"/>\n    </svg>')},Or=function(e,t){var n=28/18;return'<svg class="'.concat(e,'-svg-error" x="0px" y="0px"\n        width="').concat(n*t,'px" height="').concat(n*t,'px" viewBox="0 0 28 28" xml:space="preserve">\n        <path d="M17.6,13.4c0-0.2-0.1-0.4-0.1-0.6c0-1.6,1.3-2.8,2.8-2.8s2.8,1.3,2.8,2.8s-1.3,2.8-2.8,2.8\n        c-0.2,0-0.4,0-0.6-0.1l5.9,5.9c0.5-0.2,0.9-0.4,1.3-0.8\n        c0.7-0.7,1.1-1.6,1.1-2.5V7.4c0-1-0.4-1.9-1.1-2.5c-0.7-0.7-1.6-1-2.5-1\n        H8.1 L17.6,13.4z"/>\n        <path d="M10.1,14.2c-0.5,0.9-1.4,1.4-2.4,1.4c-1.6,0-2.8-1.3-2.8-2.8c0-1.1,0.6-2,1.4-2.5\n        L0.9,5.1 C0.3,5.7,0,6.6,0,7.5v10.7c0,1,0.4,1.8,1.1,2.5c0.7,0.7,1.6,1,2.5,1\n        h5c0.7,0,1.3-0.1,1.8-0.5c0.6-0.3,1-0.8,1.3-1.4l1.3-2.6 L10.1,14.2z"/>\n        <path d="M25.5,27.5l-25-25C-0.1,2-0.1,1,0.5,0.4l0,0C1-0.1,2-0.1,2.6,0.4l25,25c0.6,0.6,0.6,1.5\n        ,0,2.1l0,0 C27,28.1,26,28.1,25.5,27.5z"/>\n    </svg>')},Mr=function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:18,r=e.height,a=2,i=e.background?e.background:e.color,s=e.cssprefix;return t="round"==e.corners?e.height/2:"square"==e.corners?2:e.corners,"\n    @font-face {\n        font-family: 'Karla';\n        font-style: normal;\n        font-weight: 400;\n        src: local('Karla'), local('Karla-Regular'),\n             url(https://fonts.gstatic.com/s/karla/v5/31P4mP32i98D9CEnGyeX9Q.woff2) format('woff2');\n        unicode-range: U+0100-024F, U+1E00-1EFF, U+20A0-20AB, U+20AD-20CF, U+2C60-2C7F, U+A720-A7FF;\n    }\n    @font-face {\n        font-family: 'Karla';\n        font-style: normal;\n        font-weight: 400;\n        src: local('Karla'), local('Karla-Regular'),\n             url(https://fonts.gstatic.com/s/karla/v5/Zi_e6rBgGqv33BWF8WTq8g.woff2) format('woff2');\n        unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074,\n                       U+20AC, U+2212, U+2215, U+E0FF, U+EFFD, U+F000;\n    }\n\n    button.".concat(s,"-button {\n        font-family: 'Karla', sans-serif;\n\n        border: ").concat(i," ").concat(a,"px solid;\n        border-radius: ").concat(t,"px;\n        box-sizing: border-box;\n        background: ").concat(e.background?e.background:"none",";\n\n        height: ").concat(r,"px;\n        min-width: ").concat(9.6*n,"px;\n        display: inline-block;\n        position: relative;\n\n        cursor: pointer;\n        transition: border 0.5s;\n    }\n\n    button.").concat(s,"-button:focus {\n      outline: none;\n    }\n\n    /*\n    * Logo\n    */\n\n    .").concat(s,"-logo {\n        width: ").concat(r,"px;\n        height: ").concat(r,"px;\n        position: absolute;\n        top:0px;\n        left:0px;\n        width: ").concat(r-4,"px;\n        height: ").concat(r-4,"px;\n    }\n    .").concat(s,"-svg {\n        fill: ").concat(e.color,";\n        margin-top: ").concat((r-n*Pr)/2-2,"px;\n        margin-left: ").concat(r/3,"px;\n    }\n    .").concat(s,"-svg-error {\n        fill: ").concat(e.color,";\n        display:none;\n        margin-top: ").concat((r-28/18*n*Pr)/2-2,"px;\n        margin-left: ").concat(r/3,"px;\n    }\n\n\n    /*\n    * Title\n    */\n\n    .").concat(s,"-title {\n        color: ").concat(e.color,";\n        position: relative;\n        font-size: ").concat(n,"px;\n        padding-left: ").concat(1.05*r,"px;\n        padding-right: ").concat(t-10<5?r/3:t-10,"px;\n        transition: color 0.5s;\n    }\n\n    /*\n    * disabled\n    */\n\n    button.").concat(s,"-button[disabled=true] {\n        opacity: ").concat(e.disabledOpacity,";\n    }\n\n    button.").concat(s,"-button[disabled=true] > .").concat(s,"-logo > .").concat(s,"-svg {\n        display:none;\n    }\n\n    button.").concat(s,"-button[disabled=true] > .").concat(s,"-logo > .").concat(s,"-svg-error {\n        display:initial;\n    }\n\n    /*\n    * error\n    */\n\n    button.").concat(s,"-button[error=true] {\n        animation: errorShake 0.4s;\n    }\n\n    @keyframes errorShake {\n      0% { transform: translate(1px, 0) }\n      10% { transform: translate(-2px, 0) }\n      20% { transform: translate(2px, 0) }\n      30% { transform: translate(-2px, 0) }\n      40% { transform: translate(2px, 0) }\n      50% { transform: translate(-2px, 0) }\n      60% { transform: translate(2px, 0) }\n      70% { transform: translate(-2px, 0) }\n      80% { transform: translate(2px, 0) }\n      90% { transform: translate(-1px, 0) }\n      100% { transform: translate(0px, 0) }\n    }\n  ")},Ir=function(){function e(t){var n=this;St(this,e),(t=t||{}).color=t.color||"rgb(80,168,252)",t.background=t.background||!1,t.disabledOpacity=t.disabledOpacity||.5,t.height=t.height||55,t.corners=t.corners||"square",t.cssprefix=t.cssprefix||"webvr-ui",t.textEnterXRTitle=t.textEnterXRTitle||"ENTER VR",t.textXRNotFoundTitle=t.textXRNotFoundTitle||"VR NOT FOUND",t.textExitXRTitle=t.textExitXRTitle||"EXIT VR",t.onRequestSession=t.onRequestSession||function(){},t.onEndSession=t.onEndSession||function(){},t.injectCSS=!1!==t.injectCSS,this.options=t,this._enabled=!1,this.session=null,this.domElement=t.domElement||Tr(t),this.__defaultDisplayStyle=this.domElement.style.display||"initial",this.domElement.addEventListener("click",(function(){return n.__onXRButtonClick()})),this.__forceDisabled=!1,this.__setDisabledAttribute(!0),this.setTitle(this.options.textXRNotFoundTitle)}return Pt(e,[{key:"enabled",get:function(){return this._enabled},set:function(e){return this._enabled=e,this.__updateButtonState(),this}},{key:"setSession",value:function(e){return this.session=e,this.__updateButtonState(),this}},{key:"setTitle",value:function(e){return this.domElement.title=e,Dr(this.domElement,this.options.cssprefix,"title",(function(t){e?(t.innerText=e,t.style.display="initial"):t.style.display="none"})),this}},{key:"setTooltip",value:function(e){return this.domElement.title=e,this}},{key:"show",value:function(){return this.domElement.style.display=this.__defaultDisplayStyle,this}},{key:"hide",value:function(){return this.domElement.style.display="none",this}},{key:"enable",value:function(){return this.__setDisabledAttribute(!1),this.__forceDisabled=!1,this}},{key:"disable",value:function(){return this.__setDisabledAttribute(!0),this.__forceDisabled=!0,this}},{key:"remove",value:function(){this.domElement.parentElement&&this.domElement.parentElement.removeChild(this.domElement)}},{key:"__setDisabledAttribute",value:function(e){e||this.__forceDisabled?this.domElement.setAttribute("disabled","true"):this.domElement.removeAttribute("disabled")}},{key:"__onXRButtonClick",value:function(){var e=this;if(this.session)this.options.onEndSession(this.session);else if(this._enabled){var t=this.options.onRequestSession();t&&t.catch((function(t){var n="XRSession creation failed: ".concat(t.message);e.setTooltip(n),console.error(n),e.__setDisabledAttribute(!0),e.domElement.setAttribute("error","true"),setTimeout((function(){e.__setDisabledAttribute(!1),e.domElement.setAttribute("error","false")}),1e3)}))}}},{key:"__updateButtonState",value:function(){this.session?(this.setTitle(this.options.textExitXRTitle),this.setTooltip("Exit XR presentation"),this.__setDisabledAttribute(!1)):this._enabled?(this.setTitle(this.options.textEnterXRTitle),this.setTooltip("Enter XR"),this.__setDisabledAttribute(!1)):(this.setTitle(this.options.textXRNotFoundTitle),this.setTooltip("No XR headset found."),this.__setDisabledAttribute(!0))}}]),e}(),Dr=function(e,t,n,r){var a=e.querySelector("."+t+"-"+n);a&&r(a)},jr=WebGLRenderingContext,Lr=1,Ar=2,Fr=4,Nr=8,Br=16,Ur=32,zr=64,Vr=255,Hr=8,Wr=3840,qr=12,Gr=61440,Kr=65280,Xr=16,Qr=983040,$r=0,Jr=1,Yr=2,Zr=3,ea=4;function ta(e,t,n){var r=(e&t)>>n;switch(r){case 0:case 1:return r;default:return r-2+jr.SRC_COLOR}}var na=function(){function e(){St(this,e),this._state=Lr|Fr|Br|Ur,this.blendFuncSrc=jr.SRC_ALPHA,this.blendFuncDst=jr.ONE_MINUS_SRC_ALPHA,this.depthFunc=jr.LESS}return Pt(e,[{key:"cullFace",get:function(){return!!(this._state&Lr)},set:function(e){e?this._state|=Lr:this._state&=~Lr}},{key:"blend",get:function(){return!!(this._state&Ar)},set:function(e){e?this._state|=Ar:this._state&=~Ar}},{key:"depthTest",get:function(){return!!(this._state&Fr)},set:function(e){e?this._state|=Fr:this._state&=~Fr}},{key:"stencilTest",get:function(){return!!(this._state&Nr)},set:function(e){e?this._state|=Nr:this._state&=~Nr}},{key:"colorMask",get:function(){return!!(this._state&Br)},set:function(e){e?this._state|=Br:this._state&=~Br}},{key:"depthMask",get:function(){return!!(this._state&Ur)},set:function(e){e?this._state|=Ur:this._state&=~Ur}},{key:"depthFunc",get:function(){return((this._state&Qr)>>Xr)+jr.NEVER},set:function(e){e-=jr.NEVER,this._state&=~Qr,this._state|=e<<Xr}},{key:"stencilMask",get:function(){return!!(this._state&zr)},set:function(e){e?this._state|=zr:this._state&=~zr}},{key:"blendFuncSrc",get:function(){return ta(this._state,Wr,Hr)},set:function(e){switch(e){case 0:case 1:break;default:e=e-jr.SRC_COLOR+2}this._state&=~Wr,this._state|=e<<Hr}},{key:"blendFuncDst",get:function(){return ta(this._state,Gr,qr)},set:function(e){switch(e){case 0:case 1:break;default:e=e-jr.SRC_COLOR+2}this._state&=~Gr,this._state|=e<<qr}}]),e}(),ra=function(){function e(t){St(this,e),this._uniformName=t,this._texture=null}return Pt(e,[{key:"texture",get:function(){return this._texture},set:function(e){this._texture=e}}]),e}(),aa=function(){function e(t,n,r){St(this,e),this._uniformName=t,this._value=n,this._length=r,this._length||(this._length=n instanceof Array?n.length:1)}return Pt(e,[{key:"value",get:function(){return this._value},set:function(e){this._value=e}}]),e}(),ia=function(){function e(){St(this,e),this.state=new na,this.renderOrder=ea,this._samplers=[],this._uniforms=[]}return Pt(e,[{key:"defineSampler",value:function(e){var t=new ra(e);return this._samplers.push(t),t}},{key:"defineUniform",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=new aa(e,t,n);return this._uniforms.push(r),r}},{key:"materialName",get:function(){return null}},{key:"vertexSource",get:function(){return null}},{key:"fragmentSource",get:function(){return null}},{key:"getProgramDefines",value:function(e){return{}}}]),e}(),sa=1e-6,oa="undefined"!==typeof Float32Array?Float32Array:Array;Math.random;Math.PI;function ca(){var e=new oa(9);return oa!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e}function ua(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[4],e[4]=t[5],e[5]=t[6],e[6]=t[8],e[7]=t[9],e[8]=t[10],e}Math.hypot||(Math.hypot=function(){for(var e=0,t=arguments.length;t--;)e+=arguments[t]*arguments[t];return Math.sqrt(e)});function la(){var e=new oa(3);return oa!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function da(e){var t=new oa(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function pa(e,t,n){var r=new oa(3);return r[0]=e,r[1]=t,r[2]=n,r}function fa(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function ha(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e}function ma(e,t){var n=t[0]-e[0],r=t[1]-e[1],a=t[2]-e[2];return Math.hypot(n,r,a)}function va(e,t){var n=t[0],r=t[1],a=t[2],i=n*n+r*r+a*a;return i>0&&(i=1/Math.sqrt(i)),e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e}function ga(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function ba(e,t,n){var r=t[0],a=t[1],i=t[2],s=n[0],o=n[1],c=n[2];return e[0]=a*c-i*o,e[1]=i*s-r*c,e[2]=r*o-a*s,e}function ya(e,t,n){var r=t[0],a=t[1],i=t[2],s=n[3]*r+n[7]*a+n[11]*i+n[15];return s=s||1,e[0]=(n[0]*r+n[4]*a+n[8]*i+n[12])/s,e[1]=(n[1]*r+n[5]*a+n[9]*i+n[13])/s,e[2]=(n[2]*r+n[6]*a+n[10]*i+n[14])/s,e}function _a(e,t,n){var r=t[0],a=t[1],i=t[2];return e[0]=r*n[0]+a*n[3]+i*n[6],e[1]=r*n[1]+a*n[4]+i*n[7],e[2]=r*n[2]+a*n[5]+i*n[8],e}var wa=function(e){var t=e[0],n=e[1],r=e[2];return Math.hypot(t,n,r)},ka=(function(){var e=la()}(),ca()),xa=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;St(this,e),this.origin=la(),this._dir=la(),this._dir[2]=-1,t&&(ya(this.origin,this.origin,t),ua(ka,t),_a(this._dir,this._dir,ka)),this.direction=this._dir}return Pt(e,[{key:"direction",get:function(){return this._dir},set:function(e){this._dir=fa(this._dir,e),va(this._dir,this._dir),this.inv_dir=pa(1/this._dir[0],1/this._dir[1],1/this._dir[2]),this.sign=[this.inv_dir[0]<0?1:0,this.inv_dir[1]<0?1:0,this.inv_dir[2]<0?1:0]}},{key:"intersectsAABB",value:function(e,t){var n=this,r=[e,t],a=(r[n.sign[0]][0]-n.origin[0])*n.inv_dir[0],i=(r[1-n.sign[0]][0]-n.origin[0])*n.inv_dir[0],s=(r[n.sign[1]][1]-n.origin[1])*n.inv_dir[1],o=(r[1-n.sign[1]][1]-n.origin[1])*n.inv_dir[1];if(a>o||s>i)return null;s>a&&(a=s),o<i&&(i=o);var c=(r[n.sign[2]][2]-n.origin[2])*n.inv_dir[2],u=(r[1-n.sign[2]][2]-n.origin[2])*n.inv_dir[2];if(a>u||c>i)return null;c>a&&(a=c),u<i&&(i=u);var l=-1;if(a>0&&i>0)l=Math.min(a,i);else if(a>0)l=a;else{if(!(i>0))return null;l=i}l-=.02;var d,p,f,h=da(this._dir);return p=h,f=l,(d=h)[0]=p[0]*f,d[1]=p[1]*f,d[2]=p[2]*f,ha(h,h,this.origin),h}}]),e}();function Sa(){var e=new oa(16);return oa!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e}function Ra(e){var t=new oa(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function Pa(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function Ca(e,t){var n=t[0],r=t[1],a=t[2],i=t[3],s=t[4],o=t[5],c=t[6],u=t[7],l=t[8],d=t[9],p=t[10],f=t[11],h=t[12],m=t[13],v=t[14],g=t[15],b=n*o-r*s,y=n*c-a*s,_=n*u-i*s,w=r*c-a*o,k=r*u-i*o,x=a*u-i*c,S=l*m-d*h,R=l*v-p*h,P=l*g-f*h,C=d*v-p*m,T=d*g-f*m,E=p*g-f*v,O=b*E-y*T+_*C+w*P-k*R+x*S;return O?(O=1/O,e[0]=(o*E-c*T+u*C)*O,e[1]=(a*T-r*E-i*C)*O,e[2]=(m*x-v*k+g*w)*O,e[3]=(p*k-d*x-f*w)*O,e[4]=(c*P-s*E-u*R)*O,e[5]=(n*E-a*P+i*R)*O,e[6]=(v*_-h*x-g*y)*O,e[7]=(l*x-p*_+f*y)*O,e[8]=(s*T-o*P+u*S)*O,e[9]=(r*P-n*T-i*S)*O,e[10]=(h*k-m*_+g*b)*O,e[11]=(d*_-l*k-f*b)*O,e[12]=(o*R-s*C-c*S)*O,e[13]=(n*C-r*R+a*S)*O,e[14]=(m*y-h*w-v*b)*O,e[15]=(l*w-d*y+p*b)*O,e):null}function Ta(e,t,n){var r=t[0],a=t[1],i=t[2],s=t[3],o=t[4],c=t[5],u=t[6],l=t[7],d=t[8],p=t[9],f=t[10],h=t[11],m=t[12],v=t[13],g=t[14],b=t[15],y=n[0],_=n[1],w=n[2],k=n[3];return e[0]=y*r+_*o+w*d+k*m,e[1]=y*a+_*c+w*p+k*v,e[2]=y*i+_*u+w*f+k*g,e[3]=y*s+_*l+w*h+k*b,y=n[4],_=n[5],w=n[6],k=n[7],e[4]=y*r+_*o+w*d+k*m,e[5]=y*a+_*c+w*p+k*v,e[6]=y*i+_*u+w*f+k*g,e[7]=y*s+_*l+w*h+k*b,y=n[8],_=n[9],w=n[10],k=n[11],e[8]=y*r+_*o+w*d+k*m,e[9]=y*a+_*c+w*p+k*v,e[10]=y*i+_*u+w*f+k*g,e[11]=y*s+_*l+w*h+k*b,y=n[12],_=n[13],w=n[14],k=n[15],e[12]=y*r+_*o+w*d+k*m,e[13]=y*a+_*c+w*p+k*v,e[14]=y*i+_*u+w*f+k*g,e[15]=y*s+_*l+w*h+k*b,e}var Ea=Ta;!function(){var e=function(){var e=new oa(4);return oa!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0),e}()}();function Oa(){var e=new oa(4);return oa!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e[3]=1,e}function Ma(e,t,n,r){var a,i,s,o,c,u=t[0],l=t[1],d=t[2],p=t[3],f=n[0],h=n[1],m=n[2],v=n[3];return u*f+l*h+d*m+p*v<0&&(-i,-f,-h,-m,-v),1-i>sa?(Math.acos(i),Math.sin(a),Math.sin((1-r)*a)/s,Math.sin(r*a)/s):(1-r,r),e[0]=o*u+c*f,e[1]=o*l+c*h,e[2]=o*d+c*m,e[3]=o*p+c*v,e}var Ia=function(e){var t=new oa(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},Da=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},ja=function(e,t){var n=t[0],r=t[1],a=t[2],i=t[3],s=n*n+r*r+a*a+i*i;return s>0&&(s=1/Math.sqrt(s)),e[0]=n*s,e[1]=r*s,e[2]=a*s,e[3]=i*s,e},La=(function(){var e=la(),t=pa(1,0,0),n=pa(0,1,0)}(),function(){var e=Oa(),t=Oa()}(),function(){var e=ca()}(),new Float32Array([0,0,0])),Aa=new Float32Array([0,0,0,1]),Fa=new Float32Array([1,1,1]),Na=Sa(),Ba=function(){function e(){St(this,e),this.name=null,this.children=[],this.parent=null,this.visible=!0,this.selectable=!1,this._matrix=null,this._dirtyTRS=!1,this._translation=null,this._rotation=null,this._scale=null,this._dirtyWorldMatrix=!1,this._worldMatrix=null,this._activeFrameId=-1,this._hoverFrameId=-1,this._renderPrimitives=null,this._renderer=null,this._selectHandler=null}return Pt(e,[{key:"_setRenderer",value:function(e){if(this._renderer!=e&&(this._renderer&&this.clearRenderPrimitives(),this._renderer=e,e)){this.onRendererChanged(e);var t,n=kr(this.children);try{for(n.s();!(t=n.n()).done;){t.value._setRenderer(e)}}catch(r){n.e(r)}finally{n.f()}}}},{key:"onRendererChanged",value:function(e){}},{key:"clone",value:function(){var t=this,n=new e;return n.name=this.name,n.visible=this.visible,n._renderer=this._renderer,n._dirtyTRS=this._dirtyTRS,this._translation&&(n._translation=la(),fa(n._translation,this._translation)),this._rotation&&(n._rotation=Oa(),Da(n._rotation,this._rotation)),this._scale&&(n._scale=la(),fa(n._scale,this._scale)),!n._dirtyTRS&&this._matrix&&(n._matrix=Sa(),Pa(n._matrix,this._matrix)),n._dirtyWorldMatrix=this._dirtyWorldMatrix,!n._dirtyWorldMatrix&&this._worldMatrix&&(n._worldMatrix=Sa(),Pa(n._worldMatrix,this._worldMatrix)),this.waitForComplete().then((function(){if(t._renderPrimitives){var e,r=kr(t._renderPrimitives);try{for(r.s();!(e=r.n()).done;){var a=e.value;n.addRenderPrimitive(a)}}catch(c){r.e(c)}finally{r.f()}}var i,s=kr(t.children);try{for(s.s();!(i=s.n()).done;){var o=i.value;n.addNode(o.clone())}}catch(c){s.e(c)}finally{s.f()}})),n}},{key:"markActive",value:function(e){if(this.visible&&this._renderPrimitives){this._activeFrameId=e;var t,n=kr(this._renderPrimitives);try{for(n.s();!(t=n.n()).done;){t.value.markActive(e)}}catch(s){n.e(s)}finally{n.f()}}var r,a=kr(this.children);try{for(a.s();!(r=a.n()).done;){var i=r.value;i.visible&&i.markActive(e)}}catch(s){a.e(s)}finally{a.f()}}},{key:"addNode",value:function(e){e&&e.parent!=this&&(e.parent&&e.parent.removeNode(e),e.parent=this,this.children.push(e),this._renderer&&e._setRenderer(this._renderer))}},{key:"removeNode",value:function(e){var t=this.children.indexOf(e);t>-1&&(this.children.splice(t,1),e.parent=null)}},{key:"clearNodes",value:function(){var e,t=kr(this.children);try{for(t.s();!(e=t.n()).done;){e.value.parent=null}}catch(n){t.e(n)}finally{t.f()}this.children=[]}},{key:"setMatrixDirty",value:function(){if(!this._dirtyWorldMatrix){this._dirtyWorldMatrix=!0;var e,t=kr(this.children);try{for(t.s();!(e=t.n()).done;){e.value.setMatrixDirty()}}catch(n){t.e(n)}finally{t.f()}}}},{key:"_updateLocalMatrix",value:function(){return this._matrix||(this._matrix=Sa()),this._dirtyTRS&&(this._dirtyTRS=!1,function(e,t,n,r){var a=t[0],i=t[1],s=t[2],o=t[3],c=a+a,u=i+i,l=s+s,d=a*c,p=a*u,f=a*l,h=i*u,m=i*l,v=s*l,g=o*c,b=o*u,y=o*l,_=r[0],w=r[1],k=r[2];e[0]=(1-(h+v))*_,e[1]=(p+y)*_,e[2]=(f-b)*_,e[3]=0,e[4]=(p-y)*w,e[5]=(1-(d+v))*w,e[6]=(m+g)*w,e[7]=0,e[8]=(f+b)*k,e[9]=(m-g)*k,e[10]=(1-(d+h))*k,e[11]=0,e[12]=n[0],e[13]=n[1],e[14]=n[2],e[15]=1}(this._matrix,this._rotation||Aa,this._translation||La,this._scale||Fa)),this._matrix}},{key:"matrix",get:function(){return this.setMatrixDirty(),this._updateLocalMatrix()},set:function(e){e?(this._matrix||(this._matrix=Sa()),Pa(this._matrix,e)):this._matrix=null,this.setMatrixDirty(),this._dirtyTRS=!1,this._translation=null,this._rotation=null,this._scale=null}},{key:"worldMatrix",get:function(){return this._worldMatrix||(this._dirtyWorldMatrix=!0,this._worldMatrix=Sa()),(this._dirtyWorldMatrix||this._dirtyTRS)&&(this.parent?Ea(this._worldMatrix,this.parent.worldMatrix,this._updateLocalMatrix()):Pa(this._worldMatrix,this._updateLocalMatrix()),this._dirtyWorldMatrix=!1),this._worldMatrix}},{key:"translation",get:function(){return this._dirtyTRS=!0,this.setMatrixDirty(),this._translation||(this._translation=da(La)),this._translation},set:function(e){null!=e&&(this._dirtyTRS=!0,this.setMatrixDirty()),this._translation=e}},{key:"rotation",get:function(){return this._dirtyTRS=!0,this.setMatrixDirty(),this._rotation||(this._rotation=Ia(Aa)),this._rotation},set:function(e){null!=e&&(this._dirtyTRS=!0,this.setMatrixDirty()),this._rotation=e}},{key:"scale",get:function(){return this._dirtyTRS=!0,this.setMatrixDirty(),this._scale||(this._scale=da(Fa)),this._scale},set:function(e){null!=e&&(this._dirtyTRS=!0,this.setMatrixDirty()),this._scale=e}},{key:"waitForComplete",value:function(){var e,t=this,n=[],r=kr(this.children);try{for(r.s();!(e=r.n()).done;){var a=e.value;n.push(a.waitForComplete())}}catch(c){r.e(c)}finally{r.f()}if(this._renderPrimitives){var i,s=kr(this._renderPrimitives);try{for(s.s();!(i=s.n()).done;){var o=i.value;n.push(o.waitForComplete())}}catch(c){s.e(c)}finally{s.f()}}return Promise.all(n).then((function(){return t}))}},{key:"renderPrimitives",get:function(){return this._renderPrimitives}},{key:"addRenderPrimitive",value:function(e){this._renderPrimitives?this._renderPrimitives.push(e):this._renderPrimitives=[e],e._instances.push(this)}},{key:"removeRenderPrimitive",value:function(e){if(this._renderPrimitives){var t=this._renderPrimitives._instances.indexOf(e);t>-1&&(this._renderPrimitives._instances.splice(t,1),(t=e._instances.indexOf(this))>-1&&e._instances.splice(t,1),this._renderPrimitives.length||(this._renderPrimitives=null))}}},{key:"clearRenderPrimitives",value:function(){if(this._renderPrimitives){var e,t=kr(this._renderPrimitives);try{for(t.s();!(e=t.n()).done;){var n=e.value,r=n._instances.indexOf(this);r>-1&&n._instances.splice(r,1)}}catch(a){t.e(a)}finally{t.f()}this._renderPrimitives=null}}},{key:"_hitTestSelectableNode",value:function(e){if(this._renderPrimitives){var t,n=null,r=kr(this._renderPrimitives);try{for(r.s();!(t=r.n()).done;){var a=t.value;if(a._min){n||(Ca(Na,this.worldMatrix),Ta(Na,Na,e.matrix),n=new xa(Na));var i=n.intersectsAABB(a._min,a._max);if(i)return ya(i,i,this.worldMatrix),i}}}catch(u){r.e(u)}finally{r.f()}}var s,o=kr(this.children);try{for(o.s();!(s=o.n()).done;){var c=s.value._hitTestSelectableNode(e);if(c)return c}}catch(u){o.e(u)}finally{o.f()}return null}},{key:"hitTest",value:function(e){if(this.selectable&&this.visible){var t=this._hitTestSelectableNode(e);if(t){var n=new xa(e.matrix);return{node:this,intersection:t,distance:ma(pa(n.origin.x,n.origin.y,n.origin.z),t)}}return null}var r,a=null,i=kr(this.children);try{for(i.s();!(r=i.n()).done;){var s=r.value.hitTest(e);s&&(!a||a.distance>s.distance)&&(a=s)}}catch(o){i.e(o)}finally{i.f()}return a}},{key:"onSelect",value:function(e){this._selectHandler=e}},{key:"selectHandler",get:function(){return this._selectHandler}},{key:"handleSelect",value:function(){this._selectHandler&&this._selectHandler()}},{key:"onHoverStart",value:function(){}},{key:"onHoverEnd",value:function(){}},{key:"_update",value:function(e,t){this.onUpdate(e,t);var n,r=kr(this.children);try{for(r.s();!(n=r.n()).done;){n.value._update(e,t)}}catch(a){r.e(a)}finally{r.f()}}},{key:"onUpdate",value:function(e,t){}}]),e}(),Ua=function(){function e(t,n,r,a,i){St(this,e),this._gl=t,this.program=t.createProgram(),this.attrib=null,this.uniform=null,this.defines={},this._firstUse=!0,this._nextUseCallbacks=[];var s="";if(i)for(var o in i)this.defines[o]=i[o],s+="#define ".concat(o," ").concat(i[o],"\n");if(this._vertShader=t.createShader(t.VERTEX_SHADER),t.attachShader(this.program,this._vertShader),t.shaderSource(this._vertShader,s+n),t.compileShader(this._vertShader),this._fragShader=t.createShader(t.FRAGMENT_SHADER),t.attachShader(this.program,this._fragShader),t.shaderSource(this._fragShader,s+r),t.compileShader(this._fragShader),a)for(var c in this.attrib={},a)t.bindAttribLocation(this.program,a[c],c),this.attrib[c]=a[c];t.linkProgram(this.program)}return Pt(e,[{key:"onNextUse",value:function(e){this._nextUseCallbacks.push(e)}},{key:"use",value:function(){var e=this._gl;if(this._firstUse){if(this._firstUse=!1,e.getProgramParameter(this.program,e.LINK_STATUS)){if(!this.attrib){this.attrib={};for(var t=e.getProgramParameter(this.program,e.ACTIVE_ATTRIBUTES),n=0;n<t;n++){var r=e.getActiveAttrib(this.program,n);this.attrib[r.name]=e.getAttribLocation(this.program,r.name)}}this.uniform={};for(var a=e.getProgramParameter(this.program,e.ACTIVE_UNIFORMS),i="",s=0;s<a;s++){i=e.getActiveUniform(this.program,s).name.replace("[0]",""),this.uniform[i]=e.getUniformLocation(this.program,i)}}else e.getShaderParameter(this._vertShader,e.COMPILE_STATUS)?e.getShaderParameter(this._fragShader,e.COMPILE_STATUS)?console.error("Program link error: "+e.getProgramInfoLog(this.program)):console.error("Fragment shader compile error: "+e.getShaderInfoLog(this._fragShader)):console.error("Vertex shader compile error: "+e.getShaderInfoLog(this._vertShader)),e.deleteProgram(this.program),this.program=null;e.deleteShader(this._vertShader),e.deleteShader(this._fragShader)}if(e.useProgram(this.program),this._nextUseCallbacks.length){var o,c=kr(this._nextUseCallbacks);try{for(c.s();!(o=c.n()).done;){(0,o.value)(this)}}catch(u){c.e(u)}finally{c.f()}this._nextUseCallbacks=[]}}}]),e}(),za=WebGLRenderingContext,Va=0,Ha=Pt((function e(){St(this,e),this.minFilter=null,this.magFilter=null,this.wrapS=null,this.wrapT=null})),Wa=function(){function e(){St(this,e),this.sampler=new Ha,this.mipmap=!0}return Pt(e,[{key:"format",get:function(){return za.RGBA}},{key:"width",get:function(){return 0}},{key:"height",get:function(){return 0}},{key:"textureKey",get:function(){return null}}]),e}(),qa=function(e){mn(n,e);var t=_n(n);function n(e){var r;return St(this,n),(r=t.call(this))._img=e,r._imgBitmap=null,r._manualKey=null,e.src&&e.complete?e.naturalWidth?r._promise=r._finishImage():r._promise=Promise.reject("Image provided had failed to load."):r._promise=new Promise((function(t,n){e.addEventListener("load",(function(){return t(r._finishImage())})),e.addEventListener("error",n)})),r}return Pt(n,[{key:"_finishImage",value:function(){var e=this;return window.createImageBitmap?window.createImageBitmap(this._img).then((function(t){return e._imgBitmap=t,Promise.resolve(e)})):Promise.resolve(this)}},{key:"format",get:function(){return za.RGBA}},{key:"width",get:function(){return this._img.width}},{key:"height",get:function(){return this._img.height}},{key:"waitForComplete",value:function(){return this._promise}},{key:"textureKey",get:function(){return this._manualKey||this._img.src}},{key:"source",get:function(){return this._imgBitmap||this._img}},{key:"genDataKey",value:function(){this._manualKey="DATA_".concat(Va),Va++}}]),n}(Wa),Ga=function(e){mn(n,e);var t=_n(n);function n(e){var r;return St(this,n),(r=t.call(this))._video=e,e.readyState>=2?r._promise=Promise.resolve(bn(r)):e.error?r._promise=Promise.reject(e.error):r._promise=new Promise((function(t,n){e.addEventListener("loadeddata",(function(){return t(bn(r))})),e.addEventListener("error",n)})),r}return Pt(n,[{key:"format",get:function(){return za.RGBA}},{key:"width",get:function(){return this._video.videoWidth}},{key:"height",get:function(){return this._video.videoHeight}},{key:"waitForComplete",value:function(){return this._promise}},{key:"textureKey",get:function(){return this._video.src}},{key:"source",get:function(){return this._video}}]),n}(Wa),Ka=function(e){mn(n,e);var t=_n(n);function n(e,r,a){var i,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:za.RGBA,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:za.UNSIGNED_BYTE;return St(this,n),(i=t.call(this))._data=e,i._width=r,i._height=a,i._format=s,i._type=o,i._key="DATA_".concat(Va),Va++,i}return Pt(n,[{key:"format",get:function(){return this._format}},{key:"width",get:function(){return this._width}},{key:"height",get:function(){return this._height}},{key:"textureKey",get:function(){return this._key}}]),n}(Wa),Xa=function(e){mn(n,e);var t=_n(n);function n(e,r,a,i){var s;St(this,n);var o=new Uint8Array([255*e,255*r,255*a,255*i]);return(s=t.call(this,o,1,1)).mipmap=!1,s._key="COLOR_".concat(o[0],"_").concat(o[1],"_").concat(o[2],"_").concat(o[3]),s}return Pt(n)}(Ka),Qa={POSITION:1,NORMAL:2,TANGENT:3,TEXCOORD_0:4,TEXCOORD_1:5,COLOR_0:6},$a={POSITION:1,NORMAL:2,TANGENT:4,TEXCOORD_0:8,TEXCOORD_1:16,COLOR_0:32},Ja=WebGLRenderingContext,Ya=new Float32Array([-.1,-1,-.2]),Za=new Float32Array([3,3,3]),ei=new RegExp("precision (lowp|mediump|highp) float;");function ti(e){return 0===(e&e-1)}function ni(e){e=e||{alpha:!1};for(var t=document.createElement("canvas"),n=null,r=0,a=e.webgl2?["webgl2"]:["webgl","experimental-webgl"];r<a.length;r++){var i=a[r];if(n=t.getContext(i,e))break}if(!n){var s=e.webgl2?"WebGL 2":"WebGL";return console.error("This browser does not support "+s+"."),null}return n}var ri=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"left";St(this,e),this.projectionMatrix=t,this.viewport=r,this._eye=a,this._eyeIndex="left"==a?0:1,n instanceof Float32Array?(this._viewMatrix=Ra(n),this.viewTransform=new XRRigidTransform):(this.viewTransform=n,this._viewMatrix=n.inverse.matrix)}return Pt(e,[{key:"viewMatrix",get:function(){return this._viewMatrix}},{key:"eye",get:function(){return this._eye},set:function(e){this._eye=e,this._eyeIndex="left"==e?0:1}},{key:"eyeIndex",get:function(){return this._eyeIndex}}]),e}(),ai=function(){function e(t,n,r){var a=this,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;St(this,e),this._target=t,this._usage=n,this._length=i,r instanceof Promise?(this._buffer=null,this._promise=r.then((function(e){return a._buffer=e,a}))):(this._buffer=r,this._promise=Promise.resolve(this))}return Pt(e,[{key:"waitForComplete",value:function(){return this._promise}}]),e}(),ii=Pt((function e(t){St(this,e),this._attrib_index=Qa[t.name],this._componentCount=t.componentCount,this._componentType=t.componentType,this._stride=t.stride,this._byteOffset=t.byteOffset,this._normalized=t.normalized})),si=Pt((function e(t){St(this,e),this._buffer=t,this._attributes=[]})),oi=function(){function e(t){St(this,e),this._activeFrameId=0,this._instances=[],this._material=null,this.setPrimitive(t)}return Pt(e,[{key:"setPrimitive",value:function(e){this._mode=e.mode,this._elementCount=e.elementCount,this._promise=null,this._vao=null,this._complete=!1,this._attributeBuffers=[],this._attributeMask=0;var t,n=kr(e.attributes);try{for(n.s();!(t=n.n()).done;){var r=t.value;this._attributeMask|=$a[r.name];var a,i=new ii(r),s=!1,o=kr(this._attributeBuffers);try{for(o.s();!(a=o.n()).done;){var c=a.value;if(c._buffer==r.buffer){c._attributes.push(i),s=!0;break}}}catch(l){o.e(l)}finally{o.f()}if(!s){var u=new si(r.buffer);u._attributes.push(i),this._attributeBuffers.push(u)}}}catch(l){n.e(l)}finally{n.f()}this._indexBuffer=null,this._indexByteOffset=0,this._indexType=0,e.indexBuffer&&(this._indexByteOffset=e.indexByteOffset,this._indexType=e.indexType,this._indexBuffer=e.indexBuffer),e._min?(this._min=da(e._min),this._max=da(e._max)):(this._min=null,this._max=null),null!=this._material&&this.waitForComplete()}},{key:"setRenderMaterial",value:function(e){this._material=e,this._promise=null,this._complete=!1,null!=this._material&&this.waitForComplete()}},{key:"markActive",value:function(e){if(this._complete&&this._activeFrameId!=e){if(this._material&&!this._material.markActive(e))return;this._activeFrameId=e}}},{key:"samplers",get:function(){return this._material._samplerDictionary}},{key:"uniforms",get:function(){return this._material._uniform_dictionary}},{key:"waitForComplete",value:function(){var e=this;if(!this._promise){if(!this._material)return Promise.reject("RenderPrimitive does not have a material");var t,n=[],r=kr(this._attributeBuffers);try{for(r.s();!(t=r.n()).done;){var a=t.value;a._buffer._buffer||n.push(a._buffer._promise)}}catch(i){r.e(i)}finally{r.f()}this._indexBuffer&&!this._indexBuffer._buffer&&n.push(this._indexBuffer._promise),this._promise=Promise.all(n).then((function(){return e._complete=!0,e}))}return this._promise}}]),e}(),ci=function(){function e(t){St(this,e),this._texture=t,this._complete=!1,this._activeFrameId=0,this._activeCallback=null}return Pt(e,[{key:"markActive",value:function(e){this._activeCallback&&this._activeFrameId!=e&&(this._activeFrameId=e,this._activeCallback(this))}}]),e}();Sa();function ui(e,t,n,r,a){var i=(a&n)-(r&n);i&&(i>0?e.enable(t):e.disable(t))}var li=function(){function e(t,n,r){St(this,e),this._renderer=t,this._uniformName=n._uniformName,this._renderTexture=t._getRenderTexture(n._texture),this._index=r}return Pt(e,[{key:"texture",set:function(e){this._renderTexture=this._renderer._getRenderTexture(e)}}]),e}(),di=function(){function e(t){St(this,e),this._uniformName=t._uniformName,this._uniform=null,this._length=t._length,t._value instanceof Array?this._value=new Float32Array(t._value):this._value=new Float32Array([t._value])}return Pt(e,[{key:"value",set:function(e){if(1==this._value.length)this._value[0]=e;else for(var t=0;t<this._value.length;++t)this._value[t]=e[t]}}]),e}(),pi=function(){function e(t,n,r){St(this,e),this._program=r,this._state=n.state._state,this._activeFrameId=0,this._completeForActiveFrame=!1,this._samplerDictionary={},this._samplers=[];for(var a=0;a<n._samplers.length;++a){var i=new li(t,n._samplers[a],a);this._samplers.push(i),this._samplerDictionary[i._uniformName]=i}this._uniform_dictionary={},this._uniforms=[];var s,o=kr(n._uniforms);try{for(o.s();!(s=o.n()).done;){var c=s.value,u=new di(c);this._uniforms.push(u),this._uniform_dictionary[u._uniformName]=u}}catch(l){o.e(l)}finally{o.f()}this._firstBind=!0,this._renderOrder=n.renderOrder,this._renderOrder==ea&&(this._state&Ar?this._renderOrder=Yr:this._renderOrder=$r)}return Pt(e,[{key:"bind",value:function(e){if(this._firstBind){for(var t=0;t<this._samplers.length;){var n=this._samplers[t];this._program.uniform[n._uniformName]?++t:this._samplers.splice(t,1)}for(var r=0;r<this._uniforms.length;){var a=this._uniforms[r];a._uniform=this._program.uniform[a._uniformName],a._uniform?++r:this._uniforms.splice(r,1)}this._firstBind=!1}var i,s=kr(this._samplers);try{for(s.s();!(i=s.n()).done;){var o=i.value;e.activeTexture(e.TEXTURE0+o._index),o._renderTexture&&o._renderTexture._complete?e.bindTexture(e.TEXTURE_2D,o._renderTexture._texture):e.bindTexture(e.TEXTURE_2D,null)}}catch(d){s.e(d)}finally{s.f()}var c,u=kr(this._uniforms);try{for(u.s();!(c=u.n()).done;){var l=c.value;switch(l._length){case 1:e.uniform1fv(l._uniform,l._value);break;case 2:e.uniform2fv(l._uniform,l._value);break;case 3:e.uniform3fv(l._uniform,l._value);break;case 4:e.uniform4fv(l._uniform,l._value)}}}catch(d){u.e(d)}finally{u.f()}}},{key:"markActive",value:function(e){if(this._activeFrameId!=e){this._activeFrameId=e,this._completeForActiveFrame=!0;for(var t=0;t<this._samplers.length;++t){var n=this._samplers[t];if(n._renderTexture){if(!n._renderTexture._complete){this._completeForActiveFrame=!1;break}n._renderTexture.markActive(e)}}}return this._completeForActiveFrame}},{key:"cullFace",get:function(){return!!(this._state&Lr)}},{key:"blend",get:function(){return!!(this._state&Ar)}},{key:"depthTest",get:function(){return!!(this._state&Fr)}},{key:"stencilTest",get:function(){return!!(this._state&Nr)}},{key:"colorMask",get:function(){return!!(this._state&Br)}},{key:"depthMask",get:function(){return!!(this._state&Ur)}},{key:"stencilMask",get:function(){return!!(this._state&zr)}},{key:"depthFunc",get:function(){return((this._state&Qr)>>Xr)+Ja.NEVER}},{key:"blendFuncSrc",get:function(){return ta(this._state,Wr,Hr)}},{key:"blendFuncDst",get:function(){return ta(this._state,Gr,qr)}},{key:"_capsDiff",value:function(e){return e&Vr^this._state&Vr}},{key:"_blendDiff",value:function(e){return this._state&Ar?e&Kr^this._state&Kr:0}},{key:"_depthFuncDiff",value:function(e){return this._state&Fr?e&Qr^this._state&Qr:0}}]),e}(),fi=function(){function e(t,n){St(this,e),this._gl=t||ni(),this._frameId=0,this._programCache={},this._textureCache={},this._renderPrimitives=Array(ea),this._cameraPositions=[],this._vaoExt=t.getExtension("OES_vertex_array_object");var r=t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT);this._defaultFragPrecision=r.precision>0?"highp":"mediump",this._depthMaskNeedsReset=!1,this._colorMaskNeedsReset=!1,this._globalLightColor=da(Za),this._globalLightDir=da(Ya),this._multiview=n}return Pt(e,[{key:"gl",get:function(){return this._gl}},{key:"globalLightColor",get:function(){return da(this._globalLightColor)},set:function(e){fa(this._globalLightColor,e)}},{key:"globalLightDir",get:function(){return da(this._globalLightDir)},set:function(e){fa(this._globalLightDir,e)}},{key:"createRenderBuffer",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Ja.STATIC_DRAW,r=this._gl,a=r.createBuffer();if(t instanceof Promise){var i=new ai(e,n,t.then((function(t){return r.bindBuffer(e,a),r.bufferData(e,t,n),i._length=t.byteLength,a})));return i}return r.bindBuffer(e,a),r.bufferData(e,t,n),new ai(e,n,a,t.byteLength)}},{key:"updateRenderBuffer",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(e._buffer){var a=this._gl;a.bindBuffer(e._target,e._buffer),0==r&&e._length==t.byteLength?a.bufferData(e._target,t,e._usage):a.bufferSubData(e._target,r,t)}else e.waitForComplete().then((function(e){n.updateRenderBuffer(e,t,r)}))}},{key:"createRenderPrimitive",value:function(e,t){var n=new oi(e),r=this._getMaterialProgram(t,n),a=new pi(this,t,r);return n.setRenderMaterial(a),this._renderPrimitives[a._renderOrder]||(this._renderPrimitives[a._renderOrder]=[]),this._renderPrimitives[a._renderOrder].push(n),n}},{key:"createMesh",value:function(e,t){var n=new Ba;return n.addRenderPrimitive(this.createRenderPrimitive(e,t)),n}},{key:"drawViews",value:function(e,t){if(t){var n=this._gl;if(this._frameId++,t.markActive(this._frameId),1==e.length&&e[0].viewport){var r=e[0].viewport;this._gl.viewport(r.x,r.y,r.width,r.height)}for(var a=0;a<e.length;++a){this._cameraPositions.length<=a&&this._cameraPositions.push(la());var i=e[a].viewTransform.position;this._cameraPositions[a][0]=i.x,this._cameraPositions[a][1]=i.y,this._cameraPositions[a][2]=i.z}var s,o=kr(this._renderPrimitives);try{for(o.s();!(s=o.n()).done;){var c=s.value;c&&c.length&&this._drawRenderPrimitiveSet(e,c)}}catch(u){o.e(u)}finally{o.f()}this._vaoExt&&this._vaoExt.bindVertexArrayOES(null),this._depthMaskNeedsReset&&n.depthMask(!0),this._colorMaskNeedsReset&&n.colorMask(!0,!0,!0,!0)}}},{key:"_drawRenderPrimitiveSet",value:function(e,t){var n,r=this._gl,a=null,i=null,s=0,o=kr(t);try{for(o.s();!(n=o.n()).done;){var c=n.value;if(c._activeFrameId==this._frameId){if(a!=c._material._program&&((a=c._material._program).use(),a.uniform.LIGHT_DIRECTION&&r.uniform3fv(a.uniform.LIGHT_DIRECTION,this._globalLightDir),a.uniform.LIGHT_COLOR&&r.uniform3fv(a.uniform.LIGHT_COLOR,this._globalLightColor),1==e.length))if(this._multiview){var u=e[0].viewport;r.viewport(u.x,u.y,u.width,u.height),r.uniformMatrix4fv(a.uniform.LEFT_PROJECTION_MATRIX,!1,e[0].projectionMatrix),r.uniformMatrix4fv(a.uniform.LEFT_VIEW_MATRIX,!1,e[0].viewMatrix),r.uniformMatrix4fv(a.uniform.RIGHT_PROJECTION_MATRIX,!1,e[0].projectionMatrix),r.uniformMatrix4fv(a.uniform.RIGHT_VIEW_MATRIX,!1,e[0].viewMatrix),r.uniform3fv(a.uniform.CAMERA_POSITION,this._cameraPositions[0]),r.uniform1i(a.uniform.EYE_INDEX,e[0].eyeIndex)}else r.uniformMatrix4fv(a.uniform.PROJECTION_MATRIX,!1,e[0].projectionMatrix),r.uniformMatrix4fv(a.uniform.VIEW_MATRIX,!1,e[0].viewMatrix),r.uniform3fv(a.uniform.CAMERA_POSITION,this._cameraPositions[0]),r.uniform1i(a.uniform.EYE_INDEX,e[0].eyeIndex);i!=c._material&&(this._bindMaterialState(c._material,i),c._material.bind(r,a,i),i=c._material),this._vaoExt?c._vao?this._vaoExt.bindVertexArrayOES(c._vao):(c._vao=this._vaoExt.createVertexArrayOES(),this._vaoExt.bindVertexArrayOES(c._vao),this._bindPrimitive(c)):(this._bindPrimitive(c,s),s=c._attributeMask);for(var l=0;l<e.length;++l){var d=e[l];if(e.length>1){if(d.viewport){var p=d.viewport;r.viewport(p.x,p.y,p.width,p.height)}this._multiview?(0==l&&(r.uniformMatrix4fv(a.uniform.LEFT_PROJECTION_MATRIX,!1,e[0].projectionMatrix),r.uniformMatrix4fv(a.uniform.LEFT_VIEW_MATRIX,!1,e[0].viewMatrix),r.uniformMatrix4fv(a.uniform.RIGHT_PROJECTION_MATRIX,!1,e[1].projectionMatrix),r.uniformMatrix4fv(a.uniform.RIGHT_VIEW_MATRIX,!1,e[1].viewMatrix)),r.uniform3fv(a.uniform.CAMERA_POSITION,this._cameraPositions[l]),r.uniform1i(a.uniform.EYE_INDEX,d.eyeIndex)):(r.uniformMatrix4fv(a.uniform.PROJECTION_MATRIX,!1,d.projectionMatrix),r.uniformMatrix4fv(a.uniform.VIEW_MATRIX,!1,d.viewMatrix),r.uniform3fv(a.uniform.CAMERA_POSITION,this._cameraPositions[l]),r.uniform1i(a.uniform.EYE_INDEX,d.eyeIndex))}var f,h=kr(c._instances);try{for(h.s();!(f=h.n()).done;){var m=f.value;m._activeFrameId==this._frameId&&(r.uniformMatrix4fv(a.uniform.MODEL_MATRIX,!1,m.worldMatrix),c._indexBuffer?r.drawElements(c._mode,c._elementCount,c._indexType,c._indexByteOffset):r.drawArrays(c._mode,0,c._elementCount))}}catch(v){h.e(v)}finally{h.f()}if(this._multiview)break}}}}catch(v){o.e(v)}finally{o.f()}}},{key:"_getRenderTexture",value:function(e){var t=this;if(!e)return null;var n=e.textureKey;if(!n)throw new Error("Texure does not have a valid key");if(n in this._textureCache)return this._textureCache[n];var r=this._gl,a=r.createTexture(),i=new ci(a);return this._textureCache[n]=i,e instanceof Ka?(r.bindTexture(r.TEXTURE_2D,a),r.texImage2D(r.TEXTURE_2D,0,e.format,e.width,e.height,0,e.format,e._type,e._data),this._setSamplerParameters(e),i._complete=!0):e.waitForComplete().then((function(){r.bindTexture(r.TEXTURE_2D,a),r.texImage2D(r.TEXTURE_2D,0,e.format,e.format,r.UNSIGNED_BYTE,e.source),t._setSamplerParameters(e),i._complete=!0,e instanceof Ga&&e._video.addEventListener("playing",(function(){i._activeCallback=function(){e._video.paused||e._video.waiting||(r.bindTexture(r.TEXTURE_2D,a),r.texImage2D(r.TEXTURE_2D,0,e.format,e.format,r.UNSIGNED_BYTE,e.source))}}))})),i}},{key:"_setSamplerParameters",value:function(e){var t=this._gl,n=e.sampler,r=ti(e.width)&&ti(e.height),a=r&&e.mipmap;a&&t.generateMipmap(t.TEXTURE_2D);var i=n.minFilter||(a?t.LINEAR_MIPMAP_LINEAR:t.LINEAR),s=n.wrapS||(r?t.REPEAT:t.CLAMP_TO_EDGE),o=n.wrapT||(r?t.REPEAT:t.CLAMP_TO_EDGE);t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,n.magFilter||t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,i),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,s),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,o)}},{key:"_getProgramKey",value:function(e,t){var n="".concat(e,":");for(var r in t)n+="".concat(r,"=").concat(t[r],",");return n}},{key:"_getMaterialProgram",value:function(e,t){var n=this,r=this._multiview,a=e.materialName,i=r?e.vertexSourceMultiview:e.vertexSource,s=r?e.fragmentSourceMultiview:e.fragmentSource;if(null==a)throw new Error("Material does not have a name");if(null==i)throw new Error('Material "'.concat(a,'" does not have a vertex source'));if(null==s)throw new Error('Material "'.concat(a,'" does not have a fragment source'));var o=e.getProgramDefines(t),c=this._getProgramKey(a,o);if(c in this._programCache)return this._programCache[c];var u=i;u+=r?"\nuniform mat4 LEFT_PROJECTION_MATRIX, LEFT_VIEW_MATRIX, RIGHT_PROJECTION_MATRIX, RIGHT_VIEW_MATRIX, MODEL_MATRIX;\nvoid main() {\n  gl_Position = vertex_main(LEFT_PROJECTION_MATRIX, LEFT_VIEW_MATRIX, RIGHT_PROJECTION_MATRIX, RIGHT_VIEW_MATRIX, MODEL_MATRIX);\n}\n":"\nuniform mat4 PROJECTION_MATRIX, VIEW_MATRIX, MODEL_MATRIX;\n\nvoid main() {\n  gl_Position = vertex_main(PROJECTION_MATRIX, VIEW_MATRIX, MODEL_MATRIX);\n}\n";var l=(s.match(ei)?"":"precision ".concat(this._defaultFragPrecision," float;\n"))+s;l+=r?"\nout vec4 color;\nvoid main() {\n  color = fragment_main();\n}\n":"\nvoid main() {\n  gl_FragColor = fragment_main();\n}\n";var d=new Ua(this._gl,u,l,Qa,o);return this._programCache[c]=d,d.onNextUse((function(t){for(var r=0;r<e._samplers.length;++r){var a=e._samplers[r],i=t.uniform[a._uniformName];i&&n._gl.uniform1i(i,r)}})),d}},{key:"_bindPrimitive",value:function(e,t){var n=this._gl;if(t!=e._attributeMask)for(var r in Qa)e._attributeMask&$a[r]?n.enableVertexAttribArray(Qa[r]):n.disableVertexAttribArray(Qa[r]);var a,i=kr(e._attributeBuffers);try{for(i.s();!(a=i.n()).done;){var s=a.value;n.bindBuffer(n.ARRAY_BUFFER,s._buffer._buffer);var o,c=kr(s._attributes);try{for(c.s();!(o=c.n()).done;){var u=o.value;n.vertexAttribPointer(u._attrib_index,u._componentCount,u._componentType,u._normalized,u._stride,u._byteOffset)}}catch(l){c.e(l)}finally{c.f()}}}catch(l){i.e(l)}finally{i.f()}e._indexBuffer?n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,e._indexBuffer._buffer):n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,null)}},{key:"_bindMaterialState",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=this._gl,r=e._state,a=t?t._state:~r;if(r!=a){if(e._capsDiff(a)){ui(n,n.CULL_FACE,Lr,a,r),ui(n,n.BLEND,Ar,a,r),ui(n,n.DEPTH_TEST,Fr,a,r),ui(n,n.STENCIL_TEST,Nr,a,r);var i=(r&Br)-(a&Br);if(i){var s=i>1;this._colorMaskNeedsReset=!s,n.colorMask(s,s,s,s)}var o=(r&Ur)-(a&Ur);o&&(this._depthMaskNeedsReset=!(o>1),n.depthMask(o>1));var c=(r&zr)-(a&zr);c&&n.stencilMask(c>1)}e._blendDiff(a)&&n.blendFunc(e.blendFuncSrc,e.blendFuncDst),e._depthFuncDiff(a)&&n.depthFunc(e.depthFunc)}}}]),e}(),hi=Pt((function e(t,n,r,a,i,s){St(this,e),this.name=t,this.buffer=n,this.componentCount=r||3,this.componentType=a||5126,this.stride=i||0,this.byteOffset=s||0,this.normalized=!1})),mi=function(){function e(t,n,r){St(this,e),this.attributes=t||[],this.elementCount=n||0,this.mode=r||4,this.indexBuffer=null,this.indexByteOffset=0,this.indexType=0,this._min=null,this._max=null}return Pt(e,[{key:"setIndexBuffer",value:function(e,t,n){this.indexBuffer=e,this.indexByteOffset=t||0,this.indexType=n||5123}},{key:"setBounds",value:function(e,t){this._min=da(e),this._max=da(t)}}]),e}(),vi="\n#define M_PI 3.14159265\n\nuniform vec4 baseColorFactor;\n#ifdef USE_BASE_COLOR_MAP\nuniform sampler2D baseColorTex;\n#endif\n\nvarying vec3 vLight;\nvarying vec3 vView;\nvarying vec2 vTex;\n\n#ifdef USE_VERTEX_COLOR\nvarying vec4 vCol;\n#endif\n\n#ifdef USE_NORMAL_MAP\nuniform sampler2D normalTex;\nvarying mat3 vTBN;\n#else\nvarying vec3 vNorm;\n#endif\n\n#ifdef USE_METAL_ROUGH_MAP\nuniform sampler2D metallicRoughnessTex;\n#endif\nuniform vec2 metallicRoughnessFactor;\n\n#ifdef USE_OCCLUSION\nuniform sampler2D occlusionTex;\nuniform float occlusionStrength;\n#endif\n\n#ifdef USE_EMISSIVE_TEXTURE\nuniform sampler2D emissiveTex;\n#endif\nuniform vec3 emissiveFactor;\n\nuniform vec3 LIGHT_COLOR;\n\nconst vec3 dielectricSpec = vec3(0.04);\nconst vec3 black = vec3(0.0);\n\n".concat("\nvec3 lambertDiffuse(vec3 cDiff) {\n  return cDiff / M_PI;\n}\n\nfloat specD(float a, float nDotH) {\n  float aSqr = a * a;\n  float f = ((nDotH * nDotH) * (aSqr - 1.0) + 1.0);\n  return aSqr / (M_PI * f * f);\n}\n\nfloat specG(float roughness, float nDotL, float nDotV) {\n  float k = (roughness + 1.0) * (roughness + 1.0) / 8.0;\n  float gl = nDotL / (nDotL * (1.0 - k) + k);\n  float gv = nDotV / (nDotV * (1.0 - k) + k);\n  return gl * gv;\n}\n\nvec3 specF(float vDotH, vec3 F0) {\n  float exponent = (-5.55473 * vDotH - 6.98316) * vDotH;\n  float base = 2.0;\n  return F0 + (1.0 - F0) * pow(base, exponent);\n}","\n\nvec4 fragment_main() {\n#ifdef USE_BASE_COLOR_MAP\n  vec4 baseColor = texture2D(baseColorTex, vTex) * baseColorFactor;\n#else\n  vec4 baseColor = baseColorFactor;\n#endif\n\n#ifdef USE_VERTEX_COLOR\n  baseColor *= vCol;\n#endif\n\n#ifdef USE_NORMAL_MAP\n  vec3 n = texture2D(normalTex, vTex).rgb;\n  n = normalize(vTBN * (2.0 * n - 1.0));\n#else\n  vec3 n = normalize(vNorm);\n#endif\n\n#ifdef FULLY_ROUGH\n  float metallic = 0.0;\n#else\n  float metallic = metallicRoughnessFactor.x;\n#endif\n\n  float roughness = metallicRoughnessFactor.y;\n\n#ifdef USE_METAL_ROUGH_MAP\n  vec4 metallicRoughness = texture2D(metallicRoughnessTex, vTex);\n  metallic *= metallicRoughness.b;\n  roughness *= metallicRoughness.g;\n#endif\n  \n  vec3 l = normalize(vLight);\n  vec3 v = normalize(vView);\n  vec3 h = normalize(l+v);\n\n  float nDotL = clamp(dot(n, l), 0.001, 1.0);\n  float nDotV = abs(dot(n, v)) + 0.001;\n  float nDotH = max(dot(n, h), 0.0);\n  float vDotH = max(dot(v, h), 0.0);\n\n  // From GLTF Spec\n  vec3 cDiff = mix(baseColor.rgb * (1.0 - dielectricSpec.r), black, metallic); // Diffuse color\n  vec3 F0 = mix(dielectricSpec, baseColor.rgb, metallic); // Specular color\n  float a = roughness * roughness;\n\n#ifdef FULLY_ROUGH\n  vec3 specular = F0 * 0.45;\n#else\n  vec3 F = specF(vDotH, F0);\n  float D = specD(a, nDotH);\n  float G = specG(roughness, nDotL, nDotV);\n  vec3 specular = (D * F * G) / (4.0 * nDotL * nDotV);\n#endif\n  float halfLambert = dot(n, l) * 0.5 + 0.5;\n  halfLambert *= halfLambert;\n\n  vec3 color = (halfLambert * LIGHT_COLOR * lambertDiffuse(cDiff)) + specular;\n\n#ifdef USE_OCCLUSION\n  float occlusion = texture2D(occlusionTex, vTex).r;\n  color = mix(color, color * occlusion, occlusionStrength);\n#endif\n  \n  vec3 emissive = emissiveFactor;\n#ifdef USE_EMISSIVE_TEXTURE\n  emissive *= texture2D(emissiveTex, vTex).rgb;\n#endif\n  color += emissive;\n\n  // gamma correction\n  //color = pow(color, vec3(1.0/2.2));\n\n  return vec4(color, baseColor.a);\n}"),gi=function(e){mn(n,e);var t=_n(n);function n(){var e;return St(this,n),(e=t.call(this)).baseColor=e.defineSampler("baseColorTex"),e.metallicRoughness=e.defineSampler("metallicRoughnessTex"),e.normal=e.defineSampler("normalTex"),e.occlusion=e.defineSampler("occlusionTex"),e.emissive=e.defineSampler("emissiveTex"),e.baseColorFactor=e.defineUniform("baseColorFactor",[1,1,1,1]),e.metallicRoughnessFactor=e.defineUniform("metallicRoughnessFactor",[1,1]),e.occlusionStrength=e.defineUniform("occlusionStrength",1),e.emissiveFactor=e.defineUniform("emissiveFactor",[0,0,0]),e}return Pt(n,[{key:"materialName",get:function(){return"PBR"}},{key:"vertexSource",get:function(){return"\nattribute vec3 POSITION, NORMAL;\nattribute vec2 TEXCOORD_0, TEXCOORD_1;\n\nuniform vec3 CAMERA_POSITION;\nuniform vec3 LIGHT_DIRECTION;\n\nvarying vec3 vLight; // Vector from vertex to light.\nvarying vec3 vView; // Vector from vertex to camera.\nvarying vec2 vTex;\n\n#ifdef USE_NORMAL_MAP\nattribute vec4 TANGENT;\nvarying mat3 vTBN;\n#else\nvarying vec3 vNorm;\n#endif\n\n#ifdef USE_VERTEX_COLOR\nattribute vec4 COLOR_0;\nvarying vec4 vCol;\n#endif\n\nvec4 vertex_main(mat4 proj, mat4 view, mat4 model) {\n  vec3 n = normalize(vec3(model * vec4(NORMAL, 0.0)));\n#ifdef USE_NORMAL_MAP\n  vec3 t = normalize(vec3(model * vec4(TANGENT.xyz, 0.0)));\n  vec3 b = cross(n, t) * TANGENT.w;\n  vTBN = mat3(t, b, n);\n#else\n  vNorm = n;\n#endif\n\n#ifdef USE_VERTEX_COLOR\n  vCol = COLOR_0;\n#endif\n\n  vTex = TEXCOORD_0;\n  vec4 mPos = model * vec4(POSITION, 1.0);\n  vLight = -LIGHT_DIRECTION;\n  vView = CAMERA_POSITION - mPos.xyz;\n  return proj * view * mPos;\n}"}},{key:"fragmentSource",get:function(){return vi}},{key:"getProgramDefines",value:function(e){var t={};return e._attributeMask&$a.COLOR_0&&(t.USE_VERTEX_COLOR=1),e._attributeMask&$a.TEXCOORD_0&&(this.baseColor.texture&&(t.USE_BASE_COLOR_MAP=1),this.normal.texture&&e._attributeMask&$a.TANGENT&&(t.USE_NORMAL_MAP=1),this.metallicRoughness.texture&&(t.USE_METAL_ROUGH_MAP=1),this.occlusion.texture&&(t.USE_OCCLUSION=1),this.emissive.texture&&(t.USE_EMISSIVE_TEXTURE=1)),this.metallicRoughness.texture&&e._attributeMask&$a.TEXCOORD_0||1!=this.metallicRoughnessFactor.value[1]||(t.FULLY_ROUGH=1),t}}]),n}(ia),bi=WebGLRenderingContext,yi=1313821514,_i=5130562;function wi(e){return!!e.match(/^data:/)}function ki(e,t){return function(e){var t=new RegExp("^"+window.location.protocol,"i");return!!e.match(t)}(e)||wi(e)?e:t+e}function xi(e){switch(e){case"SCALAR":return 1;case"VEC2":return 2;case"VEC3":return 3;case"VEC4":return 4;default:return 0}}var Si=function(){function e(t){St(this,e),this.renderer=t,this._gl=t._gl}return Pt(e,[{key:"loadFromUrl",value:function(e){var t=this;return fetch(e).then((function(n){var r=e.lastIndexOf("/"),a=0!==r?e.substring(0,r+1):"";if(e.endsWith(".gltf"))return n.json().then((function(e){return t.loadFromJson(e,a)}));if(e.endsWith(".glb"))return n.arrayBuffer().then((function(e){return t.loadFromBinary(e,a)}));throw new Error("Unrecognized file extension")}))}},{key:"loadFromBinary",value:function(e,t){var n=new DataView(e,0,12),r=n.getUint32(0,!0),a=n.getUint32(4,!0),i=n.getUint32(8,!0);if(1179937895!=r)throw new Error("Invalid magic string in binary header.");if(2!=a)throw new Error("Incompatible version in binary header.");for(var s={},o=12;o<i;){var c=new DataView(e,o,8),u=c.getUint32(0,!0);s[c.getUint32(4,!0)]=e.slice(o+8,o+8+u),o+=u+8}if(!s[yi])throw new Error("File contained no json chunk.");var l=new TextDecoder("utf-8").decode(s[yi]),d=JSON.parse(l);return this.loadFromJson(d,t,s[_i])}},{key:"loadFromJson",value:function(e,t,n){if(!e.asset)throw new Error("Missing asset description.");if("2.0"!=e.asset.minVersion&&"2.0"!=e.asset.version)throw new Error("Incompatible asset version.");var r=[];if(n)r[0]=new Ci({},t,n);else{var a,i=kr(e.buffers);try{for(i.s();!(a=i.n()).done;){var s=a.value;r.push(new Ci(s,t))}}catch(ee){i.e(ee)}finally{i.f()}}var o,c=[],u=kr(e.bufferViews);try{for(u.s();!(o=u.n()).done;){var l=o.value;c.push(new Pi(l,r))}}catch(ee){u.e(ee)}finally{u.f()}var d=[];if(e.images){var p,f=kr(e.images);try{for(f.s();!(p=f.n()).done;){var h=p.value;d.push(new Ci(h,t))}}catch(ee){f.e(ee)}finally{f.f()}}var m=[];if(e.textures){var v,g=kr(e.textures);try{for(g.s();!(v=g.n()).done;){var b=v.value,y=d[b.source].texture(c);if(b.sampler){var _=_[b.sampler];y.sampler.minFilter=_.minFilter,y.sampler.magFilter=_.magFilter,y.sampler.wrapS=_.wrapS,y.sampler.wrapT=_.wrapT}m.push(y)}}catch(ee){g.e(ee)}finally{g.f()}}function w(e){return e?m[e.index]:null}var k=[];if(e.materials){var x,S=kr(e.materials);try{for(S.s();!(x=S.n()).done;){var R=x.value,P=new gi,C=R.pbrMetallicRoughness||{};switch(P.baseColorFactor.value=C.baseColorFactor||[1,1,1,1],P.baseColor.texture=w(C.baseColorTexture),P.metallicRoughnessFactor.value=[C.metallicFactor||1,C.roughnessFactor||1],P.metallicRoughness.texture=w(C.metallicRoughnessTexture),P.normal.texture=w(R.normalTexture),P.occlusion.texture=w(R.occlusionTexture),P.occlusionStrength.value=R.occlusionTexture&&R.occlusionTexture.strength?R.occlusionTexture.strength:1,P.emissiveFactor.value=R.emissiveFactor||[0,0,0],P.emissive.texture=w(R.emissiveTexture),!P.emissive.texture&&R.emissiveFactor&&(P.emissive.texture=new Xa(1,1,1,1)),R.alphaMode){case"BLEND":case"MASK":P.state.blend=!0;break;default:P.state.blend=!1}P.state.cullFace=!R.doubleSided,k.push(P)}}catch(ee){S.e(ee)}finally{S.f()}}var T,E=e.accessors,O=[],M=kr(e.meshes);try{for(M.s();!(T=M.n()).done;){var I=T.value,D=new Ri;O.push(D);var j,L=kr(I.primitives);try{for(L.s();!(j=L.n()).done;){var A=j.value,F=null;F="material"in A?k[A.material]:new gi;var N=[],B=0,U=null,z=null;for(var V in A.attributes){var H=E[A.attributes[V]],W=c[H.bufferView];B=H.count;var q=new hi(V,W.renderBuffer(this.renderer,bi.ARRAY_BUFFER),xi(H.type),H.componentType,W.byteStride||0,H.byteOffset||0);q.normalized=H.normalized||!1,"POSITION"==V&&(U=H.min,z=H.max),N.push(q)}var G=new mi(N,B,A.mode);if("indices"in A){var K=E[A.indices],X=c[K.bufferView];G.setIndexBuffer(X.renderBuffer(this.renderer,bi.ELEMENT_ARRAY_BUFFER),K.byteOffset||0,K.componentType),G.indexType=K.componentType,G.indexByteOffset=K.byteOffset||0,G.elementCount=K.count}U&&z&&G.setBounds(U,z),D.primitives.push(this.renderer.createRenderPrimitive(G,F))}}catch(ee){L.e(ee)}finally{L.f()}}}catch(ee){M.e(ee)}finally{M.f()}var Q,$=new Ba,J=kr(e.scenes[e.scene].nodes);try{for(J.s();!(Q=J.n()).done;){var Y=Q.value,Z=e.nodes[Y];$.addNode(this.processNodes(Z,e.nodes,O))}}catch(ee){J.e(ee)}finally{J.f()}return $}},{key:"processNodes",value:function(e,t,n){var r=new Ba;if(r.name=e.name,"mesh"in e){var a,i=kr(n[e.mesh].primitives);try{for(i.s();!(a=i.n()).done;){var s=a.value;r.addRenderPrimitive(s)}}catch(l){i.e(l)}finally{i.f()}}if(e.matrix?r.matrix=new Float32Array(e.matrix):(e.translation||e.rotation||e.scale)&&(e.translation&&(r.translation=new Float32Array(e.translation)),e.rotation&&(r.rotation=new Float32Array(e.rotation)),e.scale&&(r.scale=new Float32Array(e.scale))),e.children){var o,c=kr(e.children);try{for(c.s();!(o=c.n()).done;){var u=t[o.value];r.addNode(this.processNodes(u,t,n))}}catch(l){c.e(l)}finally{c.f()}}return r}}]),e}(),Ri=Pt((function e(){St(this,e),this.primitives=[]})),Pi=function(){function e(t,n){St(this,e),this.buffer=n[t.buffer],this.byteOffset=t.byteOffset||0,this.byteLength=t.byteLength||null,this.byteStride=t.byteStride,this._viewPromise=null,this._renderBuffer=null}return Pt(e,[{key:"dataView",value:function(){var e=this;return this._viewPromise||(this._viewPromise=this.buffer.arrayBuffer().then((function(t){return new DataView(t,e.byteOffset,e.byteLength)}))),this._viewPromise}},{key:"renderBuffer",value:function(e,t){return this._renderBuffer||(this._renderBuffer=e.createRenderBuffer(t,this.dataView())),this._renderBuffer}}]),e}(),Ci=function(){function e(t,n,r){St(this,e),this.json=t,this.baseUrl=n,this._dataPromise=null,this._texture=null,r&&(this._dataPromise=Promise.resolve(r))}return Pt(e,[{key:"arrayBuffer",value:function(){if(!this._dataPromise){if(wi(this.json.uri)){var e=this.json.uri.replace("data:application/octet-stream;base64,",""),t=Uint8Array.from(atob(e),(function(e){return e.charCodeAt(0)}));return this._dataPromise=Promise.resolve(t.buffer),this._dataPromise}this._dataPromise=fetch(ki(this.json.uri,this.baseUrl)).then((function(e){return e.arrayBuffer()}))}return this._dataPromise}},{key:"texture",value:function(e){var t=this;if(!this._texture){var n=new Image;if(this._texture=new qa(n),this.json.uri)wi(this.json.uri)?n.src=this.json.uri:n.src="".concat(this.baseUrl).concat(this.json.uri);else this._texture.genDataKey(),e[this.json.bufferView].dataView().then((function(e){var r=new Blob([e],{type:t.json.mimeType});n.src=window.URL.createObjectURL(r)}))}return this._texture}}]),e}(),Ti=new WeakMap,Ei=function(e){mn(n,e);var t=_n(n);function n(e){var r;return St(this,n),(r=t.call(this))._url=e.url,r._promise=null,r._resolver=null,r._rejecter=null,r}return Pt(n,[{key:"onRendererChanged",value:function(e){var t=this,n=Ti.get(e);n||(n=new Si(e),Ti.set(e,n)),!this._resolver&&this._promise&&(this._promise=null),this._ensurePromise(),n.loadFromUrl(this._url).then((function(e){t.addNode(e),t._resolver(e.waitForComplete()),t._resolver=null,t._rejecter=null})).catch((function(e){t._rejecter(e),t._resolver=null,t._rejecter=null}))}},{key:"_ensurePromise",value:function(){var e=this;return this._promise||(this._promise=new Promise((function(t,n){e._resolver=t,e._rejecter=n}))),this._promise}},{key:"waitForComplete",value:function(){return this._ensurePromise()}}]),n}(Ba),Oi={Handedness:Object.freeze({NONE:"none",LEFT:"left",RIGHT:"right"}),ComponentState:Object.freeze({DEFAULT:"default",TOUCHED:"touched",PRESSED:"pressed"}),ComponentProperty:Object.freeze({BUTTON:"button",X_AXIS:"xAxis",Y_AXIS:"yAxis",STATE:"state"}),ComponentType:Object.freeze({TRIGGER:"trigger",SQUEEZE:"squeeze",TOUCHPAD:"touchpad",THUMBSTICK:"thumbstick",BUTTON:"button"}),ButtonTouchThreshold:.05,AxisTouchThreshold:.1,VisualResponseProperty:Object.freeze({TRANSFORM:"transform",VISIBILITY:"visibility"})};function Mi(e){return Ii.apply(this,arguments)}function Ii(){return(Ii=Sr(wr().mark((function e(t){var n;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(t);case 2:if((n=e.sent).ok){e.next=7;break}throw new Error(n.statusText);case 7:return e.abrupt("return",n.json());case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Di(e){return ji.apply(this,arguments)}function ji(){return(ji=Sr(wr().mark((function e(t){var n;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}throw new Error("No basePath supplied");case 2:return"profilesList.json",e.next=5,Mi("".concat(t,"/").concat("profilesList.json"));case 5:return n=e.sent,e.abrupt("return",n);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Li(){return Li=Sr(wr().mark((function e(t,n){var r,a,i,s,o,c,u,l,d=arguments;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=d.length>2&&void 0!==d[2]?d[2]:null,a=!(d.length>3&&void 0!==d[3])||d[3],t){e.next=4;break}throw new Error("No xrInputSource supplied");case 4:if(n){e.next=6;break}throw new Error("No basePath supplied");case 6:return e.next=8,Di(n);case 8:if(i=e.sent,t.profiles.some((function(e){var t=i[e];return t&&(s={profileId:e,profilePath:"".concat(n,"/").concat(t.path),deprecated:!!t.deprecated}),!!s})),s){e.next=17;break}if(r){e.next=13;break}throw new Error("No matching profile name found");case 13:if(o=i[r]){e.next=16;break}throw new Error('No matching profile name found and default profile "'.concat(r,'" missing.'));case 16:s={profileId:r,profilePath:"".concat(n,"/").concat(o.path),deprecated:!!o.deprecated};case 17:return e.next=19,Mi(s.profilePath);case 19:if(c=e.sent,!a){e.next=25;break}if(l="any"===t.handedness?c.layouts[Object.keys(c.layouts)[0]]:c.layouts[t.handedness]){e.next=24;break}throw new Error("No matching handedness, ".concat(t.handedness,", in profile ").concat(s.profileId));case 24:l.assetPath&&(u=s.profilePath.replace("profile.json",l.assetPath));case 25:return e.abrupt("return",{profile:c,assetPath:u});case 26:case"end":return e.stop()}}),e)}))),Li.apply(this,arguments)}Oi.ComponentState.DEFAULT;var Ai=WebGLRenderingContext,Fi=new Uint8Array([255,255,255,1,255,255,255,2,191,191,191,4,204,204,204,5,219,219,219,7,204,204,204,10,216,216,216,13,210,210,210,17,206,206,206,21,206,206,206,26,206,206,206,31,205,205,205,36,200,200,200,42,201,201,201,47,201,201,201,52,201,201,201,57,201,201,201,61,200,200,200,65,203,203,203,68,238,238,238,135,250,250,250,200,249,249,249,201,249,249,249,201,250,250,250,201,250,250,250,201,249,249,249,201,249,249,249,201,250,250,250,200,238,238,238,135,203,203,203,68,200,200,200,65,201,201,201,61,201,201,201,57,201,201,201,52,201,201,201,47,200,200,200,42,205,205,205,36,206,206,206,31,206,206,206,26,206,206,206,21,210,210,210,17,216,216,216,13,204,204,204,10,219,219,219,7,204,204,204,5,191,191,191,4,255,255,255,2,255,255,255,1]),Ni=[1,1,1,.25],Bi=.004,Ui=[1,1,1,1],zi=[.5,.5,.5,.25],Vi={controllers:!0,lasers:!0,cursors:!0},Hi=function(e){mn(n,e);var t=_n(n);function n(){var e;return St(this,n),(e=t.call(this)).renderOrder=Zr,e.state.cullFace=!1,e.state.blend=!0,e.state.blendFuncSrc=Ai.ONE,e.state.blendFuncDst=Ai.ONE,e.state.depthMask=!1,e.laser=e.defineSampler("diffuse"),e.laser.texture=new Ka(Fi,48,1),e.laserColor=e.defineUniform("laserColor",Ni),e}return Pt(n,[{key:"materialName",get:function(){return"INPUT_LASER"}},{key:"vertexSource",get:function(){return"\n    attribute vec3 POSITION;\n    attribute vec2 TEXCOORD_0;\n\n    varying vec2 vTexCoord;\n\n    vec4 vertex_main(mat4 proj, mat4 view, mat4 model) {\n      vTexCoord = TEXCOORD_0;\n      return proj * view * model * vec4(POSITION, 1.0);\n    }"}},{key:"fragmentSource",get:function(){return"\n    precision mediump float;\n\n    uniform vec4 laserColor;\n    uniform sampler2D diffuse;\n    varying vec2 vTexCoord;\n\n    const float fadePoint = ".concat(.5335,";\n    const float fadeEnd = ").concat(.535,";\n\n    vec4 fragment_main() {\n      vec2 uv = vTexCoord;\n      float front_fade_factor = 1.0 - clamp(1.0 - (uv.y - fadePoint) / (1.0 - fadePoint), 0.0, 1.0);\n      float back_fade_factor = clamp((uv.y - fadePoint) / (fadeEnd - fadePoint), 0.0, 1.0);\n      vec4 color = laserColor * texture2D(diffuse, vTexCoord);\n      float opacity = color.a * front_fade_factor * back_fade_factor;\n      return vec4(color.rgb * opacity, opacity);\n    }")}}]),n}(ia),Wi="\nattribute vec4 POSITION;\n\nvarying float vLuminance;\nvarying float vOpacity;\n\nvec4 vertex_main(mat4 proj, mat4 view, mat4 model) {\n  vLuminance = POSITION.z;\n  vOpacity = POSITION.w;\n\n  // Billboarded, constant size vertex transform.\n  vec4 screenPos = proj * view * model * vec4(0.0, 0.0, 0.0, 1.0);\n  screenPos /= screenPos.w;\n  screenPos.xy += POSITION.xy;\n  return screenPos;\n}",qi="\nprecision mediump float;\n\nuniform vec4 cursorColor;\nvarying float vLuminance;\nvarying float vOpacity;\n\nvec4 fragment_main() {\n  vec3 color = cursorColor.rgb * vLuminance;\n  float opacity = cursorColor.a * vOpacity;\n  return vec4(color * opacity, opacity);\n}",Gi=function(e){mn(n,e);var t=_n(n);function n(){var e;return St(this,n),(e=t.call(this)).renderOrder=Zr,e.state.cullFace=!1,e.state.blend=!0,e.state.blendFuncSrc=Ai.ONE,e.state.depthMask=!1,e.cursorColor=e.defineUniform("cursorColor",Ui),e}return Pt(n,[{key:"materialName",get:function(){return"INPUT_CURSOR"}},{key:"vertexSource",get:function(){return Wi}},{key:"fragmentSource",get:function(){return qi}}]),n}(ia),Ki=function(e){mn(n,e);var t=_n(n);function n(){var e;return St(this,n),(e=t.call(this)).renderOrder=Zr,e.state.cullFace=!1,e.state.blend=!0,e.state.blendFuncSrc=Ai.ONE,e.state.depthFunc=Ai.GEQUAL,e.state.depthMask=!1,e.cursorColor=e.defineUniform("cursorColor",zi),e}return Pt(n,[{key:"materialName",get:function(){return"INPUT_CURSOR_2"}},{key:"vertexSource",get:function(){return Wi}},{key:"fragmentSource",get:function(){return qi}}]),n}(ia),Xi=function(e){mn(n,e);var t=_n(n);function n(){var e;return St(this,n),(e=t.call(this))._maxInputElements=32,e._controllers=null,e._lasers=null,e._cursors=null,e._activeControllers=0,e._activeLasers=0,e._activeCursors=0,e._blurred=!1,e}return Pt(n,[{key:"onRendererChanged",value:function(e){this._controllers=null,this._lasers=null,this._cursors=null,this._activeControllers=0,this._activeLasers=0,this._activeCursors=0}},{key:"useProfileControllerMeshes",value:function(e){var t=this;e.addEventListener("inputsourceschange",(function(e){var n,r=kr(e.added);try{var a=function(){var e=n.value;"tracked-pointer"==e.targetRayMode&&function(e,t){return Li.apply(this,arguments)}(e,"https://cdn.jsdelivr.net/npm/@webxr-input-profiles/assets@1.0/dist/profiles").then((function(n){n.profile;var r=n.assetPath;t.setControllerMesh(new Ei({url:r}),e.handedness)}))};for(r.s();!(n=r.n()).done;)a()}catch(i){r.e(i)}finally{r.f()}})),e.addEventListener("visibilitychange",(function(e){"visible-blurred"===e.session.visibilityState?t._blurred=!0:"visible"===e.session.visibilityState&&(t._blurred=!1)}))}},{key:"setControllerMesh",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"right";this._controllers||(this._controllers={}),this._controllers[t]={nodes:[e],activeCount:0},e.visible=!1,this.addNode(e)}},{key:"addController",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"right";if(this._controllers&&!this._blurred){var n=this._controllers[t];if(n){var r=null;n.activeCount<n.nodes.length?r=n.nodes[n.activeCount]:(r=n.nodes[0].clone(),this.addNode(r),n.nodes.push(r)),n.activeCount=(n.activeCount+1)%this._maxInputElements,r.matrix=e,r.visible=!0}}}},{key:"addLaserPointer",value:function(e){if(!this._blurred){!this._lasers&&this._renderer&&(this._lasers=[this._createLaserMesh()],this.addNode(this._lasers[0]));var t=null;this._activeLasers<this._lasers.length?t=this._lasers[this._activeLasers]:(t=this._lasers[0].clone(),this.addNode(t),this._lasers.push(t)),this._activeLasers=(this._activeLasers+1)%this._maxInputElements,t.matrix=e.matrix,t.visible=!0}}},{key:"addCursor",value:function(e){if(!this._blurred){!this._cursors&&this._renderer&&(this._cursors=[this._createCursorMesh()],this.addNode(this._cursors[0]));var t=null;this._activeCursors<this._cursors.length?t=this._cursors[this._activeCursors]:(t=this._cursors[0].clone(),this.addNode(t),this._cursors.push(t)),this._activeCursors=(this._activeCursors+1)%this._maxInputElements,t.translation=e,t.visible=!0}}},{key:"reset",value:function(e){if(e||(e=Vi),this._controllers&&e.controllers)for(var t in this._controllers){var n=this._controllers[t];n.activeCount=0;var r,a=kr(n.nodes);try{for(a.s();!(r=a.n()).done;){r.value.visible=!1}}catch(u){a.e(u)}finally{a.f()}}if(this._lasers&&e.lasers){var i,s=kr(this._lasers);try{for(s.s();!(i=s.n()).done;){i.value.visible=!1}}catch(u){s.e(u)}finally{s.f()}this._activeLasers=0}if(this._cursors&&e.cursors){var o,c=kr(this._cursors);try{for(c.s();!(o=c.n()).done;){o.value.visible=!1}}catch(u){c.e(u)}finally{c.f()}this._activeCursors=0}}},{key:"_createLaserMesh",value:function(){var e=this._renderer._gl,t=.005,n=[0,t,0,0,1,0,t,-1,0,0,0,-t,0,1,1,0,-t,-1,1,0,t,0,0,0,1,t,0,-1,0,0,-t,0,0,1,1,-t,0,-1,1,0,0,-t,0,0,1,0,-t,-1,0,0,0,t,0,1,1,0,t,-1,1,0,-t,0,0,0,1,-t,0,-1,0,0,t,0,0,1,1,t,0,-1,1,0],r=[0,1,2,1,3,2,4,5,6,5,7,6,8,9,10,9,11,10,12,13,14,13,15,14],a=this._renderer.createRenderBuffer(e.ARRAY_BUFFER,new Float32Array(n)),i=this._renderer.createRenderBuffer(e.ELEMENT_ARRAY_BUFFER,new Uint16Array(r)),s=r.length,o=[new hi("POSITION",a,3,e.FLOAT,20,0),new hi("TEXCOORD_0",a,2,e.FLOAT,20,12)],c=new mi(o,s);c.setIndexBuffer(i);var u=new Hi,l=this._renderer.createRenderPrimitive(c,u),d=new Ba;return d.addRenderPrimitive(l),d}},{key:"_createCursorMesh",value:function(){for(var e=this._renderer._gl,t=[],n=[],r=2*Math.PI/16,a=0;a<16;++a){var i=a*r,s=Math.cos(i),o=Math.sin(i);t.push(s*Bi,o*Bi,1,.9),a>1&&n.push(0,a-1,a)}for(var c=0;c<16;++c){var u=c*r,l=Math.cos(u),d=Math.sin(u);if(t.push(l*Bi,d*Bi,.5,.75),t.push(.007*l,.007*d,0,0),c>0){var p=16+2*c;n.push(p-2,p-1,p),n.push(p-1,p+1,p)}}n.push(46,47,16),n.push(47,17,16);var f=this._renderer.createRenderBuffer(e.ARRAY_BUFFER,new Float32Array(t)),h=this._renderer.createRenderBuffer(e.ELEMENT_ARRAY_BUFFER,new Uint16Array(n)),m=n.length,v=[new hi("POSITION",f,4,e.FLOAT,16,0)],g=new mi(v,m);g.setIndexBuffer(h);var b=new Gi,y=new Ki,_=this._renderer.createRenderPrimitive(g,b),w=this._renderer.createRenderPrimitive(g,y),k=new Ba;return k.addRenderPrimitive(_),k.addRenderPrimitive(w),k}}]),n}(Ba);window.performance&&performance.now?performance.now.bind(performance):Date.now;var Qi=function(e){mn(n,e);var t=_n(n);function n(e,r,a){return St(this,n),t.call(this,e?e.projectionMatrix:null,e?e.transform:null,a||(r&&e?r.getViewport(e):null),e?e.eye:"left")}return Pt(n)}(ri),$i=function(e){mn(n,e);var t=_n(n);function n(){var e;return St(this,n),(e=t.call(this))._timestamp=-1,e._frameDelta=0,e._statsStanding=!1,e._stats=null,e._statsEnabled=!1,e.enableStats(!0),e._inputRenderer=null,e._resetInputEndFrame=!0,e._lastTimestamp=0,e._hoverFrame=0,e._hoveredNodes=[],e.clear=!0,e}return Pt(n,[{key:"setRenderer",value:function(e){this._setRenderer(e)}},{key:"loseRenderer",value:function(){this._renderer&&(this._stats=null,this._renderer=null,this._inputRenderer=null)}},{key:"inputRenderer",get:function(){return this._inputRenderer||(this._inputRenderer=new Xi,this.addNode(this._inputRenderer)),this._inputRenderer}},{key:"updateInputSources",value:function(e,t){var n=[],r=this._hoverFrame;this._hoverFrame++;var a,i=kr(e.session.inputSources);try{for(i.s();!(a=i.n()).done;){var s=a.value,o=e.getPose(s.targetRaySpace,t);if(o){"tracked-pointer"==s.targetRayMode&&this.inputRenderer.addLaserPointer(o.transform);var c=this.hitTest(o.transform);if(c)this.inputRenderer.addCursor(c.intersection),c.node._hoverFrameId!=r&&c.node.onHoverStart(),c.node._hoverFrameId=this._hoverFrame,n.push(c.node);else{var u=new xa(o.transform.matrix),l=pa(u.origin[0],u.origin[1],u.origin[2]);ha(l,l,[1*u.direction[0],1*u.direction[1],1*u.direction[2]]),this.inputRenderer.addCursor(l)}if(s.gripSpace){var d=e.getPose(s.gripSpace,t);d&&this.inputRenderer.addController(d.transform.matrix,s.handedness)}}}}catch(m){i.e(m)}finally{i.f()}var p,f=kr(this._hoveredNodes);try{for(f.s();!(p=f.n()).done;){var h=p.value;h._hoverFrameId!=this._hoverFrame&&h.onHoverEnd()}}catch(m){f.e(m)}finally{f.f()}this._hoveredNodes=n}},{key:"handleSelect",value:function(e,t,n){var r=t.getPose(e.targetRaySpace,n);r&&this.handleSelectPointer(r.transform)}},{key:"handleSelectPointer",value:function(e){if(e){var t=this.hitTest(e);t&&t.node.handleSelect()}}},{key:"enableStats",value:function(e){e!=this._statsEnabled&&(this._statsEnabled=e,e?this._statsStanding:e||this._stats&&(this.removeNode(this._stats),this._stats=null))}},{key:"standingStats",value:function(e){this._statsStanding=e,this._stats&&(this._statsStanding?this._stats.translation=[0,1.4,-.75]:this._stats.translation=[0,-.3,-.5],this._stats.scale=[.3,.3,.3],function(e,t,n,r){var a=.5*Math.PI/180;t*=a,n*=a,r*=a;var i=Math.sin(t),s=Math.cos(t),o=Math.sin(n),c=Math.cos(n),u=Math.sin(r),l=Math.cos(r);e[0]=i*c*l-s*o*u,e[1]=s*o*l+i*c*u,e[2]=s*c*u-i*o*l,e[3]=s*c*l+i*o*u}(this._stats.rotation,-45,0,0))}},{key:"draw",value:function(e,t,n){var r=new ri(e,t);n&&(r.eye=n),this.drawViewArray([r])}},{key:"drawXRFrame",value:function(e,t){if(this._renderer&&t){var n=this._renderer.gl,r=e.session,a=r.renderState.baseLayer;if(a?n.bindFramebuffer(n.FRAMEBUFFER,a.framebuffer):a=r.renderState.layers[0],n){a.colorTexture&&n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,a.colorTexture,0),a.depthStencilTexture&&n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,a.depthStencilTexture,0),this.clear&&n.clear(n.COLOR_BUFFER_BIT|n.DEPTH_BUFFER_BIT);var i,s=[],o=kr(t.views);try{for(o.s();!(i=o.n()).done;){var c=i.value;s.push(new Qi(c,a))}}catch(u){o.e(u)}finally{o.f()}this.drawViewArray(s)}}}},{key:"drawViewArray",value:function(e){this._renderer&&this._renderer.drawViews(e,this)}},{key:"startFrame",value:function(){var e=this._timestamp;return this._timestamp=performance.now(),this._stats&&this._stats.begin(),this._frameDelta=e>=0?this._timestamp-e:0,this._update(this._timestamp,this._frameDelta),this._frameDelta}},{key:"endFrame",value:function(){this._inputRenderer&&this._resetInputEndFrame&&this._inputRenderer.reset(),this._stats&&this._stats.end()}},{key:"onLoadScene",value:function(e){return Promise.resolve()}}]),n}(Ba),Ji=WebGLRenderingContext,Yi=function(e){mn(n,e);var t=_n(n);function n(e){var r;return St(this,n),(r=t.call(this))._video=e,console.log("video state",e.readyState),e.readyState>=2?r._promise=Promise.resolve(bn(r)):e.error?r._promise=Promise.reject(e.error):r._promise=new Promise((function(t,n){e.addEventListener("loadeddata",(function(){return t(bn(r))})),e.addEventListener("error",n)})),r}return Pt(n,[{key:"format",get:function(){return Ji.RGBA}},{key:"width",get:function(){return this._video.videoWidth}},{key:"height",get:function(){return this._video.videoHeight}},{key:"waitForComplete",value:function(){return this._promise}},{key:"textureKey",get:function(){return"webxr-rtc"}},{key:"source",get:function(){return this._video}}]),n}(Wa),Zi=function(e){mn(n,e);var t=_n(n);function n(){var e;return St(this,n),(e=t.call(this)).renderOrder=Jr,e.state.depthFunc=Ji.LEQUAL,e.state.depthMask=!1,e.image=e.defineSampler("diffuse"),e.texCoordScaleOffset=e.defineUniform("texCoordScaleOffset",[1,1,0,0,1,1,0,0],4),e}return Pt(n,[{key:"materialName",get:function(){return"VIDEOBOX"}},{key:"vertexSource",get:function(){return"\n    uniform int EYE_INDEX;\n    uniform vec4 texCoordScaleOffset[2];\n    attribute vec3 POSITION;\n    attribute vec2 TEXCOORD_0;\n    varying vec2 vTexCoord;\n\n    vec4 vertex_main(mat4 proj, mat4 view, mat4 model) {\n      vec4 scaleOffset = texCoordScaleOffset[EYE_INDEX];\n      vTexCoord = (TEXCOORD_0 * scaleOffset.xy) + scaleOffset.zw;\n      // Drop the translation portion of the view matrix\n      view[3].xyz = vec3(0.0, 0.0, 0.0);\n      vec4 out_vec = proj * view * model * vec4(POSITION, 1.0);\n\n      // Returning the W component for both Z and W forces the geometry depth to\n      // the far plane. When combined with a depth func of LEQUAL this makes the\n      // sky write to any depth fragment that has not been written to yet.\n      return out_vec.xyww;\n    }"}},{key:"fragmentSource",get:function(){return"\n    uniform sampler2D diffuse;\n    varying vec2 vTexCoord;\n\n    vec4 fragment_main() {\n      return texture2D(diffuse, vTexCoord);\n    }"}}]),n}(ia),es=function(e){mn(n,e);var t=_n(n);function n(e){var r;return St(this,n),(r=t.call(this))._url=e.video.src,r._video=e.video,r._video_texture=new Yi(r._video),r._displayMode=e.displayMode||"mono",r._rotationY=e.rotationY||Math.PI,r}return Pt(n,[{key:"onRendererChanged",value:function(e){for(var t=[],n=[],r=40,a=0;a<=40;++a)for(var i=a*Math.PI/40,s=Math.sin(i),o=Math.cos(i),c=41*a,u=41*(a+1),l=0;l<=r;++l){var d=2*l*Math.PI/r+this._rotationY,p=Math.sin(d)*s*10,f=10*o,h=-Math.cos(d)*s*10,m=l/r,v=a/40;if(t.push(p,f,h,m,v),a<40&&l<r){var g=c+l,b=u+l;n.push(g,b,g+1,b,b+1,g+1)}}var y=e.createRenderBuffer(Ji.ARRAY_BUFFER,new Float32Array(t)),_=e.createRenderBuffer(Ji.ELEMENT_ARRAY_BUFFER,new Uint16Array(n)),w=[new hi("POSITION",y,3,Ji.FLOAT,20,0),new hi("TEXCOORD_0",y,2,Ji.FLOAT,20,12)],k=new mi(w,n.length);k.setIndexBuffer(_);var x=new Zi;switch(x.image.texture=this._video_texture,this._displayMode){case"mono":x.texCoordScaleOffset.value=[1,1,0,0,1,1,0,0];break;case"stereoTopBottom":x.texCoordScaleOffset.value=[1,.5,0,0,1,.5,0,.5];break;case"stereoLeftRight":x.texCoordScaleOffset.value=[.5,1,0,0,.5,1,.5,0]}var S=e.createRenderPrimitive(k,x);this.addRenderPrimitive(S)}}]),n}(Ba),ts=.0025,ns=function(){function e(t,n){var r=this;St(this,e),this.lookYaw=0,this.lookPitch=0,this.viewerHeight=0,this.canvas=t,this.baseRefSpace=n,this.refSpace=n,this.dirty=!1,t.style.cursor="grab",t.addEventListener("mousemove",(function(e){1&e.buttons&&r.rotateView(e.movementX,e.movementY)}));var a=void 0,i=void 0,s=void 0;t.addEventListener("touchstart",(function(e){if(void 0==a){var t=e.changedTouches[0];a=t.identifier,i=t.pageX,s=t.pageY}})),t.addEventListener("touchend",(function(e){var t,n=kr(e.changedTouches);try{for(n.s();!(t=n.n()).done;){var o=t.value;a==o.identifier&&(a=void 0,r.rotateView(o.pageX-i,o.pageY-s))}}catch(c){n.e(c)}finally{n.f()}})),t.addEventListener("touchcancel",(function(e){var t,n=kr(e.changedTouches);try{for(n.s();!(t=n.n()).done;){var r=t.value;a==r.identifier&&(a=void 0)}}catch(i){n.e(i)}finally{n.f()}})),t.addEventListener("touchmove",(function(e){var t,n=kr(e.changedTouches);try{for(n.s();!(t=n.n()).done;){var o=t.value;a==o.identifier&&(r.rotateView(o.pageX-i,o.pageY-s),i=o.pageX,s=o.pageY)}}catch(c){n.e(c)}finally{n.f()}}))}return Pt(e,[{key:"setHeight",value:function(e){this.viewerHeight!=e&&(this.viewerHeight=e),this.dirty=!0}},{key:"rotateView",value:function(e,t){this.lookYaw+=e*ts,this.lookPitch+=t*ts,this.lookPitch<.5*-Math.PI&&(this.lookPitch=.5*-Math.PI),this.lookPitch>.5*Math.PI&&(this.lookPitch=.5*Math.PI),this.dirty=!0}},{key:"reset",value:function(){this.lookYaw=0,this.lookPitch=0,this.refSpace=this.baseRefSpace,this.dirty=!1}},{key:"referenceSpace",get:function(){if(this.dirty){var e=Oa();!function(e,t,n){n*=.5;var r=t[0],a=t[1],i=t[2],s=t[3],o=Math.sin(n),c=Math.cos(n);e[0]=r*c+s*o,e[1]=a*c+i*o,e[2]=i*c-a*o,e[3]=s*c-r*o}(e,e,-this.lookPitch),function(e,t,n){n*=.5;var r=t[0],a=t[1],i=t[2],s=t[3],o=Math.sin(n),c=Math.cos(n);e[0]=r*c-i*o,e[1]=a*c+s*o,e[2]=i*c+r*o,e[3]=s*c-a*o}(e,e,-this.lookYaw);var t=new XRRigidTransform({},{x:e[0],y:e[1],z:e[2],w:e[3]});this.refSpace=this.baseRefSpace.getOffsetReferenceSpace(t),t=new XRRigidTransform({y:-this.viewerHeight}),this.refSpace=this.refSpace.getOffsetReferenceSpace(t),this.dirty=!1}return this.refSpace}}]),e}();WebGLRenderingContext;function rs(e,t,n){return rs=vn()?Reflect.construct.bind():function(e,t,n){var r=[null];r.push.apply(r,t);var a=new(Function.bind.apply(e,r));return n&&_e(a,n.prototype),a},rs.apply(null,arguments)}function as(e){var t="function"===typeof Map?new Map:void 0;return as=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!==typeof e)throw new TypeError("Super expression must either be null or a function");if("undefined"!==typeof t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return rs(e,arguments,pn(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),_e(r,e)},as(e)}var is,ss,os,cs=Object.create,us=Object.defineProperty,ls=Object.defineProperties,ds=Object.getOwnPropertyDescriptor,ps=Object.getOwnPropertyDescriptors,fs=Object.getOwnPropertyNames,hs=Object.getOwnPropertySymbols,ms=Object.getPrototypeOf,vs=Object.prototype.hasOwnProperty,gs=Object.prototype.propertyIsEnumerable,bs=Math.pow,ys=function(e,t,n){return t in e?us(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n},_s=function(e,t){for(var n in t||(t={}))vs.call(t,n)&&ys(e,n,t[n]);if(hs){var r,a=kr(hs(t));try{for(a.s();!(r=a.n()).done;){n=r.value;gs.call(t,n)&&ys(e,n,t[n])}}catch(i){a.e(i)}finally{a.f()}}return e},ws=function(e,t){return ls(e,ps(t))},ks=function(e,t){return function(){return t||(0,e[fs(e)[0]])((t={exports:{}}).exports,t),t.exports}},xs=function(e,t,n){return n=null!=e?cs(ms(e)):{},function(e,t,n,r){if(t&&"object"===typeof t||"function"===typeof t){var a,i=kr(fs(t));try{var s=function(){var i=a.value;vs.call(e,i)||i===n||us(e,i,{get:function(){return t[i]},enumerable:!(r=ds(t,i))||r.enumerable})};for(i.s();!(a=i.n()).done;)s()}catch(o){i.e(o)}finally{i.f()}}return e}(!t&&e&&e.__esModule?n:us(n,"default",{value:e,enumerable:!0}),e)},Ss=function(e,t,n){return new Promise((function(r,a){var i=function(e){try{o(n.next(e))}catch(t){a(t)}},s=function(e){try{o(n.throw(e))}catch(t){a(t)}},o=function(e){return e.done?r(e.value):Promise.resolve(e.value).then(i,s)};o((n=n.apply(e,t)).next())}))},Rs=(ss={"shims/process.js":function(){is=void 0}},function(){return ss&&(os=(0,ss[fs(ss)[0]])(ss=0)),os}),Ps=ks({"../../node_modules/axios/lib/helpers/bind.js":function(e,t){Rs(),t.exports=function(e,t){return function(){for(var n=new Array(arguments.length),r=0;r<n.length;r++)n[r]=arguments[r];return e.apply(t,n)}}}}),Cs=ks({"../../node_modules/axios/lib/utils.js":function(e,t){Rs();var n=Ps(),r=Object.prototype.toString;function a(e){return"[object Array]"===r.call(e)}function i(e){return"undefined"===typeof e}function s(e){return null!==e&&"object"===typeof e}function o(e){if("[object Object]"!==r.call(e))return!1;var t=Object.getPrototypeOf(e);return null===t||t===Object.prototype}function c(e){return"[object Function]"===r.call(e)}function u(e,t){if(null!==e&&"undefined"!==typeof e)if("object"!==typeof e&&(e=[e]),a(e))for(var n=0,r=e.length;n<r;n++)t.call(null,e[n],n,e);else for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.call(null,e[i],i,e)}t.exports={isArray:a,isArrayBuffer:function(e){return"[object ArrayBuffer]"===r.call(e)},isBuffer:function(e){return null!==e&&!i(e)&&null!==e.constructor&&!i(e.constructor)&&"function"===typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)},isFormData:function(e){return"undefined"!==typeof FormData&&e instanceof FormData},isArrayBufferView:function(e){return"undefined"!==typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&e.buffer instanceof ArrayBuffer},isString:function(e){return"string"===typeof e},isNumber:function(e){return"number"===typeof e},isObject:s,isPlainObject:o,isUndefined:i,isDate:function(e){return"[object Date]"===r.call(e)},isFile:function(e){return"[object File]"===r.call(e)},isBlob:function(e){return"[object Blob]"===r.call(e)},isFunction:c,isStream:function(e){return s(e)&&c(e.pipe)},isURLSearchParams:function(e){return"undefined"!==typeof URLSearchParams&&e instanceof URLSearchParams},isStandardBrowserEnv:function(){return("undefined"===typeof navigator||"ReactNative"!==navigator.product&&"NativeScript"!==navigator.product&&"NS"!==navigator.product)&&("undefined"!==typeof window&&"undefined"!==typeof document)},forEach:u,merge:function e(){var t={};function n(n,r){o(t[r])&&o(n)?t[r]=e(t[r],n):o(n)?t[r]=e({},n):a(n)?t[r]=n.slice():t[r]=n}for(var r=0,i=arguments.length;r<i;r++)u(arguments[r],n);return t},extend:function(e,t,r){return u(t,(function(t,a){e[a]=r&&"function"===typeof t?n(t,r):t})),e},trim:function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")},stripBOM:function(e){return 65279===e.charCodeAt(0)&&(e=e.slice(1)),e}}}}),Ts=ks({"../../node_modules/axios/lib/helpers/buildURL.js":function(e,t){Rs();var n=Cs();function r(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}t.exports=function(e,t,a){if(!t)return e;var i;if(a)i=a(t);else if(n.isURLSearchParams(t))i=t.toString();else{var s=[];n.forEach(t,(function(e,t){null!==e&&"undefined"!==typeof e&&(n.isArray(e)?t+="[]":e=[e],n.forEach(e,(function(e){n.isDate(e)?e=e.toISOString():n.isObject(e)&&(e=JSON.stringify(e)),s.push(r(t)+"="+r(e))})))})),i=s.join("&")}if(i){var o=e.indexOf("#");-1!==o&&(e=e.slice(0,o)),e+=(-1===e.indexOf("?")?"?":"&")+i}return e}}}),Es=ks({"../../node_modules/axios/lib/core/InterceptorManager.js":function(e,t){Rs();var n=Cs();function r(){this.handlers=[]}r.prototype.use=function(e,t,n){return this.handlers.push({fulfilled:e,rejected:t,synchronous:!!n&&n.synchronous,runWhen:n?n.runWhen:null}),this.handlers.length-1},r.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)},r.prototype.forEach=function(e){n.forEach(this.handlers,(function(t){null!==t&&e(t)}))},t.exports=r}}),Os=ks({"../../node_modules/axios/lib/helpers/normalizeHeaderName.js":function(e,t){Rs();var n=Cs();t.exports=function(e,t){n.forEach(e,(function(n,r){r!==t&&r.toUpperCase()===t.toUpperCase()&&(e[t]=n,delete e[r])}))}}}),Ms=ks({"../../node_modules/axios/lib/core/enhanceError.js":function(e,t){Rs(),t.exports=function(e,t,n,r,a){return e.config=t,n&&(e.code=n),e.request=r,e.response=a,e.isAxiosError=!0,e.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code,status:this.response&&this.response.status?this.response.status:null}},e}}}),Is=ks({"../../node_modules/axios/lib/core/createError.js":function(e,t){Rs();var n=Ms();t.exports=function(e,t,r,a,i){var s=new Error(e);return n(s,t,r,a,i)}}}),Ds=ks({"../../node_modules/axios/lib/core/settle.js":function(e,t){Rs();var n=Is();t.exports=function(e,t,r){var a=r.config.validateStatus;r.status&&a&&!a(r.status)?t(n("Request failed with status code "+r.status,r.config,null,r.request,r)):e(r)}}}),js=ks({"../../node_modules/axios/lib/helpers/cookies.js":function(e,t){Rs();var n=Cs();t.exports=n.isStandardBrowserEnv()?{write:function(e,t,r,a,i,s){var o=[];o.push(e+"="+encodeURIComponent(t)),n.isNumber(r)&&o.push("expires="+new Date(r).toGMTString()),n.isString(a)&&o.push("path="+a),n.isString(i)&&o.push("domain="+i),!0===s&&o.push("secure"),document.cookie=o.join("; ")},read:function(e){var t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}}}}),Ls=ks({"../../node_modules/axios/lib/helpers/isAbsoluteURL.js":function(e,t){Rs(),t.exports=function(e){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(e)}}}),As=ks({"../../node_modules/axios/lib/helpers/combineURLs.js":function(e,t){Rs(),t.exports=function(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e}}}),Fs=ks({"../../node_modules/axios/lib/core/buildFullPath.js":function(e,t){Rs();var n=Ls(),r=As();t.exports=function(e,t){return e&&!n(t)?r(e,t):t}}}),Ns=ks({"../../node_modules/axios/lib/helpers/parseHeaders.js":function(e,t){Rs();var n=Cs(),r=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];t.exports=function(e){var t,a,i,s={};return e?(n.forEach(e.split("\n"),(function(e){if(i=e.indexOf(":"),t=n.trim(e.substr(0,i)).toLowerCase(),a=n.trim(e.substr(i+1)),t){if(s[t]&&r.indexOf(t)>=0)return;s[t]="set-cookie"===t?(s[t]?s[t]:[]).concat([a]):s[t]?s[t]+", "+a:a}})),s):s}}}),Bs=ks({"../../node_modules/axios/lib/helpers/isURLSameOrigin.js":function(e,t){Rs();var n=Cs();t.exports=n.isStandardBrowserEnv()?function(){var e,t=/(msie|trident)/i.test(navigator.userAgent),r=document.createElement("a");function a(e){var n=e;return t&&(r.setAttribute("href",n),n=r.href),r.setAttribute("href",n),{href:r.href,protocol:r.protocol?r.protocol.replace(/:$/,""):"",host:r.host,search:r.search?r.search.replace(/^\?/,""):"",hash:r.hash?r.hash.replace(/^#/,""):"",hostname:r.hostname,port:r.port,pathname:"/"===r.pathname.charAt(0)?r.pathname:"/"+r.pathname}}return e=a(window.location.href),function(t){var r=n.isString(t)?a(t):t;return r.protocol===e.protocol&&r.host===e.host}}():function(){return!0}}}),Us=ks({"../../node_modules/axios/lib/cancel/Cancel.js":function(e,t){function n(e){this.message=e}Rs(),n.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},n.prototype.__CANCEL__=!0,t.exports=n}}),zs=ks({"../../node_modules/axios/lib/adapters/xhr.js":function(e,t){Rs();var n=Cs(),r=Ds(),a=js(),i=Ts(),s=Fs(),o=Ns(),c=Bs(),u=Is(),l=Vs(),d=Us();t.exports=function(e){return new Promise((function(t,p){var f,h=e.data,m=e.headers,v=e.responseType;function g(){e.cancelToken&&e.cancelToken.unsubscribe(f),e.signal&&e.signal.removeEventListener("abort",f)}n.isFormData(h)&&delete m["Content-Type"];var b=new XMLHttpRequest;if(e.auth){var y=e.auth.username||"",_=e.auth.password?unescape(encodeURIComponent(e.auth.password)):"";m.Authorization="Basic "+btoa(y+":"+_)}var w=s(e.baseURL,e.url);function k(){if(b){var n="getAllResponseHeaders"in b?o(b.getAllResponseHeaders()):null,a={data:v&&"text"!==v&&"json"!==v?b.response:b.responseText,status:b.status,statusText:b.statusText,headers:n,config:e,request:b};r((function(e){t(e),g()}),(function(e){p(e),g()}),a),b=null}}if(b.open(e.method.toUpperCase(),i(w,e.params,e.paramsSerializer),!0),b.timeout=e.timeout,"onloadend"in b?b.onloadend=k:b.onreadystatechange=function(){b&&4===b.readyState&&(0!==b.status||b.responseURL&&0===b.responseURL.indexOf("file:"))&&setTimeout(k)},b.onabort=function(){b&&(p(u("Request aborted",e,"ECONNABORTED",b)),b=null)},b.onerror=function(){p(u("Network Error",e,null,b)),b=null},b.ontimeout=function(){var t=e.timeout?"timeout of "+e.timeout+"ms exceeded":"timeout exceeded",n=e.transitional||l.transitional;e.timeoutErrorMessage&&(t=e.timeoutErrorMessage),p(u(t,e,n.clarifyTimeoutError?"ETIMEDOUT":"ECONNABORTED",b)),b=null},n.isStandardBrowserEnv()){var x=(e.withCredentials||c(w))&&e.xsrfCookieName?a.read(e.xsrfCookieName):void 0;x&&(m[e.xsrfHeaderName]=x)}"setRequestHeader"in b&&n.forEach(m,(function(e,t){"undefined"===typeof h&&"content-type"===t.toLowerCase()?delete m[t]:b.setRequestHeader(t,e)})),n.isUndefined(e.withCredentials)||(b.withCredentials=!!e.withCredentials),v&&"json"!==v&&(b.responseType=e.responseType),"function"===typeof e.onDownloadProgress&&b.addEventListener("progress",e.onDownloadProgress),"function"===typeof e.onUploadProgress&&b.upload&&b.upload.addEventListener("progress",e.onUploadProgress),(e.cancelToken||e.signal)&&(f=function(e){b&&(p(!e||e&&e.type?new d("canceled"):e),b.abort(),b=null)},e.cancelToken&&e.cancelToken.subscribe(f),e.signal&&(e.signal.aborted?f():e.signal.addEventListener("abort",f))),h||(h=null),b.send(h)}))}}}),Vs=ks({"../../node_modules/axios/lib/defaults.js":function(e,t){Rs();var n=Cs(),r=Os(),a=Ms(),i={"Content-Type":"application/x-www-form-urlencoded"};function s(e,t){!n.isUndefined(e)&&n.isUndefined(e["Content-Type"])&&(e["Content-Type"]=t)}var o={transitional:{silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},adapter:function(){var e;return("undefined"!==typeof XMLHttpRequest||"undefined"!==typeof is&&"[object process]"===Object.prototype.toString.call(is))&&(e=zs()),e}(),transformRequest:[function(e,t){return r(t,"Accept"),r(t,"Content-Type"),n.isFormData(e)||n.isArrayBuffer(e)||n.isBuffer(e)||n.isStream(e)||n.isFile(e)||n.isBlob(e)?e:n.isArrayBufferView(e)?e.buffer:n.isURLSearchParams(e)?(s(t,"application/x-www-form-urlencoded;charset=utf-8"),e.toString()):n.isObject(e)||t&&"application/json"===t["Content-Type"]?(s(t,"application/json"),function(e,t,r){if(n.isString(e))try{return(t||JSON.parse)(e),n.trim(e)}catch(a){if("SyntaxError"!==a.name)throw a}return(r||JSON.stringify)(e)}(e)):e}],transformResponse:[function(e){var t=this.transitional||o.transitional,r=t&&t.silentJSONParsing,i=t&&t.forcedJSONParsing,s=!r&&"json"===this.responseType;if(s||i&&n.isString(e)&&e.length)try{return JSON.parse(e)}catch(c){if(s){if("SyntaxError"===c.name)throw a(c,this,"E_JSON_PARSE");throw c}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};n.forEach(["delete","get","head"],(function(e){o.headers[e]={}})),n.forEach(["post","put","patch"],(function(e){o.headers[e]=n.merge(i)})),t.exports=o}}),Hs=ks({"../../node_modules/axios/lib/core/transformData.js":function(e,t){Rs();var n=Cs(),r=Vs();t.exports=function(e,t,a){var i=this||r;return n.forEach(a,(function(n){e=n.call(i,e,t)})),e}}}),Ws=ks({"../../node_modules/axios/lib/cancel/isCancel.js":function(e,t){Rs(),t.exports=function(e){return!(!e||!e.__CANCEL__)}}}),qs=ks({"../../node_modules/axios/lib/core/dispatchRequest.js":function(e,t){Rs();var n=Cs(),r=Hs(),a=Ws(),i=Vs(),s=Us();function o(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new s("canceled")}t.exports=function(e){return o(e),e.headers=e.headers||{},e.data=r.call(e,e.data,e.headers,e.transformRequest),e.headers=n.merge(e.headers.common||{},e.headers[e.method]||{},e.headers),n.forEach(["delete","get","head","post","put","patch","common"],(function(t){delete e.headers[t]})),(e.adapter||i.adapter)(e).then((function(t){return o(e),t.data=r.call(e,t.data,t.headers,e.transformResponse),t}),(function(t){return a(t)||(o(e),t&&t.response&&(t.response.data=r.call(e,t.response.data,t.response.headers,e.transformResponse))),Promise.reject(t)}))}}}),Gs=ks({"../../node_modules/axios/lib/core/mergeConfig.js":function(e,t){Rs();var n=Cs();t.exports=function(e,t){t=t||{};var r={};function a(e,t){return n.isPlainObject(e)&&n.isPlainObject(t)?n.merge(e,t):n.isPlainObject(t)?n.merge({},t):n.isArray(t)?t.slice():t}function i(r){return n.isUndefined(t[r])?n.isUndefined(e[r])?void 0:a(void 0,e[r]):a(e[r],t[r])}function s(e){if(!n.isUndefined(t[e]))return a(void 0,t[e])}function o(r){return n.isUndefined(t[r])?n.isUndefined(e[r])?void 0:a(void 0,e[r]):a(void 0,t[r])}function c(n){return n in t?a(e[n],t[n]):n in e?a(void 0,e[n]):void 0}var u={url:s,method:s,data:s,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:c};return n.forEach(Object.keys(e).concat(Object.keys(t)),(function(e){var t=u[e]||i,a=t(e);n.isUndefined(a)&&t!==c||(r[e]=a)})),r}}}),Ks=ks({"../../node_modules/axios/lib/env/data.js":function(e,t){Rs(),t.exports={version:"0.23.0"}}}),Xs=ks({"../../node_modules/axios/lib/helpers/validator.js":function(e,t){Rs();var n=Ks().version,r={};["object","boolean","number","function","string","symbol"].forEach((function(e,t){r[e]=function(n){return typeof n===e||"a"+(t<1?"n ":" ")+e}}));var a={};r.transitional=function(e,t,r){function i(e,t){return"[Axios v"+n+"] Transitional option '"+e+"'"+t+(r?". "+r:"")}return function(n,r,s){if(!1===e)throw new Error(i(r," has been removed"+(t?" in "+t:"")));return t&&!a[r]&&(a[r]=!0,console.warn(i(r," has been deprecated since v"+t+" and will be removed in the near future"))),!e||e(n,r,s)}},t.exports={assertOptions:function(e,t,n){if("object"!==typeof e)throw new TypeError("options must be an object");for(var r=Object.keys(e),a=r.length;a-- >0;){var i=r[a],s=t[i];if(s){var o=e[i],c=void 0===o||s(o,i,e);if(!0!==c)throw new TypeError("option "+i+" must be "+c)}else if(!0!==n)throw Error("Unknown option "+i)}},validators:r}}}),Qs=ks({"../../node_modules/axios/lib/core/Axios.js":function(e,t){Rs();var n=Cs(),r=Ts(),a=Es(),i=qs(),s=Gs(),o=Xs(),c=o.validators;function u(e){this.defaults=e,this.interceptors={request:new a,response:new a}}u.prototype.request=function(e){"string"===typeof e?(e=arguments[1]||{}).url=arguments[0]:e=e||{},(e=s(this.defaults,e)).method?e.method=e.method.toLowerCase():this.defaults.method?e.method=this.defaults.method.toLowerCase():e.method="get";var t=e.transitional;void 0!==t&&o.assertOptions(t,{silentJSONParsing:c.transitional(c.boolean),forcedJSONParsing:c.transitional(c.boolean),clarifyTimeoutError:c.transitional(c.boolean)},!1);var n=[],r=!0;this.interceptors.request.forEach((function(t){"function"===typeof t.runWhen&&!1===t.runWhen(e)||(r=r&&t.synchronous,n.unshift(t.fulfilled,t.rejected))}));var a,u=[];if(this.interceptors.response.forEach((function(e){u.push(e.fulfilled,e.rejected)})),!r){var l=[i,void 0];for(Array.prototype.unshift.apply(l,n),l=l.concat(u),a=Promise.resolve(e);l.length;)a=a.then(l.shift(),l.shift());return a}for(var d=e;n.length;){var p=n.shift(),f=n.shift();try{d=p(d)}catch(h){f(h);break}}try{a=i(d)}catch(h){return Promise.reject(h)}for(;u.length;)a=a.then(u.shift(),u.shift());return a},u.prototype.getUri=function(e){return e=s(this.defaults,e),r(e.url,e.params,e.paramsSerializer).replace(/^\?/,"")},n.forEach(["delete","get","head","options"],(function(e){u.prototype[e]=function(t,n){return this.request(s(n||{},{method:e,url:t,data:(n||{}).data}))}})),n.forEach(["post","put","patch"],(function(e){u.prototype[e]=function(t,n,r){return this.request(s(r||{},{method:e,url:t,data:n}))}})),t.exports=u}}),$s=ks({"../../node_modules/axios/lib/cancel/CancelToken.js":function(e,t){Rs();var n=Us();function r(e){if("function"!==typeof e)throw new TypeError("executor must be a function.");var t;this.promise=new Promise((function(e){t=e}));var r=this;this.promise.then((function(e){if(r._listeners){var t,n=r._listeners.length;for(t=0;t<n;t++)r._listeners[t](e);r._listeners=null}})),this.promise.then=function(e){var t,n=new Promise((function(e){r.subscribe(e),t=e})).then(e);return n.cancel=function(){r.unsubscribe(t)},n},e((function(e){r.reason||(r.reason=new n(e),t(r.reason))}))}r.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},r.prototype.subscribe=function(e){this.reason?e(this.reason):this._listeners?this._listeners.push(e):this._listeners=[e]},r.prototype.unsubscribe=function(e){if(this._listeners){var t=this._listeners.indexOf(e);-1!==t&&this._listeners.splice(t,1)}},r.source=function(){var e;return{token:new r((function(t){e=t})),cancel:e}},t.exports=r}}),Js=ks({"../../node_modules/axios/lib/helpers/spread.js":function(e,t){Rs(),t.exports=function(e){return function(t){return e.apply(null,t)}}}}),Ys=ks({"../../node_modules/axios/lib/helpers/isAxiosError.js":function(e,t){Rs(),t.exports=function(e){return"object"===typeof e&&!0===e.isAxiosError}}}),Zs=ks({"../../node_modules/axios/lib/axios.js":function(e,t){Rs();var n=Cs(),r=Ps(),a=Qs(),i=Gs();var s=function e(t){var s=new a(t),o=r(a.prototype.request,s);return n.extend(o,a.prototype,s),n.extend(o,s),o.create=function(n){return e(i(t,n))},o}(Vs());s.Axios=a,s.Cancel=Us(),s.CancelToken=$s(),s.isCancel=Ws(),s.VERSION=Ks().version,s.all=function(e){return Promise.all(e)},s.spread=Js(),s.isAxiosError=Ys(),t.exports=s,t.exports.default=s}}),eo=ks({"../../node_modules/axios/index.js":function(e,t){Rs(),t.exports=Zs()}}),to=ks({"../../node_modules/isomorphic-ws/browser.js":function(e,t){Rs();var n=null;"undefined"!==typeof WebSocket?n=WebSocket:"undefined"!==typeof MozWebSocket?n=MozWebSocket:"undefined"!==typeof global?n=global.WebSocket||global.MozWebSocket:"undefined"!==typeof window?n=window.WebSocket||window.MozWebSocket:"undefined"!==typeof self&&(n=self.WebSocket||self.MozWebSocket),t.exports=n}}),no=ks({"../../node_modules/deepmerge/dist/cjs.js":function(e,t){Rs();var n=function(e){return function(e){return!!e&&"object"===typeof e}(e)&&!function(e){var t=Object.prototype.toString.call(e);return"[object RegExp]"===t||"[object Date]"===t||function(e){return e.$$typeof===r}(e)}(e)};var r="function"===typeof Symbol&&Symbol.for?Symbol.for("react.element"):60103;function a(e,t){return!1!==t.clone&&t.isMergeableObject(e)?u((n=e,Array.isArray(n)?[]:{}),e,t):e;var n}function i(e,t,n){return e.concat(t).map((function(e){return a(e,n)}))}function s(e){return Object.keys(e).concat(function(e){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(e).filter((function(t){return e.propertyIsEnumerable(t)})):[]}(e))}function o(e,t){try{return t in e}catch(n){return!1}}function c(e,t,n){var r={};return n.isMergeableObject(e)&&s(e).forEach((function(t){r[t]=a(e[t],n)})),s(t).forEach((function(i){(function(e,t){return o(e,t)&&!(Object.hasOwnProperty.call(e,t)&&Object.propertyIsEnumerable.call(e,t))})(e,i)||(o(e,i)&&n.isMergeableObject(t[i])?r[i]=function(e,t){if(!t.customMerge)return u;var n=t.customMerge(e);return"function"===typeof n?n:u}(i,n)(e[i],t[i],n):r[i]=a(t[i],n))})),r}function u(e,t,r){(r=r||{}).arrayMerge=r.arrayMerge||i,r.isMergeableObject=r.isMergeableObject||n,r.cloneUnlessOtherwiseSpecified=a;var s=Array.isArray(t);return s===Array.isArray(e)?s?r.arrayMerge(e,t,r):c(e,t,r):a(t,r)}u.all=function(e,t){if(!Array.isArray(e))throw new Error("first argument should be an array");return e.reduce((function(e,n){return u(e,n,t)}),{})};var l=u;t.exports=l}}),ro=ks({"../../node_modules/ts.cryptojs256/ts.cryptojs256.js":function(e){Rs();var t=t||function(e,t){var n={},r=n.lib={},a=function(){},i=r.Base={extend:function(e){a.prototype=this;var t=new a;return e&&t.mixIn(e),t.hasOwnProperty("init")||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},s=r.WordArray=i.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=undefined!=t?t:4*e.length},toString:function(e){return(e||c).stringify(this)},concat:function(e){var t=this.words,n=e.words,r=this.sigBytes;if(e=e.sigBytes,this.clamp(),r%4)for(var a=0;a<e;a++)t[r+a>>>2]|=(n[a>>>2]>>>24-a%4*8&255)<<24-(r+a)%4*8;else if(65535<n.length)for(a=0;a<e;a+=4)t[r+a>>>2]=n[a>>>2];else t.push.apply(t,n);return this.sigBytes+=e,this},clamp:function(){var t=this.words,n=this.sigBytes;t[n>>>2]&=4294967295<<32-n%4*8,t.length=e.ceil(n/4)},clone:function(){var e=i.clone.call(this);return e.words=this.words.slice(0),e},random:function(t){for(var n=[],r=0;r<t;r+=4)n.push(4294967296*e.random()|0);return new s.init(n,t)}}),o=n.enc={},c=o.Hex={stringify:function(e){var t=e.words;e=e.sigBytes;for(var n=[],r=0;r<e;r++){var a=t[r>>>2]>>>24-r%4*8&255;n.push((a>>>4).toString(16)),n.push((15&a).toString(16))}return n.join("")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r+=2)n[r>>>3]|=parseInt(e.substr(r,2),16)<<24-r%8*4;return new s.init(n,t/2)}},u=o.Latin1={stringify:function(e){var t=e.words;e=e.sigBytes;for(var n=[],r=0;r<e;r++)n.push(String.fromCharCode(t[r>>>2]>>>24-r%4*8&255));return n.join("")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r++)n[r>>>2]|=(255&e.charCodeAt(r))<<24-r%4*8;return new s.init(n,t)}},l=o.Utf8={stringify:function(e){try{return decodeURIComponent(escape(u.stringify(e)))}catch(t){throw Error("Malformed UTF-8 data")}},parse:function(e){return u.parse(unescape(encodeURIComponent(e)))}},d=r.BufferedBlockAlgorithm=i.extend({reset:function(){this._data=new s.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=l.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var n=this._data,r=n.words,a=n.sigBytes,i=this.blockSize,o=a/(4*i);if(t=(o=t?e.ceil(o):e.max((0|o)-this._minBufferSize,0))*i,a=e.min(4*t,a),t){for(var c=0;c<t;c+=i)this._doProcessBlock(r,c);c=r.splice(0,t),n.sigBytes-=a}return new s.init(c,a)},clone:function(){var e=i.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0});r.Hasher=d.extend({cfg:i.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){d.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,n){return new e.init(n).finalize(t)}},_createHmacHelper:function(e){return function(t,n){return new p.HMAC.init(e,n).finalize(t)}}});var p=n.algo={};return n}(Math);!function(e){for(var n=t,r=(i=n.lib).WordArray,a=i.Hasher,i=n.algo,s=[],o=[],c=function(e){return 4294967296*(e-(0|e))|0},u=2,l=0;64>l;){var d;e:{d=u;for(var p=e.sqrt(d),f=2;f<=p;f++)if(!(d%f)){d=!1;break e}d=!0}d&&(8>l&&(s[l]=c(e.pow(u,.5))),o[l]=c(e.pow(u,1/3)),l++),u++}var h=[];i=i.SHA256=a.extend({_doReset:function(){this._hash=new r.init(s.slice(0))},_doProcessBlock:function(e,t){for(var n=this._hash.words,r=n[0],a=n[1],i=n[2],s=n[3],c=n[4],u=n[5],l=n[6],d=n[7],p=0;64>p;p++){if(16>p)h[p]=0|e[t+p];else{var f=h[p-15],m=h[p-2];h[p]=((f<<25|f>>>7)^(f<<14|f>>>18)^f>>>3)+h[p-7]+((m<<15|m>>>17)^(m<<13|m>>>19)^m>>>10)+h[p-16]}f=d+((c<<26|c>>>6)^(c<<21|c>>>11)^(c<<7|c>>>25))+(c&u^~c&l)+o[p]+h[p],m=((r<<30|r>>>2)^(r<<19|r>>>13)^(r<<10|r>>>22))+(r&a^r&i^a&i),d=l,l=u,u=c,c=s+f|0,s=i,i=a,a=r,r=f+m|0}n[0]=n[0]+r|0,n[1]=n[1]+a|0,n[2]=n[2]+i|0,n[3]=n[3]+s|0,n[4]=n[4]+c|0,n[5]=n[5]+u|0,n[6]=n[6]+l|0,n[7]=n[7]+d|0},_doFinalize:function(){var t=this._data,n=t.words,r=8*this._nDataBytes,a=8*t.sigBytes;return n[a>>>5]|=128<<24-a%32,n[14+(a+64>>>9<<4)]=e.floor(r/4294967296),n[15+(a+64>>>9<<4)]=r,t.sigBytes=4*n.length,this._process(),this._hash},clone:function(){var e=a.clone.call(this);return e._hash=this._hash.clone(),e}});n.SHA256=a._createHelper(i),n.HmacSHA256=a._createHmacHelper(i)}(Math),function(){var e=t,n=e.enc.Utf8;e.algo.HMAC=e.lib.Base.extend({init:function(e,t){e=this._hasher=new e.init,"string"==typeof t&&(t=n.parse(t));var r=e.blockSize,a=4*r;t.sigBytes>a&&(t=e.finalize(t)),t.clamp();for(var i=this._oKey=t.clone(),s=this._iKey=t.clone(),o=i.words,c=s.words,u=0;u<r;u++)o[u]^=1549556828,c[u]^=909522486;i.sigBytes=s.sigBytes=a,this.reset()},reset:function(){var e=this._hasher;e.reset(),e.update(this._iKey)},update:function(e){return this._hasher.update(e),this},finalize:function(e){var t=this._hasher;return e=t.finalize(e),t.reset(),t.finalize(this._oKey.clone().concat(e))}})}(),function(){var e=t,n=e.lib.WordArray;e.enc.Base64={stringify:function(e){var t=e.words,n=e.sigBytes,r=this._map;e.clamp(),e=[];for(var a=0;a<n;a+=3)for(var i=(t[a>>>2]>>>24-a%4*8&255)<<16|(t[a+1>>>2]>>>24-(a+1)%4*8&255)<<8|t[a+2>>>2]>>>24-(a+2)%4*8&255,s=0;4>s&&a+.75*s<n;s++)e.push(r.charAt(i>>>6*(3-s)&63));if(t=r.charAt(64))for(;e.length%4;)e.push(t);return e.join("")},parse:function(e){var t=e.length,r=this._map;(a=r.charAt(64))&&(-1!=(a=e.indexOf(a))&&(t=a));for(var a=[],i=0,s=0;s<t;s++)if(s%4){var o=r.indexOf(e.charAt(s-1))<<s%4*2,c=r.indexOf(e.charAt(s))>>>6-s%4*2;a[i>>>2]|=(o|c)<<24-i%4*8,i++}return n.create(a,i)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),function(e){for(var n=t,r=(i=n.lib).WordArray,a=i.Hasher,i=n.algo,s=[],o=[],c=function(e){return 4294967296*(e-(0|e))|0},u=2,l=0;64>l;){var d;e:{d=u;for(var p=e.sqrt(d),f=2;f<=p;f++)if(!(d%f)){d=!1;break e}d=!0}d&&(8>l&&(s[l]=c(e.pow(u,.5))),o[l]=c(e.pow(u,1/3)),l++),u++}var h=[];i=i.SHA256=a.extend({_doReset:function(){this._hash=new r.init(s.slice(0))},_doProcessBlock:function(e,t){for(var n=this._hash.words,r=n[0],a=n[1],i=n[2],s=n[3],c=n[4],u=n[5],l=n[6],d=n[7],p=0;64>p;p++){if(16>p)h[p]=0|e[t+p];else{var f=h[p-15],m=h[p-2];h[p]=((f<<25|f>>>7)^(f<<14|f>>>18)^f>>>3)+h[p-7]+((m<<15|m>>>17)^(m<<13|m>>>19)^m>>>10)+h[p-16]}f=d+((c<<26|c>>>6)^(c<<21|c>>>11)^(c<<7|c>>>25))+(c&u^~c&l)+o[p]+h[p],m=((r<<30|r>>>2)^(r<<19|r>>>13)^(r<<10|r>>>22))+(r&a^r&i^a&i),d=l,l=u,u=c,c=s+f|0,s=i,i=a,a=r,r=f+m|0}n[0]=n[0]+r|0,n[1]=n[1]+a|0,n[2]=n[2]+i|0,n[3]=n[3]+s|0,n[4]=n[4]+c|0,n[5]=n[5]+u|0,n[6]=n[6]+l|0,n[7]=n[7]+d|0},_doFinalize:function(){var t=this._data,n=t.words,r=8*this._nDataBytes,a=8*t.sigBytes;return n[a>>>5]|=128<<24-a%32,n[14+(a+64>>>9<<4)]=e.floor(r/4294967296),n[15+(a+64>>>9<<4)]=r,t.sigBytes=4*n.length,this._process(),this._hash},clone:function(){var e=a.clone.call(this);return e._hash=this._hash.clone(),e}});n.SHA256=a._createHelper(i),n.HmacSHA256=a._createHmacHelper(i)}(Math),e.enc={Base64:t.enc.Base64,Utf8:t.enc.Utf8,Latin1:t.enc.Latin1},e.SHA256=t.SHA256,e.HmacSHA256=t.HmacSHA256}}),ao=ks({"../../node_modules/jwt-encode/src/index.js":function(e,t){Rs();var n=ro(),r={alg:"HS256",typ:"JWT"};function a(e){return n.enc.Base64.stringify(e).replace(/=+$/,"").replace(/\+/g,"-").replace(/\//g,"_")}function i(e){return a(n.enc.Utf8.parse(JSON.stringify(e)))}t.exports=function(e,t){var s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=Object.assign(r,s);if("HS256"!==o.alg&&"JWT"!==o.typ)throw new Error("jwt-encode only support the HS256 algorithm and the JWT type of hash");var c=i(o),u=i(e),l="".concat(c,".").concat(u);return l=a(l=n.HmacSHA256(l,t)),"".concat(c,".").concat(u,".").concat(l)}}}),io=ks({"../../node_modules/sdp-transform/lib/grammar.js":function(e,t){Rs();var n=t.exports={v:[{name:"version",reg:/^(\d*)$/}],o:[{name:"origin",reg:/^(\S*) (\d*) (\d*) (\S*) IP(\d) (\S*)/,names:["username","sessionId","sessionVersion","netType","ipVer","address"],format:"%s %s %d %s IP%d %s"}],s:[{name:"name"}],i:[{name:"description"}],u:[{name:"uri"}],e:[{name:"email"}],p:[{name:"phone"}],z:[{name:"timezones"}],r:[{name:"repeats"}],t:[{name:"timing",reg:/^(\d*) (\d*)/,names:["start","stop"],format:"%d %d"}],c:[{name:"connection",reg:/^IN IP(\d) (\S*)/,names:["version","ip"],format:"IN IP%d %s"}],b:[{push:"bandwidth",reg:/^(TIAS|AS|CT|RR|RS):(\d*)/,names:["type","limit"],format:"%s:%s"}],m:[{reg:/^(\w*) (\d*) ([\w/]*)(?: (.*))?/,names:["type","port","protocol","payloads"],format:"%s %d %s %s"}],a:[{push:"rtp",reg:/^rtpmap:(\d*) ([\w\-.]*)(?:\s*\/(\d*)(?:\s*\/(\S*))?)?/,names:["payload","codec","rate","encoding"],format:function(e){return e.encoding?"rtpmap:%d %s/%s/%s":e.rate?"rtpmap:%d %s/%s":"rtpmap:%d %s"}},{push:"fmtp",reg:/^fmtp:(\d*) ([\S| ]*)/,names:["payload","config"],format:"fmtp:%d %s"},{name:"control",reg:/^control:(.*)/,format:"control:%s"},{name:"rtcp",reg:/^rtcp:(\d*)(?: (\S*) IP(\d) (\S*))?/,names:["port","netType","ipVer","address"],format:function(e){return null!=e.address?"rtcp:%d %s IP%d %s":"rtcp:%d"}},{push:"rtcpFbTrrInt",reg:/^rtcp-fb:(\*|\d*) trr-int (\d*)/,names:["payload","value"],format:"rtcp-fb:%s trr-int %d"},{push:"rtcpFb",reg:/^rtcp-fb:(\*|\d*) ([\w-_]*)(?: ([\w-_]*))?/,names:["payload","type","subtype"],format:function(e){return null!=e.subtype?"rtcp-fb:%s %s %s":"rtcp-fb:%s %s"}},{push:"ext",reg:/^extmap:(\d+)(?:\/(\w+))?(?: (urn:ietf:params:rtp-hdrext:encrypt))? (\S*)(?: (\S*))?/,names:["value","direction","encrypt-uri","uri","config"],format:function(e){return"extmap:%d"+(e.direction?"/%s":"%v")+(e["encrypt-uri"]?" %s":"%v")+" %s"+(e.config?" %s":"")}},{name:"extmapAllowMixed",reg:/^(extmap-allow-mixed)/},{push:"crypto",reg:/^crypto:(\d*) ([\w_]*) (\S*)(?: (\S*))?/,names:["id","suite","config","sessionConfig"],format:function(e){return null!=e.sessionConfig?"crypto:%d %s %s %s":"crypto:%d %s %s"}},{name:"setup",reg:/^setup:(\w*)/,format:"setup:%s"},{name:"connectionType",reg:/^connection:(new|existing)/,format:"connection:%s"},{name:"mid",reg:/^mid:([^\s]*)/,format:"mid:%s"},{name:"msid",reg:/^msid:(.*)/,format:"msid:%s"},{name:"ptime",reg:/^ptime:(\d*(?:\.\d*)*)/,format:"ptime:%d"},{name:"maxptime",reg:/^maxptime:(\d*(?:\.\d*)*)/,format:"maxptime:%d"},{name:"direction",reg:/^(sendrecv|recvonly|sendonly|inactive)/},{name:"icelite",reg:/^(ice-lite)/},{name:"iceUfrag",reg:/^ice-ufrag:(\S*)/,format:"ice-ufrag:%s"},{name:"icePwd",reg:/^ice-pwd:(\S*)/,format:"ice-pwd:%s"},{name:"fingerprint",reg:/^fingerprint:(\S*) (\S*)/,names:["type","hash"],format:"fingerprint:%s %s"},{push:"candidates",reg:/^candidate:(\S*) (\d*) (\S*) (\d*) (\S*) (\d*) typ (\S*)(?: raddr (\S*) rport (\d*))?(?: tcptype (\S*))?(?: generation (\d*))?(?: network-id (\d*))?(?: network-cost (\d*))?/,names:["foundation","component","transport","priority","ip","port","type","raddr","rport","tcptype","generation","network-id","network-cost"],format:function(e){var t="candidate:%s %d %s %d %s %d typ %s";return t+=null!=e.raddr?" raddr %s rport %d":"%v%v",t+=null!=e.tcptype?" tcptype %s":"%v",null!=e.generation&&(t+=" generation %d"),t+=null!=e["network-id"]?" network-id %d":"%v",t+=null!=e["network-cost"]?" network-cost %d":"%v"}},{name:"endOfCandidates",reg:/^(end-of-candidates)/},{name:"remoteCandidates",reg:/^remote-candidates:(.*)/,format:"remote-candidates:%s"},{name:"iceOptions",reg:/^ice-options:(\S*)/,format:"ice-options:%s"},{push:"ssrcs",reg:/^ssrc:(\d*) ([\w_-]*)(?::(.*))?/,names:["id","attribute","value"],format:function(e){var t="ssrc:%d";return null!=e.attribute&&(t+=" %s",null!=e.value&&(t+=":%s")),t}},{push:"ssrcGroups",reg:/^ssrc-group:([\x21\x23\x24\x25\x26\x27\x2A\x2B\x2D\x2E\w]*) (.*)/,names:["semantics","ssrcs"],format:"ssrc-group:%s %s"},{name:"msidSemantic",reg:/^msid-semantic:\s?(\w*) (\S*)/,names:["semantic","token"],format:"msid-semantic: %s %s"},{push:"groups",reg:/^group:(\w*) (.*)/,names:["type","mids"],format:"group:%s %s"},{name:"rtcpMux",reg:/^(rtcp-mux)/},{name:"rtcpRsize",reg:/^(rtcp-rsize)/},{name:"sctpmap",reg:/^sctpmap:([\w_/]*) (\S*)(?: (\S*))?/,names:["sctpmapNumber","app","maxMessageSize"],format:function(e){return null!=e.maxMessageSize?"sctpmap:%s %s %s":"sctpmap:%s %s"}},{name:"xGoogleFlag",reg:/^x-google-flag:([^\s]*)/,format:"x-google-flag:%s"},{push:"rids",reg:/^rid:([\d\w]+) (\w+)(?: ([\S| ]*))?/,names:["id","direction","params"],format:function(e){return e.params?"rid:%s %s %s":"rid:%s %s"}},{push:"imageattrs",reg:new RegExp("^imageattr:(\\d+|\\*)[\\s\\t]+(send|recv)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*)(?:[\\s\\t]+(recv|send)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*))?"),names:["pt","dir1","attrs1","dir2","attrs2"],format:function(e){return"imageattr:%s %s %s"+(e.dir2?" %s %s":"")}},{name:"simulcast",reg:new RegExp("^simulcast:(send|recv) ([a-zA-Z0-9\\-_~;,]+)(?:\\s?(send|recv) ([a-zA-Z0-9\\-_~;,]+))?$"),names:["dir1","list1","dir2","list2"],format:function(e){return"simulcast:%s %s"+(e.dir2?" %s %s":"")}},{name:"simulcast_03",reg:/^simulcast:[\s\t]+([\S+\s\t]+)$/,names:["value"],format:"simulcast: %s"},{name:"framerate",reg:/^framerate:(\d+(?:$|\.\d+))/,format:"framerate:%s"},{name:"sourceFilter",reg:/^source-filter: *(excl|incl) (\S*) (IP4|IP6|\*) (\S*) (.*)/,names:["filterMode","netType","addressTypes","destAddress","srcList"],format:"source-filter: %s %s %s %s %s"},{name:"bundleOnly",reg:/^(bundle-only)/},{name:"label",reg:/^label:(.+)/,format:"label:%s"},{name:"sctpPort",reg:/^sctp-port:(\d+)$/,format:"sctp-port:%s"},{name:"maxMessageSize",reg:/^max-message-size:(\d+)$/,format:"max-message-size:%s"},{push:"tsRefClocks",reg:/^ts-refclk:([^\s=]*)(?:=(\S*))?/,names:["clksrc","clksrcExt"],format:function(e){return"ts-refclk:%s"+(null!=e.clksrcExt?"=%s":"")}},{name:"mediaClk",reg:/^mediaclk:(?:id=(\S*))? *([^\s=]*)(?:=(\S*))?(?: *rate=(\d+)\/(\d+))?/,names:["id","mediaClockName","mediaClockValue","rateNumerator","rateDenominator"],format:function(e){var t="mediaclk:";return t+=null!=e.id?"id=%s %s":"%v%s",t+=null!=e.mediaClockValue?"=%s":"",t+=null!=e.rateNumerator?" rate=%s":"",t+=null!=e.rateDenominator?"/%s":""}},{name:"keywords",reg:/^keywds:(.+)$/,format:"keywds:%s"},{name:"content",reg:/^content:(.+)/,format:"content:%s"},{name:"bfcpFloorCtrl",reg:/^floorctrl:(c-only|s-only|c-s)/,format:"floorctrl:%s"},{name:"bfcpConfId",reg:/^confid:(\d+)/,format:"confid:%s"},{name:"bfcpUserId",reg:/^userid:(\d+)/,format:"userid:%s"},{name:"bfcpFloorId",reg:/^floorid:(.+) (?:m-stream|mstrm):(.+)/,names:["id","mStream"],format:"floorid:%s mstrm:%s"},{push:"invalid",names:["value"]}]};Object.keys(n).forEach((function(e){n[e].forEach((function(e){e.reg||(e.reg=/(.*)/),e.format||(e.format="%s")}))}))}}),so=ks({"../../node_modules/sdp-transform/lib/parser.js":function(e){Rs();var t=function(e){return String(Number(e))===e?Number(e):e},n=function(e,n,r){var a=e.name&&e.names;e.push&&!n[e.push]?n[e.push]=[]:a&&!n[e.name]&&(n[e.name]={});var i=e.push?{}:a?n[e.name]:n;!function(e,n,r,a){if(a&&!r)n[a]=t(e[1]);else for(var i=0;i<r.length;i+=1)null!=e[i+1]&&(n[r[i]]=t(e[i+1]))}(r.match(e.reg),i,e.names,e.name),e.push&&n[e.push].push(i)},r=io(),a=RegExp.prototype.test.bind(/^([a-z])=(.*)/);e.parse=function(e){var t={},i=[],s=t;return e.split(/(\r\n|\r|\n)/).filter(a).forEach((function(e){var t=e[0],a=e.slice(2);"m"===t&&(i.push({rtp:[],fmtp:[]}),s=i[i.length-1]);for(var o=0;o<(r[t]||[]).length;o+=1){var c=r[t][o];if(c.reg.test(a))return n(c,s,a)}})),t.media=i,t};var i=function(e,n){var r=n.split(/=(.+)/,2);return 2===r.length?e[r[0]]=t(r[1]):1===r.length&&n.length>1&&(e[r[0]]=void 0),e};e.parseParams=function(e){return e.split(/;\s?/).reduce(i,{})},e.parseFmtpConfig=e.parseParams,e.parsePayloads=function(e){return e.toString().split(" ").map(Number)},e.parseRemoteCandidates=function(e){for(var n=[],r=e.split(" ").map(t),a=0;a<r.length;a+=3)n.push({component:r[a],ip:r[a+1],port:r[a+2]});return n},e.parseImageAttributes=function(e){return e.split(" ").map((function(e){return e.substring(1,e.length-1).split(",").reduce(i,{})}))},e.parseSimulcastStreamList=function(e){return e.split(";").map((function(e){return e.split(",").map((function(e){var n,r=!1;return"~"!==e[0]?n=t(e):(n=t(e.substring(1,e.length)),r=!0),{scid:n,paused:r}}))}))}}}),oo=ks({"../../node_modules/sdp-transform/lib/writer.js":function(e,t){Rs();var n=io(),r=/%[sdv%]/g,a=function(e){var t=1,n=arguments,a=n.length;return e.replace(r,(function(e){if(t>=a)return e;var r=n[t];switch(t+=1,e){case"%%":return"%";case"%s":return String(r);case"%d":return Number(r);case"%v":return""}}))},i=function(e,t,n){var r=[e+"="+(t.format instanceof Function?t.format(t.push?n:n[t.name]):t.format)];if(t.names)for(var i=0;i<t.names.length;i+=1){var s=t.names[i];t.name?r.push(n[t.name][s]):r.push(n[t.names[i]])}else r.push(n[t.name]);return a.apply(null,r)},s=["v","o","s","i","u","e","p","c","b","t","r","z","a"],o=["i","c","b","a"];t.exports=function(e,t){t=t||{},null==e.version&&(e.version=0),null==e.name&&(e.name=" "),e.media.forEach((function(e){null==e.payloads&&(e.payloads="")}));var r=t.outerOrder||s,a=t.innerOrder||o,c=[];return r.forEach((function(t){n[t].forEach((function(n){n.name in e&&null!=e[n.name]?c.push(i(t,n,e)):n.push in e&&null!=e[n.push]&&e[n.push].forEach((function(e){c.push(i(t,n,e))}))}))})),e.media.forEach((function(e){c.push(i("m",n.m[0],e)),a.forEach((function(t){n[t].forEach((function(n){n.name in e&&null!=e[n.name]?c.push(i(t,n,e)):n.push in e&&null!=e[n.push]&&e[n.push].forEach((function(e){c.push(i(t,n,e))}))}))}))})),c.join("\r\n")+"\r\n"}}}),co=ks({"../../node_modules/sdp-transform/lib/index.js":function(e){Rs();var t=so(),n=oo();e.write=n,e.parse=t.parse,e.parseParams=t.parseParams,e.parseFmtpConfig=t.parseFmtpConfig,e.parsePayloads=t.parsePayloads,e.parseRemoteCandidates=t.parseRemoteCandidates,e.parseImageAttributes=t.parseImageAttributes,e.parseSimulcastStreamList=t.parseSimulcastStreamList}}),uo=ks({"../../node_modules/ms/index.js":function(e,t){Rs();var n=1e3,r=60*n,a=60*r,i=24*a,s=7*i,o=365.25*i;function c(e,t,n,r){var a=t>=1.5*n;return Math.round(e/n)+" "+r+(a?"s":"")}t.exports=function(e,t){t=t||{};var u=typeof e;if("string"===u&&e.length>0)return function(e){if((e=String(e)).length>100)return;var t=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(!t)return;var c=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return c*o;case"weeks":case"week":case"w":return c*s;case"days":case"day":case"d":return c*i;case"hours":case"hour":case"hrs":case"hr":case"h":return c*a;case"minutes":case"minute":case"mins":case"min":case"m":return c*r;case"seconds":case"second":case"secs":case"sec":case"s":return c*n;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return c;default:return}}(e);if("number"===u&&isFinite(e))return t.long?function(e){var t=Math.abs(e);if(t>=i)return c(e,t,i,"day");if(t>=a)return c(e,t,a,"hour");if(t>=r)return c(e,t,r,"minute");if(t>=n)return c(e,t,n,"second");return e+" ms"}(e):function(e){var t=Math.abs(e);if(t>=i)return Math.round(e/i)+"d";if(t>=a)return Math.round(e/a)+"h";if(t>=r)return Math.round(e/r)+"m";if(t>=n)return Math.round(e/n)+"s";return e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}}}),lo=ks({"../../node_modules/debug/src/common.js":function(e,t){Rs(),t.exports=function(e){function t(e){var r,a,i,s=null;function o(){for(var e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];if(o.enabled){var i=o,s=Number(new Date),c=s-(r||s);i.diff=c,i.prev=r,i.curr=s,r=s,n[0]=t.coerce(n[0]),"string"!==typeof n[0]&&n.unshift("%O");var u=0;n[0]=n[0].replace(/%([a-zA-Z%])/g,(function(e,r){if("%%"===e)return"%";u++;var a=t.formatters[r];if("function"===typeof a){var s=n[u];e=a.call(i,s),n.splice(u,1),u--}return e})),t.formatArgs.call(i,n);var l=i.log||t.log;l.apply(i,n)}}return o.namespace=e,o.useColors=t.useColors(),o.color=t.selectColor(e),o.extend=n,o.destroy=t.destroy,Object.defineProperty(o,"enabled",{enumerable:!0,configurable:!1,get:function(){return null!==s?s:(a!==t.namespaces&&(a=t.namespaces,i=t.enabled(e)),i)},set:function(e){s=e}}),"function"===typeof t.init&&t.init(o),o}function n(e,n){var r=t(this.namespace+("undefined"===typeof n?":":n)+e);return r.log=this.log,r}function r(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return t.debug=t,t.default=t,t.coerce=function(e){if(e instanceof Error)return e.stack||e.message;return e},t.disable=function(){var e=[].concat(xt(t.names.map(r)),xt(t.skips.map(r).map((function(e){return"-"+e})))).join(",");return t.enable(""),e},t.enable=function(e){var n;t.save(e),t.namespaces=e,t.names=[],t.skips=[];var r=("string"===typeof e?e:"").split(/[\s,]+/),a=r.length;for(n=0;n<a;n++)r[n]&&("-"===(e=r[n].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.slice(1)+"$")):t.names.push(new RegExp("^"+e+"$")))},t.enabled=function(e){if("*"===e[e.length-1])return!0;var n,r;for(n=0,r=t.skips.length;n<r;n++)if(t.skips[n].test(e))return!1;for(n=0,r=t.names.length;n<r;n++)if(t.names[n].test(e))return!0;return!1},t.humanize=uo(),t.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(e).forEach((function(n){t[n]=e[n]})),t.names=[],t.skips=[],t.formatters={},t.selectColor=function(e){for(var n=0,r=0;r<e.length;r++)n=(n<<5)-n+e.charCodeAt(r),n|=0;return t.colors[Math.abs(n)%t.colors.length]},t.enable(t.load()),t}}}),po=ks({"../../node_modules/debug/src/browser.js":function(e,t){Rs(),e.formatArgs=function(e){if(e[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+e[0]+(this.useColors?"%c ":" ")+"+"+t.exports.humanize(this.diff),!this.useColors)return;var n="color: "+this.color;e.splice(1,0,n,"color: inherit");var r=0,a=0;e[0].replace(/%[a-zA-Z%]/g,(function(e){"%%"!==e&&(r++,"%c"===e&&(a=r))})),e.splice(a,0,n)},e.save=function(t){try{t?e.storage.setItem("debug",t):e.storage.removeItem("debug")}catch(n){}},e.load=function(){var t;try{t=e.storage.getItem("debug")}catch(n){}!t&&"undefined"!==typeof is&&"env"in is&&(t=is.env.DEBUG);return t},e.useColors=function(){if("undefined"!==typeof window&&window.process&&("renderer"===window.process.type||window.process.__nwjs))return!0;if("undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!==typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!==typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},e.storage=function(){try{return localStorage}catch(e){}}(),e.destroy=function(){var e=!1;return function(){e||(e=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}}(),e.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],e.log=console.debug||console.log||function(){},t.exports=lo()(e),t.exports.formatters.j=function(e){try{return JSON.stringify(e)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}}}}),fo=ks({"../../node_modules/bowser/es5.js":function(e,t){var n,r;Rs(),n=e,r=function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var a=t[r]={i:r,l:!1,exports:{}};return e[r].call(a.exports,a,a.exports,n),a.l=!0,a.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)n.d(r,a,function(t){return e[t]}.bind(null,a));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=90)}({17:function(e,t,n){t.__esModule=!0,t.default=void 0;var r=n(18),a=function(){function e(){}return e.getFirstMatch=function(e,t){var n=t.match(e);return n&&n.length>0&&n[1]||""},e.getSecondMatch=function(e,t){var n=t.match(e);return n&&n.length>1&&n[2]||""},e.matchAndReturnConst=function(e,t,n){if(e.test(t))return n},e.getWindowsVersionName=function(e){switch(e){case"NT":return"NT";case"XP":case"NT 5.1":return"XP";case"NT 5.0":return"2000";case"NT 5.2":return"2003";case"NT 6.0":return"Vista";case"NT 6.1":return"7";case"NT 6.2":return"8";case"NT 6.3":return"8.1";case"NT 10.0":return"10";default:return}},e.getMacOSVersionName=function(e){var t=e.split(".").splice(0,2).map((function(e){return parseInt(e,10)||0}));if(t.push(0),10===t[0])switch(t[1]){case 5:return"Leopard";case 6:return"Snow Leopard";case 7:return"Lion";case 8:return"Mountain Lion";case 9:return"Mavericks";case 10:return"Yosemite";case 11:return"El Capitan";case 12:return"Sierra";case 13:return"High Sierra";case 14:return"Mojave";case 15:return"Catalina";default:return}},e.getAndroidVersionName=function(e){var t=e.split(".").splice(0,2).map((function(e){return parseInt(e,10)||0}));if(t.push(0),!(1===t[0]&&t[1]<5))return 1===t[0]&&t[1]<6?"Cupcake":1===t[0]&&t[1]>=6?"Donut":2===t[0]&&t[1]<2?"Eclair":2===t[0]&&2===t[1]?"Froyo":2===t[0]&&t[1]>2?"Gingerbread":3===t[0]?"Honeycomb":4===t[0]&&t[1]<1?"Ice Cream Sandwich":4===t[0]&&t[1]<4?"Jelly Bean":4===t[0]&&t[1]>=4?"KitKat":5===t[0]?"Lollipop":6===t[0]?"Marshmallow":7===t[0]?"Nougat":8===t[0]?"Oreo":9===t[0]?"Pie":void 0},e.getVersionPrecision=function(e){return e.split(".").length},e.compareVersions=function(t,n,r){void 0===r&&(r=!1);var a=e.getVersionPrecision(t),i=e.getVersionPrecision(n),s=Math.max(a,i),o=0,c=e.map([t,n],(function(t){var n=s-e.getVersionPrecision(t),r=t+new Array(n+1).join(".0");return e.map(r.split("."),(function(e){return new Array(20-e.length).join("0")+e})).reverse()}));for(r&&(o=s-Math.min(a,i)),s-=1;s>=o;){if(c[0][s]>c[1][s])return 1;if(c[0][s]===c[1][s]){if(s===o)return 0;s-=1}else if(c[0][s]<c[1][s])return-1}},e.map=function(e,t){var n,r=[];if(Array.prototype.map)return Array.prototype.map.call(e,t);for(n=0;n<e.length;n+=1)r.push(t(e[n]));return r},e.find=function(e,t){var n,r;if(Array.prototype.find)return Array.prototype.find.call(e,t);for(n=0,r=e.length;n<r;n+=1){var a=e[n];if(t(a,n))return a}},e.assign=function(e){for(var t,n,r=e,a=arguments.length,i=new Array(a>1?a-1:0),s=1;s<a;s++)i[s-1]=arguments[s];if(Object.assign)return Object.assign.apply(Object,[e].concat(i));var o=function(){var e=i[t];"object"==typeof e&&null!==e&&Object.keys(e).forEach((function(t){r[t]=e[t]}))};for(t=0,n=i.length;t<n;t+=1)o();return e},e.getBrowserAlias=function(e){return r.BROWSER_ALIASES_MAP[e]},e.getBrowserTypeByAlias=function(e){return r.BROWSER_MAP[e]||""},e}();t.default=a,e.exports=t.default},18:function(e,t,n){t.__esModule=!0,t.ENGINE_MAP=t.OS_MAP=t.PLATFORMS_MAP=t.BROWSER_MAP=t.BROWSER_ALIASES_MAP=void 0,t.BROWSER_ALIASES_MAP={"Amazon Silk":"amazon_silk","Android Browser":"android",Bada:"bada",BlackBerry:"blackberry",Chrome:"chrome",Chromium:"chromium",Electron:"electron",Epiphany:"epiphany",Firefox:"firefox",Focus:"focus",Generic:"generic","Google Search":"google_search",Googlebot:"googlebot","Internet Explorer":"ie","K-Meleon":"k_meleon",Maxthon:"maxthon","Microsoft Edge":"edge","MZ Browser":"mz","NAVER Whale Browser":"naver",Opera:"opera","Opera Coast":"opera_coast",PhantomJS:"phantomjs",Puffin:"puffin",QupZilla:"qupzilla",QQ:"qq",QQLite:"qqlite",Safari:"safari",Sailfish:"sailfish","Samsung Internet for Android":"samsung_internet",SeaMonkey:"seamonkey",Sleipnir:"sleipnir",Swing:"swing",Tizen:"tizen","UC Browser":"uc",Vivaldi:"vivaldi","WebOS Browser":"webos",WeChat:"wechat","Yandex Browser":"yandex",Roku:"roku"},t.BROWSER_MAP={amazon_silk:"Amazon Silk",android:"Android Browser",bada:"Bada",blackberry:"BlackBerry",chrome:"Chrome",chromium:"Chromium",electron:"Electron",epiphany:"Epiphany",firefox:"Firefox",focus:"Focus",generic:"Generic",googlebot:"Googlebot",google_search:"Google Search",ie:"Internet Explorer",k_meleon:"K-Meleon",maxthon:"Maxthon",edge:"Microsoft Edge",mz:"MZ Browser",naver:"NAVER Whale Browser",opera:"Opera",opera_coast:"Opera Coast",phantomjs:"PhantomJS",puffin:"Puffin",qupzilla:"QupZilla",qq:"QQ Browser",qqlite:"QQ Browser Lite",safari:"Safari",sailfish:"Sailfish",samsung_internet:"Samsung Internet for Android",seamonkey:"SeaMonkey",sleipnir:"Sleipnir",swing:"Swing",tizen:"Tizen",uc:"UC Browser",vivaldi:"Vivaldi",webos:"WebOS Browser",wechat:"WeChat",yandex:"Yandex Browser"},t.PLATFORMS_MAP={tablet:"tablet",mobile:"mobile",desktop:"desktop",tv:"tv"},t.OS_MAP={WindowsPhone:"Windows Phone",Windows:"Windows",MacOS:"macOS",iOS:"iOS",Android:"Android",WebOS:"WebOS",BlackBerry:"BlackBerry",Bada:"Bada",Tizen:"Tizen",Linux:"Linux",ChromeOS:"Chrome OS",PlayStation4:"PlayStation 4",Roku:"Roku"},t.ENGINE_MAP={EdgeHTML:"EdgeHTML",Blink:"Blink",Trident:"Trident",Presto:"Presto",Gecko:"Gecko",WebKit:"WebKit"}},90:function(e,t,n){t.__esModule=!0,t.default=void 0;var r,a=(r=n(91))&&r.__esModule?r:{default:r},i=n(18);function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var o=function(){function e(){}var t,n;return e.getParser=function(e,t){if(void 0===t&&(t=!1),"string"!=typeof e)throw new Error("UserAgent should be a string");return new a.default(e,t)},e.parse=function(e){return new a.default(e).getResult()},t=e,(n=[{key:"BROWSER_MAP",get:function(){return i.BROWSER_MAP}},{key:"ENGINE_MAP",get:function(){return i.ENGINE_MAP}},{key:"OS_MAP",get:function(){return i.OS_MAP}},{key:"PLATFORMS_MAP",get:function(){return i.PLATFORMS_MAP}}])&&s(t,n),e}();t.default=o,e.exports=t.default},91:function(e,t,n){t.__esModule=!0,t.default=void 0;var r=c(n(92)),a=c(n(93)),i=c(n(94)),s=c(n(95)),o=c(n(17));function c(e){return e&&e.__esModule?e:{default:e}}var u=function(){function e(e,t){if(void 0===t&&(t=!1),null==e||""===e)throw new Error("UserAgent parameter can't be empty");this._ua=e,this.parsedResult={},!0!==t&&this.parse()}var t=e.prototype;return t.getUA=function(){return this._ua},t.test=function(e){return e.test(this._ua)},t.parseBrowser=function(){var e=this;this.parsedResult.browser={};var t=o.default.find(r.default,(function(t){if("function"==typeof t.test)return t.test(e);if(t.test instanceof Array)return t.test.some((function(t){return e.test(t)}));throw new Error("Browser's test function is not valid")}));return t&&(this.parsedResult.browser=t.describe(this.getUA())),this.parsedResult.browser},t.getBrowser=function(){return this.parsedResult.browser?this.parsedResult.browser:this.parseBrowser()},t.getBrowserName=function(e){return e?String(this.getBrowser().name).toLowerCase()||"":this.getBrowser().name||""},t.getBrowserVersion=function(){return this.getBrowser().version},t.getOS=function(){return this.parsedResult.os?this.parsedResult.os:this.parseOS()},t.parseOS=function(){var e=this;this.parsedResult.os={};var t=o.default.find(a.default,(function(t){if("function"==typeof t.test)return t.test(e);if(t.test instanceof Array)return t.test.some((function(t){return e.test(t)}));throw new Error("Browser's test function is not valid")}));return t&&(this.parsedResult.os=t.describe(this.getUA())),this.parsedResult.os},t.getOSName=function(e){var t=this.getOS().name;return e?String(t).toLowerCase()||"":t||""},t.getOSVersion=function(){return this.getOS().version},t.getPlatform=function(){return this.parsedResult.platform?this.parsedResult.platform:this.parsePlatform()},t.getPlatformType=function(e){void 0===e&&(e=!1);var t=this.getPlatform().type;return e?String(t).toLowerCase()||"":t||""},t.parsePlatform=function(){var e=this;this.parsedResult.platform={};var t=o.default.find(i.default,(function(t){if("function"==typeof t.test)return t.test(e);if(t.test instanceof Array)return t.test.some((function(t){return e.test(t)}));throw new Error("Browser's test function is not valid")}));return t&&(this.parsedResult.platform=t.describe(this.getUA())),this.parsedResult.platform},t.getEngine=function(){return this.parsedResult.engine?this.parsedResult.engine:this.parseEngine()},t.getEngineName=function(e){return e?String(this.getEngine().name).toLowerCase()||"":this.getEngine().name||""},t.parseEngine=function(){var e=this;this.parsedResult.engine={};var t=o.default.find(s.default,(function(t){if("function"==typeof t.test)return t.test(e);if(t.test instanceof Array)return t.test.some((function(t){return e.test(t)}));throw new Error("Browser's test function is not valid")}));return t&&(this.parsedResult.engine=t.describe(this.getUA())),this.parsedResult.engine},t.parse=function(){return this.parseBrowser(),this.parseOS(),this.parsePlatform(),this.parseEngine(),this},t.getResult=function(){return o.default.assign({},this.parsedResult)},t.satisfies=function(e){var t=this,n={},r=0,a={},i=0;if(Object.keys(e).forEach((function(t){var s=e[t];"string"==typeof s?(a[t]=s,i+=1):"object"==typeof s&&(n[t]=s,r+=1)})),r>0){var s=Object.keys(n),c=o.default.find(s,(function(e){return t.isOS(e)}));if(c){var u=this.satisfies(n[c]);if(void 0!==u)return u}var l=o.default.find(s,(function(e){return t.isPlatform(e)}));if(l){var d=this.satisfies(n[l]);if(void 0!==d)return d}}if(i>0){var p=Object.keys(a),f=o.default.find(p,(function(e){return t.isBrowser(e,!0)}));if(void 0!==f)return this.compareVersion(a[f])}},t.isBrowser=function(e,t){void 0===t&&(t=!1);var n=this.getBrowserName().toLowerCase(),r=e.toLowerCase(),a=o.default.getBrowserTypeByAlias(r);return t&&a&&(r=a.toLowerCase()),r===n},t.compareVersion=function(e){var t=[0],n=e,r=!1,a=this.getBrowserVersion();if("string"==typeof a)return">"===e[0]||"<"===e[0]?(n=e.substr(1),"="===e[1]?(r=!0,n=e.substr(2)):t=[],">"===e[0]?t.push(1):t.push(-1)):"="===e[0]?n=e.substr(1):"~"===e[0]&&(r=!0,n=e.substr(1)),t.indexOf(o.default.compareVersions(a,n,r))>-1},t.isOS=function(e){return this.getOSName(!0)===String(e).toLowerCase()},t.isPlatform=function(e){return this.getPlatformType(!0)===String(e).toLowerCase()},t.isEngine=function(e){return this.getEngineName(!0)===String(e).toLowerCase()},t.is=function(e,t){return void 0===t&&(t=!1),this.isBrowser(e,t)||this.isOS(e)||this.isPlatform(e)},t.some=function(e){var t=this;return void 0===e&&(e=[]),e.some((function(e){return t.is(e)}))},e}();t.default=u,e.exports=t.default},92:function(e,t,n){t.__esModule=!0,t.default=void 0;var r,a=(r=n(17))&&r.__esModule?r:{default:r},i=/version\/(\d+(\.?_?\d+)+)/i,s=[{test:[/googlebot/i],describe:function(e){var t={name:"Googlebot"},n=a.default.getFirstMatch(/googlebot\/(\d+(\.\d+))/i,e)||a.default.getFirstMatch(i,e);return n&&(t.version=n),t}},{test:[/opera/i],describe:function(e){var t={name:"Opera"},n=a.default.getFirstMatch(i,e)||a.default.getFirstMatch(/(?:opera)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/opr\/|opios/i],describe:function(e){var t={name:"Opera"},n=a.default.getFirstMatch(/(?:opr|opios)[\s/](\S+)/i,e)||a.default.getFirstMatch(i,e);return n&&(t.version=n),t}},{test:[/SamsungBrowser/i],describe:function(e){var t={name:"Samsung Internet for Android"},n=a.default.getFirstMatch(i,e)||a.default.getFirstMatch(/(?:SamsungBrowser)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/Whale/i],describe:function(e){var t={name:"NAVER Whale Browser"},n=a.default.getFirstMatch(i,e)||a.default.getFirstMatch(/(?:whale)[\s/](\d+(?:\.\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/MZBrowser/i],describe:function(e){var t={name:"MZ Browser"},n=a.default.getFirstMatch(/(?:MZBrowser)[\s/](\d+(?:\.\d+)+)/i,e)||a.default.getFirstMatch(i,e);return n&&(t.version=n),t}},{test:[/focus/i],describe:function(e){var t={name:"Focus"},n=a.default.getFirstMatch(/(?:focus)[\s/](\d+(?:\.\d+)+)/i,e)||a.default.getFirstMatch(i,e);return n&&(t.version=n),t}},{test:[/swing/i],describe:function(e){var t={name:"Swing"},n=a.default.getFirstMatch(/(?:swing)[\s/](\d+(?:\.\d+)+)/i,e)||a.default.getFirstMatch(i,e);return n&&(t.version=n),t}},{test:[/coast/i],describe:function(e){var t={name:"Opera Coast"},n=a.default.getFirstMatch(i,e)||a.default.getFirstMatch(/(?:coast)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/opt\/\d+(?:.?_?\d+)+/i],describe:function(e){var t={name:"Opera Touch"},n=a.default.getFirstMatch(/(?:opt)[\s/](\d+(\.?_?\d+)+)/i,e)||a.default.getFirstMatch(i,e);return n&&(t.version=n),t}},{test:[/yabrowser/i],describe:function(e){var t={name:"Yandex Browser"},n=a.default.getFirstMatch(/(?:yabrowser)[\s/](\d+(\.?_?\d+)+)/i,e)||a.default.getFirstMatch(i,e);return n&&(t.version=n),t}},{test:[/ucbrowser/i],describe:function(e){var t={name:"UC Browser"},n=a.default.getFirstMatch(i,e)||a.default.getFirstMatch(/(?:ucbrowser)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/Maxthon|mxios/i],describe:function(e){var t={name:"Maxthon"},n=a.default.getFirstMatch(i,e)||a.default.getFirstMatch(/(?:Maxthon|mxios)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/epiphany/i],describe:function(e){var t={name:"Epiphany"},n=a.default.getFirstMatch(i,e)||a.default.getFirstMatch(/(?:epiphany)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/puffin/i],describe:function(e){var t={name:"Puffin"},n=a.default.getFirstMatch(i,e)||a.default.getFirstMatch(/(?:puffin)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/sleipnir/i],describe:function(e){var t={name:"Sleipnir"},n=a.default.getFirstMatch(i,e)||a.default.getFirstMatch(/(?:sleipnir)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/k-meleon/i],describe:function(e){var t={name:"K-Meleon"},n=a.default.getFirstMatch(i,e)||a.default.getFirstMatch(/(?:k-meleon)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/micromessenger/i],describe:function(e){var t={name:"WeChat"},n=a.default.getFirstMatch(/(?:micromessenger)[\s/](\d+(\.?_?\d+)+)/i,e)||a.default.getFirstMatch(i,e);return n&&(t.version=n),t}},{test:[/qqbrowser/i],describe:function(e){var t={name:/qqbrowserlite/i.test(e)?"QQ Browser Lite":"QQ Browser"},n=a.default.getFirstMatch(/(?:qqbrowserlite|qqbrowser)[/](\d+(\.?_?\d+)+)/i,e)||a.default.getFirstMatch(i,e);return n&&(t.version=n),t}},{test:[/msie|trident/i],describe:function(e){var t={name:"Internet Explorer"},n=a.default.getFirstMatch(/(?:msie |rv:)(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/\sedg\//i],describe:function(e){var t={name:"Microsoft Edge"},n=a.default.getFirstMatch(/\sedg\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/edg([ea]|ios)/i],describe:function(e){var t={name:"Microsoft Edge"},n=a.default.getSecondMatch(/edg([ea]|ios)\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/vivaldi/i],describe:function(e){var t={name:"Vivaldi"},n=a.default.getFirstMatch(/vivaldi\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/seamonkey/i],describe:function(e){var t={name:"SeaMonkey"},n=a.default.getFirstMatch(/seamonkey\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/sailfish/i],describe:function(e){var t={name:"Sailfish"},n=a.default.getFirstMatch(/sailfish\s?browser\/(\d+(\.\d+)?)/i,e);return n&&(t.version=n),t}},{test:[/silk/i],describe:function(e){var t={name:"Amazon Silk"},n=a.default.getFirstMatch(/silk\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/phantom/i],describe:function(e){var t={name:"PhantomJS"},n=a.default.getFirstMatch(/phantomjs\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/slimerjs/i],describe:function(e){var t={name:"SlimerJS"},n=a.default.getFirstMatch(/slimerjs\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe:function(e){var t={name:"BlackBerry"},n=a.default.getFirstMatch(i,e)||a.default.getFirstMatch(/blackberry[\d]+\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/(web|hpw)[o0]s/i],describe:function(e){var t={name:"WebOS Browser"},n=a.default.getFirstMatch(i,e)||a.default.getFirstMatch(/w(?:eb)?[o0]sbrowser\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/bada/i],describe:function(e){var t={name:"Bada"},n=a.default.getFirstMatch(/dolfin\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/tizen/i],describe:function(e){var t={name:"Tizen"},n=a.default.getFirstMatch(/(?:tizen\s?)?browser\/(\d+(\.?_?\d+)+)/i,e)||a.default.getFirstMatch(i,e);return n&&(t.version=n),t}},{test:[/qupzilla/i],describe:function(e){var t={name:"QupZilla"},n=a.default.getFirstMatch(/(?:qupzilla)[\s/](\d+(\.?_?\d+)+)/i,e)||a.default.getFirstMatch(i,e);return n&&(t.version=n),t}},{test:[/firefox|iceweasel|fxios/i],describe:function(e){var t={name:"Firefox"},n=a.default.getFirstMatch(/(?:firefox|iceweasel|fxios)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/electron/i],describe:function(e){var t={name:"Electron"},n=a.default.getFirstMatch(/(?:electron)\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/MiuiBrowser/i],describe:function(e){var t={name:"Miui"},n=a.default.getFirstMatch(/(?:MiuiBrowser)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/chromium/i],describe:function(e){var t={name:"Chromium"},n=a.default.getFirstMatch(/(?:chromium)[\s/](\d+(\.?_?\d+)+)/i,e)||a.default.getFirstMatch(i,e);return n&&(t.version=n),t}},{test:[/chrome|crios|crmo/i],describe:function(e){var t={name:"Chrome"},n=a.default.getFirstMatch(/(?:chrome|crios|crmo)\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/GSA/i],describe:function(e){var t={name:"Google Search"},n=a.default.getFirstMatch(/(?:GSA)\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:function(e){var t=!e.test(/like android/i),n=e.test(/android/i);return t&&n},describe:function(e){var t={name:"Android Browser"},n=a.default.getFirstMatch(i,e);return n&&(t.version=n),t}},{test:[/playstation 4/i],describe:function(e){var t={name:"PlayStation 4"},n=a.default.getFirstMatch(i,e);return n&&(t.version=n),t}},{test:[/safari|applewebkit/i],describe:function(e){var t={name:"Safari"},n=a.default.getFirstMatch(i,e);return n&&(t.version=n),t}},{test:[/.*/i],describe:function(e){var t=-1!==e.search("\\(")?/^(.*)\/(.*)[ \t]\((.*)/:/^(.*)\/(.*) /;return{name:a.default.getFirstMatch(t,e),version:a.default.getSecondMatch(t,e)}}}];t.default=s,e.exports=t.default},93:function(e,t,n){t.__esModule=!0,t.default=void 0;var r,a=(r=n(17))&&r.__esModule?r:{default:r},i=n(18),s=[{test:[/Roku\/DVP/],describe:function(e){var t=a.default.getFirstMatch(/Roku\/DVP-(\d+\.\d+)/i,e);return{name:i.OS_MAP.Roku,version:t}}},{test:[/windows phone/i],describe:function(e){var t=a.default.getFirstMatch(/windows phone (?:os)?\s?(\d+(\.\d+)*)/i,e);return{name:i.OS_MAP.WindowsPhone,version:t}}},{test:[/windows /i],describe:function(e){var t=a.default.getFirstMatch(/Windows ((NT|XP)( \d\d?.\d)?)/i,e),n=a.default.getWindowsVersionName(t);return{name:i.OS_MAP.Windows,version:t,versionName:n}}},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe:function(e){var t={name:i.OS_MAP.iOS},n=a.default.getSecondMatch(/(Version\/)(\d[\d.]+)/,e);return n&&(t.version=n),t}},{test:[/macintosh/i],describe:function(e){var t=a.default.getFirstMatch(/mac os x (\d+(\.?_?\d+)+)/i,e).replace(/[_\s]/g,"."),n=a.default.getMacOSVersionName(t),r={name:i.OS_MAP.MacOS,version:t};return n&&(r.versionName=n),r}},{test:[/(ipod|iphone|ipad)/i],describe:function(e){var t=a.default.getFirstMatch(/os (\d+([_\s]\d+)*) like mac os x/i,e).replace(/[_\s]/g,".");return{name:i.OS_MAP.iOS,version:t}}},{test:function(e){var t=!e.test(/like android/i),n=e.test(/android/i);return t&&n},describe:function(e){var t=a.default.getFirstMatch(/android[\s/-](\d+(\.\d+)*)/i,e),n=a.default.getAndroidVersionName(t),r={name:i.OS_MAP.Android,version:t};return n&&(r.versionName=n),r}},{test:[/(web|hpw)[o0]s/i],describe:function(e){var t=a.default.getFirstMatch(/(?:web|hpw)[o0]s\/(\d+(\.\d+)*)/i,e),n={name:i.OS_MAP.WebOS};return t&&t.length&&(n.version=t),n}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe:function(e){var t=a.default.getFirstMatch(/rim\stablet\sos\s(\d+(\.\d+)*)/i,e)||a.default.getFirstMatch(/blackberry\d+\/(\d+([_\s]\d+)*)/i,e)||a.default.getFirstMatch(/\bbb(\d+)/i,e);return{name:i.OS_MAP.BlackBerry,version:t}}},{test:[/bada/i],describe:function(e){var t=a.default.getFirstMatch(/bada\/(\d+(\.\d+)*)/i,e);return{name:i.OS_MAP.Bada,version:t}}},{test:[/tizen/i],describe:function(e){var t=a.default.getFirstMatch(/tizen[/\s](\d+(\.\d+)*)/i,e);return{name:i.OS_MAP.Tizen,version:t}}},{test:[/linux/i],describe:function(){return{name:i.OS_MAP.Linux}}},{test:[/CrOS/],describe:function(){return{name:i.OS_MAP.ChromeOS}}},{test:[/PlayStation 4/],describe:function(e){var t=a.default.getFirstMatch(/PlayStation 4[/\s](\d+(\.\d+)*)/i,e);return{name:i.OS_MAP.PlayStation4,version:t}}}];t.default=s,e.exports=t.default},94:function(e,t,n){t.__esModule=!0,t.default=void 0;var r,a=(r=n(17))&&r.__esModule?r:{default:r},i=n(18),s=[{test:[/googlebot/i],describe:function(){return{type:"bot",vendor:"Google"}}},{test:[/huawei/i],describe:function(e){var t=a.default.getFirstMatch(/(can-l01)/i,e)&&"Nova",n={type:i.PLATFORMS_MAP.mobile,vendor:"Huawei"};return t&&(n.model=t),n}},{test:[/nexus\s*(?:7|8|9|10).*/i],describe:function(){return{type:i.PLATFORMS_MAP.tablet,vendor:"Nexus"}}},{test:[/ipad/i],describe:function(){return{type:i.PLATFORMS_MAP.tablet,vendor:"Apple",model:"iPad"}}},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe:function(){return{type:i.PLATFORMS_MAP.tablet,vendor:"Apple",model:"iPad"}}},{test:[/kftt build/i],describe:function(){return{type:i.PLATFORMS_MAP.tablet,vendor:"Amazon",model:"Kindle Fire HD 7"}}},{test:[/silk/i],describe:function(){return{type:i.PLATFORMS_MAP.tablet,vendor:"Amazon"}}},{test:[/tablet(?! pc)/i],describe:function(){return{type:i.PLATFORMS_MAP.tablet}}},{test:function(e){var t=e.test(/ipod|iphone/i),n=e.test(/like (ipod|iphone)/i);return t&&!n},describe:function(e){var t=a.default.getFirstMatch(/(ipod|iphone)/i,e);return{type:i.PLATFORMS_MAP.mobile,vendor:"Apple",model:t}}},{test:[/nexus\s*[0-6].*/i,/galaxy nexus/i],describe:function(){return{type:i.PLATFORMS_MAP.mobile,vendor:"Nexus"}}},{test:[/[^-]mobi/i],describe:function(){return{type:i.PLATFORMS_MAP.mobile}}},{test:function(e){return"blackberry"===e.getBrowserName(!0)},describe:function(){return{type:i.PLATFORMS_MAP.mobile,vendor:"BlackBerry"}}},{test:function(e){return"bada"===e.getBrowserName(!0)},describe:function(){return{type:i.PLATFORMS_MAP.mobile}}},{test:function(e){return"windows phone"===e.getBrowserName()},describe:function(){return{type:i.PLATFORMS_MAP.mobile,vendor:"Microsoft"}}},{test:function(e){var t=Number(String(e.getOSVersion()).split(".")[0]);return"android"===e.getOSName(!0)&&t>=3},describe:function(){return{type:i.PLATFORMS_MAP.tablet}}},{test:function(e){return"android"===e.getOSName(!0)},describe:function(){return{type:i.PLATFORMS_MAP.mobile}}},{test:function(e){return"macos"===e.getOSName(!0)},describe:function(){return{type:i.PLATFORMS_MAP.desktop,vendor:"Apple"}}},{test:function(e){return"windows"===e.getOSName(!0)},describe:function(){return{type:i.PLATFORMS_MAP.desktop}}},{test:function(e){return"linux"===e.getOSName(!0)},describe:function(){return{type:i.PLATFORMS_MAP.desktop}}},{test:function(e){return"playstation 4"===e.getOSName(!0)},describe:function(){return{type:i.PLATFORMS_MAP.tv}}},{test:function(e){return"roku"===e.getOSName(!0)},describe:function(){return{type:i.PLATFORMS_MAP.tv}}}];t.default=s,e.exports=t.default},95:function(e,t,n){t.__esModule=!0,t.default=void 0;var r,a=(r=n(17))&&r.__esModule?r:{default:r},i=n(18),s=[{test:function(e){return"microsoft edge"===e.getBrowserName(!0)},describe:function(e){if(/\sedg\//i.test(e))return{name:i.ENGINE_MAP.Blink};var t=a.default.getFirstMatch(/edge\/(\d+(\.?_?\d+)+)/i,e);return{name:i.ENGINE_MAP.EdgeHTML,version:t}}},{test:[/trident/i],describe:function(e){var t={name:i.ENGINE_MAP.Trident},n=a.default.getFirstMatch(/trident\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:function(e){return e.test(/presto/i)},describe:function(e){var t={name:i.ENGINE_MAP.Presto},n=a.default.getFirstMatch(/presto\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:function(e){var t=e.test(/gecko/i),n=e.test(/like gecko/i);return t&&!n},describe:function(e){var t={name:i.ENGINE_MAP.Gecko},n=a.default.getFirstMatch(/gecko\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/(apple)?webkit\/537\.36/i],describe:function(){return{name:i.ENGINE_MAP.Blink}}},{test:[/(apple)?webkit/i],describe:function(e){var t={name:i.ENGINE_MAP.WebKit},n=a.default.getFirstMatch(/webkit\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}}];t.default=s,e.exports=t.default}})},"object"==typeof e&&"object"==typeof t?t.exports=r():"function"==typeof define&&define.amd?define([],r):"object"==typeof e?e.bowser=r():n.bowser=r()}}),ho=ks({"../../node_modules/mediasoup-client/lib/Logger.js":function(e){Rs();var t=e&&e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(e,"__esModule",{value:!0}),e.Logger=void 0;var n=t(po()),r="mediasoup-client",a=function(){function e(t){St(this,e),t?(this._debug=(0,n.default)("".concat(r,":").concat(t)),this._warn=(0,n.default)("".concat(r,":WARN:").concat(t)),this._error=(0,n.default)("".concat(r,":ERROR:").concat(t))):(this._debug=(0,n.default)(r),this._warn=(0,n.default)("".concat(r,":WARN")),this._error=(0,n.default)("".concat(r,":ERROR"))),this._debug.log=console.info.bind(console),this._warn.log=console.warn.bind(console),this._error.log=console.error.bind(console)}return Pt(e,[{key:"debug",get:function(){return this._debug}},{key:"warn",get:function(){return this._warn}},{key:"error",get:function(){return this._error}}]),e}();e.Logger=a}}),mo=ks({"../../node_modules/events/events.js":function(e,t){Rs();var n,r="object"===typeof Reflect?Reflect:null,a=r&&"function"===typeof r.apply?r.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)};n=r&&"function"===typeof r.ownKeys?r.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var i=Number.isNaN||function(e){return e!==e};function s(){s.init.call(this)}t.exports=s,t.exports.once=function(e,t){return new Promise((function(n,r){function a(n){e.removeListener(t,i),r(n)}function i(){"function"===typeof e.removeListener&&e.removeListener("error",a),n([].slice.call(arguments))}v(e,t,i,{once:!0}),"error"!==t&&function(e,t,n){"function"===typeof e.on&&v(e,"error",t,n)}(e,a,{once:!0})}))},s.EventEmitter=s,s.prototype._events=void 0,s.prototype._eventsCount=0,s.prototype._maxListeners=void 0;var o=10;function c(e){if("function"!==typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function u(e){return void 0===e._maxListeners?s.defaultMaxListeners:e._maxListeners}function l(e,t,n,r){var a,i,s;if(c(n),void 0===(i=e._events)?(i=e._events=Object.create(null),e._eventsCount=0):(void 0!==i.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),i=e._events),s=i[t]),void 0===s)s=i[t]=n,++e._eventsCount;else if("function"===typeof s?s=i[t]=r?[n,s]:[s,n]:r?s.unshift(n):s.push(n),(a=u(e))>0&&s.length>a&&!s.warned){s.warned=!0;var o=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");o.name="MaxListenersExceededWarning",o.emitter=e,o.type=t,o.count=s.length,function(e){console&&console.warn&&console.warn(e)}(o)}return e}function d(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function p(e,t,n){var r={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},a=d.bind(r);return a.listener=n,r.wrapFn=a,a}function f(e,t,n){var r=e._events;if(void 0===r)return[];var a=r[t];return void 0===a?[]:"function"===typeof a?n?[a.listener||a]:[a]:n?function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(a):m(a,a.length)}function h(e){var t=this._events;if(void 0!==t){var n=t[e];if("function"===typeof n)return 1;if(void 0!==n)return n.length}return 0}function m(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e[r];return n}function v(e,t,n,r){if("function"===typeof e.on)r.once?e.once(t,n):e.on(t,n);else{if("function"!==typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function a(i){r.once&&e.removeEventListener(t,a),n(i)}))}}Object.defineProperty(s,"defaultMaxListeners",{enumerable:!0,get:function(){return o},set:function(e){if("number"!==typeof e||e<0||i(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");o=e}}),s.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},s.prototype.setMaxListeners=function(e){if("number"!==typeof e||e<0||i(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},s.prototype.getMaxListeners=function(){return u(this)},s.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var r="error"===e,i=this._events;if(void 0!==i)r=r&&void 0===i.error;else if(!r)return!1;if(r){var s;if(t.length>0&&(s=t[0]),s instanceof Error)throw s;var o=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw o.context=s,o}var c=i[e];if(void 0===c)return!1;if("function"===typeof c)a(c,this,t);else{var u=c.length,l=m(c,u);for(n=0;n<u;++n)a(l[n],this,t)}return!0},s.prototype.addListener=function(e,t){return l(this,e,t,!1)},s.prototype.on=s.prototype.addListener,s.prototype.prependListener=function(e,t){return l(this,e,t,!0)},s.prototype.once=function(e,t){return c(t),this.on(e,p(this,e,t)),this},s.prototype.prependOnceListener=function(e,t){return c(t),this.prependListener(e,p(this,e,t)),this},s.prototype.removeListener=function(e,t){var n,r,a,i,s;if(c(t),void 0===(r=this._events))return this;if(void 0===(n=r[e]))return this;if(n===t||n.listener===t)0===--this._eventsCount?this._events=Object.create(null):(delete r[e],r.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!==typeof n){for(a=-1,i=n.length-1;i>=0;i--)if(n[i]===t||n[i].listener===t){s=n[i].listener,a=i;break}if(a<0)return this;0===a?n.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(n,a),1===n.length&&(r[e]=n[0]),void 0!==r.removeListener&&this.emit("removeListener",e,s||t)}return this},s.prototype.off=s.prototype.removeListener,s.prototype.removeAllListeners=function(e){var t,n,r;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[e]&&(0===--this._eventsCount?this._events=Object.create(null):delete n[e]),this;if(0===arguments.length){var a,i=Object.keys(n);for(r=0;r<i.length;++r)"removeListener"!==(a=i[r])&&this.removeAllListeners(a);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"===typeof(t=n[e]))this.removeListener(e,t);else if(void 0!==t)for(r=t.length-1;r>=0;r--)this.removeListener(e,t[r]);return this},s.prototype.listeners=function(e){return f(this,e,!0)},s.prototype.rawListeners=function(e){return f(this,e,!1)},s.listenerCount=function(e,t){return"function"===typeof e.listenerCount?e.listenerCount(t):h.call(e,t)},s.prototype.listenerCount=h,s.prototype.eventNames=function(){return this._eventsCount>0?n(this._events):[]}}}),vo=ks({"../../node_modules/mediasoup-client/lib/EnhancedEventEmitter.js":function(e){Rs(),Object.defineProperty(e,"__esModule",{value:!0}),e.EnhancedEventEmitter=void 0;var t=mo(),n=new(ho().Logger)("EnhancedEventEmitter"),r=function(e){mn(r,e);var t=_n(r);function r(){var e;return St(this,r),(e=t.call(this)).setMaxListeners(1/0),e}return Pt(r,[{key:"safeEmit",value:function(e){var t=this.listenerCount(e);try{for(var r=arguments.length,a=new Array(r>1?r-1:0),i=1;i<r;i++)a[i-1]=arguments[i];return this.emit.apply(this,[e].concat(a))}catch(s){return n.error("safeEmit() | event listener threw an error [event:%s]:%o",e,s),Boolean(t)}}},{key:"safeEmitAsPromise",value:function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];return Ss(this,null,wr().mark((function t(){var a=this;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,i){try{a.emit.apply(a,[e].concat(r,[t,i]))}catch(s){n.error("safeEmitAsPromise() | event listener threw an error [event:%s]:%o",e,s),i(s)}})));case 1:case"end":return t.stop()}}),t)})))}}]),r}(t.EventEmitter);e.EnhancedEventEmitter=r}}),go=ks({"../../node_modules/mediasoup-client/lib/errors.js":function(e){Rs(),Object.defineProperty(e,"__esModule",{value:!0}),e.InvalidStateError=e.UnsupportedError=void 0;var t=function(e){mn(n,e);var t=_n(n);function n(e){var r;return St(this,n),(r=t.call(this,e)).name="UnsupportedError",Error.hasOwnProperty("captureStackTrace")?Error.captureStackTrace(bn(r),n):r.stack=new Error(e).stack,r}return Pt(n)}(as(Error));e.UnsupportedError=t;var n=function(e){mn(n,e);var t=_n(n);function n(e){var r;return St(this,n),(r=t.call(this,e)).name="InvalidStateError",Error.hasOwnProperty("captureStackTrace")?Error.captureStackTrace(bn(r),n):r.stack=new Error(e).stack,r}return Pt(n)}(as(Error));e.InvalidStateError=n}}),bo=ks({"../../node_modules/mediasoup-client/lib/utils.js":function(e){Rs(),Object.defineProperty(e,"__esModule",{value:!0}),e.generateRandomNumber=e.clone=void 0,e.clone=function(e,t){return"undefined"===typeof e?t:JSON.parse(JSON.stringify(e))},e.generateRandomNumber=function(){return Math.round(1e7*Math.random())}}}),yo=ks({"../../node_modules/h264-profile-level-id/index.js":function(e){Rs();var t=po()("h264-profile-level-id");t.log=console.info.bind(console);e.ProfileConstrainedBaseline=1,e.ProfileBaseline=2,e.ProfileMain=3,e.ProfileConstrainedHigh=4,e.ProfileHigh=5;e.Level1_b=0,e.Level1=10,e.Level1_1=11,e.Level1_2=12,e.Level1_3=13,e.Level2=20,e.Level2_1=21,e.Level2_2=22,e.Level3=30,e.Level3_1=31,e.Level3_2=32,e.Level4=40,e.Level4_1=41,e.Level4_2=42,e.Level5=50,e.Level5_1=51,e.Level5_2=52;var n=Pt((function e(t,n){St(this,e),this.profile=t,this.level=n}));e.ProfileLevelId=n;var r=new n(1,31),a=function(){function e(t){St(this,e),this._mask=~o("x",t),this._maskedValue=o("1",t)}return Pt(e,[{key:"isMatch",value:function(e){return this._maskedValue===(e&this._mask)}}]),e}(),i=Pt((function e(t,n,r){St(this,e),this.profile_idc=t,this.profile_iop=n,this.profile=r})),s=[new i(66,new a("x1xx0000"),1),new i(77,new a("1xxx0000"),1),new i(88,new a("11xx0000"),1),new i(66,new a("x0xx0000"),2),new i(88,new a("10xx0000"),2),new i(77,new a("0x0x0000"),3),new i(100,new a("00000000"),5),new i(100,new a("00001100"),4)];function o(e,t){return(t[0]===e)<<7|(t[1]===e)<<6|(t[2]===e)<<5|(t[3]===e)<<4|(t[4]===e)<<3|(t[5]===e)<<2|(t[6]===e)<<1|(t[7]===e)<<0}function c(e,t){return function(e,t){return 0===e?10!==t&&0!==t:0===t?10!==e:e<t}(e,t)?e:t}function u(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e["level-asymmetry-allowed"];return 1===t||"1"===t}e.parseProfileLevelId=function(e){if("string"!==typeof e||6!==e.length)return null;var r=parseInt(e,16);if(0===r)return null;var a,i=255&r,o=r>>8&255,c=r>>16&255;switch(i){case 11:a=0!==(16&o)?0:11;break;case 10:case 12:case 13:case 20:case 21:case 22:case 30:case 31:case 32:case 40:case 41:case 42:case 50:case 51:case 52:a=i;break;default:return t("parseProfileLevelId() | unrecognized level_idc:%s",i),null}var u,l=kr(s);try{for(l.s();!(u=l.n()).done;){var d=u.value;if(c===d.profile_idc&&d.profile_iop.isMatch(o))return new n(d.profile,a)}}catch(p){l.e(p)}finally{l.f()}return t("parseProfileLevelId() | unrecognized profile_idc/profile_iop combination"),null},e.profileLevelIdToString=function(e){if(0==e.level)switch(e.profile){case 1:return"42f00b";case 2:return"42100b";case 3:return"4d100b";default:return t("profileLevelIdToString() | Level 1_b not is allowed for profile:%s",e.profile),null}var n;switch(e.profile){case 1:n="42e0";break;case 2:n="4200";break;case 3:n="4d00";break;case 4:n="640c";break;case 5:n="6400";break;default:return t("profileLevelIdToString() | unrecognized profile:%s",e.profile),null}var r=e.level.toString(16);return 1===r.length&&(r="0".concat(r)),"".concat(n).concat(r)},e.parseSdpProfileLevelId=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t["profile-level-id"];return n?e.parseProfileLevelId(n):r},e.isSameProfile=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=e.parseSdpProfileLevelId(t),a=e.parseSdpProfileLevelId(n);return Boolean(r&&a&&r.profile===a.profile)},e.generateProfileLevelIdForAnswer=function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!r["profile-level-id"]&&!a["profile-level-id"])return t("generateProfileLevelIdForAnswer() | no profile-level-id in local and remote params"),null;var i=e.parseSdpProfileLevelId(r),s=e.parseSdpProfileLevelId(a);if(!i)throw new TypeError("invalid local_profile_level_id");if(!s)throw new TypeError("invalid remote_profile_level_id");if(i.profile!==s.profile)throw new TypeError("H264 Profile mismatch");var o=u(r)&&u(a),l=i.level,d=s.level,p=c(l,d),f=o?l:p;return t("generateProfileLevelIdForAnswer() | result: [profile:%s, level:%s]",i.profile,f),e.profileLevelIdToString(new n(i.profile,f))}}}),_o=ks({"../../node_modules/mediasoup-client/lib/ortc.js":function(e){Rs();var t=e&&e.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var a=Object.getOwnPropertyDescriptor(t,n);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,a)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),n=e&&e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=e&&e.__importStar||function(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var a in e)"default"!==a&&Object.prototype.hasOwnProperty.call(e,a)&&t(r,e,a);return n(r,e),r};Object.defineProperty(e,"__esModule",{value:!0}),e.canReceive=e.canSend=e.generateProbatorRtpParameters=e.reduceCodecs=e.getSendingRemoteRtpParameters=e.getSendingRtpParameters=e.getRecvRtpCapabilities=e.getExtendedRtpCapabilities=e.validateSctpStreamParameters=e.validateSctpParameters=e.validateNumSctpStreams=e.validateSctpCapabilities=e.validateRtcpParameters=e.validateRtpEncodingParameters=e.validateRtpHeaderExtensionParameters=e.validateRtpCodecParameters=e.validateRtpParameters=e.validateRtpHeaderExtension=e.validateRtcpFeedback=e.validateRtpCodecCapability=e.validateRtpCapabilities=void 0;var a=r(yo()),i=r(bo());function s(e){var t=new RegExp("^(audio|video)/(.+)","i");if("object"!==typeof e)throw new TypeError("codec is not an object");if(!e.mimeType||"string"!==typeof e.mimeType)throw new TypeError("missing codec.mimeType");var n=t.exec(e.mimeType);if(!n)throw new TypeError("invalid codec.mimeType");if(e.kind=n[1].toLowerCase(),e.preferredPayloadType&&"number"!==typeof e.preferredPayloadType)throw new TypeError("invalid codec.preferredPayloadType");if("number"!==typeof e.clockRate)throw new TypeError("missing codec.clockRate");"audio"===e.kind?"number"!==typeof e.channels&&(e.channels=1):delete e.channels,e.parameters&&"object"===typeof e.parameters||(e.parameters={});for(var r=0,a=Object.keys(e.parameters);r<a.length;r++){var i=a[r],s=e.parameters[i];if(void 0===s&&(e.parameters[i]="",s=""),"string"!==typeof s&&"number"!==typeof s)throw new TypeError("invalid codec parameter [key:".concat(i,"s, value:").concat(s,"]"));if("apt"===i&&"number"!==typeof s)throw new TypeError("invalid codec apt parameter")}e.rtcpFeedback&&Array.isArray(e.rtcpFeedback)||(e.rtcpFeedback=[]);var c,u=kr(e.rtcpFeedback);try{for(u.s();!(c=u.n()).done;){o(c.value)}}catch(l){u.e(l)}finally{u.f()}}function o(e){if("object"!==typeof e)throw new TypeError("fb is not an object");if(!e.type||"string"!==typeof e.type)throw new TypeError("missing fb.type");e.parameter&&"string"===typeof e.parameter||(e.parameter="")}function c(e){if("object"!==typeof e)throw new TypeError("ext is not an object");if("audio"!==e.kind&&"video"!==e.kind)throw new TypeError("invalid ext.kind");if(!e.uri||"string"!==typeof e.uri)throw new TypeError("missing ext.uri");if("number"!==typeof e.preferredId)throw new TypeError("missing ext.preferredId");if(e.preferredEncrypt&&"boolean"!==typeof e.preferredEncrypt)throw new TypeError("invalid ext.preferredEncrypt");if(e.preferredEncrypt||(e.preferredEncrypt=!1),e.direction&&"string"!==typeof e.direction)throw new TypeError("invalid ext.direction");e.direction||(e.direction="sendrecv")}function u(e){if("object"!==typeof e)throw new TypeError("params is not an object");if(e.mid&&"string"!==typeof e.mid)throw new TypeError("params.mid is not a string");if(!Array.isArray(e.codecs))throw new TypeError("missing params.codecs");var t,n=kr(e.codecs);try{for(n.s();!(t=n.n()).done;){l(t.value)}}catch(o){n.e(o)}finally{n.f()}if(e.headerExtensions&&!Array.isArray(e.headerExtensions))throw new TypeError("params.headerExtensions is not an array");e.headerExtensions||(e.headerExtensions=[]);var r,a=kr(e.headerExtensions);try{for(a.s();!(r=a.n()).done;){d(r.value)}}catch(o){a.e(o)}finally{a.f()}if(e.encodings&&!Array.isArray(e.encodings))throw new TypeError("params.encodings is not an array");e.encodings||(e.encodings=[]);var i,s=kr(e.encodings);try{for(s.s();!(i=s.n()).done;){p(i.value)}}catch(o){s.e(o)}finally{s.f()}if(e.rtcp&&"object"!==typeof e.rtcp)throw new TypeError("params.rtcp is not an object");e.rtcp||(e.rtcp={}),f(e.rtcp)}function l(e){var t=new RegExp("^(audio|video)/(.+)","i");if("object"!==typeof e)throw new TypeError("codec is not an object");if(!e.mimeType||"string"!==typeof e.mimeType)throw new TypeError("missing codec.mimeType");var n=t.exec(e.mimeType);if(!n)throw new TypeError("invalid codec.mimeType");if("number"!==typeof e.payloadType)throw new TypeError("missing codec.payloadType");if("number"!==typeof e.clockRate)throw new TypeError("missing codec.clockRate");"audio"===n[1].toLowerCase()?"number"!==typeof e.channels&&(e.channels=1):delete e.channels,e.parameters&&"object"===typeof e.parameters||(e.parameters={});for(var r=0,a=Object.keys(e.parameters);r<a.length;r++){var i=a[r],s=e.parameters[i];if(void 0===s&&(e.parameters[i]="",s=""),"string"!==typeof s&&"number"!==typeof s)throw new TypeError("invalid codec parameter [key:".concat(i,"s, value:").concat(s,"]"));if("apt"===i&&"number"!==typeof s)throw new TypeError("invalid codec apt parameter")}e.rtcpFeedback&&Array.isArray(e.rtcpFeedback)||(e.rtcpFeedback=[]);var c,u=kr(e.rtcpFeedback);try{for(u.s();!(c=u.n()).done;){o(c.value)}}catch(l){u.e(l)}finally{u.f()}}function d(e){if("object"!==typeof e)throw new TypeError("ext is not an object");if(!e.uri||"string"!==typeof e.uri)throw new TypeError("missing ext.uri");if("number"!==typeof e.id)throw new TypeError("missing ext.id");if(e.encrypt&&"boolean"!==typeof e.encrypt)throw new TypeError("invalid ext.encrypt");e.encrypt||(e.encrypt=!1),e.parameters&&"object"===typeof e.parameters||(e.parameters={});for(var t=0,n=Object.keys(e.parameters);t<n.length;t++){var r=n[t],a=e.parameters[r];if(void 0===a&&(e.parameters[r]="",a=""),"string"!==typeof a&&"number"!==typeof a)throw new TypeError("invalid header extension parameter")}}function p(e){if("object"!==typeof e)throw new TypeError("encoding is not an object");if(e.ssrc&&"number"!==typeof e.ssrc)throw new TypeError("invalid encoding.ssrc");if(e.rid&&"string"!==typeof e.rid)throw new TypeError("invalid encoding.rid");if(e.rtx&&"object"!==typeof e.rtx)throw new TypeError("invalid encoding.rtx");if(e.rtx&&"number"!==typeof e.rtx.ssrc)throw new TypeError("missing encoding.rtx.ssrc");if(e.dtx&&"boolean"===typeof e.dtx||(e.dtx=!1),e.scalabilityMode&&"string"!==typeof e.scalabilityMode)throw new TypeError("invalid encoding.scalabilityMode")}function f(e){if("object"!==typeof e)throw new TypeError("rtcp is not an object");if(e.cname&&"string"!==typeof e.cname)throw new TypeError("invalid rtcp.cname");e.reducedSize&&"boolean"===typeof e.reducedSize||(e.reducedSize=!0)}function h(e){if("object"!==typeof e)throw new TypeError("numStreams is not an object");if("number"!==typeof e.OS)throw new TypeError("missing numStreams.OS");if("number"!==typeof e.MIS)throw new TypeError("missing numStreams.MIS")}function m(e){return!!e&&/.+\/rtx$/i.test(e.mimeType)}function v(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.strict,i=void 0!==r&&r,s=n.modify,o=void 0!==s&&s,c=e.mimeType.toLowerCase(),u=t.mimeType.toLowerCase();if(c!==u)return!1;if(e.clockRate!==t.clockRate)return!1;if(e.channels!==t.channels)return!1;switch(c){case"video/h264":if(i){var l,d=e.parameters["packetization-mode"]||0,p=t.parameters["packetization-mode"]||0;if(d!==p)return!1;if(!a.isSameProfile(e.parameters,t.parameters))return!1;try{l=a.generateProfileLevelIdForAnswer(e.parameters,t.parameters)}catch(m){return!1}o&&(l?(e.parameters["profile-level-id"]=l,t.parameters["profile-level-id"]=l):(delete e.parameters["profile-level-id"],delete t.parameters["profile-level-id"]))}break;case"video/vp9":if(i){var f=e.parameters["profile-id"]||0,h=t.parameters["profile-id"]||0;if(f!==h)return!1}}return!0}function g(e,t){var n,r=[],a=kr(e.rtcpFeedback||[]);try{var i=function(){var e=n.value,a=(t.rtcpFeedback||[]).find((function(t){return t.type===e.type&&(t.parameter===e.parameter||!t.parameter&&!e.parameter)}));a&&r.push(a)};for(a.s();!(n=a.n()).done;)i()}catch(s){a.e(s)}finally{a.f()}return r}e.validateRtpCapabilities=function(e){if("object"!==typeof e)throw new TypeError("caps is not an object");if(e.codecs&&!Array.isArray(e.codecs))throw new TypeError("caps.codecs is not an array");e.codecs||(e.codecs=[]);var t,n=kr(e.codecs);try{for(n.s();!(t=n.n()).done;){s(t.value)}}catch(i){n.e(i)}finally{n.f()}if(e.headerExtensions&&!Array.isArray(e.headerExtensions))throw new TypeError("caps.headerExtensions is not an array");e.headerExtensions||(e.headerExtensions=[]);var r,a=kr(e.headerExtensions);try{for(a.s();!(r=a.n()).done;){c(r.value)}}catch(i){a.e(i)}finally{a.f()}},e.validateRtpCodecCapability=s,e.validateRtcpFeedback=o,e.validateRtpHeaderExtension=c,e.validateRtpParameters=u,e.validateRtpCodecParameters=l,e.validateRtpHeaderExtensionParameters=d,e.validateRtpEncodingParameters=p,e.validateRtcpParameters=f,e.validateSctpCapabilities=function(e){if("object"!==typeof e)throw new TypeError("caps is not an object");if(!e.numStreams||"object"!==typeof e.numStreams)throw new TypeError("missing caps.numStreams");h(e.numStreams)},e.validateNumSctpStreams=h,e.validateSctpParameters=function(e){if("object"!==typeof e)throw new TypeError("params is not an object");if("number"!==typeof e.port)throw new TypeError("missing params.port");if("number"!==typeof e.OS)throw new TypeError("missing params.OS");if("number"!==typeof e.MIS)throw new TypeError("missing params.MIS");if("number"!==typeof e.maxMessageSize)throw new TypeError("missing params.maxMessageSize")},e.validateSctpStreamParameters=function(e){if("object"!==typeof e)throw new TypeError("params is not an object");if("number"!==typeof e.streamId)throw new TypeError("missing params.streamId");var t=!1;if("boolean"===typeof e.ordered?t=!0:e.ordered=!0,e.maxPacketLifeTime&&"number"!==typeof e.maxPacketLifeTime)throw new TypeError("invalid params.maxPacketLifeTime");if(e.maxRetransmits&&"number"!==typeof e.maxRetransmits)throw new TypeError("invalid params.maxRetransmits");if(e.maxPacketLifeTime&&e.maxRetransmits)throw new TypeError("cannot provide both maxPacketLifeTime and maxRetransmits");if(t&&e.ordered&&(e.maxPacketLifeTime||e.maxRetransmits))throw new TypeError("cannot be ordered with maxPacketLifeTime or maxRetransmits");if(t||!e.maxPacketLifeTime&&!e.maxRetransmits||(e.ordered=!1),e.label&&"string"!==typeof e.label)throw new TypeError("invalid params.label");if(e.protocol&&"string"!==typeof e.protocol)throw new TypeError("invalid params.protocol")},e.getExtendedRtpCapabilities=function(e,t){var n,r={codecs:[],headerExtensions:[]},a=kr(t.codecs||[]);try{var i=function(){var t=n.value;if(m(t))return"continue";var a=(e.codecs||[]).find((function(e){return v(e,t,{strict:!0,modify:!0})}));if(!a)return"continue";var i={mimeType:a.mimeType,kind:a.kind,clockRate:a.clockRate,channels:a.channels,localPayloadType:a.preferredPayloadType,localRtxPayloadType:void 0,remotePayloadType:t.preferredPayloadType,remoteRtxPayloadType:void 0,localParameters:a.parameters,remoteParameters:t.parameters,rtcpFeedback:g(a,t)};r.codecs.push(i)};for(a.s();!(n=a.n()).done;)i()}catch(p){a.e(p)}finally{a.f()}var s,o=kr(r.codecs);try{var c=function(){var n=s.value,r=e.codecs.find((function(e){return m(e)&&e.parameters.apt===n.localPayloadType})),a=t.codecs.find((function(e){return m(e)&&e.parameters.apt===n.remotePayloadType}));r&&a&&(n.localRtxPayloadType=r.preferredPayloadType,n.remoteRtxPayloadType=a.preferredPayloadType)};for(o.s();!(s=o.n()).done;)c()}catch(p){o.e(p)}finally{o.f()}var u,l=kr(t.headerExtensions);try{var d=function(){var t=u.value,n=e.headerExtensions.find((function(e){return r=t,(!(n=e).kind||!r.kind||n.kind===r.kind)&&n.uri===r.uri;var n,r}));if(!n)return"continue";var a={kind:t.kind,uri:t.uri,sendId:n.preferredId,recvId:t.preferredId,encrypt:n.preferredEncrypt,direction:"sendrecv"};switch(t.direction){case"sendrecv":a.direction="sendrecv";break;case"recvonly":a.direction="sendonly";break;case"sendonly":a.direction="recvonly";break;case"inactive":a.direction="inactive"}r.headerExtensions.push(a)};for(l.s();!(u=l.n()).done;)d()}catch(p){l.e(p)}finally{l.f()}return r},e.getRecvRtpCapabilities=function(e){var t,n={codecs:[],headerExtensions:[]},r=kr(e.codecs);try{for(r.s();!(t=r.n()).done;){var a=t.value,i={mimeType:a.mimeType,kind:a.kind,preferredPayloadType:a.remotePayloadType,clockRate:a.clockRate,channels:a.channels,parameters:a.localParameters,rtcpFeedback:a.rtcpFeedback};if(n.codecs.push(i),a.remoteRtxPayloadType){var s={mimeType:"".concat(a.kind,"/rtx"),kind:a.kind,preferredPayloadType:a.remoteRtxPayloadType,clockRate:a.clockRate,parameters:{apt:a.remotePayloadType},rtcpFeedback:[]};n.codecs.push(s)}}}catch(d){r.e(d)}finally{r.f()}var o,c=kr(e.headerExtensions);try{for(c.s();!(o=c.n()).done;){var u=o.value;if("sendrecv"===u.direction||"recvonly"===u.direction){var l={kind:u.kind,uri:u.uri,preferredId:u.recvId,preferredEncrypt:u.encrypt,direction:u.direction};n.headerExtensions.push(l)}}}catch(d){c.e(d)}finally{c.f()}return n},e.getSendingRtpParameters=function(e,t){var n,r={mid:void 0,codecs:[],headerExtensions:[],encodings:[],rtcp:{}},a=kr(t.codecs);try{for(a.s();!(n=a.n()).done;){var i=n.value;if(i.kind===e){var s={mimeType:i.mimeType,payloadType:i.localPayloadType,clockRate:i.clockRate,channels:i.channels,parameters:i.localParameters,rtcpFeedback:i.rtcpFeedback};if(r.codecs.push(s),i.localRtxPayloadType){var o={mimeType:"".concat(i.kind,"/rtx"),payloadType:i.localRtxPayloadType,clockRate:i.clockRate,parameters:{apt:i.localPayloadType},rtcpFeedback:[]};r.codecs.push(o)}}}}catch(p){a.e(p)}finally{a.f()}var c,u=kr(t.headerExtensions);try{for(u.s();!(c=u.n()).done;){var l=c.value;if(!(l.kind&&l.kind!==e||"sendrecv"!==l.direction&&"sendonly"!==l.direction)){var d={uri:l.uri,id:l.sendId,encrypt:l.encrypt,parameters:{}};r.headerExtensions.push(d)}}}catch(p){u.e(p)}finally{u.f()}return r},e.getSendingRemoteRtpParameters=function(e,t){var n,r={mid:void 0,codecs:[],headerExtensions:[],encodings:[],rtcp:{}},a=kr(t.codecs);try{for(a.s();!(n=a.n()).done;){var i=n.value;if(i.kind===e){var s={mimeType:i.mimeType,payloadType:i.localPayloadType,clockRate:i.clockRate,channels:i.channels,parameters:i.remoteParameters,rtcpFeedback:i.rtcpFeedback};if(r.codecs.push(s),i.localRtxPayloadType){var o={mimeType:"".concat(i.kind,"/rtx"),payloadType:i.localRtxPayloadType,clockRate:i.clockRate,parameters:{apt:i.localPayloadType},rtcpFeedback:[]};r.codecs.push(o)}}}}catch(w){a.e(w)}finally{a.f()}var c,u=kr(t.headerExtensions);try{for(u.s();!(c=u.n()).done;){var l=c.value;if(!(l.kind&&l.kind!==e||"sendrecv"!==l.direction&&"sendonly"!==l.direction)){var d={uri:l.uri,id:l.sendId,encrypt:l.encrypt,parameters:{}};r.headerExtensions.push(d)}}}catch(w){u.e(w)}finally{u.f()}if(r.headerExtensions.some((function(e){return"http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01"===e.uri}))){var p,f=kr(r.codecs);try{for(f.s();!(p=f.n()).done;){var h=p.value;h.rtcpFeedback=(h.rtcpFeedback||[]).filter((function(e){return"goog-remb"!==e.type}))}}catch(w){f.e(w)}finally{f.f()}}else if(r.headerExtensions.some((function(e){return"http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time"===e.uri}))){var m,v=kr(r.codecs);try{for(v.s();!(m=v.n()).done;){var g=m.value;g.rtcpFeedback=(g.rtcpFeedback||[]).filter((function(e){return"transport-cc"!==e.type}))}}catch(w){v.e(w)}finally{v.f()}}else{var b,y=kr(r.codecs);try{for(y.s();!(b=y.n()).done;){var _=b.value;_.rtcpFeedback=(_.rtcpFeedback||[]).filter((function(e){return"transport-cc"!==e.type&&"goog-remb"!==e.type}))}}catch(w){y.e(w)}finally{y.f()}}return r},e.reduceCodecs=function(e,t){var n=[];if(t){for(var r=0;r<e.length;++r)if(v(e[r],t)){n.push(e[r]),m(e[r+1])&&n.push(e[r+1]);break}if(0===n.length)throw new TypeError("no matching codec found")}else n.push(e[0]),m(e[1])&&n.push(e[1]);return n},e.generateProbatorRtpParameters=function(e){u(e=i.clone(e,{}));var t={mid:"probator",codecs:[],headerExtensions:[],encodings:[{ssrc:1234}],rtcp:{cname:"probator"}};return t.codecs.push(e.codecs[0]),t.codecs[0].payloadType=127,t.headerExtensions=e.headerExtensions,t},e.canSend=function(e,t){return t.codecs.some((function(t){return t.kind===e}))},e.canReceive=function(e,t){if(u(e),0===e.codecs.length)return!1;var n=e.codecs[0];return t.codecs.some((function(e){return e.remotePayloadType===n.payloadType}))}}}),wo=ks({"../../node_modules/awaitqueue/lib/index.js":function(e){Rs();var t=e&&e.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(a,i){function s(e){try{c(r.next(e))}catch(t){i(t)}}function o(e){try{c(r.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,o)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{ClosedErrorClass:Error,StoppedErrorClass:Error,RemovedTaskErrorClass:Error},n=t.ClosedErrorClass,r=void 0===n?Error:n,a=t.StoppedErrorClass,i=void 0===a?Error:a,s=t.RemovedTaskErrorClass,o=void 0===s?Error:s;St(this,e),this.closed=!1,this.pendingTasks=[],this.ClosedErrorClass=Error,this.StoppedErrorClass=Error,this.RemovedTaskErrorClass=Error,this.ClosedErrorClass=r,this.StoppedErrorClass=i,this.RemovedTaskErrorClass=o}return Pt(e,[{key:"size",get:function(){return this.pendingTasks.length}},{key:"close",value:function(){if(!this.closed){this.closed=!0;var e,t=kr(this.pendingTasks);try{for(t.s();!(e=t.n()).done;){var n=e.value;n.stopped=!0,n.reject(new this.ClosedErrorClass("AwaitQueue closed"))}}catch(r){t.e(r)}finally{t.f()}this.pendingTasks.length=0}}},{key:"push",value:function(e,n){return t(this,void 0,void 0,wr().mark((function t(){var r=this;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.closed){t.next=2;break}throw new this.ClosedErrorClass("AwaitQueue closed");case 2:if("function"===typeof e){t.next=4;break}throw new TypeError("given task is not a function");case 4:if(!e.name&&n)try{Object.defineProperty(e,"name",{value:n})}catch(a){}return t.abrupt("return",new Promise((function(t,a){var i={task:e,name:n,resolve:t,reject:a,stopped:!1,enqueuedAt:new Date,executedAt:void 0};r.pendingTasks.push(i),1===r.pendingTasks.length&&r.next()})));case 6:case"end":return t.stop()}}),t,this)})))}},{key:"removeTask",value:function(e){if(0===e)throw new TypeError("cannot remove task with index 0");var t=this.pendingTasks[e];t&&(this.pendingTasks.splice(e,1),t.reject(new this.RemovedTaskErrorClass("task removed from the queue")))}},{key:"stop",value:function(){if(!this.closed){var e,t=kr(this.pendingTasks);try{for(t.s();!(e=t.n()).done;){var n=e.value;n.stopped=!0,n.reject(new this.StoppedErrorClass("AwaitQueue stopped"))}}catch(r){t.e(r)}finally{t.f()}this.pendingTasks.length=0}}},{key:"dump",value:function(){var e=new Date,t=0;return this.pendingTasks.map((function(n){return{idx:t++,task:n.task,name:n.name,enqueuedTime:n.executedAt?n.executedAt.getTime()-n.enqueuedAt.getTime():e.getTime()-n.enqueuedAt.getTime(),executingTime:n.executedAt?e.getTime()-n.executedAt.getTime():0}}))}},{key:"next",value:function(){return t(this,void 0,void 0,wr().mark((function e(){var t;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.pendingTasks[0]){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,this.executeTask(t);case 5:this.pendingTasks.shift(),this.next();case 7:case"end":return e.stop()}}),e,this)})))}},{key:"executeTask",value:function(e){return t(this,void 0,void 0,wr().mark((function t(){var n;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.stopped){t.next=2;break}return t.abrupt("return");case 2:return e.executedAt=new Date,t.prev=3,t.next=6,e.task();case 6:if(n=t.sent,!e.stopped){t.next=9;break}return t.abrupt("return");case 9:e.resolve(n),t.next=17;break;case 12:if(t.prev=12,t.t0=t.catch(3),!e.stopped){t.next=16;break}return t.abrupt("return");case 16:e.reject(t.t0);case 17:case"end":return t.stop()}}),t,null,[[3,12]])})))}}]),e}();e.AwaitQueue=n}}),ko=ks({"../../node_modules/mediasoup-client/lib/Producer.js":function(e){Rs(),Object.defineProperty(e,"__esModule",{value:!0}),e.Producer=void 0;var t=ho(),n=vo(),r=go(),a=new t.Logger("Producer"),i=function(e){mn(i,e);var t=_n(i);function i(e){var r,s=e.id,o=e.localId,c=e.rtpSender,u=e.track,l=e.rtpParameters,d=e.stopTracks,p=e.disableTrackOnPause,f=e.zeroRtpOnPause,h=e.appData;return St(this,i),(r=t.call(this))._closed=!1,r._observer=new n.EnhancedEventEmitter,a.debug("constructor()"),r._id=s,r._localId=o,r._rtpSender=c,r._track=u,r._kind=u.kind,r._rtpParameters=l,r._paused=!!p&&!u.enabled,r._maxSpatialLayer=void 0,r._stopTracks=d,r._disableTrackOnPause=p,r._zeroRtpOnPause=f,r._appData=h||{},r._onTrackEnded=r._onTrackEnded.bind(bn(r)),r._handleTrack(),r}return Pt(i,[{key:"id",get:function(){return this._id}},{key:"localId",get:function(){return this._localId}},{key:"closed",get:function(){return this._closed}},{key:"kind",get:function(){return this._kind}},{key:"rtpSender",get:function(){return this._rtpSender}},{key:"track",get:function(){return this._track}},{key:"rtpParameters",get:function(){return this._rtpParameters}},{key:"paused",get:function(){return this._paused}},{key:"maxSpatialLayer",get:function(){return this._maxSpatialLayer}},{key:"appData",get:function(){return this._appData},set:function(e){throw new Error("cannot override appData object")}},{key:"observer",get:function(){return this._observer}},{key:"close",value:function(){this._closed||(a.debug("close()"),this._closed=!0,this._destroyTrack(),this.emit("@close"),this._observer.safeEmit("close"))}},{key:"transportClosed",value:function(){this._closed||(a.debug("transportClosed()"),this._closed=!0,this._destroyTrack(),this.safeEmit("transportclose"),this._observer.safeEmit("close"))}},{key:"getStats",value:function(){return Ss(this,null,wr().mark((function e(){return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._closed){e.next=2;break}throw new r.InvalidStateError("closed");case 2:return e.abrupt("return",this.safeEmitAsPromise("@getstats"));case 3:case"end":return e.stop()}}),e,this)})))}},{key:"pause",value:function(){a.debug("pause()"),this._closed?a.error("pause() | Producer closed"):(this._paused=!0,this._track&&this._disableTrackOnPause&&(this._track.enabled=!1),this._zeroRtpOnPause&&this.safeEmitAsPromise("@replacetrack",null).catch((function(){})),this._observer.safeEmit("pause"))}},{key:"resume",value:function(){a.debug("resume()"),this._closed?a.error("resume() | Producer closed"):(this._paused=!1,this._track&&this._disableTrackOnPause&&(this._track.enabled=!0),this._zeroRtpOnPause&&this.safeEmitAsPromise("@replacetrack",this._track).catch((function(){})),this._observer.safeEmit("resume"))}},{key:"replaceTrack",value:function(e){return Ss(this,arguments,wr().mark((function e(t){var n;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.track,a.debug("replaceTrack() [track:%o]",n),!this._closed){e.next=7;break}if(n&&this._stopTracks)try{n.stop()}catch(i){}throw new r.InvalidStateError("closed");case 7:if(!n||"ended"!==n.readyState){e.next=9;break}throw new r.InvalidStateError("track ended");case 9:if(n!==this._track){e.next=12;break}return a.debug("replaceTrack() | same track, ignored"),e.abrupt("return");case 12:if(this._zeroRtpOnPause&&this._paused){e.next=15;break}return e.next=15,this.safeEmitAsPromise("@replacetrack",n);case 15:this._destroyTrack(),this._track=n,this._track&&this._disableTrackOnPause&&(this._paused?this._paused&&(this._track.enabled=!1):this._track.enabled=!0),this._handleTrack();case 19:case"end":return e.stop()}}),e,this)})))}},{key:"setMaxSpatialLayer",value:function(e){return Ss(this,null,wr().mark((function t(){return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this._closed){t.next=4;break}throw new r.InvalidStateError("closed");case 4:if("video"===this._kind){t.next=8;break}throw new r.UnsupportedError("not a video Producer");case 8:if("number"===typeof e){t.next=10;break}throw new TypeError("invalid spatialLayer");case 10:if(e!==this._maxSpatialLayer){t.next=12;break}return t.abrupt("return");case 12:return t.next=14,this.safeEmitAsPromise("@setmaxspatiallayer",e);case 14:this._maxSpatialLayer=e;case 15:case"end":return t.stop()}}),t,this)})))}},{key:"setRtpEncodingParameters",value:function(e){return Ss(this,null,wr().mark((function t(){return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this._closed){t.next=4;break}throw new r.InvalidStateError("closed");case 4:if("object"===typeof e){t.next=6;break}throw new TypeError("invalid params");case 6:return t.next=8,this.safeEmitAsPromise("@setrtpencodingparameters",e);case 8:case"end":return t.stop()}}),t,this)})))}},{key:"_onTrackEnded",value:function(){a.debug('track "ended" event'),this.safeEmit("trackended"),this._observer.safeEmit("trackended")}},{key:"_handleTrack",value:function(){this._track&&this._track.addEventListener("ended",this._onTrackEnded)}},{key:"_destroyTrack",value:function(){if(this._track)try{this._track.removeEventListener("ended",this._onTrackEnded),this._stopTracks&&this._track.stop()}catch(e){}}}]),i}(n.EnhancedEventEmitter);e.Producer=i}}),xo=ks({"../../node_modules/mediasoup-client/lib/Consumer.js":function(e){Rs(),Object.defineProperty(e,"__esModule",{value:!0}),e.Consumer=void 0;var t=ho(),n=vo(),r=go(),a=new t.Logger("Consumer"),i=function(e){mn(i,e);var t=_n(i);function i(e){var r,s=e.id,o=e.localId,c=e.producerId,u=e.rtpReceiver,l=e.track,d=e.rtpParameters,p=e.appData;return St(this,i),(r=t.call(this))._closed=!1,r._observer=new n.EnhancedEventEmitter,a.debug("constructor()"),r._id=s,r._localId=o,r._producerId=c,r._rtpReceiver=u,r._track=l,r._rtpParameters=d,r._paused=!l.enabled,r._appData=p||{},r._onTrackEnded=r._onTrackEnded.bind(bn(r)),r._handleTrack(),r}return Pt(i,[{key:"id",get:function(){return this._id}},{key:"localId",get:function(){return this._localId}},{key:"producerId",get:function(){return this._producerId}},{key:"closed",get:function(){return this._closed}},{key:"kind",get:function(){return this._track.kind}},{key:"rtpReceiver",get:function(){return this._rtpReceiver}},{key:"track",get:function(){return this._track}},{key:"rtpParameters",get:function(){return this._rtpParameters}},{key:"paused",get:function(){return this._paused}},{key:"appData",get:function(){return this._appData},set:function(e){throw new Error("cannot override appData object")}},{key:"observer",get:function(){return this._observer}},{key:"close",value:function(){this._closed||(a.debug("close()"),this._closed=!0,this._destroyTrack(),this.emit("@close"),this._observer.safeEmit("close"))}},{key:"transportClosed",value:function(){this._closed||(a.debug("transportClosed()"),this._closed=!0,this._destroyTrack(),this.safeEmit("transportclose"),this._observer.safeEmit("close"))}},{key:"getStats",value:function(){return Ss(this,null,wr().mark((function e(){return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._closed){e.next=2;break}throw new r.InvalidStateError("closed");case 2:return e.abrupt("return",this.safeEmitAsPromise("@getstats"));case 3:case"end":return e.stop()}}),e,this)})))}},{key:"pause",value:function(){a.debug("pause()"),this._closed?a.error("pause() | Consumer closed"):(this._paused=!0,this._track.enabled=!1,this.emit("@pause"),this._observer.safeEmit("pause"))}},{key:"resume",value:function(){a.debug("resume()"),this._closed?a.error("resume() | Consumer closed"):(this._paused=!1,this._track.enabled=!0,this.emit("@resume"),this._observer.safeEmit("resume"))}},{key:"_onTrackEnded",value:function(){a.debug('track "ended" event'),this.safeEmit("trackended"),this._observer.safeEmit("trackended")}},{key:"_handleTrack",value:function(){this._track.addEventListener("ended",this._onTrackEnded)}},{key:"_destroyTrack",value:function(){try{this._track.removeEventListener("ended",this._onTrackEnded),this._track.stop()}catch(e){}}}]),i}(n.EnhancedEventEmitter);e.Consumer=i}}),So=ks({"../../node_modules/mediasoup-client/lib/DataProducer.js":function(e){Rs(),Object.defineProperty(e,"__esModule",{value:!0}),e.DataProducer=void 0;var t=ho(),n=vo(),r=go(),a=new t.Logger("DataProducer"),i=function(e){mn(i,e);var t=_n(i);function i(e){var r,s=e.id,o=e.dataChannel,c=e.sctpStreamParameters,u=e.appData;return St(this,i),(r=t.call(this))._closed=!1,r._observer=new n.EnhancedEventEmitter,a.debug("constructor()"),r._id=s,r._dataChannel=o,r._sctpStreamParameters=c,r._appData=u||{},r._handleDataChannel(),r}return Pt(i,[{key:"id",get:function(){return this._id}},{key:"closed",get:function(){return this._closed}},{key:"sctpStreamParameters",get:function(){return this._sctpStreamParameters}},{key:"readyState",get:function(){return this._dataChannel.readyState}},{key:"label",get:function(){return this._dataChannel.label}},{key:"protocol",get:function(){return this._dataChannel.protocol}},{key:"bufferedAmount",get:function(){return this._dataChannel.bufferedAmount}},{key:"bufferedAmountLowThreshold",get:function(){return this._dataChannel.bufferedAmountLowThreshold},set:function(e){this._dataChannel.bufferedAmountLowThreshold=e}},{key:"appData",get:function(){return this._appData},set:function(e){throw new Error("cannot override appData object")}},{key:"observer",get:function(){return this._observer}},{key:"close",value:function(){this._closed||(a.debug("close()"),this._closed=!0,this._dataChannel.close(),this.emit("@close"),this._observer.safeEmit("close"))}},{key:"transportClosed",value:function(){this._closed||(a.debug("transportClosed()"),this._closed=!0,this._dataChannel.close(),this.safeEmit("transportclose"),this._observer.safeEmit("close"))}},{key:"send",value:function(e){if(a.debug("send()"),this._closed)throw new r.InvalidStateError("closed");this._dataChannel.send(e)}},{key:"_handleDataChannel",value:function(){var e=this;this._dataChannel.addEventListener("open",(function(){e._closed||(a.debug('DataChannel "open" event'),e.safeEmit("open"))})),this._dataChannel.addEventListener("error",(function(t){if(!e._closed){var n=t.error;n||(n=new Error("unknown DataChannel error")),"sctp-failure"===n.errorDetail?a.error("DataChannel SCTP error [sctpCauseCode:%s]: %s",n.sctpCauseCode,n.message):a.error('DataChannel "error" event: %o',n),e.safeEmit("error",n)}})),this._dataChannel.addEventListener("close",(function(){e._closed||(a.warn('DataChannel "close" event'),e._closed=!0,e.emit("@close"),e.safeEmit("close"))})),this._dataChannel.addEventListener("message",(function(){e._closed||a.warn('DataChannel "message" event in a DataProducer, message discarded')})),this._dataChannel.addEventListener("bufferedamountlow",(function(){e._closed||e.safeEmit("bufferedamountlow")}))}}]),i}(n.EnhancedEventEmitter);e.DataProducer=i}}),Ro=ks({"../../node_modules/mediasoup-client/lib/DataConsumer.js":function(e){Rs(),Object.defineProperty(e,"__esModule",{value:!0}),e.DataConsumer=void 0;var t=ho(),n=vo(),r=new t.Logger("DataConsumer"),a=function(e){mn(a,e);var t=_n(a);function a(e){var i,s=e.id,o=e.dataProducerId,c=e.dataChannel,u=e.sctpStreamParameters,l=e.appData;return St(this,a),(i=t.call(this))._closed=!1,i._observer=new n.EnhancedEventEmitter,r.debug("constructor()"),i._id=s,i._dataProducerId=o,i._dataChannel=c,i._sctpStreamParameters=u,i._appData=l||{},i._handleDataChannel(),i}return Pt(a,[{key:"id",get:function(){return this._id}},{key:"dataProducerId",get:function(){return this._dataProducerId}},{key:"closed",get:function(){return this._closed}},{key:"sctpStreamParameters",get:function(){return this._sctpStreamParameters}},{key:"readyState",get:function(){return this._dataChannel.readyState}},{key:"label",get:function(){return this._dataChannel.label}},{key:"protocol",get:function(){return this._dataChannel.protocol}},{key:"binaryType",get:function(){return this._dataChannel.binaryType},set:function(e){this._dataChannel.binaryType=e}},{key:"appData",get:function(){return this._appData},set:function(e){throw new Error("cannot override appData object")}},{key:"observer",get:function(){return this._observer}},{key:"close",value:function(){this._closed||(r.debug("close()"),this._closed=!0,this._dataChannel.close(),this.emit("@close"),this._observer.safeEmit("close"))}},{key:"transportClosed",value:function(){this._closed||(r.debug("transportClosed()"),this._closed=!0,this._dataChannel.close(),this.safeEmit("transportclose"),this._observer.safeEmit("close"))}},{key:"_handleDataChannel",value:function(){var e=this;this._dataChannel.addEventListener("open",(function(){e._closed||(r.debug('DataChannel "open" event'),e.safeEmit("open"))})),this._dataChannel.addEventListener("error",(function(t){if(!e._closed){var n=t.error;n||(n=new Error("unknown DataChannel error")),"sctp-failure"===n.errorDetail?r.error("DataChannel SCTP error [sctpCauseCode:%s]: %s",n.sctpCauseCode,n.message):r.error('DataChannel "error" event: %o',n),e.safeEmit("error",n)}})),this._dataChannel.addEventListener("close",(function(){e._closed||(r.warn('DataChannel "close" event'),e._closed=!0,e.emit("@close"),e.safeEmit("close"))})),this._dataChannel.addEventListener("message",(function(t){e._closed||e.safeEmit("message",t.data)}))}}]),a}(n.EnhancedEventEmitter);e.DataConsumer=a}}),Po=ks({"../../node_modules/mediasoup-client/lib/Transport.js":function(e){Rs();var t=e&&e.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var a=Object.getOwnPropertyDescriptor(t,n);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,a)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),n=e&&e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=e&&e.__importStar||function(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var a in e)"default"!==a&&Object.prototype.hasOwnProperty.call(e,a)&&t(r,e,a);return n(r,e),r};Object.defineProperty(e,"__esModule",{value:!0}),e.Transport=void 0;var a=wo(),i=ho(),s=vo(),o=go(),c=r(bo()),u=r(_o()),l=ko(),d=xo(),p=So(),f=Ro(),h=Pt((function e(t){var n=this;St(this,e),this.consumerOptions=t,this.promise=new Promise((function(e,t){n.resolve=e,n.reject=t}))})),m=new i.Logger("Transport"),v=function(e){mn(n,e);var t=_n(n);function n(e){var r,i=e.direction,u=e.id,l=e.iceParameters,d=e.iceCandidates,p=e.dtlsParameters,f=e.sctpParameters,h=e.iceServers,v=e.iceTransportPolicy,g=e.additionalSettings,b=e.proprietaryConstraints,y=e.appData,_=e.handlerFactory,w=e.extendedRtpCapabilities,k=e.canProduceByKind;return St(this,n),(r=t.call(this))._closed=!1,r._connectionState="new",r._producers=new Map,r._consumers=new Map,r._dataProducers=new Map,r._dataConsumers=new Map,r._probatorConsumerCreated=!1,r._awaitQueue=new a.AwaitQueue({ClosedErrorClass:o.InvalidStateError}),r._pendingConsumerTasks=[],r._consumerCreationInProgress=!1,r._pendingPauseConsumers=new Map,r._consumerPauseInProgress=!1,r._pendingResumeConsumers=new Map,r._consumerResumeInProgress=!1,r._observer=new s.EnhancedEventEmitter,m.debug("constructor() [id:%s, direction:%s]",u,i),r._id=u,r._direction=i,r._extendedRtpCapabilities=w,r._canProduceByKind=k,r._maxSctpMessageSize=f?f.maxMessageSize:null,delete(g=c.clone(g,{})).iceServers,delete g.iceTransportPolicy,delete g.bundlePolicy,delete g.rtcpMuxPolicy,delete g.sdpSemantics,r._handler=_(),r._handler.run({direction:i,iceParameters:l,iceCandidates:d,dtlsParameters:p,sctpParameters:f,iceServers:h,iceTransportPolicy:v,additionalSettings:g,proprietaryConstraints:b,extendedRtpCapabilities:w}),r._appData=y||{},r._handleHandler(),r}return Pt(n,[{key:"id",get:function(){return this._id}},{key:"closed",get:function(){return this._closed}},{key:"direction",get:function(){return this._direction}},{key:"handler",get:function(){return this._handler}},{key:"connectionState",get:function(){return this._connectionState}},{key:"appData",get:function(){return this._appData},set:function(e){throw new Error("cannot override appData object")}},{key:"observer",get:function(){return this._observer}},{key:"close",value:function(){if(!this._closed){m.debug("close()"),this._closed=!0,this._awaitQueue.close(),this._handler.close();var e,t=kr(this._producers.values());try{for(t.s();!(e=t.n()).done;){e.value.transportClosed()}}catch(c){t.e(c)}finally{t.f()}this._producers.clear();var n,r=kr(this._consumers.values());try{for(r.s();!(n=r.n()).done;){n.value.transportClosed()}}catch(c){r.e(c)}finally{r.f()}this._consumers.clear();var a,i=kr(this._dataProducers.values());try{for(i.s();!(a=i.n()).done;){a.value.transportClosed()}}catch(c){i.e(c)}finally{i.f()}this._dataProducers.clear();var s,o=kr(this._dataConsumers.values());try{for(o.s();!(s=o.n()).done;){s.value.transportClosed()}}catch(c){o.e(c)}finally{o.f()}this._dataConsumers.clear(),this._observer.safeEmit("close")}}},{key:"getStats",value:function(){return Ss(this,null,wr().mark((function e(){return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._closed){e.next=2;break}throw new o.InvalidStateError("closed");case 2:return e.abrupt("return",this._handler.getTransportStats());case 3:case"end":return e.stop()}}),e,this)})))}},{key:"restartIce",value:function(e){return Ss(this,arguments,wr().mark((function e(t){var n,r=this;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.iceParameters,m.debug("restartIce()"),!this._closed){e.next=6;break}throw new o.InvalidStateError("closed");case 6:if(n){e.next=8;break}throw new TypeError("missing iceParameters");case 8:return e.abrupt("return",this._awaitQueue.push((function(){return Ss(r,null,wr().mark((function e(){return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._handler.restartIce(n));case 1:case"end":return e.stop()}}),e,this)})))}),"transport.restartIce()"));case 9:case"end":return e.stop()}}),e,this)})))}},{key:"updateIceServers",value:function(){return Ss(this,arguments,wr().mark((function e(){var t,n,r=this,a=arguments;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=a.length>0&&void 0!==a[0]?a[0]:{},n=t.iceServers,m.debug("updateIceServers()"),!this._closed){e.next=6;break}throw new o.InvalidStateError("closed");case 6:if(Array.isArray(n)){e.next=8;break}throw new TypeError("missing iceServers");case 8:return e.abrupt("return",this._awaitQueue.push((function(){return Ss(r,null,wr().mark((function e(){return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._handler.updateIceServers(n));case 1:case"end":return e.stop()}}),e,this)})))}),"transport.updateIceServers()"));case 9:case"end":return e.stop()}}),e,this)})))}},{key:"produce",value:function(){return Ss(this,arguments,wr().mark((function e(){var t,n,r,a,i,s,c,d,p,f,h,v,g,b=this,y=arguments;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=y.length>0&&void 0!==y[0]?y[0]:{},n=t.track,r=t.encodings,a=t.codecOptions,i=t.codec,s=t.stopTracks,c=void 0===s||s,d=t.disableTrackOnPause,p=void 0===d||d,f=t.zeroRtpOnPause,h=void 0!==f&&f,v=t.appData,g=void 0===v?{}:v,m.debug("produce() [track:%o]",n),n){e.next=6;break}throw new TypeError("missing track");case 6:if("send"===this._direction){e.next=10;break}throw new o.UnsupportedError("not a sending Transport");case 10:if(this._canProduceByKind[n.kind]){e.next=14;break}throw new o.UnsupportedError("cannot produce ".concat(n.kind));case 14:if("ended"!==n.readyState){e.next=18;break}throw new o.InvalidStateError("track ended");case 18:if(0!==this.listenerCount("connect")||"new"!==this._connectionState){e.next=22;break}throw new TypeError('no "connect" listener set into this transport');case 22:if(0!==this.listenerCount("produce")){e.next=26;break}throw new TypeError('no "produce" listener set into this transport');case 26:if(!g||"object"===typeof g){e.next=28;break}throw new TypeError("if given, appData must be an object");case 28:return e.abrupt("return",this._awaitQueue.push((function(){return Ss(b,null,wr().mark((function e(){var t,s,o,d,f,m,v,b;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!r||Array.isArray(r)){e.next=4;break}throw TypeError("encodings must be an array");case 4:r&&0===r.length?t=void 0:r&&(t=r.map((function(e){var t={active:!0};return!1===e.active&&(t.active=!1),"boolean"===typeof e.dtx&&(t.dtx=e.dtx),"string"===typeof e.scalabilityMode&&(t.scalabilityMode=e.scalabilityMode),"number"===typeof e.scaleResolutionDownBy&&(t.scaleResolutionDownBy=e.scaleResolutionDownBy),"number"===typeof e.maxBitrate&&(t.maxBitrate=e.maxBitrate),"number"===typeof e.maxFramerate&&(t.maxFramerate=e.maxFramerate),"boolean"===typeof e.adaptivePtime&&(t.adaptivePtime=e.adaptivePtime),"string"===typeof e.priority&&(t.priority=e.priority),"string"===typeof e.networkPriority&&(t.networkPriority=e.networkPriority),t})));case 5:return e.next=7,this._handler.send({track:n,encodings:t,codecOptions:a,codec:i});case 7:return s=e.sent,o=s.localId,d=s.rtpParameters,f=s.rtpSender,e.prev=11,u.validateRtpParameters(d),e.next=15,this.safeEmitAsPromise("produce",{kind:n.kind,rtpParameters:d,appData:g});case 15:return m=e.sent,v=m.id,b=new l.Producer({id:v,localId:o,rtpSender:f,track:n,rtpParameters:d,stopTracks:c,disableTrackOnPause:p,zeroRtpOnPause:h,appData:g}),this._producers.set(b.id,b),this._handleProducer(b),this._observer.safeEmit("newproducer",b),e.abrupt("return",b);case 24:throw e.prev=24,e.t0=e.catch(11),this._handler.stopSending(o).catch((function(){})),e.t0;case 28:case"end":return e.stop()}}),e,this,[[11,24]])})))}),"transport.produce()").catch((function(e){if(c)try{n.stop()}catch(t){}throw e})));case 29:case"end":return e.stop()}}),e,this)})))}},{key:"consume",value:function(e){return Ss(this,arguments,wr().mark((function e(t){var n,r,a,i,s,l,d;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.id,r=t.producerId,a=t.kind,i=t.rtpParameters,s=t.appData,l=void 0===s?{}:s,m.debug("consume()"),i=c.clone(i,void 0),!this._closed){e.next=7;break}throw new o.InvalidStateError("closed");case 7:if("recv"===this._direction){e.next=11;break}throw new o.UnsupportedError("not a receiving Transport");case 11:if("string"===typeof n){e.next=15;break}throw new TypeError("missing id");case 15:if("string"===typeof r){e.next=19;break}throw new TypeError("missing producerId");case 19:if("audio"===a||"video"===a){e.next=23;break}throw new TypeError("invalid kind '".concat(a,"'"));case 23:if(0!==this.listenerCount("connect")||"new"!==this._connectionState){e.next=27;break}throw new TypeError('no "connect" listener set into this transport');case 27:if(!l||"object"===typeof l){e.next=29;break}throw new TypeError("if given, appData must be an object");case 29:if(u.canReceive(i,this._extendedRtpCapabilities)){e.next=32;break}throw new o.UnsupportedError("cannot consume this Producer");case 32:return d=new h({id:n,producerId:r,kind:a,rtpParameters:i,appData:l}),this._pendingConsumerTasks.push(d),!1===this._consumerCreationInProgress&&this._createPendingConsumers(),e.abrupt("return",d.promise);case 36:case"end":return e.stop()}}),e,this)})))}},{key:"produceData",value:function(){return Ss(this,arguments,wr().mark((function e(){var t,n,r,a,i,s,c,l,d,f,h,v=this,g=arguments;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=g.length>0&&void 0!==g[0]?g[0]:{},n=t.ordered,r=void 0===n||n,a=t.maxPacketLifeTime,i=t.maxRetransmits,s=t.label,c=void 0===s?"":s,l=t.protocol,d=void 0===l?"":l,f=t.appData,h=void 0===f?{}:f,m.debug("produceData()"),"send"===this._direction){e.next=6;break}throw new o.UnsupportedError("not a sending Transport");case 6:if(this._maxSctpMessageSize){e.next=10;break}throw new o.UnsupportedError("SCTP not enabled by remote Transport");case 10:if(0!==this.listenerCount("connect")||"new"!==this._connectionState){e.next=14;break}throw new TypeError('no "connect" listener set into this transport');case 14:if(0!==this.listenerCount("producedata")){e.next=18;break}throw new TypeError('no "producedata" listener set into this transport');case 18:if(!h||"object"===typeof h){e.next=20;break}throw new TypeError("if given, appData must be an object");case 20:return(a||i)&&(r=!1),e.abrupt("return",this._awaitQueue.push((function(){return Ss(v,null,wr().mark((function e(){var t,n,s,o,l,f;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._handler.sendDataChannel({ordered:r,maxPacketLifeTime:a,maxRetransmits:i,label:c,protocol:d});case 2:return t=e.sent,n=t.dataChannel,s=t.sctpStreamParameters,u.validateSctpStreamParameters(s),e.next=8,this.safeEmitAsPromise("producedata",{sctpStreamParameters:s,label:c,protocol:d,appData:h});case 8:return o=e.sent,l=o.id,f=new p.DataProducer({id:l,dataChannel:n,sctpStreamParameters:s,appData:h}),this._dataProducers.set(f.id,f),this._handleDataProducer(f),this._observer.safeEmit("newdataproducer",f),e.abrupt("return",f);case 15:case"end":return e.stop()}}),e,this)})))}),"transport.produceData()"));case 22:case"end":return e.stop()}}),e,this)})))}},{key:"consumeData",value:function(e){return Ss(this,arguments,wr().mark((function e(t){var n,r,a,i,s,l,d,p,h,v=this;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.id,r=t.dataProducerId,a=t.sctpStreamParameters,i=t.label,s=void 0===i?"":i,l=t.protocol,d=void 0===l?"":l,p=t.appData,h=void 0===p?{}:p,m.debug("consumeData()"),a=c.clone(a,void 0),!this._closed){e.next=7;break}throw new o.InvalidStateError("closed");case 7:if("recv"===this._direction){e.next=11;break}throw new o.UnsupportedError("not a receiving Transport");case 11:if(this._maxSctpMessageSize){e.next=15;break}throw new o.UnsupportedError("SCTP not enabled by remote Transport");case 15:if("string"===typeof n){e.next=19;break}throw new TypeError("missing id");case 19:if("string"===typeof r){e.next=23;break}throw new TypeError("missing dataProducerId");case 23:if(0!==this.listenerCount("connect")||"new"!==this._connectionState){e.next=27;break}throw new TypeError('no "connect" listener set into this transport');case 27:if(!h||"object"===typeof h){e.next=29;break}throw new TypeError("if given, appData must be an object");case 29:return u.validateSctpStreamParameters(a),e.abrupt("return",this._awaitQueue.push((function(){return Ss(v,null,wr().mark((function e(){var t,i,o;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._handler.receiveDataChannel({sctpStreamParameters:a,label:s,protocol:d});case 2:return t=e.sent,i=t.dataChannel,o=new f.DataConsumer({id:n,dataProducerId:r,dataChannel:i,sctpStreamParameters:a,appData:h}),this._dataConsumers.set(o.id,o),this._handleDataConsumer(o),this._observer.safeEmit("newdataconsumer",o),e.abrupt("return",o);case 9:case"end":return e.stop()}}),e,this)})))}),"transport.consumeData()"));case 31:case"end":return e.stop()}}),e,this)})))}},{key:"_createPendingConsumers",value:function(){return Ss(this,null,wr().mark((function e(){var t=this;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this._awaitQueue.push((function(){return Ss(t,null,wr().mark((function e(){var t,n,r,a,i,s,o,c,l,p,f,h,v,g,b,y,_,w,k,x,S,R,P,C,T,E,O;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this._consumerCreationInProgress=!0,t=xt(this._pendingConsumerTasks),this._pendingConsumerTasks=[],n=void 0,r=[],a=kr(t);try{for(a.s();!(i=a.n()).done;)s=i.value,o=s.consumerOptions,c=o.id,l=o.kind,p=o.rtpParameters,r.push({trackId:c,kind:l,rtpParameters:p})}catch(M){a.e(M)}finally{a.f()}return e.prev=7,e.next=10,this._handler.receive(r);case 10:for(f=e.sent,h=0;h<f.length;h++)v=t[h],g=f[h],b=v.consumerOptions,y=b.id,_=b.producerId,w=b.kind,k=b.rtpParameters,x=b.appData,S=g.localId,R=g.rtpReceiver,P=g.track,C=new d.Consumer({id:y,localId:S,producerId:_,rtpReceiver:R,track:P,rtpParameters:k,appData:x}),this._consumers.set(C.id,C),this._handleConsumer(C),this._probatorConsumerCreated||n||"video"!==w||(n=C),this._observer.safeEmit("newconsumer",C),v.resolve(C);e.next=18;break;case 14:e.prev=14,e.t0=e.catch(7),T=kr(t);try{for(T.s();!(E=T.n()).done;)E.value.reject(e.t0)}catch(M){T.e(M)}finally{T.f()}case 18:if(!n){e.next=30;break}return e.prev=19,O=u.generateProbatorRtpParameters(n.rtpParameters),e.next=23,this._handler.receive([{trackId:"probator",kind:"video",rtpParameters:O}]);case 23:m.debug("_createPendingConsumers() | Consumer for RTP probation created"),this._probatorConsumerCreated=!0,e.next=30;break;case 27:e.prev=27,e.t1=e.catch(19),m.error("_createPendingConsumers() | failed to create Consumer for RTP probation:%o",e.t1);case 30:this._consumerCreationInProgress=!1;case 31:case"end":return e.stop()}}),e,this,[[7,14],[19,27]])})))}),"transport._createPendingConsumers()").then((function(){t._pendingConsumerTasks.length>0&&t._createPendingConsumers()})).catch((function(){}));case 1:case"end":return e.stop()}}),e,this)})))}},{key:"_pausePendingConsumers",value:function(){var e=this;this._awaitQueue.push((function(){return Ss(e,null,wr().mark((function e(){var t;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this._consumerPauseInProgress=!0,t=Array.from(this._pendingPauseConsumers.values()),this._pendingPauseConsumers.clear(),e.prev=3,e.next=6,this._handler.pauseReceiving(t.map((function(e){return e.localId})));case 6:e.next=11;break;case 8:e.prev=8,e.t0=e.catch(3),m.error("_pausePendingConsumers() | failed to pause Consumers:",e.t0);case 11:this._consumerPauseInProgress=!1;case 12:case"end":return e.stop()}}),e,this,[[3,8]])})))}),"consumer @pause event").then((function(){e._pendingPauseConsumers.size>0&&e._pausePendingConsumers()})).catch((function(){}))}},{key:"_resumePendingConsumers",value:function(){var e=this;this._awaitQueue.push((function(){return Ss(e,null,wr().mark((function e(){var t;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this._consumerResumeInProgress=!0,t=Array.from(this._pendingResumeConsumers.values()),this._pendingResumeConsumers.clear(),e.prev=3,e.next=6,this._handler.resumeReceiving(t.map((function(e){return e.localId})));case 6:e.next=11;break;case 8:e.prev=8,e.t0=e.catch(3),m.error("_resumePendingConsumers() | failed to resume Consumers:",e.t0);case 11:case"end":return e.stop()}}),e,this,[[3,8]])})))}),"consumer @resume event").then((function(){e._consumerResumeInProgress=!1,e._pendingResumeConsumers.size>0&&e._resumePendingConsumers()})).catch((function(){}))}},{key:"_handleHandler",value:function(){var e=this,t=this._handler;t.on("@connect",(function(t,n,r){var a=t.dtlsParameters;e._closed?r(new o.InvalidStateError("closed")):e.safeEmit("connect",{dtlsParameters:a},n,r)})),t.on("@connectionstatechange",(function(t){t!==e._connectionState&&(m.debug("connection state changed to %s",t),e._connectionState=t,e._closed||e.safeEmit("connectionstatechange",t))}))}},{key:"_handleProducer",value:function(e){var t=this;e.on("@close",(function(){t._producers.delete(e.id),t._closed||t._awaitQueue.push((function(){return Ss(t,null,wr().mark((function t(){return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this._handler.stopSending(e.localId));case 1:case"end":return t.stop()}}),t,this)})))}),"producer @close event").catch((function(e){return m.warn("producer.close() failed:%o",e)}))})),e.on("@replacetrack",(function(n,r,a){t._awaitQueue.push((function(){return Ss(t,null,wr().mark((function t(){return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this._handler.replaceTrack(e.localId,n));case 1:case"end":return t.stop()}}),t,this)})))}),"producer @replacetrack event").then(r).catch(a)})),e.on("@setmaxspatiallayer",(function(n,r,a){t._awaitQueue.push((function(){return Ss(t,null,wr().mark((function t(){return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this._handler.setMaxSpatialLayer(e.localId,n));case 1:case"end":return t.stop()}}),t,this)})))}),"producer @setmaxspatiallayer event").then(r).catch(a)})),e.on("@setrtpencodingparameters",(function(n,r,a){t._awaitQueue.push((function(){return Ss(t,null,wr().mark((function t(){return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this._handler.setRtpEncodingParameters(e.localId,n));case 1:case"end":return t.stop()}}),t,this)})))}),"producer @setrtpencodingparameters event").then(r).catch(a)})),e.on("@getstats",(function(n,r){if(t._closed)return r(new o.InvalidStateError("closed"));t._handler.getSenderStats(e.localId).then(n).catch(r)}))}},{key:"_handleConsumer",value:function(e){var t=this;e.on("@close",(function(){t._consumers.delete(e.id),t._pendingPauseConsumers.delete(e.id),t._pendingResumeConsumers.delete(e.id),t._closed||t._awaitQueue.push((function(){return Ss(t,null,wr().mark((function t(){return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this._handler.stopReceiving(e.localId));case 1:case"end":return t.stop()}}),t,this)})))}),"consumer @close event").catch((function(){}))})),e.on("@pause",(function(){t._pendingResumeConsumers.has(e.id)&&t._pendingResumeConsumers.delete(e.id),t._pendingPauseConsumers.set(e.id,e),!1===t._consumerPauseInProgress&&t._pausePendingConsumers()})),e.on("@resume",(function(){t._pendingPauseConsumers.has(e.id)&&t._pendingPauseConsumers.delete(e.id),t._pendingResumeConsumers.set(e.id,e),!1===t._consumerResumeInProgress&&t._resumePendingConsumers()})),e.on("@getstats",(function(n,r){if(t._closed)return r(new o.InvalidStateError("closed"));t._handler.getReceiverStats(e.localId).then(n).catch(r)}))}},{key:"_handleDataProducer",value:function(e){var t=this;e.on("@close",(function(){t._dataProducers.delete(e.id)}))}},{key:"_handleDataConsumer",value:function(e){var t=this;e.on("@close",(function(){t._dataConsumers.delete(e.id)}))}}]),n}(s.EnhancedEventEmitter);e.Transport=v}}),Co=ks({"../../node_modules/mediasoup-client/lib/handlers/sdp/commonUtils.js":function(e){Rs();var t=e&&e.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var a=Object.getOwnPropertyDescriptor(t,n);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,a)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),n=e&&e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=e&&e.__importStar||function(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var a in e)"default"!==a&&Object.prototype.hasOwnProperty.call(e,a)&&t(r,e,a);return n(r,e),r};Object.defineProperty(e,"__esModule",{value:!0}),e.applyCodecParameters=e.getCname=e.extractDtlsParameters=e.extractRtpCapabilities=void 0;var a=r(co());e.extractRtpCapabilities=function(e){var t,n=e.sdpObject,r=new Map,i=[],s=!1,o=!1,c=kr(n.media);try{for(c.s();!(t=c.n()).done;){var u=t.value,l=u.type;switch(l){case"audio":if(s)continue;s=!0;break;case"video":if(o)continue;o=!0;break;default:continue}var d,p=kr(u.rtp);try{for(p.s();!(d=p.n()).done;){var f=d.value,h={kind:l,mimeType:"".concat(l,"/").concat(f.codec),preferredPayloadType:f.payload,clockRate:f.rate,channels:f.encoding,parameters:{},rtcpFeedback:[]};r.set(h.preferredPayloadType,h)}}catch(E){p.e(E)}finally{p.f()}var m,v=kr(u.fmtp||[]);try{for(v.s();!(m=v.n()).done;){var g=m.value,b=a.parseParams(g.config),y=r.get(g.payload);y&&(b&&b.hasOwnProperty("profile-level-id")&&(b["profile-level-id"]=String(b["profile-level-id"])),y.parameters=b)}}catch(E){v.e(E)}finally{v.f()}var _,w=kr(u.rtcpFb||[]);try{for(w.s();!(_=w.n()).done;){var k=_.value,x=r.get(k.payload);if(x){var S={type:k.type,parameter:k.subtype};S.parameter||delete S.parameter,x.rtcpFeedback.push(S)}}}catch(E){w.e(E)}finally{w.f()}var R,P=kr(u.ext||[]);try{for(P.s();!(R=P.n()).done;){var C=R.value;if(!C["encrypt-uri"]){var T={kind:l,uri:C.uri,preferredId:C.value};i.push(T)}}}catch(E){P.e(E)}finally{P.f()}}}catch(E){c.e(E)}finally{c.f()}return{codecs:Array.from(r.values()),headerExtensions:i}},e.extractDtlsParameters=function(e){var t=e.sdpObject,n=(t.media||[]).find((function(e){return e.iceUfrag&&0!==e.port}));if(!n)throw new Error("no active media section found");var r,a=n.fingerprint||t.fingerprint;switch(n.setup){case"active":r="client";break;case"passive":r="server";break;case"actpass":r="auto"}return{role:r,fingerprints:[{algorithm:a.type,value:a.hash}]}},e.getCname=function(e){var t=(e.offerMediaObject.ssrcs||[]).find((function(e){return"cname"===e.attribute}));return t?t.value:""},e.applyCodecParameters=function(e){var t,n=e.offerRtpParameters,r=e.answerMediaObject,i=kr(n.codecs);try{var s=function(){var e=t.value,n=e.mimeType.toLowerCase();if("audio/opus"!==n)return"continue";if(!(r.rtp||[]).find((function(t){return t.payload===e.payloadType})))return"continue";r.fmtp=r.fmtp||[];var i=r.fmtp.find((function(t){return t.payload===e.payloadType}));i||(i={payload:e.payloadType,config:""},r.fmtp.push(i));var s=a.parseParams(i.config);if("audio/opus"===n){var o=e.parameters["sprop-stereo"];void 0!==o&&(s.stereo=o?1:0)}i.config="";for(var c=0,u=Object.keys(s);c<u.length;c++){var l=u[c];i.config&&(i.config+=";"),i.config+="".concat(l,"=").concat(s[l])}};for(i.s();!(t=i.n()).done;)s()}catch(o){i.e(o)}finally{i.f()}}}}),To=ks({"../../node_modules/mediasoup-client/lib/handlers/sdp/unifiedPlanUtils.js":function(e){Rs(),Object.defineProperty(e,"__esModule",{value:!0}),e.addLegacySimulcast=e.getRtpEncodings=void 0,e.getRtpEncodings=function(e){var t,n=e.offerMediaObject,r=new Set,a=kr(n.ssrcs||[]);try{for(a.s();!(t=a.n()).done;){var i=t.value.id;r.add(i)}}catch(S){a.e(S)}finally{a.f()}if(0===r.size)throw new Error("no a=ssrc lines found");var o,c=new Map,u=kr(n.ssrcGroups||[]);try{for(u.s();!(o=u.n()).done;){var l=o.value;if("FID"===l.semantics){var d=s(l.ssrcs.split(/\s+/),2),p=d[0],f=d[1];p=Number(p),f=Number(f),r.has(p)&&(r.delete(p),r.delete(f),c.set(p,f))}}}catch(S){u.e(S)}finally{u.f()}var h,m=kr(r);try{for(m.s();!(h=m.n()).done;){var v=h.value;c.set(v,null)}}catch(S){m.e(S)}finally{m.f()}var g,b=[],y=kr(c);try{for(y.s();!(g=y.n()).done;){var _=s(g.value,2),w=_[0],k=_[1],x={ssrc:w};k&&(x.rtx={ssrc:k}),b.push(x)}}catch(S){y.e(S)}finally{y.f()}return b},e.addLegacySimulcast=function(e){var t=e.offerMediaObject,n=e.numStreams;if(n<=1)throw new TypeError("numStreams must be greater than 1");var r=(t.ssrcs||[]).find((function(e){return"msid"===e.attribute}));if(!r)throw new Error("a=ssrc line with msid information not found");var a,i=s(r.value.split(" "),2),o=i[0],c=i[1],u=r.id;(t.ssrcGroups||[]).some((function(e){if("FID"!==e.semantics)return!1;var t=e.ssrcs.split(/\s+/);return Number(t[0])===u&&(a=Number(t[1]),!0)}));var l=t.ssrcs.find((function(e){return"cname"===e.attribute}));if(!l)throw new Error("a=ssrc line with cname information not found");for(var d=l.value,p=[],f=[],h=0;h<n;++h)p.push(u+h),a&&f.push(a+h);t.ssrcGroups=[],t.ssrcs=[],t.ssrcGroups.push({semantics:"SIM",ssrcs:p.join(" ")});for(var m=0;m<p.length;++m){var v=p[m];t.ssrcs.push({id:v,attribute:"cname",value:d}),t.ssrcs.push({id:v,attribute:"msid",value:"".concat(o," ").concat(c)})}for(var g=0;g<f.length;++g){var b=p[g],y=f[g];t.ssrcs.push({id:y,attribute:"cname",value:d}),t.ssrcs.push({id:y,attribute:"msid",value:"".concat(o," ").concat(c)}),t.ssrcGroups.push({semantics:"FID",ssrcs:"".concat(b," ").concat(y)})}}}}),Eo=ks({"../../node_modules/mediasoup-client/lib/handlers/HandlerInterface.js":function(e){Rs(),Object.defineProperty(e,"__esModule",{value:!0}),e.HandlerInterface=void 0;var t=function(e){mn(n,e);var t=_n(n);function n(){return St(this,n),t.call(this)}return Pt(n)}(vo().EnhancedEventEmitter);e.HandlerInterface=t}}),Oo=ks({"../../node_modules/mediasoup-client/lib/handlers/sdp/MediaSection.js":function(e){Rs();var t=e&&e.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var a=Object.getOwnPropertyDescriptor(t,n);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,a)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),n=e&&e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=e&&e.__importStar||function(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var a in e)"default"!==a&&Object.prototype.hasOwnProperty.call(e,a)&&t(r,e,a);return n(r,e),r};Object.defineProperty(e,"__esModule",{value:!0}),e.OfferMediaSection=e.AnswerMediaSection=e.MediaSection=void 0;var a=r(bo()),i=function(){function e(t){var n=t.iceParameters,r=t.iceCandidates,a=t.dtlsParameters,i=t.planB,s=void 0!==i&&i;if(St(this,e),this._mediaObject={},this._planB=s,n&&this.setIceParameters(n),r){this._mediaObject.candidates=[];var o,c=kr(r);try{for(c.s();!(o=c.n()).done;){var u=o.value,l={component:1};l.foundation=u.foundation,l.ip=u.ip,l.port=u.port,l.priority=u.priority,l.transport=u.protocol,l.type=u.type,u.tcpType&&(l.tcptype=u.tcpType),this._mediaObject.candidates.push(l)}}catch(d){c.e(d)}finally{c.f()}this._mediaObject.endOfCandidates="end-of-candidates",this._mediaObject.iceOptions="renomination"}a&&this.setDtlsRole(a.role)}return Pt(e,[{key:"mid",get:function(){return String(this._mediaObject.mid)}},{key:"closed",get:function(){return 0===this._mediaObject.port}},{key:"getObject",value:function(){return this._mediaObject}},{key:"setIceParameters",value:function(e){this._mediaObject.iceUfrag=e.usernameFragment,this._mediaObject.icePwd=e.password}},{key:"disable",value:function(){this._mediaObject.direction="inactive",delete this._mediaObject.ext,delete this._mediaObject.ssrcs,delete this._mediaObject.ssrcGroups,delete this._mediaObject.simulcast,delete this._mediaObject.simulcast_03,delete this._mediaObject.rids}},{key:"close",value:function(){this._mediaObject.direction="inactive",this._mediaObject.port=0,delete this._mediaObject.ext,delete this._mediaObject.ssrcs,delete this._mediaObject.ssrcGroups,delete this._mediaObject.simulcast,delete this._mediaObject.simulcast_03,delete this._mediaObject.rids,delete this._mediaObject.extmapAllowMixed}}]),e}();e.MediaSection=i;var s=function(e){mn(n,e);var t=_n(n);function n(e){var r,i=e.iceParameters,s=e.iceCandidates,o=e.dtlsParameters,u=e.sctpParameters,l=e.plainRtpParameters,d=e.planB,p=void 0!==d&&d,f=e.offerMediaObject,h=e.offerRtpParameters,m=e.answerRtpParameters,v=e.codecOptions,g=e.extmapAllowMixed,b=void 0!==g&&g;switch(St(this,n),(r=t.call(this,{iceParameters:i,iceCandidates:s,dtlsParameters:o,planB:p}))._mediaObject.mid=String(f.mid),r._mediaObject.type=f.type,r._mediaObject.protocol=f.protocol,l?(r._mediaObject.connection={ip:l.ip,version:l.ipVersion},r._mediaObject.port=l.port):(r._mediaObject.connection={ip:"127.0.0.1",version:4},r._mediaObject.port=7),f.type){case"audio":case"video":r._mediaObject.direction="recvonly",r._mediaObject.rtp=[],r._mediaObject.rtcpFb=[],r._mediaObject.fmtp=[];var y,_=kr(m.codecs);try{var w=function(){var e=y.value,t={payload:e.payloadType,codec:c(e),rate:e.clockRate};e.channels>1&&(t.encoding=e.channels),r._mediaObject.rtp.push(t);var n=a.clone(e.parameters,{});if(v){var i=v.opusStereo,s=v.opusFec,o=v.opusDtx,u=v.opusMaxPlaybackRate,l=v.opusMaxAverageBitrate,d=v.opusPtime,p=v.videoGoogleStartBitrate,f=v.videoGoogleMaxBitrate,m=v.videoGoogleMinBitrate,g=h.codecs.find((function(t){return t.payloadType===e.payloadType}));switch(e.mimeType.toLowerCase()){case"audio/opus":void 0!==i&&(g.parameters["sprop-stereo"]=i?1:0,n.stereo=i?1:0),void 0!==s&&(g.parameters.useinbandfec=s?1:0,n.useinbandfec=s?1:0),void 0!==o&&(g.parameters.usedtx=o?1:0,n.usedtx=o?1:0),void 0!==u&&(n.maxplaybackrate=u),void 0!==l&&(n.maxaveragebitrate=l),void 0!==d&&(g.parameters.ptime=d,n.ptime=d);break;case"video/vp8":case"video/vp9":case"video/h264":case"video/h265":void 0!==p&&(n["x-google-start-bitrate"]=p),void 0!==f&&(n["x-google-max-bitrate"]=f),void 0!==m&&(n["x-google-min-bitrate"]=m)}}for(var b={payload:e.payloadType,config:""},_=0,w=Object.keys(n);_<w.length;_++){var k=w[_];b.config&&(b.config+=";"),b.config+="".concat(k,"=").concat(n[k])}b.config&&r._mediaObject.fmtp.push(b);var x,S=kr(e.rtcpFeedback);try{for(S.s();!(x=S.n()).done;){var R=x.value;r._mediaObject.rtcpFb.push({payload:e.payloadType,type:R.type,subtype:R.parameter})}}catch(P){S.e(P)}finally{S.f()}};for(_.s();!(y=_.n()).done;)w()}catch(M){_.e(M)}finally{_.f()}r._mediaObject.payloads=m.codecs.map((function(e){return e.payloadType})).join(" "),r._mediaObject.ext=[];var k,x=kr(m.headerExtensions);try{var S=function(){var e=k.value;if(!(f.ext||[]).some((function(t){return t.uri===e.uri})))return"continue";r._mediaObject.ext.push({uri:e.uri,value:e.id})};for(x.s();!(k=x.n()).done;)S()}catch(M){x.e(M)}finally{x.f()}if(b&&"extmap-allow-mixed"===f.extmapAllowMixed&&(r._mediaObject.extmapAllowMixed="extmap-allow-mixed"),f.simulcast){r._mediaObject.simulcast={dir1:"recv",list1:f.simulcast.list1},r._mediaObject.rids=[];var R,P=kr(f.rids||[]);try{for(P.s();!(R=P.n()).done;){var C=R.value;"send"===C.direction&&r._mediaObject.rids.push({id:C.id,direction:"recv"})}}catch(M){P.e(M)}finally{P.f()}}else if(f.simulcast_03){r._mediaObject.simulcast_03={value:f.simulcast_03.value.replace(/send/g,"recv")},r._mediaObject.rids=[];var T,E=kr(f.rids||[]);try{for(E.s();!(T=E.n()).done;){var O=T.value;"send"===O.direction&&r._mediaObject.rids.push({id:O.id,direction:"recv"})}}catch(M){E.e(M)}finally{E.f()}}r._mediaObject.rtcpMux="rtcp-mux",r._mediaObject.rtcpRsize="rtcp-rsize",r._planB&&"video"===r._mediaObject.type&&(r._mediaObject.xGoogleFlag="conference");break;case"application":"number"===typeof f.sctpPort?(r._mediaObject.payloads="webrtc-datachannel",r._mediaObject.sctpPort=u.port,r._mediaObject.maxMessageSize=u.maxMessageSize):f.sctpmap&&(r._mediaObject.payloads=u.port,r._mediaObject.sctpmap={app:"webrtc-datachannel",sctpmapNumber:u.port,maxMessageSize:u.maxMessageSize})}return r}return Pt(n,[{key:"setDtlsRole",value:function(e){switch(e){case"client":this._mediaObject.setup="active";break;case"server":this._mediaObject.setup="passive";break;case"auto":this._mediaObject.setup="actpass"}}}]),n}(i);e.AnswerMediaSection=s;var o=function(e){mn(n,e);var t=_n(n);function n(e){var r,a=e.iceParameters,i=e.iceCandidates,s=e.dtlsParameters,o=e.sctpParameters,u=e.plainRtpParameters,l=e.planB,d=void 0!==l&&l,p=e.mid,f=e.kind,h=e.offerRtpParameters,m=e.streamId,v=e.trackId,g=e.oldDataChannelSpec,b=void 0!==g&&g;switch(St(this,n),(r=t.call(this,{iceParameters:a,iceCandidates:i,dtlsParameters:s,planB:d}))._mediaObject.mid=String(p),r._mediaObject.type=f,u?(r._mediaObject.connection={ip:u.ip,version:u.ipVersion},r._mediaObject.protocol="RTP/AVP",r._mediaObject.port=u.port):(r._mediaObject.connection={ip:"127.0.0.1",version:4},r._mediaObject.protocol=o?"UDP/DTLS/SCTP":"UDP/TLS/RTP/SAVPF",r._mediaObject.port=7),f){case"audio":case"video":r._mediaObject.direction="sendonly",r._mediaObject.rtp=[],r._mediaObject.rtcpFb=[],r._mediaObject.fmtp=[],r._planB||(r._mediaObject.msid="".concat(m||"-"," ").concat(v));var y,_=kr(h.codecs);try{for(_.s();!(y=_.n()).done;){var w=y.value,k={payload:w.payloadType,codec:c(w),rate:w.clockRate};w.channels>1&&(k.encoding=w.channels),r._mediaObject.rtp.push(k);for(var x={payload:w.payloadType,config:""},S=0,R=Object.keys(w.parameters);S<R.length;S++){var P=R[S];x.config&&(x.config+=";"),x.config+="".concat(P,"=").concat(w.parameters[P])}x.config&&r._mediaObject.fmtp.push(x);var C,T=kr(w.rtcpFeedback);try{for(T.s();!(C=T.n()).done;){var E=C.value;r._mediaObject.rtcpFb.push({payload:w.payloadType,type:E.type,subtype:E.parameter})}}catch(A){T.e(A)}finally{T.f()}}}catch(A){_.e(A)}finally{_.f()}r._mediaObject.payloads=h.codecs.map((function(e){return e.payloadType})).join(" "),r._mediaObject.ext=[];var O,M=kr(h.headerExtensions);try{for(M.s();!(O=M.n()).done;){var I=O.value;r._mediaObject.ext.push({uri:I.uri,value:I.id})}}catch(A){M.e(A)}finally{M.f()}r._mediaObject.rtcpMux="rtcp-mux",r._mediaObject.rtcpRsize="rtcp-rsize";var D=h.encodings[0],j=D.ssrc,L=D.rtx&&D.rtx.ssrc?D.rtx.ssrc:void 0;r._mediaObject.ssrcs=[],r._mediaObject.ssrcGroups=[],h.rtcp.cname&&r._mediaObject.ssrcs.push({id:j,attribute:"cname",value:h.rtcp.cname}),r._planB&&r._mediaObject.ssrcs.push({id:j,attribute:"msid",value:"".concat(m||"-"," ").concat(v)}),L&&(h.rtcp.cname&&r._mediaObject.ssrcs.push({id:L,attribute:"cname",value:h.rtcp.cname}),r._planB&&r._mediaObject.ssrcs.push({id:L,attribute:"msid",value:"".concat(m||"-"," ").concat(v)}),r._mediaObject.ssrcGroups.push({semantics:"FID",ssrcs:"".concat(j," ").concat(L)}));break;case"application":b?(r._mediaObject.payloads=o.port,r._mediaObject.sctpmap={app:"webrtc-datachannel",sctpmapNumber:o.port,maxMessageSize:o.maxMessageSize}):(r._mediaObject.payloads="webrtc-datachannel",r._mediaObject.sctpPort=o.port,r._mediaObject.maxMessageSize=o.maxMessageSize)}return r}return Pt(n,[{key:"setDtlsRole",value:function(e){this._mediaObject.setup="actpass"}},{key:"planBReceive",value:function(e){var t,n=this,r=e.offerRtpParameters,a=e.streamId,i=e.trackId,s=r.encodings[0],o=s.ssrc,u=s.rtx&&s.rtx.ssrc?s.rtx.ssrc:void 0,l=this._mediaObject.payloads.split(" "),d=kr(r.codecs);try{for(d.s();!(t=d.n()).done;){var p=t.value;if(!l.includes(String(p.payloadType))){var f={payload:p.payloadType,codec:c(p),rate:p.clockRate};p.channels>1&&(f.encoding=p.channels),this._mediaObject.rtp.push(f);for(var h={payload:p.payloadType,config:""},m=0,v=Object.keys(p.parameters);m<v.length;m++){var g=v[m];h.config&&(h.config+=";"),h.config+="".concat(g,"=").concat(p.parameters[g])}h.config&&this._mediaObject.fmtp.push(h);var b,y=kr(p.rtcpFeedback);try{for(y.s();!(b=y.n()).done;){var _=b.value;this._mediaObject.rtcpFb.push({payload:p.payloadType,type:_.type,subtype:_.parameter})}}catch(w){y.e(w)}finally{y.f()}}}}catch(w){d.e(w)}finally{d.f()}this._mediaObject.payloads+=" ".concat(r.codecs.filter((function(e){return!n._mediaObject.payloads.includes(e.payloadType)})).map((function(e){return e.payloadType})).join(" ")),this._mediaObject.payloads=this._mediaObject.payloads.trim(),r.rtcp.cname&&this._mediaObject.ssrcs.push({id:o,attribute:"cname",value:r.rtcp.cname}),this._mediaObject.ssrcs.push({id:o,attribute:"msid",value:"".concat(a||"-"," ").concat(i)}),u&&(r.rtcp.cname&&this._mediaObject.ssrcs.push({id:u,attribute:"cname",value:r.rtcp.cname}),this._mediaObject.ssrcs.push({id:u,attribute:"msid",value:"".concat(a||"-"," ").concat(i)}),this._mediaObject.ssrcGroups.push({semantics:"FID",ssrcs:"".concat(o," ").concat(u)}))}},{key:"planBStopReceiving",value:function(e){var t=e.offerRtpParameters.encodings[0],n=t.ssrc,r=t.rtx&&t.rtx.ssrc?t.rtx.ssrc:void 0;this._mediaObject.ssrcs=this._mediaObject.ssrcs.filter((function(e){return e.id!==n&&e.id!==r})),r&&(this._mediaObject.ssrcGroups=this._mediaObject.ssrcGroups.filter((function(e){return e.ssrcs!=="".concat(n," ").concat(r)})))}}]),n}(i);function c(e){var t=new RegExp("^(audio|video)/(.+)","i").exec(e.mimeType);if(!t)throw new TypeError("invalid codec.mimeType");return t[2]}e.OfferMediaSection=o}}),Mo=ks({"../../node_modules/mediasoup-client/lib/handlers/sdp/RemoteSdp.js":function(e){Rs();var t=e&&e.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var a=Object.getOwnPropertyDescriptor(t,n);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,a)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),n=e&&e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=e&&e.__importStar||function(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var a in e)"default"!==a&&Object.prototype.hasOwnProperty.call(e,a)&&t(r,e,a);return n(r,e),r};Object.defineProperty(e,"__esModule",{value:!0}),e.RemoteSdp=void 0;var a=r(co()),i=ho(),s=Oo(),o=new i.Logger("RemoteSdp"),c=function(){function e(t){var n=t.iceParameters,r=t.iceCandidates,a=t.dtlsParameters,i=t.sctpParameters,s=t.plainRtpParameters,o=t.planB,c=void 0!==o&&o;if(St(this,e),this._mediaSections=[],this._midToIndex=new Map,this._iceParameters=n,this._iceCandidates=r,this._dtlsParameters=a,this._sctpParameters=i,this._plainRtpParameters=s,this._planB=c,this._sdpObject={version:0,origin:{address:"0.0.0.0",ipVer:4,netType:"IN",sessionId:1e4,sessionVersion:0,username:"mediasoup-client"},name:"-",timing:{start:0,stop:0},media:[]},n&&n.iceLite&&(this._sdpObject.icelite="ice-lite"),a){this._sdpObject.msidSemantic={semantic:"WMS",token:"*"};var u=this._dtlsParameters.fingerprints.length;this._sdpObject.fingerprint={type:a.fingerprints[u-1].algorithm,hash:a.fingerprints[u-1].value},this._sdpObject.groups=[{type:"BUNDLE",mids:""}]}s&&(this._sdpObject.origin.address=s.ip,this._sdpObject.origin.ipVer=s.ipVersion)}return Pt(e,[{key:"updateIceParameters",value:function(e){o.debug("updateIceParameters() [iceParameters:%o]",e),this._iceParameters=e,this._sdpObject.icelite=e.iceLite?"ice-lite":void 0;var t,n=kr(this._mediaSections);try{for(n.s();!(t=n.n()).done;){t.value.setIceParameters(e)}}catch(r){n.e(r)}finally{n.f()}}},{key:"updateDtlsRole",value:function(e){o.debug("updateDtlsRole() [role:%s]",e),this._dtlsParameters.role=e;var t,n=kr(this._mediaSections);try{for(n.s();!(t=n.n()).done;){t.value.setDtlsRole(e)}}catch(r){n.e(r)}finally{n.f()}}},{key:"getNextMediaSectionIdx",value:function(){for(var e=0;e<this._mediaSections.length;++e){var t=this._mediaSections[e];if(t.closed)return{idx:e,reuseMid:t.mid}}return{idx:this._mediaSections.length}}},{key:"send",value:function(e){var t=e.offerMediaObject,n=e.reuseMid,r=e.offerRtpParameters,a=e.answerRtpParameters,i=e.codecOptions,o=e.extmapAllowMixed,c=void 0!==o&&o,u=new s.AnswerMediaSection({iceParameters:this._iceParameters,iceCandidates:this._iceCandidates,dtlsParameters:this._dtlsParameters,plainRtpParameters:this._plainRtpParameters,planB:this._planB,offerMediaObject:t,offerRtpParameters:r,answerRtpParameters:a,codecOptions:i,extmapAllowMixed:c});n?this._replaceMediaSection(u,n):this._midToIndex.has(u.mid)?this._replaceMediaSection(u):this._addMediaSection(u)}},{key:"receive",value:function(e){var t,n=e.mid,r=e.kind,a=e.offerRtpParameters,i=e.streamId,o=e.trackId,c=this._midToIndex.get(n);if(void 0!==c&&(t=this._mediaSections[c]),t)t.planBReceive({offerRtpParameters:a,streamId:i,trackId:o}),this._replaceMediaSection(t);else{t=new s.OfferMediaSection({iceParameters:this._iceParameters,iceCandidates:this._iceCandidates,dtlsParameters:this._dtlsParameters,plainRtpParameters:this._plainRtpParameters,planB:this._planB,mid:n,kind:r,offerRtpParameters:a,streamId:i,trackId:o});var u=this._mediaSections.find((function(e){return e.closed}));u?this._replaceMediaSection(t,u.mid):this._addMediaSection(t)}}},{key:"disableMediaSection",value:function(e){var t=this._midToIndex.get(e);if(void 0===t)throw new Error("no media section found with mid '".concat(e,"'"));this._mediaSections[t].disable()}},{key:"closeMediaSection",value:function(e){var t=this._midToIndex.get(e);if(void 0===t)throw new Error("no media section found with mid '".concat(e,"'"));var n=this._mediaSections[t];if(e===this._firstMid)return o.debug("closeMediaSection() | cannot close first media section, disabling it instead [mid:%s]",e),void this.disableMediaSection(e);n.close(),this._regenerateBundleMids()}},{key:"planBStopReceiving",value:function(e){var t=e.mid,n=e.offerRtpParameters,r=this._midToIndex.get(t);if(void 0===r)throw new Error("no media section found with mid '".concat(t,"'"));var a=this._mediaSections[r];a.planBStopReceiving({offerRtpParameters:n}),this._replaceMediaSection(a)}},{key:"sendSctpAssociation",value:function(e){var t=e.offerMediaObject,n=new s.AnswerMediaSection({iceParameters:this._iceParameters,iceCandidates:this._iceCandidates,dtlsParameters:this._dtlsParameters,sctpParameters:this._sctpParameters,plainRtpParameters:this._plainRtpParameters,offerMediaObject:t});this._addMediaSection(n)}},{key:"receiveSctpAssociation",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.oldDataChannelSpec,n=void 0!==t&&t,r=new s.OfferMediaSection({iceParameters:this._iceParameters,iceCandidates:this._iceCandidates,dtlsParameters:this._dtlsParameters,sctpParameters:this._sctpParameters,plainRtpParameters:this._plainRtpParameters,mid:"datachannel",kind:"application",oldDataChannelSpec:n});this._addMediaSection(r)}},{key:"getSdp",value:function(){return this._sdpObject.origin.sessionVersion++,a.write(this._sdpObject)}},{key:"_addMediaSection",value:function(e){this._firstMid||(this._firstMid=e.mid),this._mediaSections.push(e),this._midToIndex.set(e.mid,this._mediaSections.length-1),this._sdpObject.media.push(e.getObject()),this._regenerateBundleMids()}},{key:"_replaceMediaSection",value:function(e,t){if("string"===typeof t){var n=this._midToIndex.get(t);if(void 0===n)throw new Error("no media section found for reuseMid '".concat(t,"'"));var r=this._mediaSections[n];this._mediaSections[n]=e,this._midToIndex.delete(r.mid),this._midToIndex.set(e.mid,n),this._sdpObject.media[n]=e.getObject(),this._regenerateBundleMids()}else{var a=this._midToIndex.get(e.mid);if(void 0===a)throw new Error("no media section found with mid '".concat(e.mid,"'"));this._mediaSections[a]=e,this._sdpObject.media[a]=e.getObject()}}},{key:"_regenerateBundleMids",value:function(){this._dtlsParameters&&(this._sdpObject.groups[0].mids=this._mediaSections.filter((function(e){return!e.closed})).map((function(e){return e.mid})).join(" "))}}]),e}();e.RemoteSdp=c}}),Io=ks({"../../node_modules/mediasoup-client/lib/scalabilityModes.js":function(e){Rs(),Object.defineProperty(e,"__esModule",{value:!0}),e.parse=void 0;var t=new RegExp("^[LS]([1-9]\\d{0,1})T([1-9]\\d{0,1})");e.parse=function(e){var n=t.exec(e||"");return n?{spatialLayers:Number(n[1]),temporalLayers:Number(n[2])}:{spatialLayers:1,temporalLayers:1}}}}),Do=ks({"../../node_modules/mediasoup-client/lib/handlers/Chrome74.js":function(e){Rs();var t=e&&e.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var a=Object.getOwnPropertyDescriptor(t,n);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,a)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),n=e&&e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=e&&e.__importStar||function(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var a in e)"default"!==a&&Object.prototype.hasOwnProperty.call(e,a)&&t(r,e,a);return n(r,e),r};Object.defineProperty(e,"__esModule",{value:!0}),e.Chrome74=void 0;var a=r(co()),i=ho(),s=r(bo()),o=r(_o()),c=r(Co()),u=r(To()),l=Eo(),d=Mo(),p=Io(),f=new i.Logger("Chrome74"),h={OS:1024,MIS:1024},m=function(e){mn(n,e);var t=_n(n);function n(){var e;return St(this,n),(e=t.call(this))._mapMidTransceiver=new Map,e._sendStream=new MediaStream,e._hasDataChannelMediaSection=!1,e._nextSendSctpStreamId=0,e._transportReady=!1,e}return Pt(n,[{key:"name",get:function(){return"Chrome74"}},{key:"close",value:function(){if(f.debug("close()"),this._pc)try{this._pc.close()}catch(e){}}},{key:"getNativeRtpCapabilities",value:function(){return Ss(this,null,wr().mark((function e(){var t,n,r,i;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return f.debug("getNativeRtpCapabilities()"),t=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"unified-plan"}),e.prev=2,t.addTransceiver("audio"),t.addTransceiver("video"),e.next=7,t.createOffer();case 7:n=e.sent;try{t.close()}catch(s){}return r=a.parse(n.sdp),i=c.extractRtpCapabilities({sdpObject:r}),e.abrupt("return",i);case 14:e.prev=14,e.t0=e.catch(2);try{t.close()}catch(o){}throw e.t0;case 18:case"end":return e.stop()}}),e,null,[[2,14]])})))}},{key:"getNativeSctpCapabilities",value:function(){return Ss(this,null,wr().mark((function e(){return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return f.debug("getNativeSctpCapabilities()"),e.abrupt("return",{numStreams:h});case 2:case"end":return e.stop()}}),e)})))}},{key:"run",value:function(e){var t=this,n=e.direction,r=e.iceParameters,a=e.iceCandidates,i=e.dtlsParameters,s=e.sctpParameters,c=e.iceServers,u=e.iceTransportPolicy,l=e.additionalSettings,p=e.proprietaryConstraints,h=e.extendedRtpCapabilities;f.debug("run()"),this._direction=n,this._remoteSdp=new d.RemoteSdp({iceParameters:r,iceCandidates:a,dtlsParameters:i,sctpParameters:s}),this._sendingRtpParametersByKind={audio:o.getSendingRtpParameters("audio",h),video:o.getSendingRtpParameters("video",h)},this._sendingRemoteRtpParametersByKind={audio:o.getSendingRemoteRtpParameters("audio",h),video:o.getSendingRemoteRtpParameters("video",h)},i.role&&"auto"!==i.role&&(this._forcedLocalDtlsRole="server"===i.role?"client":"server"),this._pc=new RTCPeerConnection(_s({iceServers:c||[],iceTransportPolicy:u||"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"unified-plan"},l),p),this._pc.addEventListener("iceconnectionstatechange",(function(){switch(t._pc.iceConnectionState){case"checking":t.emit("@connectionstatechange","connecting");break;case"connected":case"completed":t.emit("@connectionstatechange","connected");break;case"failed":t.emit("@connectionstatechange","failed");break;case"disconnected":t.emit("@connectionstatechange","disconnected");break;case"closed":t.emit("@connectionstatechange","closed")}}))}},{key:"updateIceServers",value:function(e){return Ss(this,null,wr().mark((function t(){var n;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:f.debug("updateIceServers()"),(n=this._pc.getConfiguration()).iceServers=e,this._pc.setConfiguration(n);case 4:case"end":return t.stop()}}),t,this)})))}},{key:"restartIce",value:function(e){return Ss(this,null,wr().mark((function t(){var n,r,a,i;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(f.debug("restartIce()"),this._remoteSdp.updateIceParameters(e),this._transportReady){t.next=4;break}return t.abrupt("return");case 4:if("send"!==this._direction){t.next=17;break}return t.next=7,this._pc.createOffer({iceRestart:!0});case 7:return n=t.sent,f.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",n),t.next=11,this._pc.setLocalDescription(n);case 11:return r={type:"answer",sdp:this._remoteSdp.getSdp()},f.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",r),t.next=15,this._pc.setRemoteDescription(r);case 15:t.next=27;break;case 17:return a={type:"offer",sdp:this._remoteSdp.getSdp()},f.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",a),t.next=21,this._pc.setRemoteDescription(a);case 21:return t.next=23,this._pc.createAnswer();case 23:return i=t.sent,f.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",i),t.next=27,this._pc.setLocalDescription(i);case 27:case"end":return t.stop()}}),t,this)})))}},{key:"getTransportStats",value:function(){return Ss(this,null,wr().mark((function e(){return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._pc.getStats());case 1:case"end":return e.stop()}}),e,this)})))}},{key:"send",value:function(e){return Ss(this,arguments,wr().mark((function e(t){var n,r,i,l,d,h,m,v,g,b,y,_,w,k,x,S,R,P,C;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.track,r=t.encodings,i=t.codecOptions,l=t.codec,this._assertSendDirection(),f.debug("send() [kind:%s, track.id:%s]",n.kind,n.id),r&&r.length>1&&r.forEach((function(e,t){e.rid="r".concat(t)})),(h=s.clone(this._sendingRtpParametersByKind[n.kind],{})).codecs=o.reduceCodecs(h.codecs,l),(m=s.clone(this._sendingRemoteRtpParametersByKind[n.kind],{})).codecs=o.reduceCodecs(m.codecs,l),v=this._remoteSdp.getNextMediaSectionIdx(),g=this._pc.addTransceiver(n,{direction:"sendonly",streams:[this._sendStream],sendEncodings:r}),e.next=12,this._pc.createOffer();case 12:if(b=e.sent,y=a.parse(b.sdp),this._transportReady){e.next=17;break}return e.next=17,this._setupTransport({localDtlsRole:null!==(d=this._forcedLocalDtlsRole)&&void 0!==d?d:"client",localSdpObject:y});case 17:return w=!1,k=(0,p.parse)((r||[{}])[0].scalabilityMode),r&&1===r.length&&k.spatialLayers>1&&"video/vp9"===h.codecs[0].mimeType.toLowerCase()&&(f.debug("send() | enabling legacy simulcast for VP9 SVC"),w=!0,y=a.parse(b.sdp),_=y.media[v.idx],u.addLegacySimulcast({offerMediaObject:_,numStreams:k.spatialLayers}),b={type:"offer",sdp:a.write(y)}),f.debug("send() | calling pc.setLocalDescription() [offer:%o]",b),e.next=23,this._pc.setLocalDescription(b);case 23:if(x=g.mid,h.mid=x,y=a.parse(this._pc.localDescription.sdp),_=y.media[v.idx],h.rtcp.cname=c.getCname({offerMediaObject:_}),r?1===r.length?(S=u.getRtpEncodings({offerMediaObject:_}),Object.assign(S[0],r[0]),w&&(S=[S[0]]),h.encodings=S):h.encodings=r:h.encodings=u.getRtpEncodings({offerMediaObject:_}),h.encodings.length>1&&("video/vp8"===h.codecs[0].mimeType.toLowerCase()||"video/h264"===h.codecs[0].mimeType.toLowerCase())){R=kr(h.encodings);try{for(R.s();!(P=R.n()).done;)P.value.scalabilityMode="S1T3"}catch(T){R.e(T)}finally{R.f()}}return this._remoteSdp.send({offerMediaObject:_,reuseMid:v.reuseMid,offerRtpParameters:h,answerRtpParameters:m,codecOptions:i,extmapAllowMixed:!0}),C={type:"answer",sdp:this._remoteSdp.getSdp()},f.debug("send() | calling pc.setRemoteDescription() [answer:%o]",C),e.next=35,this._pc.setRemoteDescription(C);case 35:return this._mapMidTransceiver.set(x,g),e.abrupt("return",{localId:x,rtpParameters:h,rtpSender:g.sender});case 37:case"end":return e.stop()}}),e,this)})))}},{key:"stopSending",value:function(e){return Ss(this,null,wr().mark((function t(){var n,r,a;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._assertSendDirection(),f.debug("stopSending() [localId:%s]",e),n=this._mapMidTransceiver.get(e)){t.next=5;break}throw new Error("associated RTCRtpTransceiver not found");case 5:return n.sender.replaceTrack(null),this._pc.removeTrack(n.sender),this._remoteSdp.closeMediaSection(n.mid),t.next=10,this._pc.createOffer();case 10:return r=t.sent,f.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",r),t.next=14,this._pc.setLocalDescription(r);case 14:return a={type:"answer",sdp:this._remoteSdp.getSdp()},f.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",a),t.next=18,this._pc.setRemoteDescription(a);case 18:this._mapMidTransceiver.delete(e);case 19:case"end":return t.stop()}}),t,this)})))}},{key:"replaceTrack",value:function(e,t){return Ss(this,null,wr().mark((function n(){var r;return wr().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(this._assertSendDirection(),t?f.debug("replaceTrack() [localId:%s, track.id:%s]",e,t.id):f.debug("replaceTrack() [localId:%s, no track]",e),r=this._mapMidTransceiver.get(e)){n.next=5;break}throw new Error("associated RTCRtpTransceiver not found");case 5:return n.next=7,r.sender.replaceTrack(t);case 7:case"end":return n.stop()}}),n,this)})))}},{key:"setMaxSpatialLayer",value:function(e,t){return Ss(this,null,wr().mark((function n(){var r,a;return wr().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(this._assertSendDirection(),f.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",e,t),r=this._mapMidTransceiver.get(e)){n.next=5;break}throw new Error("associated RTCRtpTransceiver not found");case 5:return(a=r.sender.getParameters()).encodings.forEach((function(e,n){e.active=n<=t})),n.next=9,r.sender.setParameters(a);case 9:case"end":return n.stop()}}),n,this)})))}},{key:"setRtpEncodingParameters",value:function(e,t){return Ss(this,null,wr().mark((function n(){var r,a;return wr().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(this._assertSendDirection(),f.debug("setRtpEncodingParameters() [localId:%s, params:%o]",e,t),r=this._mapMidTransceiver.get(e)){n.next=5;break}throw new Error("associated RTCRtpTransceiver not found");case 5:return(a=r.sender.getParameters()).encodings.forEach((function(e,n){a.encodings[n]=_s(_s({},e),t)})),n.next=9,r.sender.setParameters(a);case 9:case"end":return n.stop()}}),n,this)})))}},{key:"getSenderStats",value:function(e){return Ss(this,null,wr().mark((function t(){var n;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._assertSendDirection(),n=this._mapMidTransceiver.get(e)){t.next=4;break}throw new Error("associated RTCRtpTransceiver not found");case 4:return t.abrupt("return",n.sender.getStats());case 5:case"end":return t.stop()}}),t,this)})))}},{key:"sendDataChannel",value:function(e){return Ss(this,arguments,wr().mark((function e(t){var n,r,i,s,o,c,u,l,d,p,m,v,g;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.ordered,r=t.maxPacketLifeTime,i=t.maxRetransmits,s=t.label,o=t.protocol,this._assertSendDirection(),u={negotiated:!0,id:this._nextSendSctpStreamId,ordered:n,maxPacketLifeTime:r,maxRetransmits:i,protocol:o},f.debug("sendDataChannel() [options:%o]",u),l=this._pc.createDataChannel(s,u),this._nextSendSctpStreamId=++this._nextSendSctpStreamId%h.MIS,this._hasDataChannelMediaSection){e.next=24;break}return e.next=9,this._pc.createOffer();case 9:if(d=e.sent,p=a.parse(d.sdp),m=p.media.find((function(e){return"application"===e.type})),this._transportReady){e.next=15;break}return e.next=15,this._setupTransport({localDtlsRole:null!==(c=this._forcedLocalDtlsRole)&&void 0!==c?c:"client",localSdpObject:p});case 15:return f.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",d),e.next=18,this._pc.setLocalDescription(d);case 18:return this._remoteSdp.sendSctpAssociation({offerMediaObject:m}),v={type:"answer",sdp:this._remoteSdp.getSdp()},f.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",v),e.next=23,this._pc.setRemoteDescription(v);case 23:this._hasDataChannelMediaSection=!0;case 24:return g={streamId:u.id,ordered:u.ordered,maxPacketLifeTime:u.maxPacketLifeTime,maxRetransmits:u.maxRetransmits},e.abrupt("return",{dataChannel:l,sctpStreamParameters:g});case 26:case"end":return e.stop()}}),e,this)})))}},{key:"receive",value:function(e){return Ss(this,null,wr().mark((function t(){var n,r,i,s,o,u,l,d,p,h,m,v,g,b,y,_,w,k,x,S=this;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this._assertRecvDirection(),r=[],i=new Map,s=kr(e);try{for(s.s();!(o=s.n()).done;)u=o.value,l=u.trackId,d=u.kind,p=u.rtpParameters,f.debug("receive() [trackId:%s, kind:%s]",l,d),h=p.mid||String(this._mapMidTransceiver.size),i.set(l,h),this._remoteSdp.receive({mid:h,kind:d,offerRtpParameters:p,streamId:p.rtcp.cname,trackId:l})}catch(R){s.e(R)}finally{s.f()}return m={type:"offer",sdp:this._remoteSdp.getSdp()},f.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",m),t.next=9,this._pc.setRemoteDescription(m);case 9:return t.next=11,this._pc.createAnswer();case 11:v=t.sent,g=a.parse(v.sdp),b=kr(e);try{for(_=function(){var e=y.value,t=e.trackId,n=e.rtpParameters,r=i.get(t),a=g.media.find((function(e){return String(e.mid)===r}));c.applyCodecParameters({offerRtpParameters:n,answerMediaObject:a})},b.s();!(y=b.n()).done;)_()}catch(R){b.e(R)}finally{b.f()}if(v={type:"answer",sdp:a.write(g)},this._transportReady){t.next=19;break}return t.next=19,this._setupTransport({localDtlsRole:null!==(n=this._forcedLocalDtlsRole)&&void 0!==n?n:"client",localSdpObject:g});case 19:return f.debug("receive() | calling pc.setLocalDescription() [answer:%o]",v),t.next=22,this._pc.setLocalDescription(v);case 22:w=kr(e);try{for(x=function(){var e=k.value.trackId,t=i.get(e),n=S._pc.getTransceivers().find((function(e){return e.mid===t}));if(!n)throw new Error("new RTCRtpTransceiver not found");S._mapMidTransceiver.set(t,n),r.push({localId:t,track:n.receiver.track,rtpReceiver:n.receiver})},w.s();!(k=w.n()).done;)x()}catch(R){w.e(R)}finally{w.f()}return t.abrupt("return",r);case 25:case"end":return t.stop()}}),t,this)})))}},{key:"stopReceiving",value:function(e){return Ss(this,null,wr().mark((function t(){var n,r,a;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._assertRecvDirection(),f.debug("stopReceiving() [localId:%s]",e),n=this._mapMidTransceiver.get(e)){t.next=5;break}throw new Error("associated RTCRtpTransceiver not found");case 5:return this._remoteSdp.closeMediaSection(n.mid),r={type:"offer",sdp:this._remoteSdp.getSdp()},f.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",r),t.next=10,this._pc.setRemoteDescription(r);case 10:return t.next=12,this._pc.createAnswer();case 12:return a=t.sent,f.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",a),t.next=16,this._pc.setLocalDescription(a);case 16:this._mapMidTransceiver.delete(e);case 17:case"end":return t.stop()}}),t,this)})))}},{key:"pauseReceiving",value:function(e){return Ss(this,null,wr().mark((function t(){var n,r,a,i,s,o;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this._assertRecvDirection(),n=kr(e),t.prev=2,n.s();case 4:if((r=n.n()).done){t.next=13;break}if(a=r.value,f.debug("pauseReceiving() [localId:%s]",a),i=this._mapMidTransceiver.get(a)){t.next=10;break}throw new Error("associated RTCRtpTransceiver not found");case 10:i.direction="inactive";case 11:t.next=4;break;case 13:t.next=18;break;case 15:t.prev=15,t.t0=t.catch(2),n.e(t.t0);case 18:return t.prev=18,n.f(),t.finish(18);case 21:return s={type:"offer",sdp:this._remoteSdp.getSdp()},f.debug("pauseReceiving() | calling pc.setRemoteDescription() [offer:%o]",s),t.next=25,this._pc.setRemoteDescription(s);case 25:return t.next=27,this._pc.createAnswer();case 27:return o=t.sent,f.debug("pauseReceiving() | calling pc.setLocalDescription() [answer:%o]",o),t.next=31,this._pc.setLocalDescription(o);case 31:case"end":return t.stop()}}),t,this,[[2,15,18,21]])})))}},{key:"resumeReceiving",value:function(e){return Ss(this,null,wr().mark((function t(){var n,r,a,i,s,o;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this._assertRecvDirection(),n=kr(e),t.prev=2,n.s();case 4:if((r=n.n()).done){t.next=13;break}if(a=r.value,f.debug("resumeReceiving() [localId:%s]",a),i=this._mapMidTransceiver.get(a)){t.next=10;break}throw new Error("associated RTCRtpTransceiver not found");case 10:i.direction="recvonly";case 11:t.next=4;break;case 13:t.next=18;break;case 15:t.prev=15,t.t0=t.catch(2),n.e(t.t0);case 18:return t.prev=18,n.f(),t.finish(18);case 21:return s={type:"offer",sdp:this._remoteSdp.getSdp()},f.debug("resumeReceiving() | calling pc.setRemoteDescription() [offer:%o]",s),t.next=25,this._pc.setRemoteDescription(s);case 25:return t.next=27,this._pc.createAnswer();case 27:return o=t.sent,f.debug("resumeReceiving() | calling pc.setLocalDescription() [answer:%o]",o),t.next=31,this._pc.setLocalDescription(o);case 31:case"end":return t.stop()}}),t,this,[[2,15,18,21]])})))}},{key:"getReceiverStats",value:function(e){return Ss(this,null,wr().mark((function t(){var n;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._assertRecvDirection(),n=this._mapMidTransceiver.get(e)){t.next=4;break}throw new Error("associated RTCRtpTransceiver not found");case 4:return t.abrupt("return",n.receiver.getStats());case 5:case"end":return t.stop()}}),t,this)})))}},{key:"receiveDataChannel",value:function(e){return Ss(this,arguments,wr().mark((function e(t){var n,r,i,s,o,c,u,l,d,p,h,m,v;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.sctpStreamParameters,r=t.label,i=t.protocol,this._assertRecvDirection(),o=n.streamId,c=n.ordered,u=n.maxPacketLifeTime,l=n.maxRetransmits,d={negotiated:!0,id:o,ordered:c,maxPacketLifeTime:u,maxRetransmits:l,protocol:i},f.debug("receiveDataChannel() [options:%o]",d),p=this._pc.createDataChannel(r,d),this._hasDataChannelMediaSection){e.next=23;break}return this._remoteSdp.receiveSctpAssociation(),h={type:"offer",sdp:this._remoteSdp.getSdp()},f.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",h),e.next=12,this._pc.setRemoteDescription(h);case 12:return e.next=14,this._pc.createAnswer();case 14:if(m=e.sent,this._transportReady){e.next=19;break}return v=a.parse(m.sdp),e.next=19,this._setupTransport({localDtlsRole:null!==(s=this._forcedLocalDtlsRole)&&void 0!==s?s:"client",localSdpObject:v});case 19:return f.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",m),e.next=22,this._pc.setLocalDescription(m);case 22:this._hasDataChannelMediaSection=!0;case 23:return e.abrupt("return",{dataChannel:p});case 24:case"end":return e.stop()}}),e,this)})))}},{key:"_setupTransport",value:function(e){return Ss(this,arguments,wr().mark((function e(t){var n,r,i;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.localDtlsRole,(r=t.localSdpObject)||(r=a.parse(this._pc.localDescription.sdp)),(i=c.extractDtlsParameters({sdpObject:r})).role=n,this._remoteSdp.updateDtlsRole("client"===n?"server":"client"),e.next=7,this.safeEmitAsPromise("@connect",{dtlsParameters:i});case 7:this._transportReady=!0;case 8:case"end":return e.stop()}}),e,this)})))}},{key:"_assertSendDirection",value:function(){if("send"!==this._direction)throw new Error('method can just be called for handlers with "send" direction')}},{key:"_assertRecvDirection",value:function(){if("recv"!==this._direction)throw new Error('method can just be called for handlers with "recv" direction')}}],[{key:"createFactory",value:function(){return function(){return new n}}}]),n}(l.HandlerInterface);e.Chrome74=m}}),jo=ks({"../../node_modules/mediasoup-client/lib/handlers/Chrome70.js":function(e){Rs();var t=e&&e.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var a=Object.getOwnPropertyDescriptor(t,n);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,a)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),n=e&&e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=e&&e.__importStar||function(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var a in e)"default"!==a&&Object.prototype.hasOwnProperty.call(e,a)&&t(r,e,a);return n(r,e),r};Object.defineProperty(e,"__esModule",{value:!0}),e.Chrome70=void 0;var a=r(co()),i=ho(),s=r(bo()),o=r(_o()),c=r(Co()),u=r(To()),l=Eo(),d=Mo(),p=Io(),f=new i.Logger("Chrome70"),h={OS:1024,MIS:1024},m=function(e){mn(n,e);var t=_n(n);function n(){var e;return St(this,n),(e=t.call(this))._mapMidTransceiver=new Map,e._sendStream=new MediaStream,e._hasDataChannelMediaSection=!1,e._nextSendSctpStreamId=0,e._transportReady=!1,e}return Pt(n,[{key:"name",get:function(){return"Chrome70"}},{key:"close",value:function(){if(f.debug("close()"),this._pc)try{this._pc.close()}catch(e){}}},{key:"getNativeRtpCapabilities",value:function(){return Ss(this,null,wr().mark((function e(){var t,n,r,i;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return f.debug("getNativeRtpCapabilities()"),t=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"unified-plan"}),e.prev=2,t.addTransceiver("audio"),t.addTransceiver("video"),e.next=7,t.createOffer();case 7:n=e.sent;try{t.close()}catch(s){}return r=a.parse(n.sdp),i=c.extractRtpCapabilities({sdpObject:r}),e.abrupt("return",i);case 14:e.prev=14,e.t0=e.catch(2);try{t.close()}catch(o){}throw e.t0;case 18:case"end":return e.stop()}}),e,null,[[2,14]])})))}},{key:"getNativeSctpCapabilities",value:function(){return Ss(this,null,wr().mark((function e(){return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return f.debug("getNativeSctpCapabilities()"),e.abrupt("return",{numStreams:h});case 2:case"end":return e.stop()}}),e)})))}},{key:"run",value:function(e){var t=this,n=e.direction,r=e.iceParameters,a=e.iceCandidates,i=e.dtlsParameters,s=e.sctpParameters,c=e.iceServers,u=e.iceTransportPolicy,l=e.additionalSettings,p=e.proprietaryConstraints,h=e.extendedRtpCapabilities;f.debug("run()"),this._direction=n,this._remoteSdp=new d.RemoteSdp({iceParameters:r,iceCandidates:a,dtlsParameters:i,sctpParameters:s}),this._sendingRtpParametersByKind={audio:o.getSendingRtpParameters("audio",h),video:o.getSendingRtpParameters("video",h)},this._sendingRemoteRtpParametersByKind={audio:o.getSendingRemoteRtpParameters("audio",h),video:o.getSendingRemoteRtpParameters("video",h)},i.role&&"auto"!==i.role&&(this._forcedLocalDtlsRole="server"===i.role?"client":"server"),this._pc=new RTCPeerConnection(_s({iceServers:c||[],iceTransportPolicy:u||"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"unified-plan"},l),p),this._pc.addEventListener("iceconnectionstatechange",(function(){switch(t._pc.iceConnectionState){case"checking":t.emit("@connectionstatechange","connecting");break;case"connected":case"completed":t.emit("@connectionstatechange","connected");break;case"failed":t.emit("@connectionstatechange","failed");break;case"disconnected":t.emit("@connectionstatechange","disconnected");break;case"closed":t.emit("@connectionstatechange","closed")}}))}},{key:"updateIceServers",value:function(e){return Ss(this,null,wr().mark((function t(){var n;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:f.debug("updateIceServers()"),(n=this._pc.getConfiguration()).iceServers=e,this._pc.setConfiguration(n);case 4:case"end":return t.stop()}}),t,this)})))}},{key:"restartIce",value:function(e){return Ss(this,null,wr().mark((function t(){var n,r,a,i;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(f.debug("restartIce()"),this._remoteSdp.updateIceParameters(e),this._transportReady){t.next=4;break}return t.abrupt("return");case 4:if("send"!==this._direction){t.next=17;break}return t.next=7,this._pc.createOffer({iceRestart:!0});case 7:return n=t.sent,f.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",n),t.next=11,this._pc.setLocalDescription(n);case 11:return r={type:"answer",sdp:this._remoteSdp.getSdp()},f.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",r),t.next=15,this._pc.setRemoteDescription(r);case 15:t.next=27;break;case 17:return a={type:"offer",sdp:this._remoteSdp.getSdp()},f.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",a),t.next=21,this._pc.setRemoteDescription(a);case 21:return t.next=23,this._pc.createAnswer();case 23:return i=t.sent,f.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",i),t.next=27,this._pc.setLocalDescription(i);case 27:case"end":return t.stop()}}),t,this)})))}},{key:"getTransportStats",value:function(){return Ss(this,null,wr().mark((function e(){return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._pc.getStats());case 1:case"end":return e.stop()}}),e,this)})))}},{key:"send",value:function(e){return Ss(this,arguments,wr().mark((function e(t){var n,r,i,l,d,h,m,v,g,b,y,_,w,k,x,S,R,P,C,T,E,O,M;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.track,r=t.encodings,i=t.codecOptions,l=t.codec,this._assertSendDirection(),f.debug("send() [kind:%s, track.id:%s]",n.kind,n.id),(h=s.clone(this._sendingRtpParametersByKind[n.kind],{})).codecs=o.reduceCodecs(h.codecs,l),(m=s.clone(this._sendingRemoteRtpParametersByKind[n.kind],{})).codecs=o.reduceCodecs(m.codecs,l),v=this._remoteSdp.getNextMediaSectionIdx(),g=this._pc.addTransceiver(n,{direction:"sendonly",streams:[this._sendStream]}),e.next=11,this._pc.createOffer();case 11:if(b=e.sent,y=a.parse(b.sdp),this._transportReady){e.next=16;break}return e.next=16,this._setupTransport({localDtlsRole:null!==(d=this._forcedLocalDtlsRole)&&void 0!==d?d:"client",localSdpObject:y});case 16:return r&&r.length>1&&(f.debug("send() | enabling legacy simulcast"),y=a.parse(b.sdp),_=y.media[v.idx],u.addLegacySimulcast({offerMediaObject:_,numStreams:r.length}),b={type:"offer",sdp:a.write(y)}),w=!1,k=(0,p.parse)((r||[{}])[0].scalabilityMode),r&&1===r.length&&k.spatialLayers>1&&"video/vp9"===h.codecs[0].mimeType.toLowerCase()&&(f.debug("send() | enabling legacy simulcast for VP9 SVC"),w=!0,y=a.parse(b.sdp),_=y.media[v.idx],u.addLegacySimulcast({offerMediaObject:_,numStreams:k.spatialLayers}),b={type:"offer",sdp:a.write(y)}),f.debug("send() | calling pc.setLocalDescription() [offer:%o]",b),e.next=23,this._pc.setLocalDescription(b);case 23:if(!r){e.next=38;break}f.debug("send() | applying given encodings"),x=g.sender.getParameters(),S=0;case 27:if(!(S<(x.encodings||[]).length)){e.next=36;break}if(R=x.encodings[S],P=r[S]){e.next=32;break}return e.abrupt("break",36);case 32:x.encodings[S]=Object.assign(R,P);case 33:++S,e.next=27;break;case 36:return e.next=38,g.sender.setParameters(x);case 38:if(C=g.mid,h.mid=C,y=a.parse(this._pc.localDescription.sdp),_=y.media[v.idx],h.rtcp.cname=c.getCname({offerMediaObject:_}),h.encodings=u.getRtpEncodings({offerMediaObject:_}),r)for(T=0;T<h.encodings.length;++T)r[T]&&Object.assign(h.encodings[T],r[T]);if(w&&(h.encodings=[h.encodings[0]]),h.encodings.length>1&&("video/vp8"===h.codecs[0].mimeType.toLowerCase()||"video/h264"===h.codecs[0].mimeType.toLowerCase())){E=kr(h.encodings);try{for(E.s();!(O=E.n()).done;)O.value.scalabilityMode="S1T3"}catch(I){E.e(I)}finally{E.f()}}return this._remoteSdp.send({offerMediaObject:_,reuseMid:v.reuseMid,offerRtpParameters:h,answerRtpParameters:m,codecOptions:i}),M={type:"answer",sdp:this._remoteSdp.getSdp()},f.debug("send() | calling pc.setRemoteDescription() [answer:%o]",M),e.next=52,this._pc.setRemoteDescription(M);case 52:return this._mapMidTransceiver.set(C,g),e.abrupt("return",{localId:C,rtpParameters:h,rtpSender:g.sender});case 54:case"end":return e.stop()}}),e,this)})))}},{key:"stopSending",value:function(e){return Ss(this,null,wr().mark((function t(){var n,r,a;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._assertSendDirection(),f.debug("stopSending() [localId:%s]",e),n=this._mapMidTransceiver.get(e)){t.next=5;break}throw new Error("associated RTCRtpTransceiver not found");case 5:return n.sender.replaceTrack(null),this._pc.removeTrack(n.sender),this._remoteSdp.closeMediaSection(n.mid),t.next=10,this._pc.createOffer();case 10:return r=t.sent,f.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",r),t.next=14,this._pc.setLocalDescription(r);case 14:return a={type:"answer",sdp:this._remoteSdp.getSdp()},f.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",a),t.next=18,this._pc.setRemoteDescription(a);case 18:this._mapMidTransceiver.delete(e);case 19:case"end":return t.stop()}}),t,this)})))}},{key:"replaceTrack",value:function(e,t){return Ss(this,null,wr().mark((function n(){var r;return wr().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(this._assertSendDirection(),t?f.debug("replaceTrack() [localId:%s, track.id:%s]",e,t.id):f.debug("replaceTrack() [localId:%s, no track]",e),r=this._mapMidTransceiver.get(e)){n.next=5;break}throw new Error("associated RTCRtpTransceiver not found");case 5:return n.next=7,r.sender.replaceTrack(t);case 7:case"end":return n.stop()}}),n,this)})))}},{key:"setMaxSpatialLayer",value:function(e,t){return Ss(this,null,wr().mark((function n(){var r,a;return wr().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(this._assertSendDirection(),f.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",e,t),r=this._mapMidTransceiver.get(e)){n.next=5;break}throw new Error("associated RTCRtpTransceiver not found");case 5:return(a=r.sender.getParameters()).encodings.forEach((function(e,n){e.active=n<=t})),n.next=9,r.sender.setParameters(a);case 9:case"end":return n.stop()}}),n,this)})))}},{key:"setRtpEncodingParameters",value:function(e,t){return Ss(this,null,wr().mark((function n(){var r,a;return wr().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(this._assertSendDirection(),f.debug("setRtpEncodingParameters() [localId:%s, params:%o]",e,t),r=this._mapMidTransceiver.get(e)){n.next=5;break}throw new Error("associated RTCRtpTransceiver not found");case 5:return(a=r.sender.getParameters()).encodings.forEach((function(e,n){a.encodings[n]=_s(_s({},e),t)})),n.next=9,r.sender.setParameters(a);case 9:case"end":return n.stop()}}),n,this)})))}},{key:"getSenderStats",value:function(e){return Ss(this,null,wr().mark((function t(){var n;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._assertSendDirection(),n=this._mapMidTransceiver.get(e)){t.next=4;break}throw new Error("associated RTCRtpTransceiver not found");case 4:return t.abrupt("return",n.sender.getStats());case 5:case"end":return t.stop()}}),t,this)})))}},{key:"sendDataChannel",value:function(e){return Ss(this,arguments,wr().mark((function e(t){var n,r,i,s,o,c,u,l,d,p,m,v,g;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.ordered,r=t.maxPacketLifeTime,i=t.maxRetransmits,s=t.label,o=t.protocol,this._assertSendDirection(),u={negotiated:!0,id:this._nextSendSctpStreamId,ordered:n,maxPacketLifeTime:r,maxRetransmitTime:r,maxRetransmits:i,protocol:o},f.debug("sendDataChannel() [options:%o]",u),l=this._pc.createDataChannel(s,u),this._nextSendSctpStreamId=++this._nextSendSctpStreamId%h.MIS,this._hasDataChannelMediaSection){e.next=24;break}return e.next=9,this._pc.createOffer();case 9:if(d=e.sent,p=a.parse(d.sdp),m=p.media.find((function(e){return"application"===e.type})),this._transportReady){e.next=15;break}return e.next=15,this._setupTransport({localDtlsRole:null!==(c=this._forcedLocalDtlsRole)&&void 0!==c?c:"client",localSdpObject:p});case 15:return f.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",d),e.next=18,this._pc.setLocalDescription(d);case 18:return this._remoteSdp.sendSctpAssociation({offerMediaObject:m}),v={type:"answer",sdp:this._remoteSdp.getSdp()},f.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",v),e.next=23,this._pc.setRemoteDescription(v);case 23:this._hasDataChannelMediaSection=!0;case 24:return g={streamId:u.id,ordered:u.ordered,maxPacketLifeTime:u.maxPacketLifeTime,maxRetransmits:u.maxRetransmits},e.abrupt("return",{dataChannel:l,sctpStreamParameters:g});case 26:case"end":return e.stop()}}),e,this)})))}},{key:"receive",value:function(e){return Ss(this,null,wr().mark((function t(){var n,r,i,s,o,u,l,d,p,h,m,v,g,b,y,_,w,k,x,S=this;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this._assertRecvDirection(),r=[],i=new Map,s=kr(e);try{for(s.s();!(o=s.n()).done;)u=o.value,l=u.trackId,d=u.kind,p=u.rtpParameters,f.debug("receive() [trackId:%s, kind:%s]",l,d),h=p.mid||String(this._mapMidTransceiver.size),i.set(l,h),this._remoteSdp.receive({mid:h,kind:d,offerRtpParameters:p,streamId:p.rtcp.cname,trackId:l})}catch(R){s.e(R)}finally{s.f()}return m={type:"offer",sdp:this._remoteSdp.getSdp()},f.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",m),t.next=9,this._pc.setRemoteDescription(m);case 9:return t.next=11,this._pc.createAnswer();case 11:v=t.sent,g=a.parse(v.sdp),b=kr(e);try{for(_=function(){var e=y.value,t=e.trackId,n=e.rtpParameters,r=i.get(t),a=g.media.find((function(e){return String(e.mid)===r}));c.applyCodecParameters({offerRtpParameters:n,answerMediaObject:a})},b.s();!(y=b.n()).done;)_()}catch(R){b.e(R)}finally{b.f()}if(v={type:"answer",sdp:a.write(g)},this._transportReady){t.next=19;break}return t.next=19,this._setupTransport({localDtlsRole:null!==(n=this._forcedLocalDtlsRole)&&void 0!==n?n:"client",localSdpObject:g});case 19:return f.debug("receive() | calling pc.setLocalDescription() [answer:%o]",v),t.next=22,this._pc.setLocalDescription(v);case 22:w=kr(e);try{for(x=function(){var e=k.value.trackId,t=i.get(e),n=S._pc.getTransceivers().find((function(e){return e.mid===t}));if(!n)throw new Error("new RTCRtpTransceiver not found");S._mapMidTransceiver.set(t,n),r.push({localId:t,track:n.receiver.track,rtpReceiver:n.receiver})},w.s();!(k=w.n()).done;)x()}catch(R){w.e(R)}finally{w.f()}return t.abrupt("return",r);case 25:case"end":return t.stop()}}),t,this)})))}},{key:"stopReceiving",value:function(e){return Ss(this,null,wr().mark((function t(){var n,r,a;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._assertRecvDirection(),f.debug("stopReceiving() [localId:%s]",e),n=this._mapMidTransceiver.get(e)){t.next=5;break}throw new Error("associated RTCRtpTransceiver not found");case 5:return this._remoteSdp.closeMediaSection(n.mid),r={type:"offer",sdp:this._remoteSdp.getSdp()},f.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",r),t.next=10,this._pc.setRemoteDescription(r);case 10:return t.next=12,this._pc.createAnswer();case 12:return a=t.sent,f.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",a),t.next=16,this._pc.setLocalDescription(a);case 16:this._mapMidTransceiver.delete(e);case 17:case"end":return t.stop()}}),t,this)})))}},{key:"pauseReceiving",value:function(e){return Ss(this,null,wr().mark((function e(){return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})))}},{key:"resumeReceiving",value:function(e){return Ss(this,null,wr().mark((function e(){return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})))}},{key:"getReceiverStats",value:function(e){return Ss(this,null,wr().mark((function t(){var n;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._assertRecvDirection(),n=this._mapMidTransceiver.get(e)){t.next=4;break}throw new Error("associated RTCRtpTransceiver not found");case 4:return t.abrupt("return",n.receiver.getStats());case 5:case"end":return t.stop()}}),t,this)})))}},{key:"receiveDataChannel",value:function(e){return Ss(this,arguments,wr().mark((function e(t){var n,r,i,s,o,c,u,l,d,p,h,m,v;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.sctpStreamParameters,r=t.label,i=t.protocol,this._assertRecvDirection(),o=n.streamId,c=n.ordered,u=n.maxPacketLifeTime,l=n.maxRetransmits,d={negotiated:!0,id:o,ordered:c,maxPacketLifeTime:u,maxRetransmitTime:u,maxRetransmits:l,protocol:i},f.debug("receiveDataChannel() [options:%o]",d),p=this._pc.createDataChannel(r,d),this._hasDataChannelMediaSection){e.next=23;break}return this._remoteSdp.receiveSctpAssociation(),h={type:"offer",sdp:this._remoteSdp.getSdp()},f.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",h),e.next=12,this._pc.setRemoteDescription(h);case 12:return e.next=14,this._pc.createAnswer();case 14:if(m=e.sent,this._transportReady){e.next=19;break}return v=a.parse(m.sdp),e.next=19,this._setupTransport({localDtlsRole:null!==(s=this._forcedLocalDtlsRole)&&void 0!==s?s:"client",localSdpObject:v});case 19:return f.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",m),e.next=22,this._pc.setLocalDescription(m);case 22:this._hasDataChannelMediaSection=!0;case 23:return e.abrupt("return",{dataChannel:p});case 24:case"end":return e.stop()}}),e,this)})))}},{key:"_setupTransport",value:function(e){return Ss(this,arguments,wr().mark((function e(t){var n,r,i;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.localDtlsRole,(r=t.localSdpObject)||(r=a.parse(this._pc.localDescription.sdp)),(i=c.extractDtlsParameters({sdpObject:r})).role=n,this._remoteSdp.updateDtlsRole("client"===n?"server":"client"),e.next=7,this.safeEmitAsPromise("@connect",{dtlsParameters:i});case 7:this._transportReady=!0;case 8:case"end":return e.stop()}}),e,this)})))}},{key:"_assertSendDirection",value:function(){if("send"!==this._direction)throw new Error('method can just be called for handlers with "send" direction')}},{key:"_assertRecvDirection",value:function(){if("recv"!==this._direction)throw new Error('method can just be called for handlers with "recv" direction')}}],[{key:"createFactory",value:function(){return function(){return new n}}}]),n}(l.HandlerInterface);e.Chrome70=m}}),Lo=ks({"../../node_modules/mediasoup-client/lib/handlers/sdp/planBUtils.js":function(e){Rs(),Object.defineProperty(e,"__esModule",{value:!0}),e.addLegacySimulcast=e.getRtpEncodings=void 0,e.getRtpEncodings=function(e){var t,n,r=e.offerMediaObject,a=e.track,i=new Set,o=kr(r.ssrcs||[]);try{for(o.s();!(n=o.n()).done;){var c=n.value;if("msid"===c.attribute)if(c.value.split(" ")[1]===a.id){var u=c.id;i.add(u),t||(t=u)}}}catch(C){o.e(C)}finally{o.f()}if(0===i.size)throw new Error("a=ssrc line with msid information not found [track.id:".concat(a.id,"]"));var l,d=new Map,p=kr(r.ssrcGroups||[]);try{for(p.s();!(l=p.n()).done;){var f=l.value;if("FID"===f.semantics){var h=s(f.ssrcs.split(/\s+/),2),m=h[0],v=h[1];m=Number(m),v=Number(v),i.has(m)&&(i.delete(m),i.delete(v),d.set(m,v))}}}catch(C){p.e(C)}finally{p.f()}var g,b=kr(i);try{for(b.s();!(g=b.n()).done;){var y=g.value;d.set(y,null)}}catch(C){b.e(C)}finally{b.f()}var _,w=[],k=kr(d);try{for(k.s();!(_=k.n()).done;){var x=s(_.value,2),S=x[0],R=x[1],P={ssrc:S};R&&(P.rtx={ssrc:R}),w.push(P)}}catch(C){k.e(C)}finally{k.f()}return w},e.addLegacySimulcast=function(e){var t,n,r,a=e.offerMediaObject,i=e.track,s=e.numStreams;if(s<=1)throw new TypeError("numStreams must be greater than 1");if(!(a.ssrcs||[]).find((function(e){return"msid"===e.attribute&&(e.value.split(" ")[1]===i.id&&(t=e.id,r=e.value.split(" ")[0],!0))})))throw new Error("a=ssrc line with msid information not found [track.id:".concat(i.id,"]"));(a.ssrcGroups||[]).some((function(e){if("FID"!==e.semantics)return!1;var r=e.ssrcs.split(/\s+/);return Number(r[0])===t&&(n=Number(r[1]),!0)}));var o=a.ssrcs.find((function(e){return"cname"===e.attribute&&e.id===t}));if(!o)throw new Error("a=ssrc line with cname information not found [track.id:".concat(i.id,"]"));for(var c=o.value,u=[],l=[],d=0;d<s;++d)u.push(t+d),n&&l.push(n+d);a.ssrcGroups=a.ssrcGroups||[],a.ssrcs=a.ssrcs||[],a.ssrcGroups.push({semantics:"SIM",ssrcs:u.join(" ")});for(var p=0;p<u.length;++p){var f=u[p];a.ssrcs.push({id:f,attribute:"cname",value:c}),a.ssrcs.push({id:f,attribute:"msid",value:"".concat(r," ").concat(i.id)})}for(var h=0;h<l.length;++h){var m=u[h],v=l[h];a.ssrcs.push({id:v,attribute:"cname",value:c}),a.ssrcs.push({id:v,attribute:"msid",value:"".concat(r," ").concat(i.id)}),a.ssrcGroups.push({semantics:"FID",ssrcs:"".concat(m," ").concat(v)})}}}}),Ao=ks({"../../node_modules/mediasoup-client/lib/handlers/Chrome67.js":function(e){Rs();var t=e&&e.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var a=Object.getOwnPropertyDescriptor(t,n);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,a)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),n=e&&e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=e&&e.__importStar||function(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var a in e)"default"!==a&&Object.prototype.hasOwnProperty.call(e,a)&&t(r,e,a);return n(r,e),r};Object.defineProperty(e,"__esModule",{value:!0}),e.Chrome67=void 0;var a=r(co()),i=ho(),s=r(bo()),o=r(_o()),c=r(Co()),u=r(Lo()),l=Eo(),d=Mo(),p=new i.Logger("Chrome67"),f={OS:1024,MIS:1024},h=function(e){mn(n,e);var t=_n(n);function n(){var e;return St(this,n),(e=t.call(this))._sendStream=new MediaStream,e._mapSendLocalIdRtpSender=new Map,e._nextSendLocalId=0,e._mapRecvLocalIdInfo=new Map,e._hasDataChannelMediaSection=!1,e._nextSendSctpStreamId=0,e._transportReady=!1,e}return Pt(n,[{key:"name",get:function(){return"Chrome67"}},{key:"close",value:function(){if(p.debug("close()"),this._pc)try{this._pc.close()}catch(e){}}},{key:"getNativeRtpCapabilities",value:function(){return Ss(this,null,wr().mark((function e(){var t,n,r,i;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return p.debug("getNativeRtpCapabilities()"),t=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"plan-b"}),e.prev=2,e.next=5,t.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0});case 5:n=e.sent;try{t.close()}catch(s){}return r=a.parse(n.sdp),i=c.extractRtpCapabilities({sdpObject:r}),e.abrupt("return",i);case 12:e.prev=12,e.t0=e.catch(2);try{t.close()}catch(o){}throw e.t0;case 16:case"end":return e.stop()}}),e,null,[[2,12]])})))}},{key:"getNativeSctpCapabilities",value:function(){return Ss(this,null,wr().mark((function e(){return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return p.debug("getNativeSctpCapabilities()"),e.abrupt("return",{numStreams:f});case 2:case"end":return e.stop()}}),e)})))}},{key:"run",value:function(e){var t=this,n=e.direction,r=e.iceParameters,a=e.iceCandidates,i=e.dtlsParameters,s=e.sctpParameters,c=e.iceServers,u=e.iceTransportPolicy,l=e.additionalSettings,f=e.proprietaryConstraints,h=e.extendedRtpCapabilities;p.debug("run()"),this._direction=n,this._remoteSdp=new d.RemoteSdp({iceParameters:r,iceCandidates:a,dtlsParameters:i,sctpParameters:s,planB:!0}),this._sendingRtpParametersByKind={audio:o.getSendingRtpParameters("audio",h),video:o.getSendingRtpParameters("video",h)},this._sendingRemoteRtpParametersByKind={audio:o.getSendingRemoteRtpParameters("audio",h),video:o.getSendingRemoteRtpParameters("video",h)},i.role&&"auto"!==i.role&&(this._forcedLocalDtlsRole="server"===i.role?"client":"server"),this._pc=new RTCPeerConnection(_s({iceServers:c||[],iceTransportPolicy:u||"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"plan-b"},l),f),this._pc.addEventListener("iceconnectionstatechange",(function(){switch(t._pc.iceConnectionState){case"checking":t.emit("@connectionstatechange","connecting");break;case"connected":case"completed":t.emit("@connectionstatechange","connected");break;case"failed":t.emit("@connectionstatechange","failed");break;case"disconnected":t.emit("@connectionstatechange","disconnected");break;case"closed":t.emit("@connectionstatechange","closed")}}))}},{key:"updateIceServers",value:function(e){return Ss(this,null,wr().mark((function t(){var n;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:p.debug("updateIceServers()"),(n=this._pc.getConfiguration()).iceServers=e,this._pc.setConfiguration(n);case 4:case"end":return t.stop()}}),t,this)})))}},{key:"restartIce",value:function(e){return Ss(this,null,wr().mark((function t(){var n,r,a,i;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(p.debug("restartIce()"),this._remoteSdp.updateIceParameters(e),this._transportReady){t.next=4;break}return t.abrupt("return");case 4:if("send"!==this._direction){t.next=17;break}return t.next=7,this._pc.createOffer({iceRestart:!0});case 7:return n=t.sent,p.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",n),t.next=11,this._pc.setLocalDescription(n);case 11:return r={type:"answer",sdp:this._remoteSdp.getSdp()},p.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",r),t.next=15,this._pc.setRemoteDescription(r);case 15:t.next=27;break;case 17:return a={type:"offer",sdp:this._remoteSdp.getSdp()},p.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",a),t.next=21,this._pc.setRemoteDescription(a);case 21:return t.next=23,this._pc.createAnswer();case 23:return i=t.sent,p.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",i),t.next=27,this._pc.setLocalDescription(i);case 27:case"end":return t.stop()}}),t,this)})))}},{key:"getTransportStats",value:function(){return Ss(this,null,wr().mark((function e(){return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._pc.getStats());case 1:case"end":return e.stop()}}),e,this)})))}},{key:"send",value:function(e){return Ss(this,arguments,wr().mark((function e(t){var n,r,i,l,d,f,h,m,v,g,b,y,_,w,k,x;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.track,r=t.encodings,i=t.codecOptions,l=t.codec,this._assertSendDirection(),p.debug("send() [kind:%s, track.id:%s]",n.kind,n.id),l&&p.warn("send() | codec selection is not available in %s handler",this.name),this._sendStream.addTrack(n),this._pc.addTrack(n,this._sendStream),e.next=8,this._pc.createOffer();case 8:if(f=e.sent,h=a.parse(f.sdp),(v=s.clone(this._sendingRtpParametersByKind[n.kind],{})).codecs=o.reduceCodecs(v.codecs),(g=s.clone(this._sendingRemoteRtpParametersByKind[n.kind],{})).codecs=o.reduceCodecs(g.codecs),this._transportReady){e.next=17;break}return e.next=17,this._setupTransport({localDtlsRole:null!==(d=this._forcedLocalDtlsRole)&&void 0!==d?d:"client",localSdpObject:h});case 17:return"video"===n.kind&&r&&r.length>1&&(p.debug("send() | enabling simulcast"),h=a.parse(f.sdp),m=h.media.find((function(e){return"video"===e.type})),u.addLegacySimulcast({offerMediaObject:m,track:n,numStreams:r.length}),f={type:"offer",sdp:a.write(h)}),p.debug("send() | calling pc.setLocalDescription() [offer:%o]",f),e.next=21,this._pc.setLocalDescription(f);case 21:if(h=a.parse(this._pc.localDescription.sdp),m=h.media.find((function(e){return e.type===n.kind})),v.rtcp.cname=c.getCname({offerMediaObject:m}),v.encodings=u.getRtpEncodings({offerMediaObject:m,track:n}),r)for(b=0;b<v.encodings.length;++b)r[b]&&Object.assign(v.encodings[b],r[b]);if(v.encodings.length>1&&"video/vp8"===v.codecs[0].mimeType.toLowerCase()){y=kr(v.encodings);try{for(y.s();!(_=y.n()).done;)_.value.scalabilityMode="S1T3"}catch(S){y.e(S)}finally{y.f()}}return this._remoteSdp.send({offerMediaObject:m,offerRtpParameters:v,answerRtpParameters:g,codecOptions:i}),w={type:"answer",sdp:this._remoteSdp.getSdp()},p.debug("send() | calling pc.setRemoteDescription() [answer:%o]",w),e.next=32,this._pc.setRemoteDescription(w);case 32:return k=String(this._nextSendLocalId),this._nextSendLocalId++,x=this._pc.getSenders().find((function(e){return e.track===n})),this._mapSendLocalIdRtpSender.set(k,x),e.abrupt("return",{localId:k,rtpParameters:v,rtpSender:x});case 37:case"end":return e.stop()}}),e,this)})))}},{key:"stopSending",value:function(e){return Ss(this,null,wr().mark((function t(){var n,r,a;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._assertSendDirection(),p.debug("stopSending() [localId:%s]",e),n=this._mapSendLocalIdRtpSender.get(e)){t.next=5;break}throw new Error("associated RTCRtpSender not found");case 5:return this._pc.removeTrack(n),n.track&&this._sendStream.removeTrack(n.track),this._mapSendLocalIdRtpSender.delete(e),t.next=10,this._pc.createOffer();case 10:return r=t.sent,p.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",r),t.prev=12,t.next=15,this._pc.setLocalDescription(r);case 15:t.next=23;break;case 17:if(t.prev=17,t.t0=t.catch(12),0!==this._sendStream.getTracks().length){t.next=22;break}return p.warn("stopSending() | ignoring expected error due no sending tracks: %s",t.t0.toString()),t.abrupt("return");case 22:throw t.t0;case 23:if("stable"!==this._pc.signalingState){t.next=25;break}return t.abrupt("return");case 25:return a={type:"answer",sdp:this._remoteSdp.getSdp()},p.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",a),t.next=29,this._pc.setRemoteDescription(a);case 29:case"end":return t.stop()}}),t,this,[[12,17]])})))}},{key:"replaceTrack",value:function(e,t){return Ss(this,null,wr().mark((function n(){var r,a;return wr().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(this._assertSendDirection(),t?p.debug("replaceTrack() [localId:%s, track.id:%s]",e,t.id):p.debug("replaceTrack() [localId:%s, no track]",e),r=this._mapSendLocalIdRtpSender.get(e)){n.next=5;break}throw new Error("associated RTCRtpSender not found");case 5:return a=r.track,n.next=8,r.replaceTrack(t);case 8:a&&this._sendStream.removeTrack(a),t&&this._sendStream.addTrack(t);case 10:case"end":return n.stop()}}),n,this)})))}},{key:"setMaxSpatialLayer",value:function(e,t){return Ss(this,null,wr().mark((function n(){var r,a;return wr().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(this._assertSendDirection(),p.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",e,t),r=this._mapSendLocalIdRtpSender.get(e)){n.next=5;break}throw new Error("associated RTCRtpSender not found");case 5:return(a=r.getParameters()).encodings.forEach((function(e,n){e.active=n<=t})),n.next=9,r.setParameters(a);case 9:case"end":return n.stop()}}),n,this)})))}},{key:"setRtpEncodingParameters",value:function(e,t){return Ss(this,null,wr().mark((function n(){var r,a;return wr().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(this._assertSendDirection(),p.debug("setRtpEncodingParameters() [localId:%s, params:%o]",e,t),r=this._mapSendLocalIdRtpSender.get(e)){n.next=5;break}throw new Error("associated RTCRtpSender not found");case 5:return(a=r.getParameters()).encodings.forEach((function(e,n){a.encodings[n]=_s(_s({},e),t)})),n.next=9,r.setParameters(a);case 9:case"end":return n.stop()}}),n,this)})))}},{key:"getSenderStats",value:function(e){return Ss(this,null,wr().mark((function t(){var n;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._assertSendDirection(),n=this._mapSendLocalIdRtpSender.get(e)){t.next=4;break}throw new Error("associated RTCRtpSender not found");case 4:return t.abrupt("return",n.getStats());case 5:case"end":return t.stop()}}),t,this)})))}},{key:"sendDataChannel",value:function(e){return Ss(this,arguments,wr().mark((function e(t){var n,r,i,s,o,c,u,l,d,h,m,v,g;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.ordered,r=t.maxPacketLifeTime,i=t.maxRetransmits,s=t.label,o=t.protocol,this._assertSendDirection(),u={negotiated:!0,id:this._nextSendSctpStreamId,ordered:n,maxPacketLifeTime:r,maxRetransmitTime:r,maxRetransmits:i,protocol:o},p.debug("sendDataChannel() [options:%o]",u),l=this._pc.createDataChannel(s,u),this._nextSendSctpStreamId=++this._nextSendSctpStreamId%f.MIS,this._hasDataChannelMediaSection){e.next=24;break}return e.next=9,this._pc.createOffer();case 9:if(d=e.sent,h=a.parse(d.sdp),m=h.media.find((function(e){return"application"===e.type})),this._transportReady){e.next=15;break}return e.next=15,this._setupTransport({localDtlsRole:null!==(c=this._forcedLocalDtlsRole)&&void 0!==c?c:"client",localSdpObject:h});case 15:return p.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",d),e.next=18,this._pc.setLocalDescription(d);case 18:return this._remoteSdp.sendSctpAssociation({offerMediaObject:m}),v={type:"answer",sdp:this._remoteSdp.getSdp()},p.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",v),e.next=23,this._pc.setRemoteDescription(v);case 23:this._hasDataChannelMediaSection=!0;case 24:return g={streamId:u.id,ordered:u.ordered,maxPacketLifeTime:u.maxPacketLifeTime,maxRetransmits:u.maxRetransmits},e.abrupt("return",{dataChannel:l,sctpStreamParameters:g});case 26:case"end":return e.stop()}}),e,this)})))}},{key:"receive",value:function(e){return Ss(this,null,wr().mark((function t(){var n,r,i,s,o,u,l,d,f,h,m,v,g,b,y,_,w,k,x=this;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this._assertRecvDirection(),r=[],i=kr(e);try{for(i.s();!(s=i.n()).done;)o=s.value,u=o.trackId,l=o.kind,d=o.rtpParameters,p.debug("receive() [trackId:%s, kind:%s]",u,l),f=l,this._remoteSdp.receive({mid:f,kind:l,offerRtpParameters:d,streamId:d.rtcp.cname,trackId:u})}catch(S){i.e(S)}finally{i.f()}return h={type:"offer",sdp:this._remoteSdp.getSdp()},p.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",h),t.next=8,this._pc.setRemoteDescription(h);case 8:return t.next=10,this._pc.createAnswer();case 10:m=t.sent,v=a.parse(m.sdp),g=kr(e);try{for(y=function(){var e=b.value,t=e.kind,n=e.rtpParameters,r=t,a=v.media.find((function(e){return String(e.mid)===r}));c.applyCodecParameters({offerRtpParameters:n,answerMediaObject:a})},g.s();!(b=g.n()).done;)y()}catch(S){g.e(S)}finally{g.f()}if(m={type:"answer",sdp:a.write(v)},this._transportReady){t.next=18;break}return t.next=18,this._setupTransport({localDtlsRole:null!==(n=this._forcedLocalDtlsRole)&&void 0!==n?n:"client",localSdpObject:v});case 18:return p.debug("receive() | calling pc.setLocalDescription() [answer:%o]",m),t.next=21,this._pc.setLocalDescription(m);case 21:_=kr(e);try{for(k=function(){var e=w.value,t=e.kind,n=e.trackId,a=e.rtpParameters,i=n,s=t,o=x._pc.getReceivers().find((function(e){return e.track&&e.track.id===i}));if(!o)throw new Error("new RTCRtpReceiver not");x._mapRecvLocalIdInfo.set(i,{mid:s,rtpParameters:a,rtpReceiver:o}),r.push({localId:i,track:o.track,rtpReceiver:o})},_.s();!(w=_.n()).done;)k()}catch(S){_.e(S)}finally{_.f()}return t.abrupt("return",r);case 24:case"end":return t.stop()}}),t,this)})))}},{key:"stopReceiving",value:function(e){return Ss(this,null,wr().mark((function t(){var n,r,a,i,s;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this._assertRecvDirection(),p.debug("stopReceiving() [localId:%s]",e),n=this._mapRecvLocalIdInfo.get(e)||{},r=n.mid,a=n.rtpParameters,this._mapRecvLocalIdInfo.delete(e),this._remoteSdp.planBStopReceiving({mid:r,offerRtpParameters:a}),i={type:"offer",sdp:this._remoteSdp.getSdp()},p.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",i),t.next=9,this._pc.setRemoteDescription(i);case 9:return t.next=11,this._pc.createAnswer();case 11:return s=t.sent,p.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",s),t.next=15,this._pc.setLocalDescription(s);case 15:case"end":return t.stop()}}),t,this)})))}},{key:"pauseReceiving",value:function(e){return Ss(this,null,wr().mark((function e(){return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})))}},{key:"resumeReceiving",value:function(e){return Ss(this,null,wr().mark((function e(){return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})))}},{key:"getReceiverStats",value:function(e){return Ss(this,null,wr().mark((function t(){var n,r;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._assertRecvDirection(),n=this._mapRecvLocalIdInfo.get(e)||{},r=n.rtpReceiver){t.next=4;break}throw new Error("associated RTCRtpReceiver not found");case 4:return t.abrupt("return",r.getStats());case 5:case"end":return t.stop()}}),t,this)})))}},{key:"receiveDataChannel",value:function(e){return Ss(this,arguments,wr().mark((function e(t){var n,r,i,s,o,c,u,l,d,f,h,m,v;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.sctpStreamParameters,r=t.label,i=t.protocol,this._assertRecvDirection(),o=n.streamId,c=n.ordered,u=n.maxPacketLifeTime,l=n.maxRetransmits,d={negotiated:!0,id:o,ordered:c,maxPacketLifeTime:u,maxRetransmitTime:u,maxRetransmits:l,protocol:i},p.debug("receiveDataChannel() [options:%o]",d),f=this._pc.createDataChannel(r,d),this._hasDataChannelMediaSection){e.next=23;break}return this._remoteSdp.receiveSctpAssociation({oldDataChannelSpec:!0}),h={type:"offer",sdp:this._remoteSdp.getSdp()},p.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",h),e.next=12,this._pc.setRemoteDescription(h);case 12:return e.next=14,this._pc.createAnswer();case 14:if(m=e.sent,this._transportReady){e.next=19;break}return v=a.parse(m.sdp),e.next=19,this._setupTransport({localDtlsRole:null!==(s=this._forcedLocalDtlsRole)&&void 0!==s?s:"client",localSdpObject:v});case 19:return p.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",m),e.next=22,this._pc.setLocalDescription(m);case 22:this._hasDataChannelMediaSection=!0;case 23:return e.abrupt("return",{dataChannel:f});case 24:case"end":return e.stop()}}),e,this)})))}},{key:"_setupTransport",value:function(e){return Ss(this,arguments,wr().mark((function e(t){var n,r,i;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.localDtlsRole,(r=t.localSdpObject)||(r=a.parse(this._pc.localDescription.sdp)),(i=c.extractDtlsParameters({sdpObject:r})).role=n,this._remoteSdp.updateDtlsRole("client"===n?"server":"client"),e.next=7,this.safeEmitAsPromise("@connect",{dtlsParameters:i});case 7:this._transportReady=!0;case 8:case"end":return e.stop()}}),e,this)})))}},{key:"_assertSendDirection",value:function(){if("send"!==this._direction)throw new Error('method can just be called for handlers with "send" direction')}},{key:"_assertRecvDirection",value:function(){if("recv"!==this._direction)throw new Error('method can just be called for handlers with "recv" direction')}}],[{key:"createFactory",value:function(){return function(){return new n}}}]),n}(l.HandlerInterface);e.Chrome67=h}}),Fo=ks({"../../node_modules/mediasoup-client/lib/handlers/Chrome55.js":function(e){Rs();var t=e&&e.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var a=Object.getOwnPropertyDescriptor(t,n);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,a)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),n=e&&e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=e&&e.__importStar||function(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var a in e)"default"!==a&&Object.prototype.hasOwnProperty.call(e,a)&&t(r,e,a);return n(r,e),r};Object.defineProperty(e,"__esModule",{value:!0}),e.Chrome55=void 0;var a=r(co()),i=ho(),s=go(),o=r(bo()),c=r(_o()),u=r(Co()),l=r(Lo()),d=Eo(),p=Mo(),f=new i.Logger("Chrome55"),h={OS:1024,MIS:1024},m=function(e){mn(n,e);var t=_n(n);function n(){var e;return St(this,n),(e=t.call(this))._sendStream=new MediaStream,e._mapSendLocalIdTrack=new Map,e._nextSendLocalId=0,e._mapRecvLocalIdInfo=new Map,e._hasDataChannelMediaSection=!1,e._nextSendSctpStreamId=0,e._transportReady=!1,e}return Pt(n,[{key:"name",get:function(){return"Chrome55"}},{key:"close",value:function(){if(f.debug("close()"),this._pc)try{this._pc.close()}catch(e){}}},{key:"getNativeRtpCapabilities",value:function(){return Ss(this,null,wr().mark((function e(){var t,n,r,i;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return f.debug("getNativeRtpCapabilities()"),t=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"plan-b"}),e.prev=2,e.next=5,t.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0});case 5:n=e.sent;try{t.close()}catch(s){}return r=a.parse(n.sdp),i=u.extractRtpCapabilities({sdpObject:r}),e.abrupt("return",i);case 12:e.prev=12,e.t0=e.catch(2);try{t.close()}catch(o){}throw e.t0;case 16:case"end":return e.stop()}}),e,null,[[2,12]])})))}},{key:"getNativeSctpCapabilities",value:function(){return Ss(this,null,wr().mark((function e(){return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return f.debug("getNativeSctpCapabilities()"),e.abrupt("return",{numStreams:h});case 2:case"end":return e.stop()}}),e)})))}},{key:"run",value:function(e){var t=this,n=e.direction,r=e.iceParameters,a=e.iceCandidates,i=e.dtlsParameters,s=e.sctpParameters,o=e.iceServers,u=e.iceTransportPolicy,l=e.additionalSettings,d=e.proprietaryConstraints,h=e.extendedRtpCapabilities;f.debug("run()"),this._direction=n,this._remoteSdp=new p.RemoteSdp({iceParameters:r,iceCandidates:a,dtlsParameters:i,sctpParameters:s,planB:!0}),this._sendingRtpParametersByKind={audio:c.getSendingRtpParameters("audio",h),video:c.getSendingRtpParameters("video",h)},this._sendingRemoteRtpParametersByKind={audio:c.getSendingRemoteRtpParameters("audio",h),video:c.getSendingRemoteRtpParameters("video",h)},i.role&&"auto"!==i.role&&(this._forcedLocalDtlsRole="server"===i.role?"client":"server"),this._pc=new RTCPeerConnection(_s({iceServers:o||[],iceTransportPolicy:u||"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"plan-b"},l),d),this._pc.addEventListener("iceconnectionstatechange",(function(){switch(t._pc.iceConnectionState){case"checking":t.emit("@connectionstatechange","connecting");break;case"connected":case"completed":t.emit("@connectionstatechange","connected");break;case"failed":t.emit("@connectionstatechange","failed");break;case"disconnected":t.emit("@connectionstatechange","disconnected");break;case"closed":t.emit("@connectionstatechange","closed")}}))}},{key:"updateIceServers",value:function(e){return Ss(this,null,wr().mark((function t(){var n;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:f.debug("updateIceServers()"),(n=this._pc.getConfiguration()).iceServers=e,this._pc.setConfiguration(n);case 4:case"end":return t.stop()}}),t,this)})))}},{key:"restartIce",value:function(e){return Ss(this,null,wr().mark((function t(){var n,r,a,i;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(f.debug("restartIce()"),this._remoteSdp.updateIceParameters(e),this._transportReady){t.next=4;break}return t.abrupt("return");case 4:if("send"!==this._direction){t.next=17;break}return t.next=7,this._pc.createOffer({iceRestart:!0});case 7:return n=t.sent,f.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",n),t.next=11,this._pc.setLocalDescription(n);case 11:return r={type:"answer",sdp:this._remoteSdp.getSdp()},f.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",r),t.next=15,this._pc.setRemoteDescription(r);case 15:t.next=27;break;case 17:return a={type:"offer",sdp:this._remoteSdp.getSdp()},f.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",a),t.next=21,this._pc.setRemoteDescription(a);case 21:return t.next=23,this._pc.createAnswer();case 23:return i=t.sent,f.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",i),t.next=27,this._pc.setLocalDescription(i);case 27:case"end":return t.stop()}}),t,this)})))}},{key:"getTransportStats",value:function(){return Ss(this,null,wr().mark((function e(){return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._pc.getStats());case 1:case"end":return e.stop()}}),e,this)})))}},{key:"send",value:function(e){return Ss(this,arguments,wr().mark((function e(t){var n,r,i,s,d,p,h,m,v,g,b,y,_,w,k;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.track,r=t.encodings,i=t.codecOptions,s=t.codec,this._assertSendDirection(),f.debug("send() [kind:%s, track.id:%s]",n.kind,n.id),s&&f.warn("send() | codec selection is not available in %s handler",this.name),this._sendStream.addTrack(n),this._pc.addStream(this._sendStream),e.next=8,this._pc.createOffer();case 8:if(p=e.sent,h=a.parse(p.sdp),(v=o.clone(this._sendingRtpParametersByKind[n.kind],{})).codecs=c.reduceCodecs(v.codecs),(g=o.clone(this._sendingRemoteRtpParametersByKind[n.kind],{})).codecs=c.reduceCodecs(g.codecs),this._transportReady){e.next=17;break}return e.next=17,this._setupTransport({localDtlsRole:null!==(d=this._forcedLocalDtlsRole)&&void 0!==d?d:"client",localSdpObject:h});case 17:return"video"===n.kind&&r&&r.length>1&&(f.debug("send() | enabling simulcast"),h=a.parse(p.sdp),m=h.media.find((function(e){return"video"===e.type})),l.addLegacySimulcast({offerMediaObject:m,track:n,numStreams:r.length}),p={type:"offer",sdp:a.write(h)}),f.debug("send() | calling pc.setLocalDescription() [offer:%o]",p),e.next=21,this._pc.setLocalDescription(p);case 21:if(h=a.parse(this._pc.localDescription.sdp),m=h.media.find((function(e){return e.type===n.kind})),v.rtcp.cname=u.getCname({offerMediaObject:m}),v.encodings=l.getRtpEncodings({offerMediaObject:m,track:n}),r)for(b=0;b<v.encodings.length;++b)r[b]&&Object.assign(v.encodings[b],r[b]);if(v.encodings.length>1&&"video/vp8"===v.codecs[0].mimeType.toLowerCase()){y=kr(v.encodings);try{for(y.s();!(_=y.n()).done;)_.value.scalabilityMode="S1T3"}catch(x){y.e(x)}finally{y.f()}}return this._remoteSdp.send({offerMediaObject:m,offerRtpParameters:v,answerRtpParameters:g,codecOptions:i}),w={type:"answer",sdp:this._remoteSdp.getSdp()},f.debug("send() | calling pc.setRemoteDescription() [answer:%o]",w),e.next=32,this._pc.setRemoteDescription(w);case 32:return k=String(this._nextSendLocalId),this._nextSendLocalId++,this._mapSendLocalIdTrack.set(k,n),e.abrupt("return",{localId:k,rtpParameters:v});case 36:case"end":return e.stop()}}),e,this)})))}},{key:"stopSending",value:function(e){return Ss(this,null,wr().mark((function t(){var n,r,a;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._assertSendDirection(),f.debug("stopSending() [localId:%s]",e),n=this._mapSendLocalIdTrack.get(e)){t.next=5;break}throw new Error("track not found");case 5:return this._mapSendLocalIdTrack.delete(e),this._sendStream.removeTrack(n),this._pc.addStream(this._sendStream),t.next=10,this._pc.createOffer();case 10:return r=t.sent,f.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",r),t.prev=12,t.next=15,this._pc.setLocalDescription(r);case 15:t.next=23;break;case 17:if(t.prev=17,t.t0=t.catch(12),0!==this._sendStream.getTracks().length){t.next=22;break}return f.warn("stopSending() | ignoring expected error due no sending tracks: %s",t.t0.toString()),t.abrupt("return");case 22:throw t.t0;case 23:if("stable"!==this._pc.signalingState){t.next=25;break}return t.abrupt("return");case 25:return a={type:"answer",sdp:this._remoteSdp.getSdp()},f.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",a),t.next=29,this._pc.setRemoteDescription(a);case 29:case"end":return t.stop()}}),t,this,[[12,17]])})))}},{key:"replaceTrack",value:function(e,t){return Ss(this,null,wr().mark((function e(){return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new s.UnsupportedError("not implemented");case 1:case"end":return e.stop()}}),e)})))}},{key:"setMaxSpatialLayer",value:function(e,t){return Ss(this,null,wr().mark((function e(){return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new s.UnsupportedError(" not implemented");case 1:case"end":return e.stop()}}),e)})))}},{key:"setRtpEncodingParameters",value:function(e,t){return Ss(this,null,wr().mark((function e(){return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new s.UnsupportedError("not supported");case 1:case"end":return e.stop()}}),e)})))}},{key:"getSenderStats",value:function(e){return Ss(this,null,wr().mark((function e(){return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new s.UnsupportedError("not implemented");case 1:case"end":return e.stop()}}),e)})))}},{key:"sendDataChannel",value:function(e){return Ss(this,arguments,wr().mark((function e(t){var n,r,i,s,o,c,u,l,d,p,m,v,g;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.ordered,r=t.maxPacketLifeTime,i=t.maxRetransmits,s=t.label,o=t.protocol,this._assertSendDirection(),u={negotiated:!0,id:this._nextSendSctpStreamId,ordered:n,maxPacketLifeTime:r,maxRetransmitTime:r,maxRetransmits:i,protocol:o},f.debug("sendDataChannel() [options:%o]",u),l=this._pc.createDataChannel(s,u),this._nextSendSctpStreamId=++this._nextSendSctpStreamId%h.MIS,this._hasDataChannelMediaSection){e.next=24;break}return e.next=9,this._pc.createOffer();case 9:if(d=e.sent,p=a.parse(d.sdp),m=p.media.find((function(e){return"application"===e.type})),this._transportReady){e.next=15;break}return e.next=15,this._setupTransport({localDtlsRole:null!==(c=this._forcedLocalDtlsRole)&&void 0!==c?c:"client",localSdpObject:p});case 15:return f.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",d),e.next=18,this._pc.setLocalDescription(d);case 18:return this._remoteSdp.sendSctpAssociation({offerMediaObject:m}),v={type:"answer",sdp:this._remoteSdp.getSdp()},f.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",v),e.next=23,this._pc.setRemoteDescription(v);case 23:this._hasDataChannelMediaSection=!0;case 24:return g={streamId:u.id,ordered:u.ordered,maxPacketLifeTime:u.maxPacketLifeTime,maxRetransmits:u.maxRetransmits},e.abrupt("return",{dataChannel:l,sctpStreamParameters:g});case 26:case"end":return e.stop()}}),e,this)})))}},{key:"receive",value:function(e){return Ss(this,null,wr().mark((function t(){var n,r,i,s,o,c,l,d,p,h,m,v,g,b,y,_,w,k,x,S=this;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this._assertRecvDirection(),r=[],i=kr(e);try{for(i.s();!(s=i.n()).done;)o=s.value,c=o.trackId,l=o.kind,d=o.rtpParameters,f.debug("receive() [trackId:%s, kind:%s]",c,l),p=l,h=d.rtcp.cname,this._remoteSdp.receive({mid:p,kind:l,offerRtpParameters:d,streamId:h,trackId:c})}catch(R){i.e(R)}finally{i.f()}return m={type:"offer",sdp:this._remoteSdp.getSdp()},f.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",m),t.next=8,this._pc.setRemoteDescription(m);case 8:return t.next=10,this._pc.createAnswer();case 10:v=t.sent,g=a.parse(v.sdp),b=kr(e);try{for(_=function(){var e=y.value,t=e.kind,n=e.rtpParameters,r=t,a=g.media.find((function(e){return String(e.mid)===r}));u.applyCodecParameters({offerRtpParameters:n,answerMediaObject:a})},b.s();!(y=b.n()).done;)_()}catch(R){b.e(R)}finally{b.f()}if(v={type:"answer",sdp:a.write(g)},this._transportReady){t.next=18;break}return t.next=18,this._setupTransport({localDtlsRole:null!==(n=this._forcedLocalDtlsRole)&&void 0!==n?n:"client",localSdpObject:g});case 18:return f.debug("receive() | calling pc.setLocalDescription() [answer:%o]",v),t.next=21,this._pc.setLocalDescription(v);case 21:w=kr(e);try{for(x=function(){var e=k.value,t=e.kind,n=e.trackId,a=e.rtpParameters,i=t,s=n,o=a.rtcp.cname,c=S._pc.getRemoteStreams().find((function(e){return e.id===o})).getTrackById(s);if(!c)throw new Error("remote track not found");S._mapRecvLocalIdInfo.set(s,{mid:i,rtpParameters:a}),r.push({localId:s,track:c})},w.s();!(k=w.n()).done;)x()}catch(R){w.e(R)}finally{w.f()}return t.abrupt("return",r);case 24:case"end":return t.stop()}}),t,this)})))}},{key:"stopReceiving",value:function(e){return Ss(this,null,wr().mark((function t(){var n,r,a,i,s;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this._assertRecvDirection(),f.debug("stopReceiving() [localId:%s]",e),n=this._mapRecvLocalIdInfo.get(e)||{},r=n.mid,a=n.rtpParameters,this._mapRecvLocalIdInfo.delete(e),this._remoteSdp.planBStopReceiving({mid:r,offerRtpParameters:a}),i={type:"offer",sdp:this._remoteSdp.getSdp()},f.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",i),t.next=9,this._pc.setRemoteDescription(i);case 9:return t.next=11,this._pc.createAnswer();case 11:return s=t.sent,f.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",s),t.next=15,this._pc.setLocalDescription(s);case 15:case"end":return t.stop()}}),t,this)})))}},{key:"pauseReceiving",value:function(e){return Ss(this,null,wr().mark((function e(){return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})))}},{key:"resumeReceiving",value:function(e){return Ss(this,null,wr().mark((function e(){return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})))}},{key:"getReceiverStats",value:function(e){return Ss(this,null,wr().mark((function e(){return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new s.UnsupportedError("not implemented");case 1:case"end":return e.stop()}}),e)})))}},{key:"receiveDataChannel",value:function(e){return Ss(this,arguments,wr().mark((function e(t){var n,r,i,s,o,c,u,l,d,p,h,m,v;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.sctpStreamParameters,r=t.label,i=t.protocol,this._assertRecvDirection(),o=n.streamId,c=n.ordered,u=n.maxPacketLifeTime,l=n.maxRetransmits,d={negotiated:!0,id:o,ordered:c,maxPacketLifeTime:u,maxRetransmitTime:u,maxRetransmits:l,protocol:i},f.debug("receiveDataChannel() [options:%o]",d),p=this._pc.createDataChannel(r,d),this._hasDataChannelMediaSection){e.next=23;break}return this._remoteSdp.receiveSctpAssociation({oldDataChannelSpec:!0}),h={type:"offer",sdp:this._remoteSdp.getSdp()},f.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",h),e.next=12,this._pc.setRemoteDescription(h);case 12:return e.next=14,this._pc.createAnswer();case 14:if(m=e.sent,this._transportReady){e.next=19;break}return v=a.parse(m.sdp),e.next=19,this._setupTransport({localDtlsRole:null!==(s=this._forcedLocalDtlsRole)&&void 0!==s?s:"client",localSdpObject:v});case 19:return f.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",m),e.next=22,this._pc.setLocalDescription(m);case 22:this._hasDataChannelMediaSection=!0;case 23:return e.abrupt("return",{dataChannel:p});case 24:case"end":return e.stop()}}),e,this)})))}},{key:"_setupTransport",value:function(e){return Ss(this,arguments,wr().mark((function e(t){var n,r,i;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.localDtlsRole,(r=t.localSdpObject)||(r=a.parse(this._pc.localDescription.sdp)),(i=u.extractDtlsParameters({sdpObject:r})).role=n,this._remoteSdp.updateDtlsRole("client"===n?"server":"client"),e.next=7,this.safeEmitAsPromise("@connect",{dtlsParameters:i});case 7:this._transportReady=!0;case 8:case"end":return e.stop()}}),e,this)})))}},{key:"_assertSendDirection",value:function(){if("send"!==this._direction)throw new Error('method can just be called for handlers with "send" direction')}},{key:"_assertRecvDirection",value:function(){if("recv"!==this._direction)throw new Error('method can just be called for handlers with "recv" direction')}}],[{key:"createFactory",value:function(){return function(){return new n}}}]),n}(d.HandlerInterface);e.Chrome55=m}}),No=ks({"../../node_modules/mediasoup-client/lib/handlers/Firefox60.js":function(e){Rs();var t=e&&e.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var a=Object.getOwnPropertyDescriptor(t,n);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,a)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),n=e&&e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=e&&e.__importStar||function(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var a in e)"default"!==a&&Object.prototype.hasOwnProperty.call(e,a)&&t(r,e,a);return n(r,e),r};Object.defineProperty(e,"__esModule",{value:!0}),e.Firefox60=void 0;var a=r(co()),i=ho(),s=go(),o=r(bo()),c=r(_o()),u=r(Co()),l=r(To()),d=Eo(),p=Mo(),f=new i.Logger("Firefox60"),h={OS:16,MIS:2048},m=function(e){mn(n,e);var t=_n(n);function n(){var e;return St(this,n),(e=t.call(this))._mapMidTransceiver=new Map,e._sendStream=new MediaStream,e._hasDataChannelMediaSection=!1,e._nextSendSctpStreamId=0,e._transportReady=!1,e}return Pt(n,[{key:"name",get:function(){return"Firefox60"}},{key:"close",value:function(){if(f.debug("close()"),this._pc)try{this._pc.close()}catch(e){}}},{key:"getNativeRtpCapabilities",value:function(){return Ss(this,null,wr().mark((function e(){var t,n,r,i,s,o,c,l,d,p;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return f.debug("getNativeRtpCapabilities()"),t=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require"}),(n=document.createElement("canvas")).getContext("2d"),r=n.captureStream(),i=r.getVideoTracks()[0],e.prev=6,t.addTransceiver("audio",{direction:"sendrecv"}),s=t.addTransceiver(i,{direction:"sendrecv"}),o=s.sender.getParameters(),c=[{rid:"r0",maxBitrate:1e5},{rid:"r1",maxBitrate:5e5}],o.encodings=c,e.next=14,s.sender.setParameters(o);case 14:return e.next=16,t.createOffer();case 16:l=e.sent;try{n.remove()}catch(h){}try{i.stop()}catch(h){}try{t.close()}catch(h){}return d=a.parse(l.sdp),p=u.extractRtpCapabilities({sdpObject:d}),e.abrupt("return",p);case 25:e.prev=25,e.t0=e.catch(6);try{n.remove()}catch(m){}try{i.stop()}catch(m){}try{t.close()}catch(m){}throw e.t0;case 31:case"end":return e.stop()}}),e,null,[[6,25]])})))}},{key:"getNativeSctpCapabilities",value:function(){return Ss(this,null,wr().mark((function e(){return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return f.debug("getNativeSctpCapabilities()"),e.abrupt("return",{numStreams:h});case 2:case"end":return e.stop()}}),e)})))}},{key:"run",value:function(e){var t=this,n=e.direction,r=e.iceParameters,a=e.iceCandidates,i=e.dtlsParameters,s=e.sctpParameters,o=e.iceServers,u=e.iceTransportPolicy,l=e.additionalSettings,d=e.proprietaryConstraints,h=e.extendedRtpCapabilities;f.debug("run()"),this._direction=n,this._remoteSdp=new p.RemoteSdp({iceParameters:r,iceCandidates:a,dtlsParameters:i,sctpParameters:s}),this._sendingRtpParametersByKind={audio:c.getSendingRtpParameters("audio",h),video:c.getSendingRtpParameters("video",h)},this._sendingRemoteRtpParametersByKind={audio:c.getSendingRemoteRtpParameters("audio",h),video:c.getSendingRemoteRtpParameters("video",h)},this._pc=new RTCPeerConnection(_s({iceServers:o||[],iceTransportPolicy:u||"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require"},l),d),this._pc.addEventListener("iceconnectionstatechange",(function(){switch(t._pc.iceConnectionState){case"checking":t.emit("@connectionstatechange","connecting");break;case"connected":case"completed":t.emit("@connectionstatechange","connected");break;case"failed":t.emit("@connectionstatechange","failed");break;case"disconnected":t.emit("@connectionstatechange","disconnected");break;case"closed":t.emit("@connectionstatechange","closed")}}))}},{key:"updateIceServers",value:function(e){return Ss(this,null,wr().mark((function e(){return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new s.UnsupportedError("not supported");case 1:case"end":return e.stop()}}),e)})))}},{key:"restartIce",value:function(e){return Ss(this,null,wr().mark((function t(){var n,r,a,i;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(f.debug("restartIce()"),this._remoteSdp.updateIceParameters(e),this._transportReady){t.next=4;break}return t.abrupt("return");case 4:if("send"!==this._direction){t.next=17;break}return t.next=7,this._pc.createOffer({iceRestart:!0});case 7:return n=t.sent,f.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",n),t.next=11,this._pc.setLocalDescription(n);case 11:return r={type:"answer",sdp:this._remoteSdp.getSdp()},f.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",r),t.next=15,this._pc.setRemoteDescription(r);case 15:t.next=27;break;case 17:return a={type:"offer",sdp:this._remoteSdp.getSdp()},f.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",a),t.next=21,this._pc.setRemoteDescription(a);case 21:return t.next=23,this._pc.createAnswer();case 23:return i=t.sent,f.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",i),t.next=27,this._pc.setLocalDescription(i);case 27:case"end":return t.stop()}}),t,this)})))}},{key:"getTransportStats",value:function(){return Ss(this,null,wr().mark((function e(){return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._pc.getStats());case 1:case"end":return e.stop()}}),e,this)})))}},{key:"send",value:function(e){return Ss(this,arguments,wr().mark((function e(t){var n,r,i,s,d,p,h,m,v,g,b,y,_,w,k,x;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.track,r=t.encodings,i=t.codecOptions,s=t.codec,this._assertSendDirection(),f.debug("send() [kind:%s, track.id:%s]",n.kind,n.id),r&&(r=o.clone(r,[])).length>1&&(r.forEach((function(e,t){e.rid="r".concat(t)})),r.reverse()),(d=o.clone(this._sendingRtpParametersByKind[n.kind],{})).codecs=c.reduceCodecs(d.codecs,s),(p=o.clone(this._sendingRemoteRtpParametersByKind[n.kind],{})).codecs=c.reduceCodecs(p.codecs,s),h=this._pc.addTransceiver(n,{direction:"sendonly",streams:[this._sendStream]}),!r){e.next=14;break}return(m=h.sender.getParameters()).encodings=r,e.next=14,h.sender.setParameters(m);case 14:return e.next=16,this._pc.createOffer();case 16:if(v=e.sent,g=a.parse(v.sdp),this._transportReady){e.next=21;break}return e.next=21,this._setupTransport({localDtlsRole:"client",localSdpObject:g});case 21:return f.debug("send() | calling pc.setLocalDescription() [offer:%o]",v),e.next=24,this._pc.setLocalDescription(v);case 24:if(b=h.mid,d.mid=b,g=a.parse(this._pc.localDescription.sdp),y=g.media[g.media.length-1],d.rtcp.cname=u.getCname({offerMediaObject:y}),r?1===r.length?(_=l.getRtpEncodings({offerMediaObject:y}),Object.assign(_[0],r[0]),d.encodings=_):d.encodings=r.reverse():d.encodings=l.getRtpEncodings({offerMediaObject:y}),d.encodings.length>1&&("video/vp8"===d.codecs[0].mimeType.toLowerCase()||"video/h264"===d.codecs[0].mimeType.toLowerCase())){w=kr(d.encodings);try{for(w.s();!(k=w.n()).done;)k.value.scalabilityMode="S1T3"}catch(S){w.e(S)}finally{w.f()}}return this._remoteSdp.send({offerMediaObject:y,offerRtpParameters:d,answerRtpParameters:p,codecOptions:i,extmapAllowMixed:!0}),x={type:"answer",sdp:this._remoteSdp.getSdp()},f.debug("send() | calling pc.setRemoteDescription() [answer:%o]",x),e.next=36,this._pc.setRemoteDescription(x);case 36:return this._mapMidTransceiver.set(b,h),e.abrupt("return",{localId:b,rtpParameters:d,rtpSender:h.sender});case 38:case"end":return e.stop()}}),e,this)})))}},{key:"stopSending",value:function(e){return Ss(this,null,wr().mark((function t(){var n,r,a;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(f.debug("stopSending() [localId:%s]",e),n=this._mapMidTransceiver.get(e)){t.next=4;break}throw new Error("associated transceiver not found");case 4:return n.sender.replaceTrack(null),this._pc.removeTrack(n.sender),this._remoteSdp.disableMediaSection(n.mid),t.next=9,this._pc.createOffer();case 9:return r=t.sent,f.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",r),t.next=13,this._pc.setLocalDescription(r);case 13:return a={type:"answer",sdp:this._remoteSdp.getSdp()},f.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",a),t.next=17,this._pc.setRemoteDescription(a);case 17:this._mapMidTransceiver.delete(e);case 18:case"end":return t.stop()}}),t,this)})))}},{key:"replaceTrack",value:function(e,t){return Ss(this,null,wr().mark((function n(){var r;return wr().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(this._assertSendDirection(),t?f.debug("replaceTrack() [localId:%s, track.id:%s]",e,t.id):f.debug("replaceTrack() [localId:%s, no track]",e),r=this._mapMidTransceiver.get(e)){n.next=5;break}throw new Error("associated RTCRtpTransceiver not found");case 5:return n.next=7,r.sender.replaceTrack(t);case 7:case"end":return n.stop()}}),n,this)})))}},{key:"setMaxSpatialLayer",value:function(e,t){return Ss(this,null,wr().mark((function n(){var r,a;return wr().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(this._assertSendDirection(),f.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",e,t),r=this._mapMidTransceiver.get(e)){n.next=5;break}throw new Error("associated transceiver not found");case 5:return a=r.sender.getParameters(),t=a.encodings.length-1-t,a.encodings.forEach((function(e,n){e.active=n>=t})),n.next=10,r.sender.setParameters(a);case 10:case"end":return n.stop()}}),n,this)})))}},{key:"setRtpEncodingParameters",value:function(e,t){return Ss(this,null,wr().mark((function n(){var r,a;return wr().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(this._assertSendDirection(),f.debug("setRtpEncodingParameters() [localId:%s, params:%o]",e,t),r=this._mapMidTransceiver.get(e)){n.next=5;break}throw new Error("associated RTCRtpTransceiver not found");case 5:return(a=r.sender.getParameters()).encodings.forEach((function(e,n){a.encodings[n]=_s(_s({},e),t)})),n.next=9,r.sender.setParameters(a);case 9:case"end":return n.stop()}}),n,this)})))}},{key:"getSenderStats",value:function(e){return Ss(this,null,wr().mark((function t(){var n;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._assertSendDirection(),n=this._mapMidTransceiver.get(e)){t.next=4;break}throw new Error("associated RTCRtpTransceiver not found");case 4:return t.abrupt("return",n.sender.getStats());case 5:case"end":return t.stop()}}),t,this)})))}},{key:"sendDataChannel",value:function(e){return Ss(this,arguments,wr().mark((function e(t){var n,r,i,s,o,c,u,l,d,p,m,v;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.ordered,r=t.maxPacketLifeTime,i=t.maxRetransmits,s=t.label,o=t.protocol,this._assertSendDirection(),c={negotiated:!0,id:this._nextSendSctpStreamId,ordered:n,maxPacketLifeTime:r,maxRetransmits:i,protocol:o},f.debug("sendDataChannel() [options:%o]",c),u=this._pc.createDataChannel(s,c),this._nextSendSctpStreamId=++this._nextSendSctpStreamId%h.MIS,this._hasDataChannelMediaSection){e.next=24;break}return e.next=9,this._pc.createOffer();case 9:if(l=e.sent,d=a.parse(l.sdp),p=d.media.find((function(e){return"application"===e.type})),this._transportReady){e.next=15;break}return e.next=15,this._setupTransport({localDtlsRole:"client",localSdpObject:d});case 15:return f.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",l),e.next=18,this._pc.setLocalDescription(l);case 18:return this._remoteSdp.sendSctpAssociation({offerMediaObject:p}),m={type:"answer",sdp:this._remoteSdp.getSdp()},f.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",m),e.next=23,this._pc.setRemoteDescription(m);case 23:this._hasDataChannelMediaSection=!0;case 24:return v={streamId:c.id,ordered:c.ordered,maxPacketLifeTime:c.maxPacketLifeTime,maxRetransmits:c.maxRetransmits},e.abrupt("return",{dataChannel:u,sctpStreamParameters:v});case 26:case"end":return e.stop()}}),e,this)})))}},{key:"receive",value:function(e){return Ss(this,null,wr().mark((function t(){var n,r,i,s,o,c,l,d,p,h,m,v,g,b,y,_,w,k,x=this;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this._assertRecvDirection(),n=[],r=new Map,i=kr(e);try{for(i.s();!(s=i.n()).done;)o=s.value,c=o.trackId,l=o.kind,d=o.rtpParameters,f.debug("receive() [trackId:%s, kind:%s]",c,l),p=d.mid||String(this._mapMidTransceiver.size),r.set(c,p),this._remoteSdp.receive({mid:p,kind:l,offerRtpParameters:d,streamId:d.rtcp.cname,trackId:c})}catch(S){i.e(S)}finally{i.f()}return h={type:"offer",sdp:this._remoteSdp.getSdp()},f.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",h),t.next=9,this._pc.setRemoteDescription(h);case 9:return t.next=11,this._pc.createAnswer();case 11:m=t.sent,v=a.parse(m.sdp),g=kr(e);try{for(y=function(){var e=b.value,t=e.trackId,n=e.rtpParameters,i=r.get(t),s=v.media.find((function(e){return String(e.mid)===i}));u.applyCodecParameters({offerRtpParameters:n,answerMediaObject:s}),m={type:"answer",sdp:a.write(v)}},g.s();!(b=g.n()).done;)y()}catch(S){g.e(S)}finally{g.f()}if(this._transportReady){t.next=18;break}return t.next=18,this._setupTransport({localDtlsRole:"client",localSdpObject:v});case 18:return f.debug("receive() | calling pc.setLocalDescription() [answer:%o]",m),t.next=21,this._pc.setLocalDescription(m);case 21:_=kr(e);try{for(k=function(){var e=w.value.trackId,t=r.get(e),a=x._pc.getTransceivers().find((function(e){return e.mid===t}));if(!a)throw new Error("new RTCRtpTransceiver not found");x._mapMidTransceiver.set(t,a),n.push({localId:t,track:a.receiver.track,rtpReceiver:a.receiver})},_.s();!(w=_.n()).done;)k()}catch(S){_.e(S)}finally{_.f()}return t.abrupt("return",n);case 24:case"end":return t.stop()}}),t,this)})))}},{key:"stopReceiving",value:function(e){return Ss(this,null,wr().mark((function t(){var n,r,a;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._assertRecvDirection(),f.debug("stopReceiving() [localId:%s]",e),n=this._mapMidTransceiver.get(e)){t.next=5;break}throw new Error("associated RTCRtpTransceiver not found");case 5:return this._remoteSdp.closeMediaSection(n.mid),r={type:"offer",sdp:this._remoteSdp.getSdp()},f.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",r),t.next=10,this._pc.setRemoteDescription(r);case 10:return t.next=12,this._pc.createAnswer();case 12:return a=t.sent,f.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",a),t.next=16,this._pc.setLocalDescription(a);case 16:this._mapMidTransceiver.delete(e);case 17:case"end":return t.stop()}}),t,this)})))}},{key:"pauseReceiving",value:function(e){return Ss(this,null,wr().mark((function t(){var n,r,a,i,s,o;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this._assertRecvDirection(),n=kr(e),t.prev=2,n.s();case 4:if((r=n.n()).done){t.next=13;break}if(a=r.value,f.debug("pauseReceiving() [localId:%s]",a),i=this._mapMidTransceiver.get(a)){t.next=10;break}throw new Error("associated RTCRtpTransceiver not found");case 10:i.direction="inactive";case 11:t.next=4;break;case 13:t.next=18;break;case 15:t.prev=15,t.t0=t.catch(2),n.e(t.t0);case 18:return t.prev=18,n.f(),t.finish(18);case 21:return s={type:"offer",sdp:this._remoteSdp.getSdp()},f.debug("pauseReceiving() | calling pc.setRemoteDescription() [offer:%o]",s),t.next=25,this._pc.setRemoteDescription(s);case 25:return t.next=27,this._pc.createAnswer();case 27:return o=t.sent,f.debug("pauseReceiving() | calling pc.setLocalDescription() [answer:%o]",o),t.next=31,this._pc.setLocalDescription(o);case 31:case"end":return t.stop()}}),t,this,[[2,15,18,21]])})))}},{key:"resumeReceiving",value:function(e){return Ss(this,null,wr().mark((function t(){var n,r,a,i,s,o;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this._assertRecvDirection(),n=kr(e),t.prev=2,n.s();case 4:if((r=n.n()).done){t.next=13;break}if(a=r.value,f.debug("resumeReceiving() [localId:%s]",a),i=this._mapMidTransceiver.get(a)){t.next=10;break}throw new Error("associated RTCRtpTransceiver not found");case 10:i.direction="recvonly";case 11:t.next=4;break;case 13:t.next=18;break;case 15:t.prev=15,t.t0=t.catch(2),n.e(t.t0);case 18:return t.prev=18,n.f(),t.finish(18);case 21:return s={type:"offer",sdp:this._remoteSdp.getSdp()},f.debug("resumeReceiving() | calling pc.setRemoteDescription() [offer:%o]",s),t.next=25,this._pc.setRemoteDescription(s);case 25:return t.next=27,this._pc.createAnswer();case 27:return o=t.sent,f.debug("resumeReceiving() | calling pc.setLocalDescription() [answer:%o]",o),t.next=31,this._pc.setLocalDescription(o);case 31:case"end":return t.stop()}}),t,this,[[2,15,18,21]])})))}},{key:"getReceiverStats",value:function(e){return Ss(this,null,wr().mark((function t(){var n;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._assertRecvDirection(),n=this._mapMidTransceiver.get(e)){t.next=4;break}throw new Error("associated RTCRtpTransceiver not found");case 4:return t.abrupt("return",n.receiver.getStats());case 5:case"end":return t.stop()}}),t,this)})))}},{key:"receiveDataChannel",value:function(e){return Ss(this,arguments,wr().mark((function e(t){var n,r,i,s,o,c,u,l,d,p,h,m;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.sctpStreamParameters,r=t.label,i=t.protocol,this._assertRecvDirection(),s=n.streamId,o=n.ordered,c=n.maxPacketLifeTime,u=n.maxRetransmits,l={negotiated:!0,id:s,ordered:o,maxPacketLifeTime:c,maxRetransmits:u,protocol:i},f.debug("receiveDataChannel() [options:%o]",l),d=this._pc.createDataChannel(r,l),this._hasDataChannelMediaSection){e.next=23;break}return this._remoteSdp.receiveSctpAssociation(),p={type:"offer",sdp:this._remoteSdp.getSdp()},f.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",p),e.next=12,this._pc.setRemoteDescription(p);case 12:return e.next=14,this._pc.createAnswer();case 14:if(h=e.sent,this._transportReady){e.next=19;break}return m=a.parse(h.sdp),e.next=19,this._setupTransport({localDtlsRole:"client",localSdpObject:m});case 19:return f.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",h),e.next=22,this._pc.setLocalDescription(h);case 22:this._hasDataChannelMediaSection=!0;case 23:return e.abrupt("return",{dataChannel:d});case 24:case"end":return e.stop()}}),e,this)})))}},{key:"_setupTransport",value:function(e){return Ss(this,arguments,wr().mark((function e(t){var n,r,i;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.localDtlsRole,(r=t.localSdpObject)||(r=a.parse(this._pc.localDescription.sdp)),(i=u.extractDtlsParameters({sdpObject:r})).role=n,this._remoteSdp.updateDtlsRole("client"===n?"server":"client"),e.next=7,this.safeEmitAsPromise("@connect",{dtlsParameters:i});case 7:this._transportReady=!0;case 8:case"end":return e.stop()}}),e,this)})))}},{key:"_assertSendDirection",value:function(){if("send"!==this._direction)throw new Error('method can just be called for handlers with "send" direction')}},{key:"_assertRecvDirection",value:function(){if("recv"!==this._direction)throw new Error('method can just be called for handlers with "recv" direction')}}],[{key:"createFactory",value:function(){return function(){return new n}}}]),n}(d.HandlerInterface);e.Firefox60=m}}),Bo=ks({"../../node_modules/mediasoup-client/lib/handlers/Safari12.js":function(e){Rs();var t=e&&e.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var a=Object.getOwnPropertyDescriptor(t,n);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,a)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),n=e&&e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=e&&e.__importStar||function(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var a in e)"default"!==a&&Object.prototype.hasOwnProperty.call(e,a)&&t(r,e,a);return n(r,e),r};Object.defineProperty(e,"__esModule",{value:!0}),e.Safari12=void 0;var a=r(co()),i=ho(),s=r(bo()),o=r(_o()),c=r(Co()),u=r(To()),l=Eo(),d=Mo(),p=new i.Logger("Safari12"),f={OS:1024,MIS:1024},h=function(e){mn(n,e);var t=_n(n);function n(){var e;return St(this,n),(e=t.call(this))._mapMidTransceiver=new Map,e._sendStream=new MediaStream,e._hasDataChannelMediaSection=!1,e._nextSendSctpStreamId=0,e._transportReady=!1,e}return Pt(n,[{key:"name",get:function(){return"Safari12"}},{key:"close",value:function(){if(p.debug("close()"),this._pc)try{this._pc.close()}catch(e){}}},{key:"getNativeRtpCapabilities",value:function(){return Ss(this,null,wr().mark((function e(){var t,n,r,i;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return p.debug("getNativeRtpCapabilities()"),t=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require"}),e.prev=2,t.addTransceiver("audio"),t.addTransceiver("video"),e.next=7,t.createOffer();case 7:n=e.sent;try{t.close()}catch(s){}return r=a.parse(n.sdp),i=c.extractRtpCapabilities({sdpObject:r}),e.abrupt("return",i);case 14:e.prev=14,e.t0=e.catch(2);try{t.close()}catch(o){}throw e.t0;case 18:case"end":return e.stop()}}),e,null,[[2,14]])})))}},{key:"getNativeSctpCapabilities",value:function(){return Ss(this,null,wr().mark((function e(){return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return p.debug("getNativeSctpCapabilities()"),e.abrupt("return",{numStreams:f});case 2:case"end":return e.stop()}}),e)})))}},{key:"run",value:function(e){var t=this,n=e.direction,r=e.iceParameters,a=e.iceCandidates,i=e.dtlsParameters,s=e.sctpParameters,c=e.iceServers,u=e.iceTransportPolicy,l=e.additionalSettings,f=e.proprietaryConstraints,h=e.extendedRtpCapabilities;p.debug("run()"),this._direction=n,this._remoteSdp=new d.RemoteSdp({iceParameters:r,iceCandidates:a,dtlsParameters:i,sctpParameters:s}),this._sendingRtpParametersByKind={audio:o.getSendingRtpParameters("audio",h),video:o.getSendingRtpParameters("video",h)},this._sendingRemoteRtpParametersByKind={audio:o.getSendingRemoteRtpParameters("audio",h),video:o.getSendingRemoteRtpParameters("video",h)},i.role&&"auto"!==i.role&&(this._forcedLocalDtlsRole="server"===i.role?"client":"server"),this._pc=new RTCPeerConnection(_s({iceServers:c||[],iceTransportPolicy:u||"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require"},l),f),this._pc.addEventListener("iceconnectionstatechange",(function(){switch(t._pc.iceConnectionState){case"checking":t.emit("@connectionstatechange","connecting");break;case"connected":case"completed":t.emit("@connectionstatechange","connected");break;case"failed":t.emit("@connectionstatechange","failed");break;case"disconnected":t.emit("@connectionstatechange","disconnected");break;case"closed":t.emit("@connectionstatechange","closed")}}))}},{key:"updateIceServers",value:function(e){return Ss(this,null,wr().mark((function t(){var n;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:p.debug("updateIceServers()"),(n=this._pc.getConfiguration()).iceServers=e,this._pc.setConfiguration(n);case 4:case"end":return t.stop()}}),t,this)})))}},{key:"restartIce",value:function(e){return Ss(this,null,wr().mark((function t(){var n,r,a,i;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(p.debug("restartIce()"),this._remoteSdp.updateIceParameters(e),this._transportReady){t.next=4;break}return t.abrupt("return");case 4:if("send"!==this._direction){t.next=17;break}return t.next=7,this._pc.createOffer({iceRestart:!0});case 7:return n=t.sent,p.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",n),t.next=11,this._pc.setLocalDescription(n);case 11:return r={type:"answer",sdp:this._remoteSdp.getSdp()},p.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",r),t.next=15,this._pc.setRemoteDescription(r);case 15:t.next=27;break;case 17:return a={type:"offer",sdp:this._remoteSdp.getSdp()},p.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",a),t.next=21,this._pc.setRemoteDescription(a);case 21:return t.next=23,this._pc.createAnswer();case 23:return i=t.sent,p.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",i),t.next=27,this._pc.setLocalDescription(i);case 27:case"end":return t.stop()}}),t,this)})))}},{key:"getTransportStats",value:function(){return Ss(this,null,wr().mark((function e(){return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._pc.getStats());case 1:case"end":return e.stop()}}),e,this)})))}},{key:"send",value:function(e){return Ss(this,arguments,wr().mark((function e(t){var n,r,i,l,d,f,h,m,v,g,b,y,_,w,k,x;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.track,r=t.encodings,i=t.codecOptions,l=t.codec,this._assertSendDirection(),p.debug("send() [kind:%s, track.id:%s]",n.kind,n.id),(f=s.clone(this._sendingRtpParametersByKind[n.kind],{})).codecs=o.reduceCodecs(f.codecs,l),(h=s.clone(this._sendingRemoteRtpParametersByKind[n.kind],{})).codecs=o.reduceCodecs(h.codecs,l),m=this._remoteSdp.getNextMediaSectionIdx(),v=this._pc.addTransceiver(n,{direction:"sendonly",streams:[this._sendStream]}),e.next=11,this._pc.createOffer();case 11:if(g=e.sent,b=a.parse(g.sdp),this._transportReady){e.next=16;break}return e.next=16,this._setupTransport({localDtlsRole:null!==(d=this._forcedLocalDtlsRole)&&void 0!==d?d:"client",localSdpObject:b});case 16:return r&&r.length>1&&(p.debug("send() | enabling legacy simulcast"),b=a.parse(g.sdp),y=b.media[m.idx],u.addLegacySimulcast({offerMediaObject:y,numStreams:r.length}),g={type:"offer",sdp:a.write(b)}),console.debug("send() | calling pc.setLocalDescription() [offer:%o]",g.sdp),e.next=20,this._pc.setLocalDescription(g);case 20:if(_=v.mid,f.mid=_,b=a.parse(this._pc.localDescription.sdp),y=b.media[m.idx],f.rtcp.cname=c.getCname({offerMediaObject:y}),f.encodings=u.getRtpEncodings({offerMediaObject:y}),console.warn(f.encodings,y,r),f.encodings.length>1&&("video/vp8"===f.codecs[0].mimeType.toLowerCase()||"video/h264"===f.codecs[0].mimeType.toLowerCase())){w=kr(f.encodings);try{for(w.s();!(k=w.n()).done;)k.value.scalabilityMode="S1T3"}catch(S){w.e(S)}finally{w.f()}}return this._remoteSdp.send({offerMediaObject:y,reuseMid:m.reuseMid,offerRtpParameters:f,answerRtpParameters:h,codecOptions:i}),x={type:"answer",sdp:this._remoteSdp.getSdp()},console.debug("send() | calling pc.setRemoteDescription() [answer:%o]",x.sdp),e.next=34,this._pc.setRemoteDescription(x);case 34:return this._mapMidTransceiver.set(_,v),e.abrupt("return",{localId:_,rtpParameters:f,rtpSender:v.sender});case 36:case"end":return e.stop()}}),e,this)})))}},{key:"stopSending",value:function(e){return Ss(this,null,wr().mark((function t(){var n,r,a;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._assertSendDirection(),p.debug("stopSending() [localId:%s]",e),n=this._mapMidTransceiver.get(e)){t.next=5;break}throw new Error("associated RTCRtpTransceiver not found");case 5:return n.sender.replaceTrack(null),this._pc.removeTrack(n.sender),this._remoteSdp.closeMediaSection(n.mid),t.next=10,this._pc.createOffer();case 10:return r=t.sent,p.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",r),t.next=14,this._pc.setLocalDescription(r);case 14:return a={type:"answer",sdp:this._remoteSdp.getSdp()},p.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",a),t.next=18,this._pc.setRemoteDescription(a);case 18:this._mapMidTransceiver.delete(e);case 19:case"end":return t.stop()}}),t,this)})))}},{key:"replaceTrack",value:function(e,t){return Ss(this,null,wr().mark((function n(){var r;return wr().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(this._assertSendDirection(),t?p.debug("replaceTrack() [localId:%s, track.id:%s]",e,t.id):p.debug("replaceTrack() [localId:%s, no track]",e),r=this._mapMidTransceiver.get(e)){n.next=5;break}throw new Error("associated RTCRtpTransceiver not found");case 5:return n.next=7,r.sender.replaceTrack(t);case 7:case"end":return n.stop()}}),n,this)})))}},{key:"setMaxSpatialLayer",value:function(e,t){return Ss(this,null,wr().mark((function n(){var r,a;return wr().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(this._assertSendDirection(),console.warn("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",e,t),r=this._mapMidTransceiver.get(e)){n.next=5;break}throw new Error("associated RTCRtpTransceiver not found");case 5:return(a=r.sender.getParameters()).encodings.forEach((function(e,n){e.active=n<=t})),n.next=9,r.sender.setParameters(a);case 9:case"end":return n.stop()}}),n,this)})))}},{key:"setRtpEncodingParameters",value:function(e,t){return Ss(this,null,wr().mark((function n(){var r,a;return wr().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(this._assertSendDirection(),console.warn("setRtpEncodingParameters() [localId:%s, params:%o]",e,t),r=this._mapMidTransceiver.get(e)){n.next=5;break}throw new Error("associated RTCRtpTransceiver not found");case 5:return(a=r.sender.getParameters()).encodings.forEach((function(e,n){a.encodings[n]=_s(_s({},e),t)})),n.next=9,r.sender.setParameters(a);case 9:case"end":return n.stop()}}),n,this)})))}},{key:"getSenderStats",value:function(e){return Ss(this,null,wr().mark((function t(){var n;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._assertSendDirection(),n=this._mapMidTransceiver.get(e)){t.next=4;break}throw new Error("associated RTCRtpTransceiver not found");case 4:return t.abrupt("return",n.sender.getStats());case 5:case"end":return t.stop()}}),t,this)})))}},{key:"sendDataChannel",value:function(e){return Ss(this,arguments,wr().mark((function e(t){var n,r,i,s,o,c,u,l,d,h,m,v,g;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.ordered,r=t.maxPacketLifeTime,i=t.maxRetransmits,s=t.label,o=t.protocol,this._assertSendDirection(),u={negotiated:!0,id:this._nextSendSctpStreamId,ordered:n,maxPacketLifeTime:r,maxRetransmits:i,protocol:o},p.debug("sendDataChannel() [options:%o]",u),l=this._pc.createDataChannel(s,u),this._nextSendSctpStreamId=++this._nextSendSctpStreamId%f.MIS,this._hasDataChannelMediaSection){e.next=24;break}return e.next=9,this._pc.createOffer();case 9:if(d=e.sent,h=a.parse(d.sdp),m=h.media.find((function(e){return"application"===e.type})),this._transportReady){e.next=15;break}return e.next=15,this._setupTransport({localDtlsRole:null!==(c=this._forcedLocalDtlsRole)&&void 0!==c?c:"client",localSdpObject:h});case 15:return p.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",d),e.next=18,this._pc.setLocalDescription(d);case 18:return this._remoteSdp.sendSctpAssociation({offerMediaObject:m}),v={type:"answer",sdp:this._remoteSdp.getSdp()},p.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",v),e.next=23,this._pc.setRemoteDescription(v);case 23:this._hasDataChannelMediaSection=!0;case 24:return g={streamId:u.id,ordered:u.ordered,maxPacketLifeTime:u.maxPacketLifeTime,maxRetransmits:u.maxRetransmits},e.abrupt("return",{dataChannel:l,sctpStreamParameters:g});case 26:case"end":return e.stop()}}),e,this)})))}},{key:"receive",value:function(e){return Ss(this,null,wr().mark((function t(){var n,r,i,s,o,u,l,d,f,h,m,v,g,b,y,_,w,k,x,S=this;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this._assertRecvDirection(),r=[],i=new Map,s=kr(e);try{for(s.s();!(o=s.n()).done;)u=o.value,l=u.trackId,d=u.kind,f=u.rtpParameters,p.debug("receive() [trackId:%s, kind:%s]",l,d),h=f.mid||String(this._mapMidTransceiver.size),i.set(l,h),this._remoteSdp.receive({mid:h,kind:d,offerRtpParameters:f,streamId:f.rtcp.cname,trackId:l})}catch(R){s.e(R)}finally{s.f()}return m={type:"offer",sdp:this._remoteSdp.getSdp()},p.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",m),t.next=9,this._pc.setRemoteDescription(m);case 9:return t.next=11,this._pc.createAnswer();case 11:v=t.sent,g=a.parse(v.sdp),b=kr(e);try{for(_=function(){var e=y.value,t=e.trackId,n=e.rtpParameters,r=i.get(t),a=g.media.find((function(e){return String(e.mid)===r}));c.applyCodecParameters({offerRtpParameters:n,answerMediaObject:a})},b.s();!(y=b.n()).done;)_()}catch(R){b.e(R)}finally{b.f()}if(v={type:"answer",sdp:a.write(g)},this._transportReady){t.next=19;break}return t.next=19,this._setupTransport({localDtlsRole:null!==(n=this._forcedLocalDtlsRole)&&void 0!==n?n:"client",localSdpObject:g});case 19:return p.debug("receive() | calling pc.setLocalDescription() [answer:%o]",v),t.next=22,this._pc.setLocalDescription(v);case 22:w=kr(e);try{for(x=function(){var e=k.value.trackId,t=i.get(e),n=S._pc.getTransceivers().find((function(e){return e.mid===t}));if(!n)throw new Error("new RTCRtpTransceiver not found");S._mapMidTransceiver.set(t,n),r.push({localId:t,track:n.receiver.track,rtpReceiver:n.receiver})},w.s();!(k=w.n()).done;)x()}catch(R){w.e(R)}finally{w.f()}return t.abrupt("return",r);case 25:case"end":return t.stop()}}),t,this)})))}},{key:"stopReceiving",value:function(e){return Ss(this,null,wr().mark((function t(){var n,r,a;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._assertRecvDirection(),p.debug("stopReceiving() [localId:%s]",e),n=this._mapMidTransceiver.get(e)){t.next=5;break}throw new Error("associated RTCRtpTransceiver not found");case 5:return this._remoteSdp.closeMediaSection(n.mid),r={type:"offer",sdp:this._remoteSdp.getSdp()},p.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",r),t.next=10,this._pc.setRemoteDescription(r);case 10:return t.next=12,this._pc.createAnswer();case 12:return a=t.sent,p.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",a),t.next=16,this._pc.setLocalDescription(a);case 16:this._mapMidTransceiver.delete(e);case 17:case"end":return t.stop()}}),t,this)})))}},{key:"pauseReceiving",value:function(e){return Ss(this,null,wr().mark((function t(){var n,r,a,i,s,o;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this._assertRecvDirection(),n=kr(e),t.prev=2,n.s();case 4:if((r=n.n()).done){t.next=13;break}if(a=r.value,p.debug("pauseReceiving() [localId:%s]",a),i=this._mapMidTransceiver.get(a)){t.next=10;break}throw new Error("associated RTCRtpTransceiver not found");case 10:i.direction="inactive";case 11:t.next=4;break;case 13:t.next=18;break;case 15:t.prev=15,t.t0=t.catch(2),n.e(t.t0);case 18:return t.prev=18,n.f(),t.finish(18);case 21:return s={type:"offer",sdp:this._remoteSdp.getSdp()},p.debug("pauseReceiving() | calling pc.setRemoteDescription() [offer:%o]",s),t.next=25,this._pc.setRemoteDescription(s);case 25:return t.next=27,this._pc.createAnswer();case 27:return o=t.sent,p.debug("pauseReceiving() | calling pc.setLocalDescription() [answer:%o]",o),t.next=31,this._pc.setLocalDescription(o);case 31:case"end":return t.stop()}}),t,this,[[2,15,18,21]])})))}},{key:"resumeReceiving",value:function(e){return Ss(this,null,wr().mark((function t(){var n,r,a,i,s,o;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this._assertRecvDirection(),n=kr(e),t.prev=2,n.s();case 4:if((r=n.n()).done){t.next=13;break}if(a=r.value,p.debug("resumeReceiving() [localId:%s]",a),i=this._mapMidTransceiver.get(a)){t.next=10;break}throw new Error("associated RTCRtpTransceiver not found");case 10:i.direction="recvonly";case 11:t.next=4;break;case 13:t.next=18;break;case 15:t.prev=15,t.t0=t.catch(2),n.e(t.t0);case 18:return t.prev=18,n.f(),t.finish(18);case 21:return s={type:"offer",sdp:this._remoteSdp.getSdp()},p.debug("resumeReceiving() | calling pc.setRemoteDescription() [offer:%o]",s),t.next=25,this._pc.setRemoteDescription(s);case 25:return t.next=27,this._pc.createAnswer();case 27:return o=t.sent,p.debug("resumeReceiving() | calling pc.setLocalDescription() [answer:%o]",o),t.next=31,this._pc.setLocalDescription(o);case 31:case"end":return t.stop()}}),t,this,[[2,15,18,21]])})))}},{key:"getReceiverStats",value:function(e){return Ss(this,null,wr().mark((function t(){var n;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._assertRecvDirection(),n=this._mapMidTransceiver.get(e)){t.next=4;break}throw new Error("associated RTCRtpTransceiver not found");case 4:return t.abrupt("return",n.receiver.getStats());case 5:case"end":return t.stop()}}),t,this)})))}},{key:"receiveDataChannel",value:function(e){return Ss(this,arguments,wr().mark((function e(t){var n,r,i,s,o,c,u,l,d,f,h,m,v;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.sctpStreamParameters,r=t.label,i=t.protocol,this._assertRecvDirection(),o=n.streamId,c=n.ordered,u=n.maxPacketLifeTime,l=n.maxRetransmits,d={negotiated:!0,id:o,ordered:c,maxPacketLifeTime:u,maxRetransmits:l,protocol:i},p.debug("receiveDataChannel() [options:%o]",d),f=this._pc.createDataChannel(r,d),this._hasDataChannelMediaSection){e.next=23;break}return this._remoteSdp.receiveSctpAssociation(),h={type:"offer",sdp:this._remoteSdp.getSdp()},p.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",h),e.next=12,this._pc.setRemoteDescription(h);case 12:return e.next=14,this._pc.createAnswer();case 14:if(m=e.sent,this._transportReady){e.next=19;break}return v=a.parse(m.sdp),e.next=19,this._setupTransport({localDtlsRole:null!==(s=this._forcedLocalDtlsRole)&&void 0!==s?s:"client",localSdpObject:v});case 19:return p.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",m),e.next=22,this._pc.setLocalDescription(m);case 22:this._hasDataChannelMediaSection=!0;case 23:return e.abrupt("return",{dataChannel:f});case 24:case"end":return e.stop()}}),e,this)})))}},{key:"_setupTransport",value:function(e){return Ss(this,arguments,wr().mark((function e(t){var n,r,i;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.localDtlsRole,(r=t.localSdpObject)||(r=a.parse(this._pc.localDescription.sdp)),(i=c.extractDtlsParameters({sdpObject:r})).role=n,this._remoteSdp.updateDtlsRole("client"===n?"server":"client"),e.next=7,this.safeEmitAsPromise("@connect",{dtlsParameters:i});case 7:this._transportReady=!0;case 8:case"end":return e.stop()}}),e,this)})))}},{key:"_assertSendDirection",value:function(){if("send"!==this._direction)throw new Error('method can just be called for handlers with "send" direction')}},{key:"_assertRecvDirection",value:function(){if("recv"!==this._direction)throw new Error('method can just be called for handlers with "recv" direction')}}],[{key:"createFactory",value:function(){return function(){return new n}}}]),n}(l.HandlerInterface);e.Safari12=h}}),Uo=ks({"../../node_modules/mediasoup-client/lib/handlers/Safari11.js":function(e){Rs();var t=e&&e.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var a=Object.getOwnPropertyDescriptor(t,n);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,a)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),n=e&&e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=e&&e.__importStar||function(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var a in e)"default"!==a&&Object.prototype.hasOwnProperty.call(e,a)&&t(r,e,a);return n(r,e),r};Object.defineProperty(e,"__esModule",{value:!0}),e.Safari11=void 0;var a=r(co()),i=ho(),s=r(bo()),o=r(_o()),c=r(Co()),u=r(Lo()),l=Eo(),d=Mo(),p=new i.Logger("Safari11"),f={OS:1024,MIS:1024},h=function(e){mn(n,e);var t=_n(n);function n(){var e;return St(this,n),(e=t.call(this))._sendStream=new MediaStream,e._mapSendLocalIdRtpSender=new Map,e._nextSendLocalId=0,e._mapRecvLocalIdInfo=new Map,e._hasDataChannelMediaSection=!1,e._nextSendSctpStreamId=0,e._transportReady=!1,e}return Pt(n,[{key:"name",get:function(){return"Safari11"}},{key:"close",value:function(){if(p.debug("close()"),this._pc)try{this._pc.close()}catch(e){}}},{key:"getNativeRtpCapabilities",value:function(){return Ss(this,null,wr().mark((function e(){var t,n,r,i;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return p.debug("getNativeRtpCapabilities()"),t=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"plan-b"}),e.prev=2,e.next=5,t.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0});case 5:n=e.sent;try{t.close()}catch(s){}return r=a.parse(n.sdp),i=c.extractRtpCapabilities({sdpObject:r}),e.abrupt("return",i);case 12:e.prev=12,e.t0=e.catch(2);try{t.close()}catch(o){}throw e.t0;case 16:case"end":return e.stop()}}),e,null,[[2,12]])})))}},{key:"getNativeSctpCapabilities",value:function(){return Ss(this,null,wr().mark((function e(){return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return p.debug("getNativeSctpCapabilities()"),e.abrupt("return",{numStreams:f});case 2:case"end":return e.stop()}}),e)})))}},{key:"run",value:function(e){var t=this,n=e.direction,r=e.iceParameters,a=e.iceCandidates,i=e.dtlsParameters,s=e.sctpParameters,c=e.iceServers,u=e.iceTransportPolicy,l=e.additionalSettings,f=e.proprietaryConstraints,h=e.extendedRtpCapabilities;p.debug("run()"),this._direction=n,this._remoteSdp=new d.RemoteSdp({iceParameters:r,iceCandidates:a,dtlsParameters:i,sctpParameters:s,planB:!0}),this._sendingRtpParametersByKind={audio:o.getSendingRtpParameters("audio",h),video:o.getSendingRtpParameters("video",h)},this._sendingRemoteRtpParametersByKind={audio:o.getSendingRemoteRtpParameters("audio",h),video:o.getSendingRemoteRtpParameters("video",h)},i.role&&"auto"!==i.role&&(this._forcedLocalDtlsRole="server"===i.role?"client":"server"),this._pc=new RTCPeerConnection(_s({iceServers:c||[],iceTransportPolicy:u||"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require"},l),f),this._pc.addEventListener("iceconnectionstatechange",(function(){switch(t._pc.iceConnectionState){case"checking":t.emit("@connectionstatechange","connecting");break;case"connected":case"completed":t.emit("@connectionstatechange","connected");break;case"failed":t.emit("@connectionstatechange","failed");break;case"disconnected":t.emit("@connectionstatechange","disconnected");break;case"closed":t.emit("@connectionstatechange","closed")}}))}},{key:"updateIceServers",value:function(e){return Ss(this,null,wr().mark((function t(){var n;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:p.debug("updateIceServers()"),(n=this._pc.getConfiguration()).iceServers=e,this._pc.setConfiguration(n);case 4:case"end":return t.stop()}}),t,this)})))}},{key:"restartIce",value:function(e){return Ss(this,null,wr().mark((function t(){var n,r,a,i;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(p.debug("restartIce()"),this._remoteSdp.updateIceParameters(e),this._transportReady){t.next=4;break}return t.abrupt("return");case 4:if("send"!==this._direction){t.next=17;break}return t.next=7,this._pc.createOffer({iceRestart:!0});case 7:return n=t.sent,p.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",n),t.next=11,this._pc.setLocalDescription(n);case 11:return r={type:"answer",sdp:this._remoteSdp.getSdp()},p.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",r),t.next=15,this._pc.setRemoteDescription(r);case 15:t.next=27;break;case 17:return a={type:"offer",sdp:this._remoteSdp.getSdp()},p.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",a),t.next=21,this._pc.setRemoteDescription(a);case 21:return t.next=23,this._pc.createAnswer();case 23:return i=t.sent,p.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",i),t.next=27,this._pc.setLocalDescription(i);case 27:case"end":return t.stop()}}),t,this)})))}},{key:"getTransportStats",value:function(){return Ss(this,null,wr().mark((function e(){return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._pc.getStats());case 1:case"end":return e.stop()}}),e,this)})))}},{key:"send",value:function(e){return Ss(this,arguments,wr().mark((function e(t){var n,r,i,l,d,f,h,m,v,g,b,y,_,w,k,x;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.track,r=t.encodings,i=t.codecOptions,l=t.codec,this._assertSendDirection(),p.debug("send() [kind:%s, track.id:%s]",n.kind,n.id),l&&p.warn("send() | codec selection is not available in %s handler",this.name),this._sendStream.addTrack(n),this._pc.addTrack(n,this._sendStream),e.next=8,this._pc.createOffer();case 8:if(f=e.sent,h=a.parse(f.sdp),(v=s.clone(this._sendingRtpParametersByKind[n.kind],{})).codecs=o.reduceCodecs(v.codecs),(g=s.clone(this._sendingRemoteRtpParametersByKind[n.kind],{})).codecs=o.reduceCodecs(g.codecs),this._transportReady){e.next=17;break}return e.next=17,this._setupTransport({localDtlsRole:null!==(d=this._forcedLocalDtlsRole)&&void 0!==d?d:"client",localSdpObject:h});case 17:return"video"===n.kind&&r&&r.length>1&&(p.debug("send() | enabling simulcast"),h=a.parse(f.sdp),m=h.media.find((function(e){return"video"===e.type})),u.addLegacySimulcast({offerMediaObject:m,track:n,numStreams:r.length}),f={type:"offer",sdp:a.write(h)}),p.debug("send() | calling pc.setLocalDescription() [offer:%o]",f),e.next=21,this._pc.setLocalDescription(f);case 21:if(h=a.parse(this._pc.localDescription.sdp),m=h.media.find((function(e){return e.type===n.kind})),v.rtcp.cname=c.getCname({offerMediaObject:m}),v.encodings=u.getRtpEncodings({offerMediaObject:m,track:n}),r)for(b=0;b<v.encodings.length;++b)r[b]&&Object.assign(v.encodings[b],r[b]);if(v.encodings.length>1&&"video/vp8"===v.codecs[0].mimeType.toLowerCase()){y=kr(v.encodings);try{for(y.s();!(_=y.n()).done;)_.value.scalabilityMode="S1T3"}catch(S){y.e(S)}finally{y.f()}}return this._remoteSdp.send({offerMediaObject:m,offerRtpParameters:v,answerRtpParameters:g,codecOptions:i}),w={type:"answer",sdp:this._remoteSdp.getSdp()},p.debug("send() | calling pc.setRemoteDescription() [answer:%o]",w),e.next=32,this._pc.setRemoteDescription(w);case 32:return k=String(this._nextSendLocalId),this._nextSendLocalId++,x=this._pc.getSenders().find((function(e){return e.track===n})),this._mapSendLocalIdRtpSender.set(k,x),e.abrupt("return",{localId:k,rtpParameters:v,rtpSender:x});case 37:case"end":return e.stop()}}),e,this)})))}},{key:"stopSending",value:function(e){return Ss(this,null,wr().mark((function t(){var n,r,a;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._assertSendDirection(),n=this._mapSendLocalIdRtpSender.get(e)){t.next=4;break}throw new Error("associated RTCRtpSender not found");case 4:return n.track&&this._sendStream.removeTrack(n.track),this._mapSendLocalIdRtpSender.delete(e),t.next=8,this._pc.createOffer();case 8:return r=t.sent,p.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",r),t.prev=10,t.next=13,this._pc.setLocalDescription(r);case 13:t.next=21;break;case 15:if(t.prev=15,t.t0=t.catch(10),0!==this._sendStream.getTracks().length){t.next=20;break}return p.warn("stopSending() | ignoring expected error due no sending tracks: %s",t.t0.toString()),t.abrupt("return");case 20:throw t.t0;case 21:if("stable"!==this._pc.signalingState){t.next=23;break}return t.abrupt("return");case 23:return a={type:"answer",sdp:this._remoteSdp.getSdp()},p.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",a),t.next=27,this._pc.setRemoteDescription(a);case 27:case"end":return t.stop()}}),t,this,[[10,15]])})))}},{key:"replaceTrack",value:function(e,t){return Ss(this,null,wr().mark((function n(){var r,a;return wr().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(this._assertSendDirection(),t?p.debug("replaceTrack() [localId:%s, track.id:%s]",e,t.id):p.debug("replaceTrack() [localId:%s, no track]",e),r=this._mapSendLocalIdRtpSender.get(e)){n.next=5;break}throw new Error("associated RTCRtpSender not found");case 5:return a=r.track,n.next=8,r.replaceTrack(t);case 8:a&&this._sendStream.removeTrack(a),t&&this._sendStream.addTrack(t);case 10:case"end":return n.stop()}}),n,this)})))}},{key:"setMaxSpatialLayer",value:function(e,t){return Ss(this,null,wr().mark((function n(){var r,a;return wr().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(this._assertSendDirection(),p.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",e,t),r=this._mapSendLocalIdRtpSender.get(e)){n.next=5;break}throw new Error("associated RTCRtpSender not found");case 5:return(a=r.getParameters()).encodings.forEach((function(e,n){e.active=n<=t})),n.next=9,r.setParameters(a);case 9:case"end":return n.stop()}}),n,this)})))}},{key:"setRtpEncodingParameters",value:function(e,t){return Ss(this,null,wr().mark((function n(){var r,a;return wr().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(this._assertSendDirection(),p.debug("setRtpEncodingParameters() [localId:%s, params:%o]",e,t),r=this._mapSendLocalIdRtpSender.get(e)){n.next=5;break}throw new Error("associated RTCRtpSender not found");case 5:return(a=r.getParameters()).encodings.forEach((function(e,n){a.encodings[n]=_s(_s({},e),t)})),n.next=9,r.setParameters(a);case 9:case"end":return n.stop()}}),n,this)})))}},{key:"getSenderStats",value:function(e){return Ss(this,null,wr().mark((function t(){var n;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._assertSendDirection(),n=this._mapSendLocalIdRtpSender.get(e)){t.next=4;break}throw new Error("associated RTCRtpSender not found");case 4:return t.abrupt("return",n.getStats());case 5:case"end":return t.stop()}}),t,this)})))}},{key:"sendDataChannel",value:function(e){return Ss(this,arguments,wr().mark((function e(t){var n,r,i,s,o,c,u,l,d,h,m,v,g;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.ordered,r=t.maxPacketLifeTime,i=t.maxRetransmits,s=t.label,o=t.protocol,this._assertSendDirection(),u={negotiated:!0,id:this._nextSendSctpStreamId,ordered:n,maxPacketLifeTime:r,maxRetransmits:i,protocol:o},p.debug("sendDataChannel() [options:%o]",u),l=this._pc.createDataChannel(s,u),this._nextSendSctpStreamId=++this._nextSendSctpStreamId%f.MIS,this._hasDataChannelMediaSection){e.next=24;break}return e.next=9,this._pc.createOffer();case 9:if(d=e.sent,h=a.parse(d.sdp),m=h.media.find((function(e){return"application"===e.type})),this._transportReady){e.next=15;break}return e.next=15,this._setupTransport({localDtlsRole:null!==(c=this._forcedLocalDtlsRole)&&void 0!==c?c:"client",localSdpObject:h});case 15:return p.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",d),e.next=18,this._pc.setLocalDescription(d);case 18:return this._remoteSdp.sendSctpAssociation({offerMediaObject:m}),v={type:"answer",sdp:this._remoteSdp.getSdp()},p.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",v),e.next=23,this._pc.setRemoteDescription(v);case 23:this._hasDataChannelMediaSection=!0;case 24:return g={streamId:u.id,ordered:u.ordered,maxPacketLifeTime:u.maxPacketLifeTime,maxRetransmits:u.maxRetransmits},e.abrupt("return",{dataChannel:l,sctpStreamParameters:g});case 26:case"end":return e.stop()}}),e,this)})))}},{key:"receive",value:function(e){return Ss(this,null,wr().mark((function t(){var n,r,i,s,o,u,l,d,f,h,m,v,g,b,y,_,w,k,x=this;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this._assertRecvDirection(),r=[],i=kr(e);try{for(i.s();!(s=i.n()).done;)o=s.value,u=o.trackId,l=o.kind,d=o.rtpParameters,p.debug("receive() [trackId:%s, kind:%s]",u,l),f=l,this._remoteSdp.receive({mid:f,kind:l,offerRtpParameters:d,streamId:d.rtcp.cname,trackId:u})}catch(S){i.e(S)}finally{i.f()}return h={type:"offer",sdp:this._remoteSdp.getSdp()},p.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",h),t.next=8,this._pc.setRemoteDescription(h);case 8:return t.next=10,this._pc.createAnswer();case 10:m=t.sent,v=a.parse(m.sdp),g=kr(e);try{for(y=function(){var e=b.value,t=e.kind,n=e.rtpParameters,r=t,a=v.media.find((function(e){return String(e.mid)===r}));c.applyCodecParameters({offerRtpParameters:n,answerMediaObject:a})},g.s();!(b=g.n()).done;)y()}catch(S){g.e(S)}finally{g.f()}if(m={type:"answer",sdp:a.write(v)},this._transportReady){t.next=18;break}return t.next=18,this._setupTransport({localDtlsRole:null!==(n=this._forcedLocalDtlsRole)&&void 0!==n?n:"client",localSdpObject:v});case 18:return p.debug("receive() | calling pc.setLocalDescription() [answer:%o]",m),t.next=21,this._pc.setLocalDescription(m);case 21:_=kr(e);try{for(k=function(){var e=w.value,t=e.kind,n=e.trackId,a=e.rtpParameters,i=t,s=n,o=x._pc.getReceivers().find((function(e){return e.track&&e.track.id===s}));if(!o)throw new Error("new RTCRtpReceiver not");x._mapRecvLocalIdInfo.set(s,{mid:i,rtpParameters:a,rtpReceiver:o}),r.push({localId:s,track:o.track,rtpReceiver:o})},_.s();!(w=_.n()).done;)k()}catch(S){_.e(S)}finally{_.f()}return t.abrupt("return",r);case 24:case"end":return t.stop()}}),t,this)})))}},{key:"stopReceiving",value:function(e){return Ss(this,null,wr().mark((function t(){var n,r,a,i,s;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this._assertRecvDirection(),p.debug("stopReceiving() [localId:%s]",e),n=this._mapRecvLocalIdInfo.get(e)||{},r=n.mid,a=n.rtpParameters,this._mapRecvLocalIdInfo.delete(e),this._remoteSdp.planBStopReceiving({mid:r,offerRtpParameters:a}),i={type:"offer",sdp:this._remoteSdp.getSdp()},p.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",i),t.next=9,this._pc.setRemoteDescription(i);case 9:return t.next=11,this._pc.createAnswer();case 11:return s=t.sent,p.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",s),t.next=15,this._pc.setLocalDescription(s);case 15:case"end":return t.stop()}}),t,this)})))}},{key:"getReceiverStats",value:function(e){return Ss(this,null,wr().mark((function t(){var n,r;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._assertRecvDirection(),n=this._mapRecvLocalIdInfo.get(e)||{},r=n.rtpReceiver){t.next=4;break}throw new Error("associated RTCRtpReceiver not found");case 4:return t.abrupt("return",r.getStats());case 5:case"end":return t.stop()}}),t,this)})))}},{key:"pauseReceiving",value:function(e){return Ss(this,null,wr().mark((function e(){return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})))}},{key:"resumeReceiving",value:function(e){return Ss(this,null,wr().mark((function e(){return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})))}},{key:"receiveDataChannel",value:function(e){return Ss(this,arguments,wr().mark((function e(t){var n,r,i,s,o,c,u,l,d,f,h,m,v;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.sctpStreamParameters,r=t.label,i=t.protocol,this._assertRecvDirection(),o=n.streamId,c=n.ordered,u=n.maxPacketLifeTime,l=n.maxRetransmits,d={negotiated:!0,id:o,ordered:c,maxPacketLifeTime:u,maxRetransmits:l,protocol:i},p.debug("receiveDataChannel() [options:%o]",d),f=this._pc.createDataChannel(r,d),this._hasDataChannelMediaSection){e.next=23;break}return this._remoteSdp.receiveSctpAssociation({oldDataChannelSpec:!0}),h={type:"offer",sdp:this._remoteSdp.getSdp()},p.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",h),e.next=12,this._pc.setRemoteDescription(h);case 12:return e.next=14,this._pc.createAnswer();case 14:if(m=e.sent,this._transportReady){e.next=19;break}return v=a.parse(m.sdp),e.next=19,this._setupTransport({localDtlsRole:null!==(s=this._forcedLocalDtlsRole)&&void 0!==s?s:"client",localSdpObject:v});case 19:return p.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",m),e.next=22,this._pc.setLocalDescription(m);case 22:this._hasDataChannelMediaSection=!0;case 23:return e.abrupt("return",{dataChannel:f});case 24:case"end":return e.stop()}}),e,this)})))}},{key:"_setupTransport",value:function(e){return Ss(this,arguments,wr().mark((function e(t){var n,r,i;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.localDtlsRole,(r=t.localSdpObject)||(r=a.parse(this._pc.localDescription.sdp)),(i=c.extractDtlsParameters({sdpObject:r})).role=n,this._remoteSdp.updateDtlsRole("client"===n?"server":"client"),e.next=7,this.safeEmitAsPromise("@connect",{dtlsParameters:i});case 7:this._transportReady=!0;case 8:case"end":return e.stop()}}),e,this)})))}},{key:"_assertSendDirection",value:function(){if("send"!==this._direction)throw new Error('method can just be called for handlers with "send" direction')}},{key:"_assertRecvDirection",value:function(){if("recv"!==this._direction)throw new Error('method can just be called for handlers with "recv" direction')}}],[{key:"createFactory",value:function(){return function(){return new n}}}]),n}(l.HandlerInterface);e.Safari11=h}}),zo=ks({"../../node_modules/mediasoup-client/lib/handlers/ortc/edgeUtils.js":function(e){Rs();var t=e&&e.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var a=Object.getOwnPropertyDescriptor(t,n);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,a)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),n=e&&e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=e&&e.__importStar||function(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var a in e)"default"!==a&&Object.prototype.hasOwnProperty.call(e,a)&&t(r,e,a);return n(r,e),r};Object.defineProperty(e,"__esModule",{value:!0}),e.mangleRtpParameters=e.getCapabilities=void 0;var a=r(bo());e.getCapabilities=function(){var e,t=RTCRtpReceiver.getCapabilities(),n=a.clone(t,{}),r=kr(n.codecs);try{for(r.s();!(e=r.n()).done;){var i=e.value;if(i.channels=i.numChannels,delete i.numChannels,i.mimeType=i.mimeType||"".concat(i.kind,"/").concat(i.name),i.parameters){var s=i.parameters;s.apt&&(s.apt=Number(s.apt)),s["packetization-mode"]&&(s["packetization-mode"]=Number(s["packetization-mode"]))}var o,c=kr(i.rtcpFeedback||[]);try{for(c.s();!(o=c.n()).done;){var u=o.value;u.parameter||(u.parameter="")}}catch(l){c.e(l)}finally{c.f()}}}catch(l){r.e(l)}finally{r.f()}return n},e.mangleRtpParameters=function(e){var t=a.clone(e,{});t.mid&&(t.muxId=t.mid,delete t.mid);var n,r=kr(t.codecs);try{for(r.s();!(n=r.n()).done;){var i=n.value;i.channels&&(i.numChannels=i.channels,delete i.channels),i.mimeType&&!i.name&&(i.name=i.mimeType.split("/")[1]),delete i.mimeType}}catch(s){r.e(s)}finally{r.f()}return t}}}),Vo=ks({"../../node_modules/mediasoup-client/lib/handlers/Edge11.js":function(e){Rs();var t=e&&e.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var a=Object.getOwnPropertyDescriptor(t,n);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,a)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),n=e&&e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=e&&e.__importStar||function(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var a in e)"default"!==a&&Object.prototype.hasOwnProperty.call(e,a)&&t(r,e,a);return n(r,e),r};Object.defineProperty(e,"__esModule",{value:!0}),e.Edge11=void 0;var a=ho(),i=go(),s=r(bo()),o=r(_o()),c=r(zo()),u=Eo(),l=new a.Logger("Edge11"),d=function(e){mn(n,e);var t=_n(n);function n(){var e;return St(this,n),(e=t.call(this))._rtpSenders=new Map,e._rtpReceivers=new Map,e._nextSendLocalId=0,e._transportReady=!1,e}return Pt(n,[{key:"name",get:function(){return"Edge11"}},{key:"close",value:function(){l.debug("close()");try{this._iceGatherer.close()}catch(s){}try{this._iceTransport.stop()}catch(s){}try{this._dtlsTransport.stop()}catch(s){}var e,t=kr(this._rtpSenders.values());try{for(t.s();!(e=t.n()).done;){var n=e.value;try{n.stop()}catch(s){}}}catch(o){t.e(o)}finally{t.f()}var r,a=kr(this._rtpReceivers.values());try{for(a.s();!(r=a.n()).done;){var i=r.value;try{i.stop()}catch(s){}}}catch(o){a.e(o)}finally{a.f()}}},{key:"getNativeRtpCapabilities",value:function(){return Ss(this,null,wr().mark((function e(){return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l.debug("getNativeRtpCapabilities()"),e.abrupt("return",c.getCapabilities());case 2:case"end":return e.stop()}}),e)})))}},{key:"getNativeSctpCapabilities",value:function(){return Ss(this,null,wr().mark((function e(){return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l.debug("getNativeSctpCapabilities()"),e.abrupt("return",{numStreams:{OS:0,MIS:0}});case 2:case"end":return e.stop()}}),e)})))}},{key:"run",value:function(e){e.direction;var t=e.iceParameters,n=e.iceCandidates,r=e.dtlsParameters,a=(e.sctpParameters,e.iceServers),i=e.iceTransportPolicy,c=(e.additionalSettings,e.proprietaryConstraints,e.extendedRtpCapabilities);l.debug("run()"),this._sendingRtpParametersByKind={audio:o.getSendingRtpParameters("audio",c),video:o.getSendingRtpParameters("video",c)},this._remoteIceParameters=t,this._remoteIceCandidates=n,this._remoteDtlsParameters=r,this._cname="CNAME-".concat(s.generateRandomNumber()),this._setIceGatherer({iceServers:a,iceTransportPolicy:i}),this._setIceTransport(),this._setDtlsTransport()}},{key:"updateIceServers",value:function(e){return Ss(this,null,wr().mark((function e(){return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new i.UnsupportedError("not supported");case 1:case"end":return e.stop()}}),e)})))}},{key:"restartIce",value:function(e){return Ss(this,null,wr().mark((function t(){var n,r,a;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(l.debug("restartIce()"),this._remoteIceParameters=e,this._transportReady){t.next=4;break}return t.abrupt("return");case 4:l.debug("restartIce() | calling iceTransport.start()"),this._iceTransport.start(this._iceGatherer,e,"controlling"),n=kr(this._remoteIceCandidates);try{for(n.s();!(r=n.n()).done;)a=r.value,this._iceTransport.addRemoteCandidate(a)}catch(i){n.e(i)}finally{n.f()}this._iceTransport.addRemoteCandidate({});case 9:case"end":return t.stop()}}),t,this)})))}},{key:"getTransportStats",value:function(){return Ss(this,null,wr().mark((function e(){return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._iceTransport.getStats());case 1:case"end":return e.stop()}}),e,this)})))}},{key:"send",value:function(e){return Ss(this,arguments,wr().mark((function e(t){var n,r,a,i,u,d,p,f,h,m,v;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.track,r=t.encodings,t.codecOptions,a=t.codec,l.debug("send() [kind:%s, track.id:%s]",n.kind,n.id),this._transportReady){e.next=5;break}return e.next=5,this._setupTransport({localDtlsRole:"server"});case 5:l.debug("send() | calling new RTCRtpSender()"),i=new RTCRtpSender(n,this._dtlsTransport),(u=s.clone(this._sendingRtpParametersByKind[n.kind],{})).codecs=o.reduceCodecs(u.codecs,a),d=u.codecs.some((function(e){return/.+\/rtx$/i.test(e.mimeType)})),r||(r=[{}]),p=kr(r);try{for(p.s();!(f=p.n()).done;)(h=f.value).ssrc=s.generateRandomNumber(),d&&(h.rtx={ssrc:s.generateRandomNumber()})}catch(g){p.e(g)}finally{p.f()}return u.encodings=r,u.rtcp={cname:this._cname,reducedSize:!0,mux:!0},m=c.mangleRtpParameters(u),l.debug("send() | calling rtpSender.send() [params:%o]",m),e.next=19,i.send(m);case 19:return v=String(this._nextSendLocalId),this._nextSendLocalId++,this._rtpSenders.set(v,i),e.abrupt("return",{localId:v,rtpParameters:u,rtpSender:i});case 23:case"end":return e.stop()}}),e,this)})))}},{key:"stopSending",value:function(e){return Ss(this,null,wr().mark((function t(){var n;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(l.debug("stopSending() [localId:%s]",e),n=this._rtpSenders.get(e)){t.next=4;break}throw new Error("RTCRtpSender not found");case 4:this._rtpSenders.delete(e),t.prev=5,l.debug("stopSending() | calling rtpSender.stop()"),n.stop(),t.next=14;break;case 10:throw t.prev=10,t.t0=t.catch(5),l.warn("stopSending() | rtpSender.stop() failed:%o",t.t0),t.t0;case 14:case"end":return t.stop()}}),t,this,[[5,10]])})))}},{key:"replaceTrack",value:function(e,t){return Ss(this,null,wr().mark((function n(){var r;return wr().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(t?l.debug("replaceTrack() [localId:%s, track.id:%s]",e,t.id):l.debug("replaceTrack() [localId:%s, no track]",e),r=this._rtpSenders.get(e)){n.next=4;break}throw new Error("RTCRtpSender not found");case 4:r.setTrack(t);case 5:case"end":return n.stop()}}),n,this)})))}},{key:"setMaxSpatialLayer",value:function(e,t){return Ss(this,null,wr().mark((function n(){var r,a;return wr().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(l.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",e,t),r=this._rtpSenders.get(e)){n.next=4;break}throw new Error("RTCRtpSender not found");case 4:return(a=r.getParameters()).encodings.forEach((function(e,n){e.active=n<=t})),n.next=8,r.setParameters(a);case 8:case"end":return n.stop()}}),n,this)})))}},{key:"setRtpEncodingParameters",value:function(e,t){return Ss(this,null,wr().mark((function n(){var r,a;return wr().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(l.debug("setRtpEncodingParameters() [localId:%s, params:%o]",e,t),r=this._rtpSenders.get(e)){n.next=4;break}throw new Error("RTCRtpSender not found");case 4:return(a=r.getParameters()).encodings.forEach((function(e,n){a.encodings[n]=_s(_s({},e),t)})),n.next=8,r.setParameters(a);case 8:case"end":return n.stop()}}),n,this)})))}},{key:"getSenderStats",value:function(e){return Ss(this,null,wr().mark((function t(){var n;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=this._rtpSenders.get(e)){t.next=3;break}throw new Error("RTCRtpSender not found");case 3:return t.abrupt("return",n.getStats());case 4:case"end":return t.stop()}}),t,this)})))}},{key:"sendDataChannel",value:function(e){return Ss(this,null,wr().mark((function e(){return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new i.UnsupportedError("not implemented");case 1:case"end":return e.stop()}}),e)})))}},{key:"receive",value:function(e){return Ss(this,null,wr().mark((function t(){var n,r,a,i,s,o,u,d,p,f,h,m,v,g,b;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=[],r=kr(e);try{for(r.s();!(a=r.n()).done;)i=a.value,s=i.trackId,o=i.kind,l.debug("receive() [trackId:%s, kind:%s]",s,o)}catch(y){r.e(y)}finally{r.f()}if(this._transportReady){t.next=6;break}return t.next=6,this._setupTransport({localDtlsRole:"server"});case 6:u=kr(e),t.prev=7,u.s();case 9:if((d=u.n()).done){t.next=24;break}return p=d.value,f=p.trackId,h=p.kind,m=p.rtpParameters,l.debug("receive() | calling new RTCRtpReceiver()"),(v=new RTCRtpReceiver(this._dtlsTransport,h)).addEventListener("error",(function(e){l.error('rtpReceiver "error" event [event:%o]',e)})),g=c.mangleRtpParameters(m),l.debug("receive() | calling rtpReceiver.receive() [params:%o]",g),t.next=19,v.receive(g);case 19:b=f,this._rtpReceivers.set(b,v),n.push({localId:b,track:v.track,rtpReceiver:v});case 22:t.next=9;break;case 24:t.next=29;break;case 26:t.prev=26,t.t0=t.catch(7),u.e(t.t0);case 29:return t.prev=29,u.f(),t.finish(29);case 32:return t.abrupt("return",n);case 33:case"end":return t.stop()}}),t,this,[[7,26,29,32]])})))}},{key:"stopReceiving",value:function(e){return Ss(this,null,wr().mark((function t(){var n;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(l.debug("stopReceiving() [localId:%s]",e),n=this._rtpReceivers.get(e)){t.next=4;break}throw new Error("RTCRtpReceiver not found");case 4:this._rtpReceivers.delete(e);try{l.debug("stopReceiving() | calling rtpReceiver.stop()"),n.stop()}catch(r){l.warn("stopReceiving() | rtpReceiver.stop() failed:%o",r)}case 6:case"end":return t.stop()}}),t,this)})))}},{key:"pauseReceiving",value:function(e){return Ss(this,null,wr().mark((function e(){return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})))}},{key:"resumeReceiving",value:function(e){return Ss(this,null,wr().mark((function e(){return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})))}},{key:"getReceiverStats",value:function(e){return Ss(this,null,wr().mark((function t(){var n;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=this._rtpReceivers.get(e)){t.next=3;break}throw new Error("RTCRtpReceiver not found");case 3:return t.abrupt("return",n.getStats());case 4:case"end":return t.stop()}}),t,this)})))}},{key:"receiveDataChannel",value:function(e){return Ss(this,null,wr().mark((function e(){return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new i.UnsupportedError("not implemented");case 1:case"end":return e.stop()}}),e)})))}},{key:"_setIceGatherer",value:function(e){var t=e.iceServers,n=e.iceTransportPolicy,r=new RTCIceGatherer({iceServers:t||[],gatherPolicy:n||"all"});r.addEventListener("error",(function(e){l.error('iceGatherer "error" event [event:%o]',e)}));try{r.gather()}catch(a){l.debug("_setIceGatherer() | iceGatherer.gather() failed: %s",a.toString())}this._iceGatherer=r}},{key:"_setIceTransport",value:function(){var e=this,t=new RTCIceTransport(this._iceGatherer);t.addEventListener("statechange",(function(){switch(t.state){case"checking":e.emit("@connectionstatechange","connecting");break;case"connected":case"completed":e.emit("@connectionstatechange","connected");break;case"failed":e.emit("@connectionstatechange","failed");break;case"disconnected":e.emit("@connectionstatechange","disconnected");break;case"closed":e.emit("@connectionstatechange","closed")}})),t.addEventListener("icestatechange",(function(){switch(t.state){case"checking":e.emit("@connectionstatechange","connecting");break;case"connected":case"completed":e.emit("@connectionstatechange","connected");break;case"failed":e.emit("@connectionstatechange","failed");break;case"disconnected":e.emit("@connectionstatechange","disconnected");break;case"closed":e.emit("@connectionstatechange","closed")}})),t.addEventListener("candidatepairchange",(function(e){l.debug('iceTransport "candidatepairchange" event [pair:%o]',e.pair)})),this._iceTransport=t}},{key:"_setDtlsTransport",value:function(){var e=this,t=new RTCDtlsTransport(this._iceTransport);t.addEventListener("statechange",(function(){l.debug('dtlsTransport "statechange" event [state:%s]',t.state)})),t.addEventListener("dtlsstatechange",(function(){l.debug('dtlsTransport "dtlsstatechange" event [state:%s]',t.state),"closed"===t.state&&e.emit("@connectionstatechange","closed")})),t.addEventListener("error",(function(e){l.error('dtlsTransport "error" event [event:%o]',e)})),this._dtlsTransport=t}},{key:"_setupTransport",value:function(e){return Ss(this,arguments,wr().mark((function e(t){var n,r,a,i,s;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.localDtlsRole,l.debug("_setupTransport()"),(r=this._dtlsTransport.getLocalParameters()).role=n,e.next=6,this.safeEmitAsPromise("@connect",{dtlsParameters:r});case 6:this._iceTransport.start(this._iceGatherer,this._remoteIceParameters,"controlling"),a=kr(this._remoteIceCandidates);try{for(a.s();!(i=a.n()).done;)s=i.value,this._iceTransport.addRemoteCandidate(s)}catch(o){a.e(o)}finally{a.f()}this._iceTransport.addRemoteCandidate({}),this._remoteDtlsParameters.fingerprints=this._remoteDtlsParameters.fingerprints.filter((function(e){return"sha-256"===e.algorithm||"sha-384"===e.algorithm||"sha-512"===e.algorithm})),this._dtlsTransport.start(this._remoteDtlsParameters),this._transportReady=!0;case 13:case"end":return e.stop()}}),e,this)})))}}],[{key:"createFactory",value:function(){return function(){return new n}}}]),n}(u.HandlerInterface);e.Edge11=d}}),Ho=ks({"../../node_modules/mediasoup-client/lib/handlers/ReactNative.js":function(e){Rs();var t=e&&e.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var a=Object.getOwnPropertyDescriptor(t,n);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,a)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),n=e&&e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=e&&e.__importStar||function(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var a in e)"default"!==a&&Object.prototype.hasOwnProperty.call(e,a)&&t(r,e,a);return n(r,e),r};Object.defineProperty(e,"__esModule",{value:!0}),e.ReactNative=void 0;var a=r(co()),i=ho(),s=go(),o=r(bo()),c=r(_o()),u=r(Co()),l=r(Lo()),d=Eo(),p=Mo(),f=new i.Logger("ReactNative"),h={OS:1024,MIS:1024},m=function(e){mn(n,e);var t=_n(n);function n(){var e;return St(this,n),(e=t.call(this))._sendStream=new MediaStream,e._mapSendLocalIdTrack=new Map,e._nextSendLocalId=0,e._mapRecvLocalIdInfo=new Map,e._hasDataChannelMediaSection=!1,e._nextSendSctpStreamId=0,e._transportReady=!1,e}return Pt(n,[{key:"name",get:function(){return"ReactNative"}},{key:"close",value:function(){if(f.debug("close()"),this._sendStream.release(!1),this._pc)try{this._pc.close()}catch(e){}}},{key:"getNativeRtpCapabilities",value:function(){return Ss(this,null,wr().mark((function e(){var t,n,r,i;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return f.debug("getNativeRtpCapabilities()"),t=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"plan-b"}),e.prev=2,e.next=5,t.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0});case 5:n=e.sent;try{t.close()}catch(s){}return r=a.parse(n.sdp),i=u.extractRtpCapabilities({sdpObject:r}),e.abrupt("return",i);case 12:e.prev=12,e.t0=e.catch(2);try{t.close()}catch(o){}throw e.t0;case 16:case"end":return e.stop()}}),e,null,[[2,12]])})))}},{key:"getNativeSctpCapabilities",value:function(){return Ss(this,null,wr().mark((function e(){return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return f.debug("getNativeSctpCapabilities()"),e.abrupt("return",{numStreams:h});case 2:case"end":return e.stop()}}),e)})))}},{key:"run",value:function(e){var t=this,n=e.direction,r=e.iceParameters,a=e.iceCandidates,i=e.dtlsParameters,s=e.sctpParameters,o=e.iceServers,u=e.iceTransportPolicy,l=e.additionalSettings,d=e.proprietaryConstraints,h=e.extendedRtpCapabilities;f.debug("run()"),this._direction=n,this._remoteSdp=new p.RemoteSdp({iceParameters:r,iceCandidates:a,dtlsParameters:i,sctpParameters:s,planB:!0}),this._sendingRtpParametersByKind={audio:c.getSendingRtpParameters("audio",h),video:c.getSendingRtpParameters("video",h)},this._sendingRemoteRtpParametersByKind={audio:c.getSendingRemoteRtpParameters("audio",h),video:c.getSendingRemoteRtpParameters("video",h)},i.role&&"auto"!==i.role&&(this._forcedLocalDtlsRole="server"===i.role?"client":"server"),this._pc=new RTCPeerConnection(_s({iceServers:o||[],iceTransportPolicy:u||"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"plan-b"},l),d),this._pc.addEventListener("iceconnectionstatechange",(function(){switch(t._pc.iceConnectionState){case"checking":t.emit("@connectionstatechange","connecting");break;case"connected":case"completed":t.emit("@connectionstatechange","connected");break;case"failed":t.emit("@connectionstatechange","failed");break;case"disconnected":t.emit("@connectionstatechange","disconnected");break;case"closed":t.emit("@connectionstatechange","closed")}}))}},{key:"updateIceServers",value:function(e){return Ss(this,null,wr().mark((function t(){var n;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:f.debug("updateIceServers()"),(n=this._pc.getConfiguration()).iceServers=e,this._pc.setConfiguration(n);case 4:case"end":return t.stop()}}),t,this)})))}},{key:"restartIce",value:function(e){return Ss(this,null,wr().mark((function t(){var n,r,a,i;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(f.debug("restartIce()"),this._remoteSdp.updateIceParameters(e),this._transportReady){t.next=4;break}return t.abrupt("return");case 4:if("send"!==this._direction){t.next=17;break}return t.next=7,this._pc.createOffer({iceRestart:!0});case 7:return n=t.sent,f.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",n),t.next=11,this._pc.setLocalDescription(n);case 11:return r={type:"answer",sdp:this._remoteSdp.getSdp()},f.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",r),t.next=15,this._pc.setRemoteDescription(r);case 15:t.next=27;break;case 17:return a={type:"offer",sdp:this._remoteSdp.getSdp()},f.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",a),t.next=21,this._pc.setRemoteDescription(a);case 21:return t.next=23,this._pc.createAnswer();case 23:return i=t.sent,f.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",i),t.next=27,this._pc.setLocalDescription(i);case 27:case"end":return t.stop()}}),t,this)})))}},{key:"getTransportStats",value:function(){return Ss(this,null,wr().mark((function e(){return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._pc.getStats());case 1:case"end":return e.stop()}}),e,this)})))}},{key:"send",value:function(e){return Ss(this,arguments,wr().mark((function e(t){var n,r,i,s,d,p,h,m,v,g,b,y,_,w,k;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.track,r=t.encodings,i=t.codecOptions,s=t.codec,this._assertSendDirection(),f.debug("send() [kind:%s, track.id:%s]",n.kind,n.id),s&&f.warn("send() | codec selection is not available in %s handler",this.name),this._sendStream.addTrack(n),this._pc.addStream(this._sendStream),e.next=8,this._pc.createOffer();case 8:if(p=e.sent,h=a.parse(p.sdp),(v=o.clone(this._sendingRtpParametersByKind[n.kind],{})).codecs=c.reduceCodecs(v.codecs),(g=o.clone(this._sendingRemoteRtpParametersByKind[n.kind],{})).codecs=c.reduceCodecs(g.codecs),this._transportReady){e.next=17;break}return e.next=17,this._setupTransport({localDtlsRole:null!==(d=this._forcedLocalDtlsRole)&&void 0!==d?d:"client",localSdpObject:h});case 17:return"video"===n.kind&&r&&r.length>1&&(f.debug("send() | enabling simulcast"),h=a.parse(p.sdp),m=h.media.find((function(e){return"video"===e.type})),l.addLegacySimulcast({offerMediaObject:m,track:n,numStreams:r.length}),p={type:"offer",sdp:a.write(h)}),f.debug("send() | calling pc.setLocalDescription() [offer:%o]",p),e.next=21,this._pc.setLocalDescription(p);case 21:if(h=a.parse(this._pc.localDescription.sdp),m=h.media.find((function(e){return e.type===n.kind})),v.rtcp.cname=u.getCname({offerMediaObject:m}),v.encodings=l.getRtpEncodings({offerMediaObject:m,track:n}),r)for(b=0;b<v.encodings.length;++b)r[b]&&Object.assign(v.encodings[b],r[b]);if(v.encodings.length>1&&("video/vp8"===v.codecs[0].mimeType.toLowerCase()||"video/h264"===v.codecs[0].mimeType.toLowerCase())){y=kr(v.encodings);try{for(y.s();!(_=y.n()).done;)_.value.scalabilityMode="S1T3"}catch(x){y.e(x)}finally{y.f()}}return this._remoteSdp.send({offerMediaObject:m,offerRtpParameters:v,answerRtpParameters:g,codecOptions:i}),w={type:"answer",sdp:this._remoteSdp.getSdp()},f.debug("send() | calling pc.setRemoteDescription() [answer:%o]",w),e.next=32,this._pc.setRemoteDescription(w);case 32:return k=String(this._nextSendLocalId),this._nextSendLocalId++,this._mapSendLocalIdTrack.set(k,n),e.abrupt("return",{localId:k,rtpParameters:v});case 36:case"end":return e.stop()}}),e,this)})))}},{key:"stopSending",value:function(e){return Ss(this,null,wr().mark((function t(){var n,r,a;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._assertSendDirection(),f.debug("stopSending() [localId:%s]",e),n=this._mapSendLocalIdTrack.get(e)){t.next=5;break}throw new Error("track not found");case 5:return this._mapSendLocalIdTrack.delete(e),this._sendStream.removeTrack(n),this._pc.addStream(this._sendStream),t.next=10,this._pc.createOffer();case 10:return r=t.sent,f.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",r),t.prev=12,t.next=15,this._pc.setLocalDescription(r);case 15:t.next=23;break;case 17:if(t.prev=17,t.t0=t.catch(12),0!==this._sendStream.getTracks().length){t.next=22;break}return f.warn("stopSending() | ignoring expected error due no sending tracks: %s",t.t0.toString()),t.abrupt("return");case 22:throw t.t0;case 23:if("stable"!==this._pc.signalingState){t.next=25;break}return t.abrupt("return");case 25:return a={type:"answer",sdp:this._remoteSdp.getSdp()},f.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",a),t.next=29,this._pc.setRemoteDescription(a);case 29:case"end":return t.stop()}}),t,this,[[12,17]])})))}},{key:"replaceTrack",value:function(e,t){return Ss(this,null,wr().mark((function e(){return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new s.UnsupportedError("not implemented");case 1:case"end":return e.stop()}}),e)})))}},{key:"setMaxSpatialLayer",value:function(e,t){return Ss(this,null,wr().mark((function e(){return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new s.UnsupportedError("not implemented");case 1:case"end":return e.stop()}}),e)})))}},{key:"setRtpEncodingParameters",value:function(e,t){return Ss(this,null,wr().mark((function e(){return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new s.UnsupportedError("not implemented");case 1:case"end":return e.stop()}}),e)})))}},{key:"getSenderStats",value:function(e){return Ss(this,null,wr().mark((function e(){return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new s.UnsupportedError("not implemented");case 1:case"end":return e.stop()}}),e)})))}},{key:"sendDataChannel",value:function(e){return Ss(this,arguments,wr().mark((function e(t){var n,r,i,s,o,c,u,l,d,p,m,v,g;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.ordered,r=t.maxPacketLifeTime,i=t.maxRetransmits,s=t.label,o=t.protocol,this._assertSendDirection(),u={negotiated:!0,id:this._nextSendSctpStreamId,ordered:n,maxPacketLifeTime:r,maxRetransmitTime:r,maxRetransmits:i,protocol:o},f.debug("sendDataChannel() [options:%o]",u),l=this._pc.createDataChannel(s,u),this._nextSendSctpStreamId=++this._nextSendSctpStreamId%h.MIS,this._hasDataChannelMediaSection){e.next=24;break}return e.next=9,this._pc.createOffer();case 9:if(d=e.sent,p=a.parse(d.sdp),m=p.media.find((function(e){return"application"===e.type})),this._transportReady){e.next=15;break}return e.next=15,this._setupTransport({localDtlsRole:null!==(c=this._forcedLocalDtlsRole)&&void 0!==c?c:"client",localSdpObject:p});case 15:return f.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",d),e.next=18,this._pc.setLocalDescription(d);case 18:return this._remoteSdp.sendSctpAssociation({offerMediaObject:m}),v={type:"answer",sdp:this._remoteSdp.getSdp()},f.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",v),e.next=23,this._pc.setRemoteDescription(v);case 23:this._hasDataChannelMediaSection=!0;case 24:return g={streamId:u.id,ordered:u.ordered,maxPacketLifeTime:u.maxPacketLifeTime,maxRetransmits:u.maxRetransmits},e.abrupt("return",{dataChannel:l,sctpStreamParameters:g});case 26:case"end":return e.stop()}}),e,this)})))}},{key:"receive",value:function(e){return Ss(this,null,wr().mark((function t(){var n,r,i,s,c,l,d,p,h,m,v,g,b,y,_,w,k,x,S,R,P=this;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this._assertRecvDirection(),r=[],i=new Map,s=kr(e);try{for(s.s();!(c=s.n()).done;)l=c.value,d=l.trackId,p=l.kind,h=l.rtpParameters,f.debug("receive() [trackId:%s, kind:%s]",d,p),m=p,v=h.rtcp.cname,f.debug("receive() | forcing a random remote streamId to avoid well known bug in react-native-webrtc"),v+="-hack-".concat(o.generateRandomNumber()),i.set(d,v),this._remoteSdp.receive({mid:m,kind:p,offerRtpParameters:h,streamId:v,trackId:d})}catch(C){s.e(C)}finally{s.f()}return g={type:"offer",sdp:this._remoteSdp.getSdp()},f.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",g),t.next=9,this._pc.setRemoteDescription(g);case 9:return t.next=11,this._pc.createAnswer();case 11:b=t.sent,y=a.parse(b.sdp),_=kr(e);try{for(k=function(){var e=w.value,t=e.kind,n=e.rtpParameters,r=t,a=y.media.find((function(e){return String(e.mid)===r}));u.applyCodecParameters({offerRtpParameters:n,answerMediaObject:a})},_.s();!(w=_.n()).done;)k()}catch(C){_.e(C)}finally{_.f()}if(b={type:"answer",sdp:a.write(y)},this._transportReady){t.next=19;break}return t.next=19,this._setupTransport({localDtlsRole:null!==(n=this._forcedLocalDtlsRole)&&void 0!==n?n:"client",localSdpObject:y});case 19:return f.debug("receive() | calling pc.setLocalDescription() [answer:%o]",b),t.next=22,this._pc.setLocalDescription(b);case 22:x=kr(e);try{for(R=function(){var e=S.value,t=e.kind,n=e.trackId,a=e.rtpParameters,s=n,o=t,c=i.get(n),u=P._pc.getRemoteStreams().find((function(e){return e.id===c})).getTrackById(s);if(!u)throw new Error("remote track not found");P._mapRecvLocalIdInfo.set(s,{mid:o,rtpParameters:a}),r.push({localId:s,track:u})},x.s();!(S=x.n()).done;)R()}catch(C){x.e(C)}finally{x.f()}return t.abrupt("return",r);case 25:case"end":return t.stop()}}),t,this)})))}},{key:"stopReceiving",value:function(e){return Ss(this,null,wr().mark((function t(){var n,r,a,i,s;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this._assertRecvDirection(),f.debug("stopReceiving() [localId:%s]",e),n=this._mapRecvLocalIdInfo.get(e)||{},r=n.mid,a=n.rtpParameters,this._mapRecvLocalIdInfo.delete(e),this._remoteSdp.planBStopReceiving({mid:r,offerRtpParameters:a}),i={type:"offer",sdp:this._remoteSdp.getSdp()},f.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",i),t.next=9,this._pc.setRemoteDescription(i);case 9:return t.next=11,this._pc.createAnswer();case 11:return s=t.sent,f.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",s),t.next=15,this._pc.setLocalDescription(s);case 15:case"end":return t.stop()}}),t,this)})))}},{key:"pauseReceiving",value:function(e){return Ss(this,null,wr().mark((function e(){return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})))}},{key:"resumeReceiving",value:function(e){return Ss(this,null,wr().mark((function e(){return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})))}},{key:"getReceiverStats",value:function(e){return Ss(this,null,wr().mark((function e(){return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new s.UnsupportedError("not implemented");case 1:case"end":return e.stop()}}),e)})))}},{key:"receiveDataChannel",value:function(e){return Ss(this,arguments,wr().mark((function e(t){var n,r,i,s,o,c,u,l,d,p,h,m,v;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.sctpStreamParameters,r=t.label,i=t.protocol,this._assertRecvDirection(),o=n.streamId,c=n.ordered,u=n.maxPacketLifeTime,l=n.maxRetransmits,d={negotiated:!0,id:o,ordered:c,maxPacketLifeTime:u,maxRetransmitTime:u,maxRetransmits:l,protocol:i},f.debug("receiveDataChannel() [options:%o]",d),p=this._pc.createDataChannel(r,d),this._hasDataChannelMediaSection){e.next=23;break}return this._remoteSdp.receiveSctpAssociation({oldDataChannelSpec:!0}),h={type:"offer",sdp:this._remoteSdp.getSdp()},f.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",h),e.next=12,this._pc.setRemoteDescription(h);case 12:return e.next=14,this._pc.createAnswer();case 14:if(m=e.sent,this._transportReady){e.next=19;break}return v=a.parse(m.sdp),e.next=19,this._setupTransport({localDtlsRole:null!==(s=this._forcedLocalDtlsRole)&&void 0!==s?s:"client",localSdpObject:v});case 19:return f.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",m),e.next=22,this._pc.setLocalDescription(m);case 22:this._hasDataChannelMediaSection=!0;case 23:return e.abrupt("return",{dataChannel:p});case 24:case"end":return e.stop()}}),e,this)})))}},{key:"_setupTransport",value:function(e){return Ss(this,arguments,wr().mark((function e(t){var n,r,i;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.localDtlsRole,(r=t.localSdpObject)||(r=a.parse(this._pc.localDescription.sdp)),(i=u.extractDtlsParameters({sdpObject:r})).role=n,this._remoteSdp.updateDtlsRole("client"===n?"server":"client"),e.next=7,this.safeEmitAsPromise("@connect",{dtlsParameters:i});case 7:this._transportReady=!0;case 8:case"end":return e.stop()}}),e,this)})))}},{key:"_assertSendDirection",value:function(){if("send"!==this._direction)throw new Error('method can just be called for handlers with "send" direction')}},{key:"_assertRecvDirection",value:function(){if("recv"!==this._direction)throw new Error('method can just be called for handlers with "recv" direction')}}],[{key:"createFactory",value:function(){return function(){return new n}}}]),n}(d.HandlerInterface);e.ReactNative=m}}),Wo=ks({"../../node_modules/mediasoup-client/lib/Device.js":function(e){Rs();var t=e&&e.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var a=Object.getOwnPropertyDescriptor(t,n);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,a)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),n=e&&e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=e&&e.__importStar||function(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var a in e)"default"!==a&&Object.prototype.hasOwnProperty.call(e,a)&&t(r,e,a);return n(r,e),r},a=e&&e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(e,"__esModule",{value:!0}),e.Device=e.detectDevice=void 0;var i=a(fo()),s=ho(),o=vo(),c=go(),u=r(bo()),l=r(_o()),d=Po(),p=Do(),f=jo(),h=Ao(),m=Fo(),v=No(),g=Bo(),b=Uo(),y=Vo(),_=Ho(),w=new s.Logger("Device");function k(){if("object"===typeof navigator&&"ReactNative"===navigator.product)return"undefined"===typeof RTCPeerConnection?void w.warn("this._detectDevice() | unsupported ReactNative without RTCPeerConnection"):(w.debug("this._detectDevice() | ReactNative handler chosen"),"ReactNative");if("object"!==typeof navigator||"string"!==typeof navigator.userAgent)w.warn("this._detectDevice() | unknown device");else{var e=navigator.userAgent,t=i.default.getParser(e),n=t.getEngine();if(t.satisfies({chrome:">=74",chromium:">=74","microsoft edge":">=88"}))return"Chrome74";if(t.satisfies({chrome:">=70",chromium:">=70"}))return"Chrome70";if(t.satisfies({chrome:">=67",chromium:">=67"}))return"Chrome67";if(t.satisfies({chrome:">=55",chromium:">=55"}))return"Chrome55";if(t.satisfies({firefox:">=60"}))return"Firefox60";if(t.satisfies({ios:{OS:">=14.3",firefox:">=30.0"}}))return"Safari12";if(t.satisfies({safari:">=12.0"})&&"undefined"!==typeof RTCRtpTransceiver&&RTCRtpTransceiver.prototype.hasOwnProperty("currentDirection"))return"Safari12";if(t.satisfies({safari:">=11"}))return"Safari11";if(t.satisfies({"microsoft edge":">=11"})&&t.satisfies({"microsoft edge":"<=18"}))return"Edge11";if(n.name&&"blink"===n.name.toLowerCase()){var r=e.match(/(?:(?:Chrome|Chromium))[ /](\w+)/i);if(r){var a=Number(r[1]);return a>=74?"Chrome74":a>=70?"Chrome70":a>=67?"Chrome67":"Chrome55"}return"Chrome74"}w.warn("this._detectDevice() | browser not supported [name:%s, version:%s]",t.getBrowserName(),t.getBrowserVersion())}}e.detectDevice=k;var x=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.handlerName,r=t.handlerFactory,a=t.Handler;if(St(this,e),this._loaded=!1,this._observer=new o.EnhancedEventEmitter,w.debug("constructor()"),a){if(w.warn("constructor() | Handler option is DEPRECATED, use handlerName or handlerFactory instead"),"string"!==typeof a)throw new TypeError("non string Handler option no longer supported, use handlerFactory instead");n=a}if(n&&r)throw new TypeError("just one of handlerName or handlerInterface can be given");if(r)this._handlerFactory=r;else{if(n)w.debug("constructor() | handler given: %s",n);else{if(!(n=k()))throw new c.UnsupportedError("device not supported");w.debug("constructor() | detected handler: %s",n)}switch(n){case"Chrome74":this._handlerFactory=p.Chrome74.createFactory();break;case"Chrome70":this._handlerFactory=f.Chrome70.createFactory();break;case"Chrome67":this._handlerFactory=h.Chrome67.createFactory();break;case"Chrome55":this._handlerFactory=m.Chrome55.createFactory();break;case"Firefox60":this._handlerFactory=v.Firefox60.createFactory();break;case"Safari12":this._handlerFactory=g.Safari12.createFactory();break;case"Safari11":this._handlerFactory=b.Safari11.createFactory();break;case"Edge11":this._handlerFactory=y.Edge11.createFactory();break;case"ReactNative":this._handlerFactory=_.ReactNative.createFactory();break;default:throw new TypeError('unknown handlerName "'.concat(n,'"'))}}var i=this._handlerFactory();this._handlerName=i.name,i.close(),this._extendedRtpCapabilities=void 0,this._recvRtpCapabilities=void 0,this._canProduceByKind={audio:!1,video:!1},this._sctpCapabilities=void 0}return Pt(e,[{key:"handlerName",get:function(){return this._handlerName}},{key:"loaded",get:function(){return this._loaded}},{key:"rtpCapabilities",get:function(){if(!this._loaded)throw new c.InvalidStateError("not loaded");return this._recvRtpCapabilities}},{key:"sctpCapabilities",get:function(){if(!this._loaded)throw new c.InvalidStateError("not loaded");return this._sctpCapabilities}},{key:"observer",get:function(){return this._observer}},{key:"load",value:function(e){return Ss(this,arguments,wr().mark((function e(t){var n,r,a;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.routerRtpCapabilities,w.debug("load() [routerRtpCapabilities:%o]",n),n=u.clone(n,void 0),e.prev=3,!this._loaded){e.next=6;break}throw new c.InvalidStateError("already loaded");case 6:return l.validateRtpCapabilities(n),r=this._handlerFactory(),e.next=10,r.getNativeRtpCapabilities();case 10:return a=e.sent,w.debug("load() | got native RTP capabilities:%o",a),l.validateRtpCapabilities(a),this._extendedRtpCapabilities=l.getExtendedRtpCapabilities(a,n),w.debug("load() | got extended RTP capabilities:%o",this._extendedRtpCapabilities),this._canProduceByKind.audio=l.canSend("audio",this._extendedRtpCapabilities),this._canProduceByKind.video=l.canSend("video",this._extendedRtpCapabilities),this._recvRtpCapabilities=l.getRecvRtpCapabilities(this._extendedRtpCapabilities),l.validateRtpCapabilities(this._recvRtpCapabilities),w.debug("load() | got receiving RTP capabilities:%o",this._recvRtpCapabilities),e.next=22,r.getNativeSctpCapabilities();case 22:this._sctpCapabilities=e.sent,w.debug("load() | got native SCTP capabilities:%o",this._sctpCapabilities),l.validateSctpCapabilities(this._sctpCapabilities),w.debug("load() succeeded"),this._loaded=!0,r.close(),e.next=34;break;case 30:throw e.prev=30,e.t0=e.catch(3),r&&r.close(),e.t0;case 34:case"end":return e.stop()}}),e,this,[[3,30]])})))}},{key:"canProduce",value:function(e){if(!this._loaded)throw new c.InvalidStateError("not loaded");if("audio"!==e&&"video"!==e)throw new TypeError('invalid kind "'.concat(e,'"'));return this._canProduceByKind[e]}},{key:"createSendTransport",value:function(e){var t=e.id,n=e.iceParameters,r=e.iceCandidates,a=e.dtlsParameters,i=e.sctpParameters,s=e.iceServers,o=e.iceTransportPolicy,c=e.additionalSettings,u=e.proprietaryConstraints,l=e.appData;return w.debug("createSendTransport()"),this._createTransport({direction:"send",id:t,iceParameters:n,iceCandidates:r,dtlsParameters:a,sctpParameters:i,iceServers:s,iceTransportPolicy:o,additionalSettings:c,proprietaryConstraints:u,appData:l})}},{key:"createRecvTransport",value:function(e){var t=e.id,n=e.iceParameters,r=e.iceCandidates,a=e.dtlsParameters,i=e.sctpParameters,s=e.iceServers,o=e.iceTransportPolicy,c=e.additionalSettings,u=e.proprietaryConstraints,l=e.appData;return w.debug("createRecvTransport()"),this._createTransport({direction:"recv",id:t,iceParameters:n,iceCandidates:r,dtlsParameters:a,sctpParameters:i,iceServers:s,iceTransportPolicy:o,additionalSettings:c,proprietaryConstraints:u,appData:l})}},{key:"_createTransport",value:function(e){var t=e.direction,n=e.id,r=e.iceParameters,a=e.iceCandidates,i=e.dtlsParameters,s=e.sctpParameters,o=e.iceServers,u=e.iceTransportPolicy,l=e.additionalSettings,p=e.proprietaryConstraints,f=e.appData;if(!this._loaded)throw new c.InvalidStateError("not loaded");if("string"!==typeof n)throw new TypeError("missing id");if("object"!==typeof r)throw new TypeError("missing iceParameters");if(!Array.isArray(a))throw new TypeError("missing iceCandidates");if("object"!==typeof i)throw new TypeError("missing dtlsParameters");if(s&&"object"!==typeof s)throw new TypeError("wrong sctpParameters");if(f&&"object"!==typeof f)throw new TypeError("if given, appData must be an object");var h=new d.Transport({direction:t,id:n,iceParameters:r,iceCandidates:a,dtlsParameters:i,sctpParameters:s,iceServers:o,iceTransportPolicy:u,additionalSettings:l,proprietaryConstraints:p,appData:f,handlerFactory:this._handlerFactory,extendedRtpCapabilities:this._extendedRtpCapabilities,canProduceByKind:this._canProduceByKind});return this._observer.safeEmit("newtransport",h),h}}]),e}();e.Device=x}}),qo=ks({"../../node_modules/mediasoup-client/lib/RtpParameters.js":function(e){Rs(),Object.defineProperty(e,"__esModule",{value:!0})}}),Go=ks({"../../node_modules/mediasoup-client/lib/SctpParameters.js":function(e){Rs(),Object.defineProperty(e,"__esModule",{value:!0})}}),Ko=ks({"../../node_modules/mediasoup-client/lib/types.js":function(e){Rs();var t=e&&e.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var a=Object.getOwnPropertyDescriptor(t,n);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,a)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),n=e&&e.__exportStar||function(e,n){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(n,r)||t(n,e,r)};Object.defineProperty(e,"__esModule",{value:!0}),n(Wo(),e),n(Po(),e),n(ko(),e),n(xo(),e),n(So(),e),n(Ro(),e),n(qo(),e),n(Go(),e),n(Eo(),e),n(go(),e)}}),Xo=ks({"../../node_modules/mediasoup-client/lib/index.js":function(e){Rs();var t=e&&e.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var a=Object.getOwnPropertyDescriptor(t,n);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,a)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),n=e&&e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=e&&e.__importStar||function(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var a in e)"default"!==a&&Object.prototype.hasOwnProperty.call(e,a)&&t(r,e,a);return n(r,e),r},a=e&&e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(e,"__esModule",{value:!0}),e.debug=e.parseScalabilityMode=e.detectDevice=e.Device=e.version=e.types=void 0;var i=a(po());e.debug=i.default;var s=Wo();Object.defineProperty(e,"Device",{enumerable:!0,get:function(){return s.Device}}),Object.defineProperty(e,"detectDevice",{enumerable:!0,get:function(){return s.detectDevice}});var o=r(Ko());e.types=o,e.version="3.6.52";var c=Io();Object.defineProperty(e,"parseScalabilityMode",{enumerable:!0,get:function(){return c.parse}})}}),Qo=ks({"../../node_modules/whatwg-fetch/dist/fetch.umd.js":function(e,t){var n,r;Rs(),n=e,r=function(e){var t="undefined"!==typeof globalThis&&globalThis||"undefined"!==typeof self&&self||"undefined"!==typeof t&&t,n="URLSearchParams"in t,r="Symbol"in t&&"iterator"in Symbol,a="FileReader"in t&&"Blob"in t&&function(){try{return new Blob,!0}catch(e){return!1}}(),i="FormData"in t,s="ArrayBuffer"in t;if(s)var o=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],c=ArrayBuffer.isView||function(e){return e&&o.indexOf(Object.prototype.toString.call(e))>-1};function u(e){if("string"!==typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(e)||""===e)throw new TypeError('Invalid character in header field name: "'+e+'"');return e.toLowerCase()}function l(e){return"string"!==typeof e&&(e=String(e)),e}function d(e){var t={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return r&&(t[Symbol.iterator]=function(){return t}),t}function p(e){this.map={},e instanceof p?e.forEach((function(e,t){this.append(t,e)}),this):Array.isArray(e)?e.forEach((function(e){this.append(e[0],e[1])}),this):e&&Object.getOwnPropertyNames(e).forEach((function(t){this.append(t,e[t])}),this)}function f(e){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}function h(e){return new Promise((function(t,n){e.onload=function(){t(e.result)},e.onerror=function(){n(e.error)}}))}function m(e){var t=new FileReader,n=h(t);return t.readAsArrayBuffer(e),n}function v(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function g(){return this.bodyUsed=!1,this._initBody=function(e){var t;this.bodyUsed=this.bodyUsed,this._bodyInit=e,e?"string"===typeof e?this._bodyText=e:a&&Blob.prototype.isPrototypeOf(e)?this._bodyBlob=e:i&&FormData.prototype.isPrototypeOf(e)?this._bodyFormData=e:n&&URLSearchParams.prototype.isPrototypeOf(e)?this._bodyText=e.toString():s&&a&&(t=e)&&DataView.prototype.isPrototypeOf(t)?(this._bodyArrayBuffer=v(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):s&&(ArrayBuffer.prototype.isPrototypeOf(e)||c(e))?this._bodyArrayBuffer=v(e):this._bodyText=e=Object.prototype.toString.call(e):this._bodyText="",this.headers.get("content-type")||("string"===typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):n&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},a&&(this.blob=function(){var e=f(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){if(this._bodyArrayBuffer){var e=f(this);return e||(ArrayBuffer.isView(this._bodyArrayBuffer)?Promise.resolve(this._bodyArrayBuffer.buffer.slice(this._bodyArrayBuffer.byteOffset,this._bodyArrayBuffer.byteOffset+this._bodyArrayBuffer.byteLength)):Promise.resolve(this._bodyArrayBuffer))}return this.blob().then(m)}),this.text=function(){var e=f(this);if(e)return e;if(this._bodyBlob)return function(e){var t=new FileReader,n=h(t);return t.readAsText(e),n}(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(function(e){for(var t=new Uint8Array(e),n=new Array(t.length),r=0;r<t.length;r++)n[r]=String.fromCharCode(t[r]);return n.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},i&&(this.formData=function(){return this.text().then(_)}),this.json=function(){return this.text().then(JSON.parse)},this}p.prototype.append=function(e,t){e=u(e),t=l(t);var n=this.map[e];this.map[e]=n?n+", "+t:t},p.prototype.delete=function(e){delete this.map[u(e)]},p.prototype.get=function(e){return e=u(e),this.has(e)?this.map[e]:null},p.prototype.has=function(e){return this.map.hasOwnProperty(u(e))},p.prototype.set=function(e,t){this.map[u(e)]=l(t)},p.prototype.forEach=function(e,t){for(var n in this.map)this.map.hasOwnProperty(n)&&e.call(t,this.map[n],n,this)},p.prototype.keys=function(){var e=[];return this.forEach((function(t,n){e.push(n)})),d(e)},p.prototype.values=function(){var e=[];return this.forEach((function(t){e.push(t)})),d(e)},p.prototype.entries=function(){var e=[];return this.forEach((function(t,n){e.push([n,t])})),d(e)},r&&(p.prototype[Symbol.iterator]=p.prototype.entries);var b=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function y(e,t){if(!(this instanceof y))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');var n=(t=t||{}).body;if(e instanceof y){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new p(e.headers)),this.method=e.method,this.mode=e.mode,this.signal=e.signal,n||null==e._bodyInit||(n=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=t.credentials||this.credentials||"same-origin",!t.headers&&this.headers||(this.headers=new p(t.headers)),this.method=function(e){var t=e.toUpperCase();return b.indexOf(t)>-1?t:e}(t.method||this.method||"GET"),this.mode=t.mode||this.mode||null,this.signal=t.signal||this.signal,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&n)throw new TypeError("Body not allowed for GET or HEAD requests");if(this._initBody(n),("GET"===this.method||"HEAD"===this.method)&&("no-store"===t.cache||"no-cache"===t.cache)){var r=/([?&])_=[^&]*/;r.test(this.url)?this.url=this.url.replace(r,"$1_="+(new Date).getTime()):this.url+=(/\?/.test(this.url)?"&":"?")+"_="+(new Date).getTime()}}function _(e){var t=new FormData;return e.trim().split("&").forEach((function(e){if(e){var n=e.split("="),r=n.shift().replace(/\+/g," "),a=n.join("=").replace(/\+/g," ");t.append(decodeURIComponent(r),decodeURIComponent(a))}})),t}function w(e){var t=new p;return e.replace(/\r?\n[\t ]+/g," ").split("\r").map((function(e){return 0===e.indexOf("\n")?e.substr(1,e.length):e})).forEach((function(e){var n=e.split(":"),r=n.shift().trim();if(r){var a=n.join(":").trim();t.append(r,a)}})),t}function k(e,t){if(!(this instanceof k))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');t||(t={}),this.type="default",this.status=void 0===t.status?200:t.status,this.ok=this.status>=200&&this.status<300,this.statusText=void 0===t.statusText?"":""+t.statusText,this.headers=new p(t.headers),this.url=t.url||"",this._initBody(e)}y.prototype.clone=function(){return new y(this,{body:this._bodyInit})},g.call(y.prototype),g.call(k.prototype),k.prototype.clone=function(){return new k(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new p(this.headers),url:this.url})},k.error=function(){var e=new k(null,{status:0,statusText:""});return e.type="error",e};var x=[301,302,303,307,308];k.redirect=function(e,t){if(-1===x.indexOf(t))throw new RangeError("Invalid status code");return new k(null,{status:t,headers:{location:e}})},e.DOMException=t.DOMException;try{new e.DOMException}catch(R){e.DOMException=function(e,t){this.message=e,this.name=t;var n=Error(e);this.stack=n.stack},e.DOMException.prototype=Object.create(Error.prototype),e.DOMException.prototype.constructor=e.DOMException}function S(n,r){return new Promise((function(i,o){var c=new y(n,r);if(c.signal&&c.signal.aborted)return o(new e.DOMException("Aborted","AbortError"));var u=new XMLHttpRequest;function d(){u.abort()}u.onload=function(){var e={status:u.status,statusText:u.statusText,headers:w(u.getAllResponseHeaders()||"")};e.url="responseURL"in u?u.responseURL:e.headers.get("X-Request-URL");var t="response"in u?u.response:u.responseText;setTimeout((function(){i(new k(t,e))}),0)},u.onerror=function(){setTimeout((function(){o(new TypeError("Network request failed"))}),0)},u.ontimeout=function(){setTimeout((function(){o(new TypeError("Network request failed"))}),0)},u.onabort=function(){setTimeout((function(){o(new e.DOMException("Aborted","AbortError"))}),0)},u.open(c.method,function(e){try{return""===e&&t.location.href?t.location.href:e}catch(n){return e}}(c.url),!0),"include"===c.credentials?u.withCredentials=!0:"omit"===c.credentials&&(u.withCredentials=!1),"responseType"in u&&(a?u.responseType="blob":s&&c.headers.get("Content-Type")&&-1!==c.headers.get("Content-Type").indexOf("application/octet-stream")&&(u.responseType="arraybuffer")),!r||"object"!==typeof r.headers||r.headers instanceof p?c.headers.forEach((function(e,t){u.setRequestHeader(t,e)})):Object.getOwnPropertyNames(r.headers).forEach((function(e){u.setRequestHeader(e,l(r.headers[e]))})),c.signal&&(c.signal.addEventListener("abort",d),u.onreadystatechange=function(){4===u.readyState&&c.signal.removeEventListener("abort",d)}),u.send("undefined"===typeof c._bodyInit?null:c._bodyInit)}))}S.polyfill=!0,t.fetch||(t.fetch=S,t.Headers=p,t.Request=y,t.Response=k),e.Headers=p,e.Request=y,e.Response=k,e.fetch=S,Object.defineProperty(e,"__esModule",{value:!0})},"object"===typeof e&&"undefined"!==typeof t?r(e):"function"===typeof define&&define.amd?define(["exports"],r):r(n.WHATWGFetch={})}}),$o=ks({"../../node_modules/isomorphic-fetch/fetch-npm-browserify.js":function(e,t){Rs(),Qo(),t.exports=self.fetch.bind(self)}});Rs(),Rs(),Rs(),Rs(),Rs(),Rs();var Jo=function(){function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){};St(this,e),this._onSetListener=n,this._stack=[],this._eventIndex=0,this.emit=function(e){t._stack.forEach((function(t){return t.execute(e)}))},this.removeAllListeners=function(){t._stack=[]},this.pipe=function(e){return t.add((function(t){return e.emit(t)}))},this.add=function(e){var n=t._eventIndex;t._stack.push({execute:e,id:n}),t._eventIndex++;return t._onSetListener(),{removeListener:function(){t._stack=t._stack.filter((function(e){return e.id!==n&&e}))}}},this.once=function(e){var n=t.add((function(t){n.removeListener(),e(t)}))},this.asPromise=function(e){return new Promise((function(n,r){var a=e&&setTimeout((function(){r("Event asPromise timeout : "+e)}),e);t.once((function(e){a&&clearTimeout(a),n(e)}))}))},this.watch=function(e,n){return new Promise((function(r,a){var i=n&&setTimeout((function(){a("Event watch timeout : "+n)}),n),s=t.add((function(t){e(t)&&(i&&clearTimeout(i),s(),r(t))})).removeListener}))}}return Pt(e,[{key:"length",get:function(){return this._stack.length}}]),e}(),Yo=function(){function e(){St(this,e),this.events=[]}return Pt(e,[{key:"make",value:function(){var e=new Jo;return this.events.push(e),e}},{key:"dispose",value:function(){this.events.forEach((function(e){return e.removeAllListeners()})),this.events=[]}}]),e}(),Zo=["error","warn","debug","disable"],ec=function(){function e(t){St(this,e),this.prefix=t}return Pt(e,[{key:"debug",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._log.apply(this,["debug"].concat(t))}},{key:"warn",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._log.apply(this,["warn"].concat(t))}},{key:"error",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._log.apply(this,["error"].concat(t))}},{key:"_log",value:function(t){for(var n,r,a,i=arguments.length,s=new Array(i>1?i-1:0),o=1;o<i;o++)s[o-1]=arguments[o];var c=Zo.indexOf(t),u=Zo.indexOf(e.level);if(u>=c){var l=new Date(Date.now()+324e5).toISOString()+"+JST";s=[this.prefix].concat(xt(s)).map((function(e){return"object"===typeof e?JSON.parse(JSON.stringify(e)):e}));var d=[l,t].concat(xt(s));switch("string"===e.format&&(d=[l+" "+t+" "+JSON.stringify(s)]),t){case"debug":(n=console).info.apply(n,xt(d));break;case"warn":(r=console).warn.apply(r,xt(d));break;case"error":(a=console).error.apply(a,xt(d))}e.onLog.emit({id:e.id,timestamp:l,level:t,message:s})}}}]),e}(),tc=ec;tc.level="error",tc.format="object",tc.id=Math.random().toString().slice(2,7),tc.onLog=new Jo;var nc=new tc("packages/common/src/error.ts"),rc=function(e){mn(n,e);var t=_n(n);function n(e){var r,a=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return St(this,n),(r=t.call(this,e.message)).id=Math.random().toString().slice(2,10),Object.assign(bn(r),e),r.name=r.type,a&&(r.payload?nc.warn("error detail","id:".concat(r.id,", type:").concat(r.type,", message:").concat(r.message),r.payload):nc.warn("error detail","id:".concat(r.id,", type:").concat(r.type,", message:").concat(r.message))),r}return Pt(n,[{key:"toJSON",value:function(){return{type:this.type,message:this.message,payload:this.payload}}}]),n}(as(Error));Rs();var ac=xs(eo()),ic=new tc("packages/common/src/http.ts"),sc=function(){function e(t){St(this,e),this.api=ac.default.create({baseURL:t})}return Pt(e,[{key:"get",value:function(e,t){return Ss(this,null,wr().mark((function n(){var r,a;return wr().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.api.get(e,t).catch((function(e){return e}));case 2:if(r=n.sent,!ac.default.isAxiosError(r)){n.next=18;break}if(a=ws(_s({},r.response),{message:r.message}),!(null==t?void 0:t.retry)){n.next=14;break}return n.next=8,t.retry(a);case 8:if(!n.sent){n.next=13;break}return n.abrupt("return",this.get(e,t));case 13:throw a;case 14:throw ic.warn("response error",{error:a}),a;case 18:return n.abrupt("return",r.data);case 19:case"end":return n.stop()}}),n,this)})))}},{key:"post",value:function(e,t,n){return Ss(this,null,wr().mark((function r(){var a,i;return wr().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,this.api.post(e,t,n).catch((function(e){return e}));case 2:if(a=r.sent,!ac.default.isAxiosError(a)){r.next=18;break}if(i=ws(_s({},a.response),{message:a.message}),!(null==n?void 0:n.retry)){r.next=14;break}return r.next=8,n.retry(i);case 8:if(!r.sent){r.next=13;break}return r.abrupt("return",this.post(e,t,n));case 13:throw i;case 14:throw ic.warn("response error",{error:i}),i;case 18:return r.abrupt("return",a.data);case 19:case"end":return r.stop()}}),r,this)})))}},{key:"put",value:function(e,t,n){return Ss(this,null,wr().mark((function r(){var a,i;return wr().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,this.api.put(e,t,n).catch((function(e){return e}));case 2:if(a=r.sent,!ac.default.isAxiosError(a)){r.next=18;break}if(i=ws(_s({},a.response),{message:a.message}),!(null==n?void 0:n.retry)){r.next=14;break}return r.next=8,n.retry(i);case 8:if(!r.sent){r.next=13;break}return r.abrupt("return",this.put(e,t,n));case 13:throw i;case 14:throw ic.warn("response error",{error:i}),i;case 18:return r.abrupt("return",a.data);case 19:case"end":return r.stop()}}),r,this)})))}},{key:"delete",value:function(e,t){return Ss(this,null,wr().mark((function n(){var r,a;return wr().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.api.delete(e,t).catch((function(e){return e}));case 2:if(r=n.sent,!ac.default.isAxiosError(r)){n.next=18;break}if(a=ws(_s({},r.response),{message:r.message}),!(null==t?void 0:t.retry)){n.next=14;break}return n.next=8,t.retry(a);case 8:if(!n.sent){n.next=13;break}return n.abrupt("return",this.delete(e,t));case 13:throw a;case 14:throw ic.warn("response error",{error:a}),a;case 18:return n.abrupt("return",r.data);case 19:case"end":return n.stop()}}),n,this)})))}}]),e}();Rs();new tc("packages/common/src/promise.ts");var oc=function(){function e(){var t=this;St(this,e),this.id=Math.random().toString().slice(2),this.queue=[],this.running=!1,this.push=function(e){return new Promise((function(n,r){t.queue.push({promise:e,done:n,failed:r}),t.running||t.run()}))}}return Pt(e,[{key:"run",value:function(){return Ss(this,null,wr().mark((function e(){var t,n;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=this.queue.shift())){e.next=17;break}return this.running=!0,e.prev=3,e.next=6,t.promise();case 6:n=e.sent,t.done(n),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(3),t.failed(e.t0);case 13:return e.next=15,this.run();case 15:e.next=18;break;case 17:this.running=!1;case 18:case"end":return e.stop()}}),e,this,[[3,10]])})))}}]),e}();Rs();Rs(),Rs();var cc=new tc("packages/core/src/publication/index.ts"),uc=function(){function e(t){var n,r,a=this;St(this,e),this._status="created",this.onUnpublished=new Jo,this.onSubscribed=new Jo,this.onUnsubscribed=new Jo,this.onSubscriptionChanged=new Jo,this.onMetadataUpdated=new Jo,this._onEncodingsChanged=new Jo,this.cancel=function(){return new Promise((function(e,t){var n=!1;a._channel._unpublish(a.id).catch((function(e){n=!0,t(e)})),a.stream=void 0,a.onUnpublished.asPromise(a._context.config.rtcApi.timeout).then((function(){return e()})).catch((function(e){n||t(e)}))}))},this.updateMetadata=function(e){return new Promise((function(t,n){var r=!1;a._channel._updatePublicationMetadata(a.id,e).catch((function(e){r=!0,n(e)})),a.onMetadataUpdated.watch((function(t){return t.metadata===e}),a._context.config.rtcApi.timeout).catch((function(e){if(!r)throw new rc({type:"timeout",message:"publication onMetadataUpdated",payload:{error:e}})})).then((function(){return t()}))}))},this.id=t.id,this._channel=t.channel,this._context=this._channel._context,this.publisherId=t.publisherId,this.contentType=t.contentType,this._metadata=t.metadata,this.originId=t.origin,this.codecCapabilities=null!=(n=t.codecCapabilities)?n:[],this.encodings=null!=(r=t.encodings)?r:[],this.stream=t.stream,this._status="published",cc.debug("publication spawned",this.toJSON())}return Pt(e,[{key:"publisher",get:function(){return this._channel._getMember(this.publisherId)}},{key:"origin",get:function(){var e;return this._channel._getPublication(null!=(e=this.originId)?e:"")}},{key:"metadata",get:function(){return this._metadata}},{key:"status",get:function(){return this._status}},{key:"subscriptions",get:function(){var e=this;return this._channel.subscriptions.filter((function(t){return t.publication.id===e.id}))}},{key:"_updateMetadata",value:function(e){this._metadata=e,this.onMetadataUpdated.emit({metadata:e})}},{key:"_unpublished",value:function(){this.onUnpublished.emit(),this._status="canceled"}},{key:"_subscribed",value:function(e){this.onSubscribed.emit({subscription:e}),this.onSubscriptionChanged.emit()}},{key:"_unsubscribed",value:function(e){this.onUnsubscribed.emit({subscription:e}),this.onSubscriptionChanged.emit()}},{key:"updateEncodings",value:function(e){cc.debug("updateEncodings",{encodings:e}),this.encodings=e,this._onEncodingsChanged.emit(e)}},{key:"toJSON",value:function(){var e;return{id:this.id,channelId:this._channel.id,publisherId:this.publisher.id,origin:null==(e=this.origin)?void 0:e.id,contentType:this.contentType,metadata:this.metadata,codecCapabilities:this.codecCapabilities,encodings:this.encodings}}}]),e}();Rs(),Rs();var lc=new tc("packages/core/src/subscription/index.ts"),dc=function(){function e(t){var n=this;St(this,e),this._status="created",this.onCanceled=new Jo,this.onStreamAttached=new Jo,this.cancel=function(){return new Promise((function(e,t){var r=!1;n._channel._unsubscribe(n.id).catch((function(e){r=!0,t(e)})),n.onCanceled.asPromise(n._context.config.rtcApi.timeout).then((function(){return e()})).catch((function(e){r||t(e)}))}))},this._channel=t.channel,this._context=this._channel._context,this.id=t.id,this.contentType=t.contentType,this.subscriberId=t.subscriberId,this.publicationId=t.publicationId,this._status="subscribed",lc.debug("subscription spawned",this.toJSON())}return Pt(e,[{key:"subscriber",get:function(){return this._channel._getMember(this.subscriberId)}},{key:"publication",get:function(){return this._channel._getPublication(this.publicationId)}},{key:"status",get:function(){return this._status}},{key:"stream",get:function(){return this._stream},set:function(e){this._stream=e,e&&this.onStreamAttached.emit()}},{key:"toJSON",value:function(){return{id:this.id,contentType:this.contentType,subscriberId:this.subscriberId,publication:this.publication,channelId:this._channel.id}}},{key:"_canceled",value:function(){this.stream=void 0,this._status="canceled",this.onCanceled.emit()}}]),e}();var pc=new tc("packages/core/src/channel/index.ts"),fc=function(){function e(t,n){var r=this;St(this,e),this._context=t,this._channelImpl=n,this.id=this._channelImpl.id,this.name=this._channelImpl.name,this.appId=this._context.appId,this._status="created",this._api=this._context._api,this.disposed=!1,this._members={},this._getMember=function(e){return r._members[e]},this._persons={},this._getPerson=function(e){return r._persons[e]},this._publications={},this._getPublication=function(e){return r._publications[e]},this._subscriptions={},this._getSubscription=function(e){return r._subscriptions[e]},this._events=new Yo,this.onClosed=this._events.make(),this.onMetadataUpdated=this._events.make(),this.onMembershipChanged=this._events.make(),this.onMemberJoined=this._events.make(),this.onMemberLeft=this._events.make(),this.onMemberMetadataUpdated=this._events.make(),this.onPublicationChanged=this._events.make(),this.onStreamPublished=this._events.make(),this.onStreamUnpublished=this._events.make(),this.onPublicationMetadataUpdated=this._events.make(),this.onSubscriptionChanged=this._events.make(),this.onStreamSubscribed=this._events.make(),this.onStreamUnsubscribed=this._events.make(),this._onDisposed=this._events.make(),this.leave=function(e){return Ss(r,null,wr().mark((function t(){return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this._channelImpl.leave(this.id,e.id));case 1:case"end":return t.stop()}}),t,this)})))},this.updateMetadata=function(e){return r._channelImpl.updateChannelMetadata(e)},this.close=function(){return new Promise((function(e,t){return Ss(r,null,wr().mark((function n(){var r;return wr().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=!1,pc.debug("[start] close channel",{id:this.id}),this._api.deleteChannel(this.id).catch((function(e){r=!0,t(e)})),n.prev=3,n.next=6,this.onClosed.asPromise(this._context.config.rtcApi.timeout);case 6:pc.debug("[end] close channel",{id:this.id}),n.next=12;break;case 9:n.prev=9,n.t0=n.catch(3),r||(pc.error("[failed] close channel",{id:this.id,error:n.t0}),t(n.t0));case 12:this._status="closed",e();case 14:case"end":return n.stop()}}),n,this,[[3,9]])})))}))},this._updateMemberTtl=function(e,t){return r._channelImpl.updateMemberTtl(e,t)},this._updateMemberMetadata=function(e,t){return r._channelImpl.updateMemberMetadata(e,t)},this._publish=function(e){return r._channelImpl.publish(e)},this._unpublish=function(e){return Ss(r,null,wr().mark((function t(){return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this._channelImpl.unpublish(e));case 1:case"end":return t.stop()}}),t,this)})))},this._subscribe=function(e,t){var n=r._getPublication(t),a=r._getMember(e);if(void 0==a)throw new rc({type:"notFound",message:"subscriber not found",payload:{subscriberId:e,publicationId:t}});return r._channelImpl.subscribe({publication:n.toJSON(),subscriber:a.toJSON()})},this._unsubscribe=function(e){return Ss(r,null,wr().mark((function t(){return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._getSubscription(e)){t.next=2;break}throw new rc({type:"forbidden",message:"can't unsubscribe not exist subscription",payload:{subscriptionId:e}});case 2:return t.next=4,this._channelImpl.unsubscribe(e).catch((function(e){throw e}));case 4:case"end":return t.stop()}}),t,this)})))},this._updatePublicationMetadata=function(e,t){return r._channelImpl.updatePublicationMetadata(e,t)},this._setupPropertiesFromChannel(),this._setupListenChannelEvent(),this._status="opened",t._onDisposed.once((function(){r.dispose()})),pc.debug("channel spawned",this.toJSON())}return Pt(e,[{key:"_addMember",value:function(e){var t=this._getMember(e.id);if(t)return t;var n=this._context._createRemoteMember(this,e);return this._members[n.id]=n,n}},{key:"_removeMember",value:function(e){delete this._members[e]}},{key:"_addPerson",value:function(e){this._persons[e.id]=e}},{key:"_removePerson",value:function(e){delete this._persons[e]}},{key:"_addPublication",value:function(e){var t=this._getPublication(e.id);if(t)return t;var n=function(e,t){var n=t.publisherId,r=t.stream,a=t.origin,i=t.metadata,s=t.codecCapabilities,o=t.encodings,c=t.contentType,u=t.id;return e._getPublication(u)||(c=c.toLowerCase(),new uc({id:u,channel:e,publisherId:n,contentType:c,metadata:i,origin:a,stream:r,codecCapabilities:null!=s?s:[],encodings:null!=o?o:[]}))}(this,e);return this._publications[e.id]=n,n}},{key:"_removePublication",value:function(e){delete this._publications[e]}},{key:"_addSubscription",value:function(e){var t=this._getSubscription(e.id);if(t)return t;var n=function(e,t){var n=t.subscriberId,r=t.publicationId,a=t.id,i=e._getSubscription(a);if(i)return i;var s=e._getPublication(r).contentType;return new dc({channel:e,id:a,subscriberId:n,publicationId:r,contentType:s})}(this,e);return this._subscriptions[e.id]=n,n}},{key:"_removeSubscription",value:function(e){delete this._subscriptions[e]}},{key:"members",get:function(){return Object.values(this._members)}},{key:"persons",get:function(){return Object.values(this._persons)}},{key:"bots",get:function(){return this.members.filter((function(e){return"bot"===e.type}))}},{key:"publications",get:function(){return Object.values(this._publications)}},{key:"subscriptions",get:function(){return Object.values(this._subscriptions)}},{key:"metadata",get:function(){return this._channelImpl.metadata}},{key:"status",get:function(){return this._status}},{key:"toJSON",value:function(){return{id:this.id,name:this.name,appId:this.appId,metadata:this.metadata,members:this.members,publications:this.publications,subscriptions:this.subscriptions}}},{key:"_setupPropertiesFromChannel",value:function(){var e=this;this._channelImpl.members.forEach((function(t){e._addMember(t)})),this._channelImpl.publications.forEach((function(t){e._addPublication(t)})),this._channelImpl.subscriptions.forEach((function(t){e._addSubscription(t)}))}},{key:"_setupListenChannelEvent",value:function(){var e=this;this._channelImpl.onClosed.add((function(){return e._handleOnChannelClose()})),this._channelImpl.onMetadataUpdated.add((function(t){var n=t.channel;return e._handleOnChannelMetadataUpdate(n.metadata)})),this._channelImpl.onMemberJoined.add((function(t){var n=t.member;e._handleOnMemberJoin(n)})),this._channelImpl.onMemberLeft.add((function(t){var n=t.member;e._handleOnMemberLeft(n)})),this._channelImpl.onMembershipChanged.pipe(this.onMembershipChanged),this._channelImpl.onMemberMetadataUpdated.add((function(t){var n=t.member;e._handleOnMemberMetadataUpdate(n,n.metadata)})),this._channelImpl.onStreamPublished.add((function(t){var n=t.publication;e._handleOnStreamPublish(n)})),this._channelImpl.onStreamUnpublished.add((function(t){var n=t.publication;e._handleOnStreamUnpublish(n)})),this._channelImpl.onPublicationChanged.pipe(this.onPublicationChanged),this._channelImpl.onPublicationMetadataUpdated.add((function(t){var n=t.publication;e._handleOnStreamMetadataUpdate(n,n.metadata)})),this._channelImpl.onStreamSubscribed.add((function(t){var n=t.subscription;e._handleOnStreamSubscribe(n)})),this._channelImpl.onStreamUnsubscribed.add((function(t){var n=t.subscription;e._handleOnStreamUnsubscribe(n)})),this._channelImpl.onSubscriptionChanged.pipe(this.onSubscriptionChanged)}},{key:"_handleOnChannelClose",value:function(){this.onClosed.emit({}),this.dispose()}},{key:"_handleOnChannelMetadataUpdate",value:function(e){this.onMetadataUpdated.emit({metadata:e})}},{key:"_handleOnMemberJoin",value:function(e){var t=this._addMember(e);this.onMemberJoined.emit({member:t})}},{key:"_handleOnMemberLeft",value:function(e){var t=this._getMember(e.id);this._removeMember(t.id),t._left();var n=this._getPerson(e.id);n&&(this._removePerson(t.id),n._left()),this.onMemberLeft.emit({member:t})}},{key:"_handleOnMemberMetadataUpdate",value:function(e,t){var n=this._getMember(e.id);n._metadataUpdated(t);var r=this._getPerson(e.id);r&&r._metadataUpdated(t),this.onMemberMetadataUpdated.emit({member:n,metadata:t})}},{key:"_handleOnStreamPublish",value:function(e){var t=this._addPublication(e);this.onStreamPublished.emit({publication:t})}},{key:"_handleOnStreamUnpublish",value:function(e){var t=this._getPublication(e.id);this._removePublication(t.id),t._unpublished(),this.onStreamUnpublished.emit({publication:t})}},{key:"_handleOnStreamMetadataUpdate",value:function(e,t){var n=this._getPublication(e.id);n._updateMetadata(t),this.onPublicationMetadataUpdated.emit({publication:n,metadata:t})}},{key:"_handleOnStreamSubscribe",value:function(e){var t=this._addSubscription(e);this._getPublication(t.publication.id)._subscribed(t),this.onStreamSubscribed.emit({subscription:t})}},{key:"_handleOnStreamUnsubscribe",value:function(e){var t=this._getSubscription(e.id);this._removeSubscription(t.id),t._canceled(),this._getPublication(t.publication.id)._unsubscribed(t),this.onStreamUnsubscribed.emit({subscription:t})}},{key:"join",value:function(){return Ss(this,arguments,wr().mark((function e(){var t,n,r,a,i,s=arguments;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0==(t=s.length>0&&void 0!==s[0]?s[0]:{}).name){e.next=5;break}if(!this.members.find((function(e){return e.name===t.name}))){e.next=5;break}throw new rc({type:"forbidden",message:"already exist same name member",payload:t});case 5:return void 0===t.keepaliveIntervalSec&&(t.keepaliveIntervalSec=25),pc.debug("join channel",{channelId:this.id,options:t}),n=ws(_s({},t),{type:"person",subtype:"person"}),null!==t.keepaliveIntervalSec&&(n.ttlSec=Date.now()/1e3+t.keepaliveIntervalSec),e.next=11,this._channelImpl.joinChannel(n);case 11:return(r=e.sent).name=n.name,e.next=15,this._createLocalPerson(r,{keepaliveIntervalSec:t.keepaliveIntervalSec});case 15:return a=e.sent,i=new fl(a),e.abrupt("return",i);case 18:case"end":return e.stop()}}),e,this)})))}},{key:"moveChannel",value:function(e){return Ss(this,null,wr().mark((function t(){var n,r,a,i;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e instanceof fl){t.next=2;break}throw new rc({type:"invalidType",message:"invalid person instance"});case 2:if(n=e.channel,this.id!==n.id){t.next=5;break}throw new rc({type:"invalidParameter",message:"same channel"});case 5:return t.next=7,n.leave(e);case 7:return r={name:e.name,type:e.type,subtype:e.subtype,metadata:e.metadata},void 0!=e.keepaliveIntervalSec&&(r.ttlSec=Date.now()/1e3+e.keepaliveIntervalSec),t.next=11,this._channelImpl.joinChannel(r);case 11:return a=t.sent,t.next=14,this._createLocalPerson(a,{keepaliveIntervalSec:e.keepaliveIntervalSec});case 14:i=t.sent,e.apply(i);case 16:case"end":return t.stop()}}),t,this)})))}},{key:"_createLocalPerson",value:function(e,t){return Ss(this,arguments,wr().mark((function e(t,n){var r,a;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.keepaliveIntervalSec,e.next=3,Ll(this._context,this,t,{keepaliveIntervalSec:r});case 3:return a=e.sent,this._addPerson(a),e.abrupt("return",a);case 6:case"end":return e.stop()}}),e,this)})))}},{key:"dispose",value:function(){this.disposed||(this.disposed=!0,pc.debug("disposed",{id:this.id}),this._onDisposed.emit(),this._events.dispose(),this._channelImpl.dispose())}}]),e}(),hc=function(){function e(){St(this,e)}return Pt(e,null,[{key:"Create",value:function(e){return Ss(this,arguments,wr().mark((function e(t){var n,r,a,i=arguments;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=i.length>1&&void 0!==i[1]?i[1]:{},e.next=3,t._api.createChannel(n);case 3:return r=e.sent,a=new fc(t,r),e.abrupt("return",a);case 6:case"end":return e.stop()}}),e)})))}},{key:"Find",value:function(e,t){return Ss(this,null,wr().mark((function n(){var r,a;return wr().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e._api.findChannel(t);case 2:return r=n.sent,a=new fc(e,r),n.abrupt("return",a);case 5:case"end":return n.stop()}}),n)})))}},{key:"FindOrCreate",value:function(e,t){return Ss(this,null,wr().mark((function n(){var r,a;return wr().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e._api.findOrCreateChannel(t);case 2:return r=n.sent,a=new fc(e,r),n.abrupt("return",a);case 5:case"end":return n.stop()}}),n)})))}}]),e}();Rs(),Rs(),Rs(),Rs(),Rs(),Rs(),Rs();var mc=2e4;Rs();var vc,gc=xs(to());Rs(),Rs();var bc=new Uint8Array(16);function yc(){if(!vc&&!(vc="undefined"!==typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!==typeof msCrypto&&"function"===typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return vc(bc)}Rs(),Rs(),Rs();var _c=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;var wc=function(e){return"string"===typeof e&&_c.test(e)},kc=[];for(yl=0;yl<256;++yl)kc.push((yl+256).toString(16).substr(1));var xc=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(kc[e[t+0]]+kc[e[t+1]]+kc[e[t+2]]+kc[e[t+3]]+"-"+kc[e[t+4]]+kc[e[t+5]]+"-"+kc[e[t+6]]+kc[e[t+7]]+"-"+kc[e[t+8]]+kc[e[t+9]]+"-"+kc[e[t+10]]+kc[e[t+11]]+kc[e[t+12]]+kc[e[t+13]]+kc[e[t+14]]+kc[e[t+15]]).toLowerCase();if(!wc(n))throw TypeError("Stringified UUID is invalid");return n};Rs();var Sc,Rc,Pc=function(e,t,n){var r=(e=e||{}).random||(e.rng||yc)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t){n=n||0;for(var a=0;a<16;++a)t[n+a]=r[a];return t}return xc(r)},Cc=new tc("packages/rtc-rpc-api-client/src/rpc.ts"),Tc=function(){function e(){var t=this;St(this,e),this.closed=!1,this.negotiated=!1,this.reconnecting=!1,this._pendingRequests=[],this._events=new Yo,this._onMessage=this._events.make(),this.onNotify=this._events.make(),this.onFatalError=this._events.make(),this.onDisconnected=this._events.make(),this._send=function(e){return new Promise((function(n,r){return Ss(t,null,wr().mark((function t(){return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,new Promise((function(e){return setTimeout(e,0)}));case 2:if(this._ws.readyState===this._ws.OPEN){t.next=5;break}return r(new rc({type:"forbidden",message:"wrong state",payload:{request:e,wsReadyState:Dc[this._ws.readyState]}})),t.abrupt("return");case 5:this._ws.send(JSON.stringify(e),(function(e){if(e)throw r(new rc({type:"internalError",message:"failed to send rpc message",payload:e}))})),n();case 7:case"end":return t.stop()}}),t,this)})))}))}}return Pt(e,[{key:"connect",value:function(e){return Ss(this,arguments,wr().mark((function e(t){var n,r,a,i,s,o=this;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.domain,r=t.token,a=t.secure,i=r,this._ws=new gc.default("".concat(a?"wss":"ws","://").concat(n,"/ws"),i),this._ws.onmessage=function(e){o._onMessage.emit(JSON.parse(e.data))},this._ws.onclose=function(){return Ss(o,null,wr().mark((function e(){return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.onDisconnected.emit();case 1:case"end":return e.stop()}}),e,this)})))},this._onMessage.add((function(e){Oc(e)&&o.onNotify.emit(e)})),e.next=8,new Promise((function(e,t){var n=setTimeout((function(){t(new rc({type:"internalError",message:"timeout"}))}),1e4);o._ws.onerror=function(e){Cc.error("ws error before established",e),t(e)},o._ws.onopen=function(){clearTimeout(n),e()}})).catch((function(e){return e}));case 8:if(!(s=e.sent)){e.next=11;break}throw new rc({type:"internalError",message:"failed to connect rtc-api",payload:s});case 11:this.negotiated=!0;case 12:case"end":return e.stop()}}),e,this)})))}},{key:"close",value:function(){this.closed||(this.closed=!0,Cc.debug("closed"),this._ws.close(),this._events.dispose())}},{key:"resolvePendingRequests",value:function(){var e=this;Cc.warn("resolve pendingRequests",xt(this._pendingRequests)),this._pendingRequests.forEach((function(t){return Ss(e,null,wr().mark((function e(){return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._send(t);case 2:case"end":return e.stop()}}),e,this)})))})),this._pendingRequests=[]}},{key:"request",value:function(e,t){return Ss(this,null,wr().mark((function n(){var r,a,i,s,o,c=this;return wr().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!this.closed){n.next=2;break}throw new rc({type:"forbidden",message:"rpc closed"});case 2:if(r=!1,n.prev=3,a=Ec(e,t),i=function(){return Ss(c,null,wr().mark((function n(){var i=this;return wr().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this._onMessage.watch((function(e){return e.id===a.id}),mc).catch((function(){if(!r)throw new rc({type:"timeout",message:"rpc request timeout",payload:{method:e,params:t,wsReadyState:Dc[i._ws.readyState]}})}));case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}}),n,this)})))},this.reconnecting){n.next=18;break}return this._send(a).catch((function(e){throw e})),n.next=10,Promise.race([i(),this.onFatalError.asPromise(20100).then((function(n){throw r||Cc.error("onFatalError",{method:e,params:t}),n})),this.onDisconnected.asPromise(20100).then((function(){throw r||Cc.error("onDisconnected",{method:e,params:t}),new Mc}))]);case 10:if(!(s=n.sent).error){n.next=14;break}throw Cc.error("[failed] request ",{message:s,method:e,params:t}),new Ic(s.error);case 14:return r=!0,n.abrupt("return",s.result);case 18:return Cc.warn("[start] reconnecting. pending request",{request:a}),this._pendingRequests.push(a),n.next=22,Promise.race([i(),this.onFatalError.asPromise(20100).then((function(e){throw r||Cc.warn("[failed] reconnecting. pending request",{e:e}),e}))]);case 22:if(!(o=n.sent).error){n.next=26;break}throw Cc.warn("[failed] reconnecting. pending request",{message:o,request:a}),new Ic(o.error);case 26:return Cc.warn("[end] reconnecting. pending request",{request:a}),r=!0,n.abrupt("return",o.result);case 29:n.next=35;break;case 31:throw n.prev=31,n.t0=n.catch(3),r=!0,n.t0;case 35:case"end":return n.stop()}}),n,this,[[3,31]])})))}},{key:"notify",value:function(e,t){return Ss(this,null,wr().mark((function n(){var r;return wr().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=Ec(e,t,!0),n.next=3,this._send(r);case 3:case"end":return n.stop()}}),n,this)})))}},{key:"batch",value:function(e){return Ss(this,null,wr().mark((function t(){var n,r,a=this;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.map((function(e){var t=e.method,n=e.params;return Ec(t,n)})),this._send(n).catch((function(e){throw e})),t.next=4,Promise.all(n.map((function(e){return Ss(a,[e],wr().mark((function e(t){var n,r;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.id,e.next=3,this._onMessage.watch((function(e){return e.id===n}),mc);case 3:return r=e.sent,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e,this)})))})));case 4:return r=t.sent,t.abrupt("return",r);case 6:case"end":return t.stop()}}),t,this)})))}}]),e}(),Ec=function(e,t,n){return n?{jsonrpc:"2.0",method:e,params:t}:{jsonrpc:"2.0",method:e,params:t,id:Pc()}},Oc=function(e){var t=e;return!(!t.method||void 0!=t.id)},Mc=function(e){mn(n,e);var t=_n(n);function n(){return St(this,n),t.call(this,{type:"backendError",message:"connection closed"})}return Pt(n)}(rc),Ic=function(e){mn(n,e);var t=_n(n);function n(e){return St(this,n),t.call(this,{type:"backendError",message:"request failed",payload:e})}return Pt(n)}(rc),Dc=["CONNECTING","OPEN","CLOSING","CLOSED"],jc=new tc("packages/rtc-rpc-api-client/src/client.ts"),Lc=function(){function e(t){var n=this;St(this,e),this.args=t,this.closed=!1,this._domain=null!=(Sc=this.args.domain)?Sc:"b-rapi.beta.skyway.ntt.com",this._secure=null==(Rc=this.args.secure)||Rc,this._token=this.args.token,this._rpc=new Tc,this._subscribingChannelEvents=new Set,this._subscribingChannelVersions={},this._httpClient=new sc("http".concat(this.args.secure?"s":"","://").concat(this.args.domain)),this._reconnectCount=0,this._reconnectLimit=8,this._events=new Yo,this.onEvent=this._events.make(),this.onFatalError=this._events.make(),this.onClose=this._events.make(),this.onReconnected=this._events.make(),t.log&&(tc.level=t.log.level,tc.format=t.log.format),jc.debug("RtcRpcApiClient spawned",t),this._rpc.onNotify.add((function(e){if("channelEventNotification"===e.method){var t=e.params;n._subscribingChannelVersions[t.data.channel.id]=t.data.channel.version,n.onEvent.emit({channelId:t.data.channel.id,event:t})}})),this._rpc.onDisconnected.add((function(){return Ss(n,null,wr().mark((function e(){return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._rpc.negotiated||this._rpc.closed||this._rpc.reconnecting){e.next=3;break}return e.next=3,this._reconnect();case 3:case"end":return e.stop()}}),e,this)})))})),this._rpc.onFatalError.once((function(e){jc.error("fatal error",e),n.onFatalError.emit(e),n.close()}))}return Pt(e,[{key:"_reconnect",value:function(){return Ss(this,null,wr().mark((function e(){var t,n=this;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this._reconnectCount>=this._reconnectLimit)){e.next=4;break}return this._rpc.onFatalError.emit(new rc({type:"internalError",message:"_reconnectLimit exceeded"})),this.close(),e.abrupt("return");case 4:return this._rpc.reconnecting=!0,jc.warn("[start] reconnect",{reconnectCount:this._reconnectCount,limit:this._reconnectLimit}),this._reconnectCount++,t=100*bs(this._reconnectCount,2)+100*bs(this._reconnectCount,2)*Math.random(),e.next=10,new Promise((function(e){return setTimeout(e,t)}));case 10:return e.prev=10,jc.warn("[start] reconnect rtc api",{reconnectCount:this._reconnectCount}),e.next=14,this.connect().catch((function(e){throw jc.warn("[failed] reconnect rtc api",{reconnectCount:n._reconnectCount}),e}));case 14:return this._rpc.reconnecting=!1,jc.warn("[end] reconnect rtc api",{reconnectCount:this._reconnectCount}),this._reconnectCount=0,jc.warn("re subscribe channel events",{_subscribingChannelEvents:xt(this._subscribingChannelEvents)}),this._rpc.resolvePendingRequests(),e.next=21,Promise.all(xt(this._subscribingChannelEvents).map((function(e){return Ss(n,null,wr().mark((function t(){var n,r,a,i,o;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.split(":"),r=s(n,2),a=r[0],i=r[1],o=this._subscribingChannelVersions[i],t.next=4,this.subscribeChannelEvents({appId:a,channelId:i,offset:o});case 4:case"end":return t.stop()}}),t,this)})))})));case 21:jc.warn("[end] reconnect",{reconnectCount:this._reconnectCount}),this.onReconnected.emit(),e.next=30;break;case 25:return e.prev=25,e.t0=e.catch(10),jc.warn("[fail] reconnect",{reconnectCount:this._reconnectCount,error:e.t0}),e.next=30,this._reconnect();case 30:case"end":return e.stop()}}),e,this,[[10,25]])})))}},{key:"updateToken",value:function(e){jc.debug("token update",{token:e}),this._token=e}},{key:"close",value:function(){this.closed||(this.closed=!0,jc.debug("closed"),this._rpc.close(),this.onClose.emit(),this._events.dispose())}},{key:"health",value:function(){return Ss(this,null,wr().mark((function e(){var t;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._httpClient.get("/health");case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}}),e,this)})))}},{key:"connect",value:function(){return Ss(this,null,wr().mark((function e(){return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return jc.debug("connect to rtc api rpc",this._domain),e.next=3,this._rpc.connect({domain:this._domain,token:this._token,secure:this._secure}).catch((function(e){throw new rc({type:"internalError",message:"failed to connect rpc api",payload:{reason:"There may be a problem with the token or failure on the server side",error:e}})}));case 3:case"end":return e.stop()}}),e,this)})))}},{key:"_channelSubscribed",value:function(e,t){this._subscribingChannelEvents.add(e+":"+t),jc.debug("_channelSubscribed",{appId:e,channelId:t,_subscribingChannelEvents:xt(this._subscribingChannelEvents)})}},{key:"_isSubscribingChannel",value:function(e,t){return this._subscribingChannelEvents.has(e+":"+t)}},{key:"createChannel",value:function(e){return Ss(this,arguments,wr().mark((function e(t){var n,r,a,i,s;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.name,r=t.metadata,a=t.appId,e.next=3,this._rpc.request("createChannel",{name:n,metadata:r,appId:a,authToken:this._token});case 3:return i=e.sent,s=i.channel,this._channelSubscribed(a,s.id),e.abrupt("return",s);case 7:case"end":return e.stop()}}),e,this)})))}},{key:"findOrCreateChannel",value:function(e){return Ss(this,arguments,wr().mark((function e(t){var n,r,a,i,s;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.name,r=t.metadata,a=t.appId,e.next=3,this._rpc.request("findOrCreateChannel",{name:n,metadata:r,appId:a,authToken:this._token});case 3:return i=e.sent,s=i.channel,this._channelSubscribed(a,s.id),e.abrupt("return",s);case 7:case"end":return e.stop()}}),e,this)})))}},{key:"getChannel",value:function(e){return Ss(this,arguments,wr().mark((function e(t){var n,r,a;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.appId,r=t.id,e.next=3,this._rpc.request("getChannel",{id:r,appId:n,authToken:this._token});case 3:if(a=e.sent,this._isSubscribingChannel(n,r)){e.next=10;break}return this._channelSubscribed(n,r),e.next=8,this.subscribeChannelEvents({appId:n,channelId:r,offset:a.channel.version});case 8:e.next=11;break;case 10:jc.debug("debug _isSubscribingChannel",{appId:n,id:r});case 11:return e.abrupt("return",a.channel);case 12:case"end":return e.stop()}}),e,this)})))}},{key:"getChannelByName",value:function(e){return Ss(this,arguments,wr().mark((function e(t){var n,r,a;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.name,r=t.appId,e.next=3,this._rpc.request("getChannelByName",{name:n,appId:r,authToken:this._token});case 3:return a=e.sent,e.abrupt("return",a.channel);case 5:case"end":return e.stop()}}),e,this)})))}},{key:"deleteChannel",value:function(e){return Ss(this,arguments,wr().mark((function e(t){var n,r;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.id,r=t.appId,e.next=3,this._rpc.request("deleteChannel",{id:n,appId:r,authToken:this._token});case 3:case"end":return e.stop()}}),e,this)})))}},{key:"updateChannelMetadata",value:function(e){return Ss(this,arguments,wr().mark((function e(t){var n,r,a;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.id,r=t.metadata,a=t.appId,e.next=3,this._rpc.request("updateChannelMetadata",{id:n,metadata:r,appId:a,authToken:this._token});case 3:case"end":return e.stop()}}),e,this)})))}},{key:"addMember",value:function(e){return Ss(this,arguments,wr().mark((function e(t){var n,r,a,i,s,o,c,u,l;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.channelId,r=t.name,a=t.metadata,i=t.subscribeChannelEvents,s=t.appId,o=t.ttlSec,c=t.subtype,u=t.type,e.next=3,this._rpc.request("addMember",{channelId:n,name:r,metadata:a,subscribeChannelEvents:i,appId:s,ttlSec:o&&parseInt(o.toString()),authToken:this._token,subtype:c,type:u});case 3:return l=e.sent,e.abrupt("return",l);case 5:case"end":return e.stop()}}),e,this)})))}},{key:"updateMemberTtl",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return Ss(this,null,wr().mark((function n(){var r,a,i,s,o;return wr().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=e.appId,a=e.channelId,i=e.memberId,s=e.ttlSec,n.prev=1,n.next=4,this._rpc.request("updateMemberTtl",{appId:r,channelId:a,memberId:i,ttlSec:s&&parseInt(s.toString()),authToken:this._token});case 4:case 13:n.next=16;break;case 6:if(n.prev=6,n.t0=n.catch(1),o=new rc({type:"internalError",message:"updateMemberTtl failed",payload:n.t0}),!(t>0)){n.next=15;break}return jc.warn("retry updateMemberTtl",{error:o,retry:t}),n.next=13,this.updateMemberTtl(e,t-1);case 15:throw o;case 16:case"end":return n.stop()}}),n,this,[[1,6]])})))}},{key:"updateMemberMetadata",value:function(e){return Ss(this,arguments,wr().mark((function e(t){var n,r,a,i;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.channelId,r=t.memberId,a=t.metadata,i=t.appId,e.next=3,this._rpc.request("updateMemberMetadata",{channelId:n,memberId:r,metadata:a,appId:i,authToken:this._token});case 3:case"end":return e.stop()}}),e,this)})))}},{key:"leaveChannel",value:function(e){return Ss(this,arguments,wr().mark((function e(t){var n,r,a;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.channelId,r=t.id,a=t.appId,e.next=3,this._rpc.request("removeMember",{channelId:n,id:r,appId:a,authToken:this._token});case 3:case"end":return e.stop()}}),e,this)})))}},{key:"publishStream",value:function(e){return Ss(this,arguments,wr().mark((function e(t){var n,r,a,i,s,o,c,u,l;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.appId,r=t.channelId,a=t.publisherId,i=t.contentType,s=t.metadata,o=t.origin,c=t.codecCapabilities,u=t.encodings,e.next=3,this._rpc.request("publishStream",{channelId:r,publisherId:a,contentType:i[0].toUpperCase()+i.slice(1),metadata:s,origin:o,codecCapabilities:c,encodings:u,appId:n,authToken:this._token});case 3:return l=e.sent,e.abrupt("return",{publicationId:l.id});case 5:case"end":return e.stop()}}),e,this)})))}},{key:"updatePublicationMetadata",value:function(e){return Ss(this,arguments,wr().mark((function e(t){var n,r,a,i;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.channelId,r=t.publicationId,a=t.appId,i=t.metadata,e.next=3,this._rpc.request("updatePublicationMetadata",{channelId:n,publicationId:r,metadata:i,appId:a,authToken:this._token});case 3:case"end":return e.stop()}}),e,this)})))}},{key:"unpublishStream",value:function(e){return Ss(this,arguments,wr().mark((function e(t){var n,r,a;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.channelId,r=t.publicationId,a=t.appId,e.next=3,this._rpc.request("unpublishStream",{channelId:n,publicationId:r,appId:a,authToken:this._token});case 3:case"end":return e.stop()}}),e,this)})))}},{key:"subscribeStream",value:function(e){return Ss(this,arguments,wr().mark((function e(t){var n,r,a,i,s;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.channelId,r=t.subscriberId,a=t.publicationId,i=t.appId,e.next=3,this._rpc.request("subscribeStream",{channelId:n,subscriberId:r,publicationId:a,appId:i,authToken:this._token});case 3:return s=e.sent,e.abrupt("return",{subscriptionId:s.id});case 5:case"end":return e.stop()}}),e,this)})))}},{key:"unsubscribeStream",value:function(e){return Ss(this,arguments,wr().mark((function e(t){var n,r,a;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.channelId,r=t.subscriptionId,a=t.appId,e.next=3,this._rpc.request("unsubscribeStream",{channelId:n,subscriptionId:r,appId:a,authToken:this._token});case 3:case"end":return e.stop()}}),e,this)})))}},{key:"subscribeChannelEvents",value:function(e){return Ss(this,arguments,wr().mark((function e(t){var n,r,a;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.appId,r=t.channelId,a=t.offset,e.prev=1,jc.debug("[start] subscribeChannelEvents",{offset:a}),e.next=5,this._rpc.request("subscribeChannelEvents",{appId:n,authToken:this._token,channelId:r,offset:a});case 5:jc.debug("[end] subscribeChannelEvents",{offset:a}),e.next=18;break;case 8:if(e.prev=8,e.t0=e.catch(1),!(e.t0 instanceof Mc)){e.next=16;break}return jc.warn("reconnect happened while subscribeChannelEvents. retry",{offset:a,error:e.t0}),e.next=14,this.subscribeChannelEvents({appId:n,channelId:r,offset:a});case 14:e.next=18;break;case 16:throw jc.warn("[failed] subscribeChannelEvents",{offset:a,error:e.t0}),e.t0;case 18:case"end":return e.stop()}}),e,this,[[1,8]])})))}}]),e}();Rs(),Rs();var Ac=xs(no()),Fc=Pt((function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};St(this,e),this.rtcApi={domain:"b-rapi.beta.skyway.ntt.com",timeout:3e4,secure:!0},this.log={level:"error",format:"object"},Object.assign(this,(0,Ac.default)(this,t))}));Rs();var Nc=new tc("packages/rtc-api-client/src/infrastructure/api.ts"),Bc=function(){function e(t){var n=this;St(this,e),this._client=t,this.closed=!1,this.onClose=new Jo,t.onClose.once((function(){n.close()}))}return Pt(e,[{key:"updateAuthToken",value:function(e){this._client.updateToken(e)}},{key:"close",value:function(){this.closed||(this.closed=!0,Nc.debug("closed"),this._client.close(),this.onClose.emit(),this.onClose.removeAllListeners())}},{key:"createChannel",value:function(e,t){return Ss(this,null,wr().mark((function n(){var r,a,i;return wr().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this._client.createChannel({appId:e,name:t.name,metadata:t.metadata}).catch((function(e){var t=e.payload;if(4030===(null==t?void 0:t.code))throw new rc({type:"insufficientPermissions",message:"Insufficient permission for creating a channel"});throw new rc({type:"backendError",message:"createChannel failed",payload:e})}));case 2:return r=n.sent,a=r.id,n.next=6,this.getChannel(e,{id:a});case 6:return i=n.sent,n.abrupt("return",i);case 8:case"end":return n.stop()}}),n,this)})))}},{key:"getChannel",value:function(e,t){return Ss(this,arguments,wr().mark((function e(t,n){var r,a;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.name,!(a=n.id)){e.next=5;break}return e.next=4,this._client.getChannel({appId:t,id:a}).catch((function(e){var t=e.payload;if(4030===(null==t?void 0:t.code))throw new rc({type:"insufficientPermissions",message:"Insufficient permission for finding a channel"});throw new rc({type:"backendError",message:"getChannel failed",payload:e})}));case 4:case 8:return e.abrupt("return",e.sent);case 5:if(!r){e.next=9;break}return e.next=8,this._client.getChannelByName({appId:t,name:r}).catch((function(e){var t=e.payload;if(4030===(null==t?void 0:t.code))throw new rc({type:"insufficientPermissions",message:"Insufficient permission for finding a channel"});throw new rc({type:"backendError",message:"getChannel by name failed",payload:e})}));case 9:throw new rc({type:"invalidParameter",message:"channel query must has id or name"});case 10:case"end":return e.stop()}}),e,this)})))}},{key:"findOrCreateChannel",value:function(e,t){return Ss(this,null,wr().mark((function n(){return wr().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",this._client.findOrCreateChannel(ws(_s({},t),{appId:e})).catch((function(e){var t=e.payload;if(4030===(null==t?void 0:t.code))throw new rc({type:"insufficientPermissions",message:"Insufficient permission for finding or creating a channel"});throw new rc({type:"backendError",message:"findOrCreateChannel failed",payload:e})})));case 1:case"end":return n.stop()}}),n,this)})))}},{key:"deleteChannel",value:function(e,t){return Ss(this,null,wr().mark((function n(){return wr().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this._client.deleteChannel({appId:e,id:t}).catch((function(e){var t=e.payload;if(4030===(null==t?void 0:t.code))throw new rc({type:"insufficientPermissions",message:"Insufficient permission for finding or delete a channel"});throw new rc({type:"backendError",message:"deleteChannel failed",payload:e})}));case 2:case"end":return n.stop()}}),n,this)})))}},{key:"updateChannelMetadata",value:function(e,t,n){return Ss(this,null,wr().mark((function r(){return wr().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,this._client.updateChannelMetadata({appId:e,id:t,metadata:n}).catch((function(e){var t=e.payload;if(4030===(null==t?void 0:t.code))throw new rc({type:"insufficientPermissions",message:"Insufficient permission for finding or update channel's metadata"});throw new rc({type:"backendError",message:"updateChannelMetadata failed",payload:e})}));case 2:case"end":return r.stop()}}),r,this)})))}},{key:"join",value:function(e,t,n){return Ss(this,null,wr().mark((function r(){var a,i,s;return wr().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,this._client.addMember({appId:e,channelId:t,name:n.name,metadata:n.metadata,ttlSec:n.ttlSec,type:n.type,subtype:n.subtype}).catch((function(r){var a=r.payload,i=r.message,s=r.type;if(4030===(null==a?void 0:a.code))throw new rc({type:"insufficientPermissions",message:"Insufficient permission for join channel",payload:{memberInit:n,appId:e,channelId:t}});throw new rc({type:s,message:"join channel failed",payload:{message:i,payload:a,memberInit:n,channelId:t,appId:e}})}));case 2:return a=r.sent,i=a.memberId,s={id:i,name:n.name,type:n.type,subtype:n.subtype,metadata:n.metadata},r.abrupt("return",s);case 6:case"end":return r.stop()}}),r,this)})))}},{key:"updateMemberTtl",value:function(e,t,n,r){return Ss(this,null,wr().mark((function a(){return wr().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,this._client.updateMemberTtl({appId:e,channelId:t,memberId:n,ttlSec:r});case 2:case"end":return a.stop()}}),a,this)})))}},{key:"updateMemberMetadata",value:function(e,t,n,r){return Ss(this,null,wr().mark((function a(){return wr().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,this._client.updateMemberMetadata({appId:e,channelId:t,memberId:n,metadata:r}).catch((function(e){var t=e.payload;if(4030===(null==t?void 0:t.code))throw new rc({type:"insufficientPermissions",message:"Insufficient permission for updateMemberMetadata"});throw new rc({type:"backendError",message:"updateMemberMetadata failed",payload:e})}));case 2:case"end":return a.stop()}}),a,this)})))}},{key:"leave",value:function(e,t,n){return Ss(this,null,wr().mark((function r(){return wr().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,this._client.leaveChannel({channelId:t,id:n,appId:e}).catch((function(e){var t=e.payload;if(4030===(null==t?void 0:t.code))throw new rc({type:"insufficientPermissions",message:"Insufficient permission for leaveChannel"});throw new rc({type:"backendError",message:"leaveChannel failed",payload:e})}));case 2:case"end":return r.stop()}}),r,this)})))}},{key:"publish",value:function(e,t){return Ss(this,null,wr().mark((function n(){var r,a,i,s,o;return wr().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this._client.publishStream({channelId:t.channel,publisherId:t.publisher,contentType:t.contentType,metadata:t.metadata,origin:t.origin,codecCapabilities:t.codecCapabilities,encodings:t.encodings,appId:e}).catch((function(e){var t=e.payload;if(4030===(null==t?void 0:t.code))throw new rc({type:"insufficientPermissions",message:"Insufficient permission for publishStream"});throw new rc({type:"backendError",message:"publishStream failed",payload:e})}));case 2:return i=n.sent,s=i.publicationId,o={id:s,channelId:t.channel,publisherId:t.publisher,origin:t.origin,contentType:t.contentType,metadata:t.metadata,codecCapabilities:null!=(r=t.codecCapabilities)?r:[],encodings:null!=(a=t.encodings)?a:[]},n.abrupt("return",o);case 6:case"end":return n.stop()}}),n,this)})))}},{key:"updatePublicationMetadata",value:function(e,t,n,r){return Ss(this,null,wr().mark((function a(){return wr().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,this._client.updatePublicationMetadata({channelId:t,publicationId:n,metadata:r,appId:e}).catch((function(e){var t=e.payload;if(4030===(null==t?void 0:t.code))throw new rc({type:"insufficientPermissions",message:"Insufficient permission for updatePublicationMetadata"});throw new rc({type:"backendError",message:"updatePublicationMetadata failed",payload:e})}));case 2:case"end":return a.stop()}}),a,this)})))}},{key:"unpublish",value:function(e,t,n){return Ss(this,null,wr().mark((function r(){return wr().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,this._client.unpublishStream({channelId:t,publicationId:n,appId:e}).catch((function(e){var t=e.payload;if(4030===(null==t?void 0:t.code))throw new rc({type:"insufficientPermissions",message:"Insufficient permission for unpublishStream"});throw new rc({type:"backendError",message:"unpublishStream failed",payload:e})}));case 2:case"end":return r.stop()}}),r,this)})))}},{key:"subscribe",value:function(e,t){return Ss(this,null,wr().mark((function n(){var r,a,i;return wr().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this._client.subscribeStream({channelId:t.channel.id,subscriberId:t.subscriber.id,publicationId:t.publication.id,appId:e}).catch((function(e){var t=e.payload;if(4030===(null==t?void 0:t.code))throw new rc({type:"insufficientPermissions",message:"Insufficient permission for subscribeStream"});throw new rc({type:"backendError",message:"subscribeStream failed",payload:e})}));case 2:return r=n.sent,a=r.subscriptionId,i={id:a,publicationId:t.publication.id,channelId:t.channel.id,publisherId:t.publication.publisherId,subscriberId:t.subscriber.id,contentType:t.publication.contentType},n.abrupt("return",i);case 6:case"end":return n.stop()}}),n,this)})))}},{key:"unsubscribe",value:function(e,t,n){return Ss(this,null,wr().mark((function r(){return wr().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,this._client.unsubscribeStream({appId:e,channelId:t,subscriptionId:n}).catch((function(e){var t=e.payload;if(4030===(null==t?void 0:t.code))throw new rc({type:"insufficientPermissions",message:"Insufficient permission for unsubscribeStream"});throw new rc({type:"backendError",message:"unsubscribeStream failed",payload:e})}));case 2:case"end":return r.stop()}}),r,this)})))}}]),e}(),Uc=new tc("packages/rtc-api-client/src/client.ts"),zc=function(){function e(t,n,r){var a=this;St(this,e),this.appId=t,this.config=n,this._rpc=r,this.closed=!1,this.onFatalError=new Jo,this.apiClient=new Bc(r),r.onFatalError.once((function(e){a.onFatalError.emit(e)}))}return Pt(e,[{key:"updateAuthToken",value:function(e){this._rpc.updateToken(e)}},{key:"createChannel",value:function(){return Ss(this,arguments,wr().mark((function e(){var t,n,r,a=arguments;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.length>0&&void 0!==a[0]?a[0]:{},Uc.debug("[start] apiClient.createChannel",{init:t}),e.next=4,this.apiClient.createChannel(this.appId,t).catch((function(e){throw Uc.debug("[failed] apiClient.createChannel",{init:t,e:e}),e}));case 4:return(n=e.sent).name=t.name,Uc.debug("[end] apiClient.createChannel",{init:t}),r=Kc(this.appId,this._rpc,this.apiClient,n,this.config),e.abrupt("return",r);case 9:case"end":return e.stop()}}),e,this)})))}},{key:"findChannel",value:function(e){return Ss(this,null,wr().mark((function t(){var n,r;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return Uc.debug("[start] apiClient.getChannel",{query:e}),t.next=3,this.apiClient.getChannel(this.appId,e).catch((function(t){throw Uc.debug("[failed] apiClient.getChannel",{query:e,e:t}),t}));case 3:return n=t.sent,r=Kc(this.appId,this._rpc,this.apiClient,n,this.config),Uc.debug("[end] apiClient.getChannel",{channelId:r.id}),t.abrupt("return",r);case 7:case"end":return t.stop()}}),t,this)})))}},{key:"findOrCreateChannel",value:function(e){return Ss(this,null,wr().mark((function t(){var n,r;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return Uc.debug("[start] apiClient.findOrCreateChannel",{query:e}),t.next=3,this.apiClient.findOrCreateChannel(this.appId,e).catch((function(t){throw Uc.debug("[failed] apiClient.findOrCreateChannel",{query:e,e:t}),t}));case 3:return n=t.sent,Uc.debug("[end] apiClient.findOrCreateChannel",{query:e}),r=Kc(this.appId,this._rpc,this.apiClient,n,this.config),t.abrupt("return",r);case 7:case"end":return t.stop()}}),t,this)})))}},{key:"deleteChannel",value:function(e){return this.apiClient.deleteChannel(this.appId,e)}},{key:"close",value:function(){this.closed||(this.closed=!0,Uc.debug("closed",{appid:this.appId}),this.apiClient.close())}}],[{key:"Create",value:function(t){return Ss(this,null,wr().mark((function n(){var r,a;return wr().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return(r=new Fc(t)).log&&(tc.level=r.log.level,tc.format=r.log.format),Uc.debug("RtcApiClient spawned",r),a=new Lc(ws(_s({},r.rtcApi),{token:t.token,log:r.log})),n.next=6,a.connect();case 6:return n.abrupt("return",new e(t.appId,r,a));case 7:case"end":return n.stop()}}),n)})))}}]),e}();Rs(),Rs(),Rs();var Vc=new tc("packages/rtc-api-client/src/infrastructure/eventObserver.ts"),Hc=function(){function e(t,n,r){var a=this;St(this,e),this.onEvent=new Jo,this._disposer=[];var i=new Wc(r.version,(function(e){return Ss(a,null,wr().mark((function a(){return wr().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,n.subscribeChannelEvents({appId:t,channelId:r.id,offset:e});case 2:return a.next=4,new Promise((function(e){return setTimeout(e,5e3)}));case 4:i.packetLostHappened&&Vc.error("failed to resolve event lost");case 5:case"end":return a.stop()}}),a)})))}));this._disposer=[n.onEvent.add((function(e){return Ss(a,[e],wr().mark((function e(t){var n,a;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.channelId,a=t.event,n===r.id&&i.push({event:a,version:a.data.channel.version});case 2:case"end":return e.stop()}}),e)})))})).removeListener,i.onEvent.add((function(e){a.onEvent.emit(e)})).removeListener]}return Pt(e,[{key:"dispose",value:function(){this._disposer.forEach((function(e){return e()})),this.onEvent.removeAllListeners()}}]),e}(),Wc=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3;St(this,e),this.presentVersion=t,this.onPacketLost=n,this.packetLifetime=r,this.onEvent=new Jo,this.eventBuffer={},this.packetLostHappened=!1}return Pt(e,[{key:"expectNextVersion",get:function(){return this.presentVersion+1}},{key:"push",value:function(e){var t=e.version;if(t<this.expectNextVersion)Vc.debug("duplicate event",ws(_s({},e),{presentVersion:this.presentVersion}));else{if(t>this.expectNextVersion)return Vc.debug("maybe miss order event received",ws(_s({},e),{presentVersion:this.presentVersion})),this.eventBuffer[t]=e,void this.handlePacketLifetime();this.packetLostHappened&&(Vc.warn("event packetLost resolved",{eventFrame:e}),this.packetLostHappened=!1),this.eventBuffer[t]=e,this.resolveEvents()}}},{key:"handlePacketLifetime",value:function(){var e=this,t=s(Object.keys(this.eventBuffer).sort().map((function(t){return e.eventBuffer[Number(t)]})),1)[0];void 0==this.packetLifeTimer&&t&&(Vc.debug("set event packetLost timer",ws(_s({},t),{presentVersion:this.presentVersion})),this.packetLifeTimer=setTimeout((function(){return Ss(e,null,wr().mark((function e(){return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.presentVersion<t.version)){e.next=10;break}if(Vc.warn("event packetLost",{oldestBufferedEvent:t,eventBufferLength:Object.keys(this.eventBuffer).length,presentVersion:this.presentVersion}),!this.packetLostHappened){e.next=7;break}return Vc.warn("event not retransmit yet"),e.abrupt("return");case 7:return this.packetLostHappened=!0,e.next=10,this.onPacketLost(this.expectNextVersion);case 10:this.packetLifeTimer=void 0,this.handlePacketLifetime();case 12:case"end":return e.stop()}}),e,this)})))}),this.packetLifetime))}},{key:"resolveEvents",value:function(){for(var e=this,t=[],n=this.expectNextVersion;;n++){var r=this.eventBuffer[n];if(!r)break;t.push(r),delete this.eventBuffer[n]}t.length>0&&(this.presentVersion=t.slice(-1)[0].version,t.forEach((function(t){e.onEvent.emit(t.event)})))}}]),e}(),qc=new tc("packages/rtc-api-client/src/domain/channel.ts"),Gc=function(){function e(t,n,r,a,i){var s=this;St(this,e),this.appId=t,this.eventObserver=r,this.apiClient=a,this.config=i,this.disposed=!1,this._events=new Yo,this.onClosed=this._events.make(),this.onMetadataUpdated=this._events.make(),this.onMembershipChanged=this._events.make(),this.onMemberJoined=this._events.make(),this.onMemberLeft=this._events.make(),this.onMemberMetadataUpdated=this._events.make(),this.onPublicationChanged=this._events.make(),this.onStreamPublished=this._events.make(),this.onStreamUnpublished=this._events.make(),this.onPublicationMetadataUpdated=this._events.make(),this.onSubscriptionChanged=this._events.make(),this.onStreamSubscribed=this._events.make(),this.onStreamUnsubscribed=this._events.make(),this.updateChannelMetadata=function(e){return new Promise((function(t,n){s.apiClient.updateChannelMetadata(s.appId,s.id,e).catch(n),s.onMetadataUpdated.watch((function(t){return t.channel.metadata===e})).then((function(){return t()})).catch((function(e){return n(new rc({type:"timeout",message:"ChannelImpl updateChannelMetadata",payload:{error:e}}))}))}))},this.leave=function(e,t){return new Promise((function(n,r){s.apiClient.leave(s.appId,e,t).catch(r),s.onMemberLeft.watch((function(e){return e.member.id===t}),s.config.rtcApi.timeout).then((function(){return n()})).catch((function(e){return r(new rc({type:"timeout",message:"ChannelImpl onMemberLeft",payload:{error:e}}))}))}))},this.updateMemberMetadata=function(e,t){return new Promise((function(n,r){s.apiClient.updateMemberMetadata(s.appId,s.id,e,t).catch(r),s.onMemberMetadataUpdated.watch((function(n){return n.member.id===e&&n.member.metadata===t})).then((function(){return n()})).catch((function(e){return r(new rc({type:"timeout",message:"ChannelImpl updateMemberMetadata",payload:{error:e}}))}))}))},this.unpublish=function(e){return new Promise((function(t,n){s.apiClient.unpublish(s.appId,s.id,e).catch(n),s.onStreamUnpublished.watch((function(t){return t.publication.id===e})).then((function(){return t()})).catch((function(e){return n(new rc({type:"timeout",message:"ChannelImpl unpublish",payload:{error:e}}))}))}))},this.updatePublicationMetadata=function(e,t){return new Promise((function(n,r){s.apiClient.updatePublicationMetadata(s.appId,s.id,e,t).catch(r),s.onPublicationMetadataUpdated.watch((function(n){return n.publication.id===e&&n.publication.metadata===t})).then((function(){return n()})).catch((function(e){return r(new rc({type:"timeout",message:"ChannelImpl updatePublicationMetadata",payload:{error:e}}))}))}))},this.unsubscribe=function(e){return new Promise((function(t,n){s.apiClient.unsubscribe(s.appId,s.id,e).catch(n),s.onStreamUnsubscribed.watch((function(t){return t.subscription.id===e})).then((function(){return t()})).catch((function(e){return n(new rc({type:"timeout",message:"ChannelImpl unsubscribe",payload:{error:e}}))}))}))},this.id=n.id,this.name=n.name,this.metadata=n.metadata,this.members=n.members,this.publications=n.publications,this.subscriptions=n.subscriptions,this.version=n.version,r.onEvent.add((function(e){switch(qc.debug("received event: ",e),s.version=e.data.channel.version,e.type){case"ChannelDeleted":s._channelClosed();break;case"ChannelMetadataUpdated":s._channelMetadataUpdated(e.data);break;case"MemberAdded":s._memberJoined(e.data);break;case"MemberRemoved":s._memberLeft(e.data);break;case"MemberMetadataUpdated":s._memberMetadataUpdated(e.data);break;case"StreamPublished":s._streamPublished(e.data);break;case"StreamUnpublished":s._streamUnpublished(e.data);break;case"PublicationMetadataUpdated":s._publicationMetadataUpdated(e.data);break;case"StreamSubscribed":s._streamSubscribed(e.data);break;case"StreamUnsubscribed":s._streamUnsubscribed(e.data)}})),a.onClose.once((function(){s.dispose()}))}return Pt(e,[{key:"getMember",value:function(e){return this.members.find((function(t){return t.id===e}))}},{key:"addMember",value:function(e){var t=this.getMember(e.id);return t||(this.members.push(e),e)}},{key:"deleteMember",value:function(e){this.members=this.members.filter((function(t){return t.id!==e}))}},{key:"getPublication",value:function(e){return this.publications.find((function(t){return t.id===e}))}},{key:"addPublication",value:function(e){var t=this.getPublication(e.id);if(t)return t;var n=ws(_s({},e),{channelId:this.id,codecCapabilities:[],encodings:[]});return this.publications.push(n),n}},{key:"deletePublication",value:function(e){this.publications=this.publications.filter((function(t){return t.id!==e}))}},{key:"getSubscription",value:function(e){return this.subscriptions.find((function(t){return t.id===e}))}},{key:"addSubscription",value:function(e){var t=this.getSubscription(e.id);if(t)return t;var n=this.getPublication(e.publicationId),r=ws(_s({},e),{channelId:this.id,publisherId:n.publisherId,contentType:n.contentType});return this.subscriptions.push(r),r}},{key:"deleteSubscription",value:function(e){this.subscriptions=this.subscriptions.filter((function(t){return t.id!==e}))}},{key:"_channelClosed",value:function(){this.onClosed.emit({})}},{key:"_channelMetadataUpdated",value:function(e){this.metadata=e.channel.metadata,this.onMetadataUpdated.emit(e)}},{key:"_memberJoined",value:function(e){this.addMember(e.member),this.onMemberJoined.emit(e),this.onMembershipChanged.emit({})}},{key:"_memberLeft",value:function(e){var t=this.getMember(e.member.id);if(!t)throw new rc({type:"notFound",message:"member not found",payload:{event:e}});this.deleteMember(t.id),this.onMemberLeft.emit({member:t}),this.onMembershipChanged.emit({})}},{key:"_memberMetadataUpdated",value:function(e){var t=this.getMember(e.member.id);if(!t)throw new rc({type:"notFound",message:"member not found",payload:{event:e}});t.metadata=e.member.metadata,this.onMemberMetadataUpdated.emit(e)}},{key:"_streamPublished",value:function(e){var t=this.addPublication(e.publication),n=ws(_s({},e),{publication:t});this.onStreamPublished.emit(n),this.onPublicationChanged.emit({})}},{key:"_streamUnpublished",value:function(e){var t=this.getPublication(e.publication.id);if(!t)throw new rc({type:"notFound",message:"publication not found"});this.deletePublication(t.id);var n=ws(_s({},e),{publication:t});this.onStreamUnpublished.emit(n),this.onPublicationChanged.emit({})}},{key:"_publicationMetadataUpdated",value:function(e){var t=this.getPublication(e.publication.id);if(!t)throw new rc({type:"notFound",message:"publication not found"});t.metadata=e.publication.metadata;var n=ws(_s({},e),{publication:t});this.onPublicationMetadataUpdated.emit(n)}},{key:"_streamSubscribed",value:function(e){var t=this.addSubscription(e.subscription),n=ws(_s({},e),{subscription:t});this.onStreamSubscribed.emit(n),this.onSubscriptionChanged.emit({})}},{key:"_streamUnsubscribed",value:function(e){var t=this.getSubscription(e.subscription.id);if(!t)throw new rc({type:"notFound",message:"subscription not found"});this.deleteSubscription(t.id);var n=ws(_s({},e),{subscription:t});this.onStreamUnsubscribed.emit(n),this.onSubscriptionChanged.emit({})}},{key:"joinChannel",value:function(e){return Ss(this,null,wr().mark((function t(){var n,r,a,i=this;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.type&&(e.type=e.type[0].toUpperCase()+e.type.slice(1)),e.subtype&&(e.subtype=e.subtype[0].toUpperCase()+e.subtype.slice(1)),qc.debug("[start] joinChannel",{memberInit:e}),t.next=5,this.apiClient.join(this.appId,this.id,_s({},e));case 5:if(r=t.sent,null==(n=this.getMember(r.id))){t.next=10;break}t.t0=n,t.next=13;break;case 10:return t.next=12,this.onMemberJoined.watch((function(e){return e.member.id===r.id}),this.config.rtcApi.timeout).catch((function(e){throw new rc({type:"timeout",message:"ChannelImpl onMemberJoined",payload:{res:r,error:e,exist:i.getMember(r.id)}})}));case 12:t.t0=t.sent.member;case 13:return a=t.t0,qc.debug("[end] joinChannel",{member:a}),t.abrupt("return",a);case 16:case"end":return t.stop()}}),t,this)})))}},{key:"updateMemberTtl",value:function(e,t){return this.apiClient.updateMemberTtl(this.appId,this.id,e,t)}},{key:"publish",value:function(e){return Ss(this,null,wr().mark((function t(){var n,r,a,i,s=this;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return qc.debug("[start] apiClient.publish",{init:e}),t.next=3,this.apiClient.publish(this.appId,ws(_s({},e),{channel:this.id}));case 3:if(n=t.sent,qc.debug("[end] apiClient.publish",{publicationDto:n}),!(r=this.getPublication(n.id))){t.next=8;break}return t.abrupt("return",r);case 8:return t.next=10,this.onStreamPublished.watch((function(e){return e.publication.id===n.id}),this.config.rtcApi.timeout).catch((function(e){throw new rc({type:"timeout",message:"ChannelImpl onStreamPublished",payload:{publicationDto:n,error:e,exist:s.getPublication(n.id)}})}));case 10:return a=t.sent,i=a.publication,t.abrupt("return",i);case 13:case"end":return t.stop()}}),t,this)})))}},{key:"subscribe",value:function(e){return Ss(this,null,wr().mark((function t(){var n,r,a,i;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return qc.debug("[start] apiClient.subscribe",{init:e}),t.next=3,this.apiClient.subscribe(this.appId,ws(_s({},e),{channel:this}));case 3:if(n=t.sent,qc.debug("[end] apiClient.subscribe",{subscriptionDto:n}),!(r=this.getSubscription(n.id))){t.next=8;break}return t.abrupt("return",r);case 8:return t.next=10,this.onStreamSubscribed.watch((function(e){return e.subscription.id===n.id}),this.config.rtcApi.timeout).catch((function(e){throw new rc({type:"timeout",message:"ChannelImpl onStreamSubscribed",payload:{subscriptionDto:n,error:e}})}));case 10:return a=t.sent,i=a.subscription,t.abrupt("return",i);case 13:case"end":return t.stop()}}),t,this)})))}},{key:"dispose",value:function(){this.disposed||(this.disposed=!0,qc.debug("disposed",{id:this.id}),this.eventObserver.dispose(),this._events.dispose())}}]),e}();function Kc(e,t,n,r,a){var i=new Hc(e,t,r);return new Gc(e,r,i,n,a)}var Xc,Qc=xs(no()),$c=Pt((function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};St(this,e),this.rtcApi={domain:"b-rapi.beta.skyway.ntt.com",timeout:3e4,secure:!0},this.iceParamServer={domain:"b-ice.beta.skyway.ntt.com",version:1,secure:!0},this.messageService={domain:"b-msas.beta.skyway.ntt.com",secure:!0},this.rtcConfig={timeout:3e4,turnPolicy:"enable",encodedInsertableStreams:!1},this.token={updateReminderSec:60},this.log={level:"error",format:"object"},this.debug={disableDPlane:!1},Object.assign(this,(0,Qc.default)(this,t))}));Rs(),Rs(),Rs(),Rs();var Jc=new Uint8Array(16);function Yc(){if(!Xc&&!(Xc="undefined"!==typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!==typeof msCrypto&&"function"===typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Xc(Jc)}Rs(),Rs(),Rs();var Zc=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;var eu=function(e){return"string"===typeof e&&Zc.test(e)},tu=[];for(yl=0;yl<256;++yl)tu.push((yl+256).toString(16).substr(1));var nu=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(tu[e[t+0]]+tu[e[t+1]]+tu[e[t+2]]+tu[e[t+3]]+"-"+tu[e[t+4]]+tu[e[t+5]]+"-"+tu[e[t+6]]+tu[e[t+7]]+"-"+tu[e[t+8]]+tu[e[t+9]]+"-"+tu[e[t+10]]+tu[e[t+11]]+tu[e[t+12]]+tu[e[t+13]]+tu[e[t+14]]+tu[e[t+15]]).toLowerCase();if(!eu(n))throw TypeError("Stringified UUID is invalid");return n};Rs();var ru=function(e,t,n){var r=(e=e||{}).random||(e.rng||Yc)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t){n=n||0;for(var a=0;a<16;++a)t[n+a]=r[a];return t}return nu(r)};function au(e){this.message=e}Rs(),Rs(),au.prototype=new Error,au.prototype.name="InvalidCharacterError";var iu="undefined"!=typeof window&&window.atob&&window.atob.bind(window)||function(e){var t=String(e).replace(/=+$/,"");if(t.length%4==1)throw new au("'atob' failed: The string to be decoded is not correctly encoded.");for(var n,r,a=0,i=0,s="";r=t.charAt(i++);~r&&(n=a%4?64*n+r:r,a++%4)?s+=String.fromCharCode(255&n>>(-2*a&6)):0)r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(r);return s};function su(e){this.message=e}su.prototype=new Error,su.prototype.name="InvalidTokenError";var ou=function(e,t){if("string"!=typeof e)throw new su("Invalid token specified");var n=!0===(t=t||{}).header?0:1;try{return JSON.parse(function(e){var t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw"Illegal base64url string!"}try{return decodeURIComponent(iu(t).replace(/(.)/g,(function(e,t){var n=t.charCodeAt(0).toString(16).toUpperCase();return n.length<2&&(n="0"+n),"%"+n})))}catch(n){return iu(t)}}(e.split(".")[n]))}catch(r){throw new su("Invalid token specified: "+r.message)}},cu=xs(ao()),uu=function(){function e(t){St(this,e),Object.assign(this,t)}return Pt(e,[{key:"encode",value:function(e){return this.tokenString=(0,cu.default)({jti:this.jti,iat:this.iat,exp:this.exp,scope:this.scope},e),this.tokenString}}],[{key:"Decode",value:function(t){try{var n=new e(ou(t));return n.tokenString=t,n}catch(r){throw new rc({type:"invalidParameter",message:"failed to decode token",payload:r})}}}]),e}();Rs(),Rs(),Rs(),Rs(),Rs();var lu=function(){function e(){St(this,e),this._onContextAttached=new Jo}return Pt(e,[{key:"_attachContext",value:function(e){this._context=e,this._onContextAttached.emit(e)}}]),e}();Rs();var du=new tc("packages/core/src/plugin/internal/person/connection/messageBuffer.ts"),pu=function(){function e(t){var n=this;St(this,e),this.messaging=t,this._indicateMessageBuffer={},this._excludeConnectionIndicateBuffering=new Set;var r=this.messaging.onIndicated.addListener((function(e){var t=e.src.id+e.src.name;n._excludeConnectionIndicateBuffering.has(t)||(n._indicateMessageBuffer[t]||(n._indicateMessageBuffer[t]=[]),n._indicateMessageBuffer[t].push(e))})).removeListener;this._disposer=r}return Pt(e,[{key:"resolveMessagingBuffer",value:function(e){var t=this,n=e.id+e.name,r=this._indicateMessageBuffer[n];(null==r?void 0:r.length)>0&&(du.debug("resolveMessagingBuffer",{length:r.length}),r.forEach((function(e){t.messaging.onIndicated.emit(e)})),delete this._indicateMessageBuffer[n]),this._excludeConnectionIndicateBuffering.add(n)}},{key:"close",value:function(){this._disposer(),this._indicateMessageBuffer={},this._excludeConnectionIndicateBuffering=new Set}}]),e}();Rs(),Rs();var fu=function(){function e(t){St(this,e),this._status="joined",this._events=new Yo,this.onLeft=this._events.make(),this.onMetadataUpdated=this._events.make(),this.channel=t.channel,this.id=t.id,this.name=t.name,this._metadata=t.metadata}return Pt(e,[{key:"metadata",get:function(){return this._metadata}},{key:"status",get:function(){return this._status}},{key:"publications",get:function(){var e=this;return this.channel.publications.filter((function(t){return t.publisher.id===e.id}))}},{key:"subscriptions",get:function(){var e=this;return this.channel.subscriptions.filter((function(t){return t.subscriber.id===e.id}))}},{key:"toJSON",value:function(){return{id:this.id,name:this.name,type:this.type,subtype:this.subtype,metadata:this.metadata}}},{key:"_left",value:function(){this._status="left",this.onLeft.emit(),this._events.dispose()}},{key:"_metadataUpdated",value:function(e){this._metadata=e,this.onMetadataUpdated.emit(e)}},{key:"updateMetadata",value:function(e){return Ss(this,null,wr().mark((function t(){return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.channel._updateMemberMetadata(this.id,e);case 2:case"end":return t.stop()}}),t,this)})))}}]),e}();Rs(),Rs();var hu=xs(co());function mu(e,t){var n;if(void 0===(null==(n=null!=e?e:{})?void 0:n.srcObject))throw new rc({type:"invalidType",message:"invalid element was passed",payload:{element:e}});e.srcObject?e.srcObject.addTrack(t):e.srcObject=new MediaStream([t])}function vu(e,t){var n;if(void 0===(null==(n=null!=e?e:{})?void 0:n.srcObject))throw new rc({type:"invalidType",message:"invalid element was passed",payload:{element:e}});var r=e.srcObject;r.getTracks().length>0&&r.removeTrack(t),0===r.getTracks().length&&(e.srcObject=null)}Rs(),Rs(),Rs(),Rs();var gu,bu=Pt((function e(t,n,r){St(this,e),this.id=t,this.label=n,this.contentType=r,this.side="remote"})),yu=function(e){mn(n,e);var t=_n(n);function n(e,r,a){var i;return St(this,n),(i=t.call(this,e,r,"audio")).track=a,i.contentType="audio",i}return Pt(n,[{key:"attach",value:function(e){this._element=e,mu(e,this.track)}},{key:"detach",value:function(){this._element&&(vu(this._element,this.track),this._element=void 0)}}]),n}(bu);Rs(),Rs(),Rs(),Rs(),Rs();var _u=new Uint8Array(16);function wu(){if(!gu&&!(gu="undefined"!==typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!==typeof msCrypto&&"function"===typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return gu(_u)}Rs(),Rs(),Rs();var ku=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;var xu=function(e){return"string"===typeof e&&ku.test(e)},Su=[];for(yl=0;yl<256;++yl)Su.push((yl+256).toString(16).substr(1));var Ru=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(Su[e[t+0]]+Su[e[t+1]]+Su[e[t+2]]+Su[e[t+3]]+"-"+Su[e[t+4]]+Su[e[t+5]]+"-"+Su[e[t+6]]+Su[e[t+7]]+"-"+Su[e[t+8]]+Su[e[t+9]]+"-"+Su[e[t+10]]+Su[e[t+11]]+Su[e[t+12]]+Su[e[t+13]]+Su[e[t+14]]+Su[e[t+15]]).toLowerCase();if(!xu(n))throw TypeError("Stringified UUID is invalid");return n};Rs();var Pu=function(e,t,n){var r=(e=e||{}).random||(e.rng||wu)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t){n=n||0;for(var a=0;a<16;++a)t[n+a]=r[a];return t}return Ru(r)},Cu=function(){function e(t,n){St(this,e),this.label=t,this.contentType=n,this.side="local",this.id=Pu(),this._muted=!1,this._onMuted=new Jo,this._onUnmuted=new Jo}return Pt(e,[{key:"muted",get:function(){return this._muted}},{key:"mute",value:function(){this.muted||(this._muted=!0,this._onMuted.emit())}},{key:"unmute",value:function(){this.muted&&(this._muted=!1,this._onUnmuted.emit())}}]),e}(),Tu=function(e){mn(n,e);var t=_n(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return St(this,n),(e=t.call(this,"datachannel","data"))._options=r,e.contentType="data",e._onWriteData=new Jo,e}return Pt(n,[{key:"write",value:function(e){ArrayBuffer.isView(e)||"string"===typeof e||(e=Eu+JSON.stringify(e)),this._onWriteData.emit(e)}}]),n}(Cu),Eu="skyway_object:",Ou=function(e){mn(n,e);var t=_n(n);function n(e,r,a){var i;return St(this,n),(i=t.call(this,e,r,"data"))._datachannel=a,i.contentType="data",i.onData=new Jo,a.onmessage=function(e){var t=e.data;"string"===typeof t&&t.includes(Eu)&&(t=JSON.parse(t.slice(Eu.length))),i.onData.emit(t)},i}return Pt(n)}(bu);Rs();var Mu=function(e){mn(n,e);var t=_n(n);function n(e,r,a){var i;return St(this,n),(i=t.call(this,e,r,"video")).track=a,i.contentType="video",i}return Pt(n,[{key:"attach",value:function(e){this._element=e,mu(e,this.track)}},{key:"detach",value:function(){this._element&&(vu(this._element,this.track),this._element=void 0)}}]),n}(bu),Iu=function(e,t,n,r){if(n instanceof RTCDataChannel){var a=new Ou(e,t,n);return a.codec=r,a}if("audio"===n.kind){var i=new yu(e,t,n);return i.codec=r,i}if("video"===n.kind){var s=new Mu(e,t,n);return s.codec=r,s}throw new rc({type:"notImplemented",message:"invalid stream type"})};Rs();var Du=function(){function e(t,n,r){St(this,e),this.publicationId=t,this.streamId=n,this.label=r}return Pt(e,[{key:"toLabel",value:function(){return JSON.stringify({p:this.publicationId,s:this.streamId,l:this.label})}}],[{key:"fromLabel",value:function(t){var n=JSON.parse(t);return new e(n.p,n.s,n.l)}}]),e}();Rs();var ju=new tc("src/core/dataPlane/peerConnection/peer.ts"),Lu=function(){function e(t,n,r,a,i,s){var o,c=this;St(this,e),this._context=t,this._iceManager=n,this.messenger=r,this.localPersonId=a,this.endpoint=i,this.role=s,this._pendingCandidates=[],this.pc=new RTCPeerConnection(ws(_s({},this._context.config.rtcConfig),{iceTransportPolicy:"turnOnly"===this._context.config.rtcConfig.turnPolicy?"relay":void 0,iceServers:this._iceManager.iceServers})),this.onSignalingStateChanged=new Jo,this.onConnectionStateChanged=new Jo,this.onDisconnect=new Jo,this.connected=!1,this.disconnected=!1,this._onICECandidate=function(e){return Ss(c,null,wr().mark((function t(){var n;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null!=e.candidate&&"closed"!==this.pc.connectionState){t.next=2;break}return t.abrupt("return");case 2:n={type:"p2pMessage",kind:"iceCandidateMessage",payload:{candidate:e.candidate,role:this.role}},this.messenger.indicate(this.endpoint,n).catch((function(e){return ju.error("failed to send candidate",e)})),ju.debug("[".concat(this.localPersonId,"] send candidate"));case 5:case"end":return t.stop()}}),t,this)})))},this._onConnectionStateChange=function(){return Ss(c,null,wr().mark((function e(){var t;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.pc.connectionState,ju.debug("_onConnectionStateChange",this.localPersonId,t),e.t0=t,e.next="connected"===e.t0?5:"failed"===e.t0?8:"disconnected"===e.t0?10:16;break;case 5:return this.connected=!0,this._pendingCandidates=[],e.abrupt("break",16);case 8:return ju.warn("ice failed",{localPersonId:this.localPersonId,endpointId:this.endpoint.id}),e.abrupt("break",16);case 10:return e.next=12,new Promise((function(e){return setTimeout(e,5e3)}));case 12:if(["disconnected","failed"].includes(this.pc.connectionState)&&"closed"!==this.pc.connectionState){e.next=14;break}return e.abrupt("return");case 14:return ju.warn("ice disconnected",{localPersonId:this.localPersonId,endpointId:this.endpoint.id}),e.abrupt("break",16);case 16:this.onConnectionStateChanged.emit(this.pc.connectionState);case 17:case"end":return e.stop()}}),e,this)})))},this.waitForSignalingState=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e4;return Ss(c,null,wr().mark((function n(){var r=this;return wr().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(this.pc.signalingState!==e){n.next=2;break}return n.abrupt("return");case 2:return n.next=4,this.onSignalingStateChanged.watch((function(){return r.pc.signalingState===e}),t).catch((function(e){return ju.warn("signalingState timeout",e)}));case 4:case"end":return n.stop()}}),n,this)})))},this.waitForConnectionState=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e4;return Ss(c,null,wr().mark((function n(){var r=this;return wr().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!e.includes(this.pc.connectionState)){n.next=2;break}return n.abrupt("return");case 2:return n.next=4,this.onConnectionStateChanged.watch((function(){return e.includes(r.pc.connectionState)}),t).catch((function(e){return ju.warn("connectionState timeout",e)}));case 4:case"end":return n.stop()}}),n,this)})))},this.waitForStats=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:100,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1e4;return Ss(c,null,wr().mark((function a(){var i,s,o=this;return wr().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:i=wr().mark((function a(i){var s,c;return wr().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(!(i>=r)){a.next=2;break}throw new rc({type:"timeout",message:"waitForStats"});case 2:return a.next=4,o.pc.getStats(e);case 4:if(s=a.sent,c=[],s.forEach((function(e){c.push(JSON.parse(JSON.stringify(e)))})),!t(c)){a.next=9;break}return a.abrupt("return","break");case 9:return a.next=11,new Promise((function(e){return setTimeout(e,n)}));case 11:case"end":return a.stop()}}),a)})),s=0;case 2:return a.delegateYield(i(s),"t0",3);case 3:if("break"!==a.t0){a.next=6;break}return a.abrupt("break",9);case 6:s+=n,a.next=2;break;case 9:case"end":return a.stop()}}),a)})))},this.setPeerConnectionListener();var u=null==(o=this.pc)?void 0:o.peerIdentity;u&&u.catch((function(e){ju.debug("firefox peerIdentity",e)}))}return Pt(e,[{key:"setPeerConnectionListener",value:function(){var e=this;this.pc.onicecandidate=this._onICECandidate,this.pc.onconnectionstatechange=this._onConnectionStateChange,this.pc.onsignalingstatechange=function(){return e.onSignalingStateChanged.emit(e.pc.signalingState)}}},{key:"unSetPeerConnectionListener",value:function(){this.pc.onicecandidate=null,this.pc.onconnectionstatechange=null,this.pc.onsignalingstatechange=null}},{key:"handleCandidate",value:function(e){return Ss(this,null,wr().mark((function t(){return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._pendingCandidates.push(e),!this.pc.remoteDescription){t.next=4;break}return t.next=4,this.resolveCandidates();case 4:case"end":return t.stop()}}),t,this)})))}},{key:"resolveCandidates",value:function(){return Ss(this,null,wr().mark((function e(){var t,n=this;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=xt(this._pendingCandidates),this._pendingCandidates=[],e.next=4,Promise.all(t.map((function(e){"closed"!==n.pc.signalingState&&(ju.debug("addIcecandidate",e),n.pc.addIceCandidate(e).catch((function(e){ju.warn("failed to add ice candidate",{localPersonId:n.localPersonId,endpointId:n.endpoint.id,err:e})})))})));case 4:case"end":return e.stop()}}),e,this)})))}}]),e}(),Au=new tc("packages/core/src/plugin/internal/person/connection/receiver.ts"),Fu=function(e){mn(n,e);var t=_n(n);function n(e,r,a,i,s){var o;return St(this,n),(o=t.call(this,e,r,a,i,s,"receiver")).onStreamAdded=new Jo,o._publicationInfo={},o.streams={},o._subscriptions={},o._promiseQueue=new oc,o.onError=new Jo,o.messenger.onIndicated.add((function(e){return Ss(bn(o),[e],wr().mark((function e(t){var n,r,a,i,o,c,u=this;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.src,r=t.data,n.id===s.id&&n.name===s.name){e.next=3;break}return e.abrupt("return");case 3:a=r,e.t0=a.kind,e.next="senderProduceMessage"===e.t0?7:"senderUnproduceMessage"===e.t0?9:"iceCandidateMessage"===e.t0?11:14;break;case 7:return this._promiseQueue.push((function(){return u._handleSenderProduce(a.payload)})).catch((function(e){return Au.error("handle senderProduceMessage failed",{localPersonId:u.localPersonId,endpointId:u.endpoint.id,err:e})})),e.abrupt("break",14);case 9:return this._promiseQueue.push((function(){return u._handleSenderUnproduce(a.payload)})).catch((function(e){return Au.error("handle handleSenderUnproduce",{localPersonId:u.localPersonId,endpointId:u.endpoint.id,err:e})})),e.abrupt("break",14);case 11:return i=a.payload,o=i.role,c=i.candidate,"sender"===o&&this.handleCandidate(c).catch((function(e){return Au.warn("handle iceCandidateMessage",{localPersonId:u.localPersonId,endpointId:u.endpoint.id,err:e})})),e.abrupt("break",14);case 14:case"end":return e.stop()}}),e,this)})))})),o.pc.ontrack=function(e){var t=e.track,n=e.transceiver;if(!n.mid)throw new rc({type:"parameterMissing",message:"mid missing"});var r=Object.values(o._publicationInfo).find((function(e){var t;return e.mid===(null==(t=n.mid)?void 0:t.toString())}));if(r){var a=hu.parse(o.pc.remoteDescription.sdp),i=o._getCodecFromSdp(a,n,t.kind),s=Iu(r.streamId,r.label,t,i);s.codec=i,o.streams[r.publicationId]=s,Au.debug("MediaStreamTrack added",r,t,i),o.onStreamAdded.emit({publicationId:r.publicationId,stream:s})}else Au.error("info not exist",{localPersonId:o.localPersonId,endpointId:o.endpoint.id,publicationInfo:o._publicationInfo,mid:n.mid})},o.pc.ondatachannel=function(e){var t=e.channel,n=Du.fromLabel(t.label),r=n.publicationId,a=n.label,i=n.streamId,s={mimeType:"datachannel"},c=Iu(i,a,t,s);o.streams[r]=c,Au.debug("DataChannel added",r,t,s),o.onStreamAdded.emit({publicationId:r,stream:c})},o}return Pt(n,[{key:"_getCodecFromSdp",value:function(e,t,n){var r=e.media.find((function(e){var n,r;return(null==(n=e.mid)?void 0:n.toString())===(null==(r=t.mid)?void 0:r.toString())}));if(!r)throw new rc({type:"notFound",message:"m-line not exist"});var a=r.payloads.split(" ")[0],i=r.rtp.find((function(e){return e.payload.toString()===a})),o="".concat(n,"/").concat(i.codec),c={},u=r.fmtp.find((function(e){return e.payload.toString()===a}));if(null==u?void 0:u.config){var l,d=kr(u.config.split(";"));try{for(d.s();!(l=d.n()).done;){var p=s(l.value.split("="),2),f=p[0],h=p[1];c[f]=h}}catch(m){d.e(m)}finally{d.f()}}return{mimeType:o,parameters:c}}},{key:"hasMedia",get:function(){return Object.values(this.streams).length>0}},{key:"close",value:function(){Au.debug("close receiver",this.localPersonId,this.endpoint.id),this.unSetPeerConnectionListener(),this.pc.close()}},{key:"add",value:function(e){this._subscriptions[e.id]=e}},{key:"remove",value:function(e){var t=this._subscriptions[e];if(t){delete this._subscriptions[t.id];var n=t.publication.id;this.streams[n]&&delete this.streams[n]}}},{key:"_validateRemoteOffer",value:function(e){var t,n=this,r=kr(hu.parse(e).media);try{var a=function(){var e=t.value,r=Object.values(n._publicationInfo).find((function(t){var n;return t.mid===(null==(n=e.mid)?void 0:n.toString())}));if(!r){var a=new rc({type:"invalidParameter",message:"mismatch between sdp and state",payload:{media:e,info:n._publicationInfo}});throw n.onError.emit(a),a}};for(r.s();!(t=r.n()).done;)a()}catch(i){r.e(i)}finally{r.f()}}},{key:"_handleSenderProduce",value:function(e){return Ss(this,arguments,wr().mark((function e(t){var n,r,a;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.sdp,r=t.publicationId,a=t.info,"closed"!==this.pc.signalingState){e.next=4;break}return Au.debug("pc already closed"),e.abrupt("return");case 4:if("stable"===this.pc.signalingState){e.next=14;break}if(!("have-local-offer"===this.pc.signalingState&&this.pc.remoteDescription||"have-remote-offer"===this.pc.signalingState)){e.next=12;break}return Au.warn("wait for be stable",{localPersonId:this.localPersonId,endpointId:this.endpoint.id}),e.next=9,this.waitForSignalingState("stable");case 9:return e.next=11,this._handleSenderProduce({sdp:n,publicationId:r,info:a});case 11:return e.abrupt("return");case 12:return Au.warn("something wrong",{localPersonId:this.localPersonId,endpointId:this.endpoint.id,signalingState:this.pc.signalingState}),e.abrupt("return");case 14:return Au.debug("handle info",a,Object.keys(this._publicationInfo)),this._publicationInfo[a.publicationId]=a,this._validateRemoteOffer(n.sdp),e.next=19,this.sendAnswer(n);case 19:return e.next=21,this.resolveCandidates();case 21:case"end":return e.stop()}}),e,this)})))}},{key:"_handleSenderUnproduce",value:function(e){return Ss(this,arguments,wr().mark((function e(t){var n,r;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.sdp,r=t.publicationId,"closed"!==this.pc.signalingState){e.next=3;break}return e.abrupt("return");case 3:if("stable"===this.pc.signalingState){e.next=12;break}if(!("have-local-offer"===this.pc.signalingState&&this.pc.remoteDescription||"have-remote-offer"===this.pc.signalingState)){e.next=11;break}return Au.warn("wait for be stable"),e.next=8,this.waitForSignalingState("stable");case 8:return e.next=10,this._handleSenderUnproduce({sdp:n,publicationId:r});case 10:case 11:return e.abrupt("return");case 12:return delete this._publicationInfo[r],e.next=15,this.sendAnswer(n);case 15:return e.next=17,this.resolveCandidates();case 17:case"end":return e.stop()}}),e,this)})))}},{key:"sendAnswer",value:function(e){return Ss(this,null,wr().mark((function t(){var n,r,a=this;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return Au.debug("[receiver] start: _answer()"),t.next=3,this.pc.setRemoteDescription(e);case 3:return t.next=5,this.pc.createAnswer();case 5:return n=t.sent,t.next=8,this.pc.setLocalDescription(n);case 8:return r={type:"p2pMessage",kind:"receiverAnswerMessage",payload:{sdp:this.pc.localDescription}},t.next=11,this.messenger.indicate(this.endpoint,r).catch((function(e){return Au.error("failed to send answer",{localPersonId:a.localPersonId,endpointId:a.endpoint.id,e:e})}));case 11:Au.debug("[receiver] end: _answer()");case 12:case"end":return t.stop()}}),t,this)})))}}]),n}(Lu);Rs();var Nu=xs(co());Rs();var Bu=xs(Xo()),Uu=function(e,t){return Ss(void 0,null,wr().mark((function n(){var r;return wr().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return void 0==(r=e.getParameters()).encodings&&(r.encodings=[]),r.encodings=t.map((function(e,t){return _s(_s({},r.encodings[t]||{}),e)})),n.next=5,e.setParameters(r);case 5:case"end":return n.stop()}}),n)})))},zu=new tc("packages/core/src/plugin/internal/person/connection/sender.ts"),Vu=function(e){mn(n,e);var t=_n(n);function n(e,r,a,i,s){var o;return St(this,n),(o=t.call(this,e,r,a,i,s,"sender")).publications={},o.transceivers={},o.datachannels={},o._pendingPublications=[],o._isNegotiating=!1,o.promiseQueue=new oc,o.disposer=[],o._ms=new MediaStream,o.messenger.onIndicated.add((function(e){return Ss(bn(o),[e],wr().mark((function e(t){var n,r,a,i,o,c,u=this;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.src,r=t.data,n.id===s.id&&n.name===s.name){e.next=3;break}return e.abrupt("return");case 3:a=r,e.t0=a.kind,e.next="receiverAnswerMessage"===e.t0?7:"iceCandidateMessage"===e.t0?9:12;break;case 7:return this.promiseQueue.push((function(){return u._handleReceiverAnswer(a.payload)})).catch((function(e){return zu.error("handle receiverAnswerMessage",{localPersonId:u.localPersonId,endpointId:u.endpoint.id,err:e})})),e.abrupt("break",12);case 9:return i=a.payload,o=i.role,c=i.candidate,"receiver"===o&&this.handleCandidate(c).catch((function(e){return zu.warn("handle iceCandidateMessage",{localPersonId:u.localPersonId,endpointId:u.endpoint.id,err:e})})),e.abrupt("break",12);case 12:case"end":return e.stop()}}),e,this)})))})),o}return Pt(n,[{key:"hasMedia",get:function(){return Object.values(this.datachannels).length>0||Object.values(this.transceivers).length>0}},{key:"_getMid",value:function(e,t){if("data"===e.contentType){var n=t.media.find((function(e){return"application"===e.type}));if(void 0==(null==n?void 0:n.mid))throw new rc({type:"parameterMissing",message:"datachannel mid undefined"});return n.mid.toString()}var r=this.transceivers[e.id].mid;if(void 0==r)throw new rc({type:"parameterMissing",message:"media mid undefined"});return r.toString()}},{key:"add",value:function(e){return Ss(this,null,wr().mark((function t(){var n,r,a,i,s,o,c,u,l,d,p,f,h=this;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this._isNegotiating&&"stable"===this.pc.signalingState){t.next=4;break}return this._pendingPublications.push(e),zu.debug("isNegotiating",{publication:e,isNegotiating:this._isNegotiating,signalingState:this.pc.signalingState}),t.abrupt("return");case 4:if(this._isNegotiating=!0,zu.debug("add publication",{publication:e}),this.publications[e.id]=e,a=e.stream){t.next=10;break}throw new rc({type:"notFound",message:"stream not found"});case 10:return"data"===a.contentType?(i=this.pc.createDataChannel(new Du(e.id,a.id,a.label).toLabel(),a._options),this.disposer=[].concat(xt(this.disposer),[a._onWriteData.add((function(e){"open"===i.readyState&&i.send(e)})).removeListener]),this.datachannels[e.id]=i):(this.disposer=[].concat(xt(this.disposer),[a._onReplaceTrack.add((function(t){return Ss(h,null,wr().mark((function n(){return wr().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this._replaceTrack(e.id,t.clone());case 2:case"end":return n.stop()}}),n,this)})))})).removeListener,a._onMuted.add((function(){return Ss(h,null,wr().mark((function t(){return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._replaceTrack(e.id,a._mutedTrack.clone());case 2:case"end":return t.stop()}}),t,this)})))})).removeListener,a._onUnmuted.add((function(){return Ss(h,null,wr().mark((function t(){return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._replaceTrack(e.id,a.track.clone());case 2:case"end":return t.stop()}}),t,this)})))})).removeListener]),s=a.muted?a._mutedTrack.clone():a.track.clone(),o=this.pc.addTransceiver(s,{direction:"sendonly",streams:[this._ms]}),e._onEncodingsChanged.add((function(e){return Ss(h,null,wr().mark((function t(){return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Uu(o.sender,e).catch((function(e){zu.error("_onEncodingsChanged failed",e)}));case 2:case"end":return t.stop()}}),t)})))})),this.transceivers[e.id]=o),t.next=13,this.pc.createOffer().catch((function(e){throw new rc({type:"internalError",message:"can't create offer",payload:e})}));case 13:return c=t.sent,t.next=16,this.pc.setLocalDescription(c);case 16:if(u=Nu.parse(this.pc.localDescription.sdp),l=this._getMid(e,u),"data"===e.contentType){t.next=31;break}return Hu(null!=(n=e.codecCapabilities)?n:[],l,u),d=Nu.write(u),t.next=23,this.pc.setLocalDescription({type:"offer",sdp:d});case 23:if(!((null==(r=e.encodings)?void 0:r.length)>0)){t.next=31;break}if("Safari12"!==(0,Bu.detectDevice)()&&"Safari11"!==(0,Bu.detectDevice)()){t.next=28;break}this._safariSetupEncoding(e),t.next=31;break;case 28:return p=this.transceivers[e.id],t.next=31,Uu(p.sender,e.encodings);case 31:return f={type:"p2pMessage",kind:"senderProduceMessage",payload:{sdp:this.pc.localDescription,publicationId:e.id,info:{publicationId:e.id,streamId:a.id,label:a.label,mid:l}}},t.next=34,this.messenger.indicate(this.endpoint,f).catch((function(e){return zu.error("in remote error :",{localPersonId:h.localPersonId,endpointId:h.endpoint.id,error:e})}));case 34:case"end":return t.stop()}}),t,this)})))}},{key:"remove",value:function(e){return Ss(this,null,wr().mark((function t(){var n,r,a,i,s=this;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this._isNegotiating&&"stable"===this.pc.signalingState){t.next=4;break}return this._pendingPublications.push(e),zu.debug("isNegotiating",{publicationId:e,_isNegotiating:this._isNegotiating,signalingState:this.pc.signalingState}),t.abrupt("return");case 4:if(this._isNegotiating=!0,n=this.publications[e]){t.next=9;break}return zu.warn("publication not found",{publicationId:e}),t.abrupt("return");case 9:if(delete this.publications[e],r=n.stream){t.next=13;break}throw new rc({type:"notFound",message:"publication not have stream",payload:n});case 13:return"data"===r.contentType?(this.datachannels[e].close(),delete this.datachannels[e]):(this.transceivers[e].stop(),delete this.transceivers[e]),t.next=16,this.pc.createOffer().catch((function(e){throw new rc({type:"internalError",message:"can't create offer",payload:e})}));case 16:return a=t.sent,t.next=19,this.pc.setLocalDescription(a);case 19:return i={type:"p2pMessage",kind:"senderUnproduceMessage",payload:{sdp:this.pc.localDescription,publicationId:e}},t.next=22,this.messenger.indicate(this.endpoint,i).catch((function(e){return zu.error("in remote error :",{localPersonId:s.localPersonId,endpointId:s.endpoint.id,error:e})}));case 22:case"end":return t.stop()}}),t,this)})))}},{key:"_replaceTrack",value:function(e,t){return Ss(this,null,wr().mark((function n(){var r;return wr().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(r=this.transceivers[e]){n.next=4;break}return zu.warn("can't replace track, transceiver not found",{publicationId:e}),n.abrupt("return");case 4:return n.next=6,r.sender.replaceTrack(t);case 6:case"end":return n.stop()}}),n,this)})))}},{key:"_handleReceiverAnswer",value:function(e){return Ss(this,arguments,wr().mark((function e(t){var n,r=this;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.sdp,"closed"!==this.pc.signalingState){e.next=3;break}return e.abrupt("return");case 3:return zu.debug("_handleReceiverAnswer"),e.next=6,this.pc.setRemoteDescription(new RTCSessionDescription(n)).catch((function(e){throw zu.error("sRD failed",{localPersonId:r.localPersonId,endpointId:r.endpoint.id,sdp:n}),e}));case 6:return e.next=8,this.resolveCandidates();case 8:return e.next=10,this.waitForSignalingState("stable");case 10:return this._isNegotiating=!1,e.next=13,this._resolvePendingSender();case 13:case"end":return e.stop()}}),e,this)})))}},{key:"_safariSetupEncoding",value:function(e){var t=this.transceivers[e.id],n=e.stream;this.waitForStats(n.track,(function(e){var t=e.find((function(e){return e.id.includes("RTCOutboundRTP")}));return(null==t?void 0:t.keyFramesEncoded)>0}),10,this._context.config.rtcConfig.timeout).then((function(){Uu(t.sender,e.encodings).catch((function(e){zu.error("setEncodingParams failed",e)}))})).catch((function(e){zu.error("waitForStats",e)}))}},{key:"_resolvePendingSender",value:function(){return Ss(this,null,wr().mark((function e(){var t;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this._pendingPublications.shift()){e.next=3;break}return e.abrupt("return");case 3:if(zu.debug("resolve pending sender",{publication:t}),"string"!==typeof t){e.next=9;break}return e.next=7,this.remove(t);case 7:e.next=11;break;case 9:return e.next=11,this.add(t);case 11:case"end":return e.stop()}}),e,this)})))}},{key:"close",value:function(){zu.debug("close sender",{localPersonId:this.localPersonId,endpointId:this.endpoint.id}),this.unSetPeerConnectionListener(),this.disposer.forEach((function(e){return e()})),this.disposer=[],this.pc.close()}}]),n}(Lu);function Hu(e,t,n){var r,a,i=e.map((function(t){if(!t.mimeType.includes("/"))throw new rc({type:"invalidParameter",message:"invalid mimeType format",payload:e});var n=s(t.mimeType.split("/"),2)[1];if(!n)throw new rc({type:"invalidParameter",message:"codecName not found in mimeType",payload:e});return ws(_s({},t),{codecName:n.toLowerCase()})})),o=n.media.find((function(e){var n;return(null==(n=e.mid)?void 0:n.toString())===t}));if(!o)throw new rc({type:"notFound",message:"media not found"});var c=o.rtp.filter((function(e){return!!i.map((function(e){return e.codecName})).includes(e.codec.toLowerCase())})),u=[].concat(xt(c),xt(o.rtp.filter((function(e){return!i.map((function(e){return e.codecName})).includes(e.codec.toLowerCase())})))),l=u.find((function(e){return"opus"===e.codec.toLowerCase()})),d=null==(a=null==(r=i.find((function(e){return"opus"===e.codecName})))?void 0:r.parameters)?void 0:a.usedtx;o.fmtp.forEach((function(e){l&&e.payload===l.payload&&!1!==d&&(e.config.length>0?e.config+=";usedtx=1":e.config="usedtx=1")})),o.payloads=u.map((function(e){return e.payload.toString()})).join(" ")}var Wu=new tc("packages/core/src/plugin/internal/person/connection/index.ts"),qu=function(){function e(t,n,r,a,i,s){var o=this;St(this,e),this._iceManager=t,this._messenger=n,this._context=r,this.channelId=a,this.localPerson=i,this.remoteMember=s,this.type="p2p",this.onDisconnect=new Jo,this.onClose=new Jo,this.closed=!1,this.disconnected=!1,this.sender=new Vu(this._context,this._iceManager,this._messenger,this.localPerson.id,this.remoteMember),this.receiver=new Fu(this._context,this._iceManager,this._messenger,this.localPerson.id,this.remoteMember),this.sender.onDisconnect.once((function(){o.disconnected=!0,o.onDisconnect.emit()})),this.receiver.onDisconnect.once((function(){o.disconnected=!0,o.onDisconnect.emit()}))}return Pt(e,[{key:"startPublishing",value:function(e){return Ss(this,null,wr().mark((function t(){return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.sender.add(e);case 2:case"end":return t.stop()}}),t,this)})))}},{key:"stopPublishing",value:function(e){return Ss(this,null,wr().mark((function t(){return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.sender.remove(e.id);case 2:this._closeIfNeeded();case 3:case"end":return t.stop()}}),t,this)})))}},{key:"startSubscribing",value:function(e){return Ss(this,null,wr().mark((function t(){var n,r;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.receiver.add(e),n=e.publication.id,r=this.receiver.streams[n]){t.next=7;break}return t.next=6,this.receiver.onStreamAdded.watch((function(e){return e.publicationId===n}),this._context.config.rtcConfig.timeout).catch((function(){throw new rc({type:"timeout",message:"onStreamAdded",payload:{subscription:e}})}));case 6:r=this.receiver.streams[n];case 7:e.codec=r.codec,e.stream=r;case 9:case"end":return t.stop()}}),t,this)})))}},{key:"stopSubscribing",value:function(e){return Ss(this,null,wr().mark((function t(){return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.receiver.remove(e.id),this._closeIfNeeded();case 2:case"end":return t.stop()}}),t,this)})))}},{key:"_closeIfNeeded",value:function(){this.sender.hasMedia||this.receiver.hasMedia||this.close()}},{key:"getStats",value:function(e){return Ss(this,null,wr().mark((function t(){var n;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.stream){t.next=3;break}throw new rc({type:"parameterMissing",message:"Subscription or Publication must has stream"});case 3:if("local"!==n.side){t.next=9;break}if("data"!==n.contentType){t.next=6;break}return t.abrupt("return",this.sender.pc.getStats());case 6:return t.abrupt("return",this.sender.pc.getStats(n.track));case 9:if("data"!==n.contentType){t.next=11;break}return t.abrupt("return",this.receiver.pc.getStats());case 11:return t.abrupt("return",this.receiver.pc.getStats(n.track));case 12:case"end":return t.stop()}}),t,this)})))}},{key:"close",value:function(){this.closed||(this.closed=!0,Wu.debug("closed",{endpointId:this.remoteMember.id}),this.sender.close(),this.receiver.close(),this.onClose.emit())}},{key:"getRTCPeerConnection",value:function(e){return"sender"===e?this.sender.pc:this.receiver.pc}}]),e}();Rs();var Gu=Pt((function e(t,n){var r=this;St(this,e),this._context=t,this.messaging=n,this.onIndicated=new Jo,this.indicateChunkedMessageBuffer={},this.indicateVersion=0,this.indicate=function(e,t){return Ss(r,null,wr().mark((function n(){var r,a,i,s,o,c,u,l,d,p;return wr().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(a=(this.indicateVersion++).toString(),!((i=JSON.stringify(t.payload)).length>10240)){n.next=25;break}s=null!=(r=i.match(/.{1,10240}/g))?r:[],o=0,c=kr(s),n.prev=6,c.s();case 8:if((u=c.n()).done){n.next=15;break}return l=u.value,d={type:t.type,kind:t.kind,length:s.length-1,offset:o++,chunk:l,id:a},n.next=13,this.messaging.indicate({id:e.id,name:e.name},d,this._context.config.rtcConfig.timeout).catch((function(e){throw new rc({type:"internalError",message:"indicate failed",payload:e})}));case 13:n.next=8;break;case 15:n.next=20;break;case 17:n.prev=17,n.t0=n.catch(6),c.e(n.t0);case 20:return n.prev=20,c.f(),n.finish(20);case 23:n.next=28;break;case 25:return p={type:t.type,kind:t.kind,length:0,offset:0,chunk:i,id:a},n.next=28,this.messaging.indicate({id:e.id,name:e.name},p,30).catch((function(e){throw new rc({type:"internalError",message:"indicate failed",payload:e})}));case 28:case"end":return n.stop()}}),n,this,[[6,17,20,23]])})))},n.onIndicated.addListener((function(e){var t,n=e.src,a=e.data;if("p2pMessage"===a.type){var i=a,s=i.type,o=i.kind,c=i.chunk,u=i.length,l=i.offset,d=i.id;if(0===u)r.onIndicated.emit({src:n,data:{type:s,kind:o,payload:JSON.parse(c)}});else if(r.indicateChunkedMessageBuffer[d]=[].concat(xt(null!=(t=r.indicateChunkedMessageBuffer[d])?t:[]),[i.chunk]),u===l){var p=r.indicateChunkedMessageBuffer[d].join("");delete r.indicateChunkedMessageBuffer[d],r.onIndicated.emit({src:n,data:{type:s,kind:o,payload:JSON.parse(p)}})}}}))})),Ku=new tc("packages/core/src/plugin/internal/person/member.ts"),Xu=function(e){mn(n,e);var t=_n(n);function n(e){var r;return St(this,n),(r=t.call(this,e)).args=e,r.type="person",r.subtype="person",r.side="remote",r._connections={},r._context=r.args.channel._context,r.onPublicationSubscribed=r._events.make(),r.onPublicationUnsubscribed=r._events.make(),r.subscribe=function(e){return new Promise((function(t,n){var a=!1;r.channel._subscribe(r.id,e).catch((function(e){a=!0,n(e)})),r.onPublicationSubscribed.watch((function(t){return t.subscription.publication.id===e}),r._context.config.rtcApi.timeout).then((function(e){var n=e.subscription;t({subscription:n})})).catch((function(){a||n(new rc({type:"timeout",message:"onPublicationSubscribed"}))}))}))},r.plugin=e.plugin,r.channel.onStreamUnsubscribed.add((function(e){var t=e.subscription;t.subscriber.id===r.id&&r.onPublicationUnsubscribed.emit({subscription:t})})),r.channel.onStreamSubscribed.add((function(e){var t=e.subscription;t.subscriber.id===r.id&&r.onPublicationSubscribed.emit({subscription:t})})),r.onLeft.once((function(){Ku.debug("RemotePerson left: ",{id:r.id}),Object.values(r._connections).forEach((function(e){e.close()})),r._connections={}})),r}return Pt(n,[{key:"_getConnection",value:function(e){return this._connections[e]}},{key:"_getOrCreateConnection",value:function(e){var t;return null!=(t=this._getConnection(e.id))?t:this._createConnection(this.channel,e,this)}},{key:"_createConnection",value:function(e,t,n){var r=this;if("local"!==t.side)throw new rc({type:"invalidParameter",message:"wrong localPerson type"});var a=t._messaging,i=new Gu(this._context,a),s=new qu(t.iceManager,i,this._context,e.id,t,n);return this.plugin.messageBuffers[t.id].resolveMessagingBuffer(n),s.onClose.once((function(){delete r._connections[t.id]})),this._connections[t.id]=s,s}},{key:"unsubscribe",value:function(e){return Ss(this,null,wr().mark((function t(){return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.channel._unsubscribe(e);case 2:case"end":return t.stop()}}),t,this)})))}}]),n}(fu),Qu=function(e){mn(n,e);var t=_n(n);function n(){var e;return St(this,n),(e=t.apply(this,arguments)).subtype="person",e.messageBuffers={},e._whenCreateLocalPerson=function(t){return Ss(bn(e),null,wr().mark((function e(){return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.messageBuffers[t.id]=new pu(t._messaging);case 1:case"end":return e.stop()}}),e,this)})))},e._whenDisposeLocalPerson=function(t){return Ss(bn(e),null,wr().mark((function e(){return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.messageBuffers[t.id].close(),delete this.messageBuffers[t.id];case 3:case"end":return e.stop()}}),e,this)})))},e._createRemoteMember=function(t,n){return new Xu(ws(_s({},e._context),{channel:t,metadata:n.metadata,id:n.id,name:n.name,plugin:bn(e)}))},e}return Pt(n)}(lu);Rs(),Rs(),Rs();var $u=new tc("packages/core/src/plugin/internal/unknown/connection.ts"),Ju=function(){function e(t,n){St(this,e),this.localPerson=t,this.remoteMember=n,this.type="unknown",this.onDisconnect=new Jo,this.onClose=new Jo,this.closed=!1}return Pt(e,[{key:"close",value:function(){this.closed=!0,this.onClose.emit()}},{key:"startPublishing",value:function(e){return Ss(this,null,wr().mark((function t(){return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:$u.debug("this is unknown type connection. should install ".concat(this.remoteMember.subtype," plugin"),{publication:e});case 1:case"end":return t.stop()}}),t,this)})))}},{key:"stopPublishing",value:function(e){return Ss(this,null,wr().mark((function t(){return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:$u.debug("this is unknown type connection. should install ".concat(this.remoteMember.subtype," plugin"),{publication:e});case 1:case"end":return t.stop()}}),t,this)})))}},{key:"startSubscribing",value:function(e){return Ss(this,null,wr().mark((function t(){return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:$u.debug("this is unknown type connection. should install ".concat(this.remoteMember.subtype," plugin"),{subscription:e});case 1:case"end":return t.stop()}}),t,this)})))}},{key:"stopSubscribing",value:function(e){return Ss(this,null,wr().mark((function t(){return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:$u.debug("this is unknown type connection. should install ".concat(this.remoteMember.subtype," plugin"),{subscription:e});case 1:case"end":return t.stop()}}),t,this)})))}}]),e}(),Yu=new tc("packages/core/src/plugin/internal/person/member.ts"),Zu=function(e){mn(n,e);var t=_n(n);function n(e){var r;return St(this,n),(r=t.call(this,e)).type="bot",r.side="remote",r._connections={},r.plugin=e.plugin,r.subtype=e.subtype,Yu.warn("unknown subtype member spawned",e),r}return Pt(n,[{key:"_getConnection",value:function(e){return this._connections[e]}},{key:"_getOrCreateConnection",value:function(e){var t;return null!=(t=this._getConnection(e.id))?t:this._createConnection(e,this)}},{key:"_createConnection",value:function(e,t){return new Ju(e,t)}}]),n}(fu),el=function(e){mn(n,e);var t=_n(n);function n(){var e;return St(this,n),(e=t.apply(this,arguments)).subtype="unknown",e._createRemoteMember=function(t,n){return new Zu(ws(_s({},e._context),{channel:t,metadata:n.metadata,id:n.id,name:n.name,plugin:bn(e),subtype:n.subtype}))},e}return Pt(n)}(lu),tl=new tc("packages/core/src/context.ts"),nl=function(){function e(t,n,r){var a=this;if(St(this,e),this.config=n,this.authToken=r,this.disposed=!1,this.plugins=[],this._unknownPlugin=new el,this._reminderSec=this.config.token.updateReminderSec,this._events=new Yo,this.onTokenUpdateReminder=this._events.make(),this.onTokenExpired=this._events.make(),this.onFatalError=this._events.make(),this._onTokenUpdated=this._events.make(),this._onDisposed=this._events.make(),!r.tokenString)throw new rc({type:"parameterMissing",message:"tokenString is required"});this._authTokenString=r.tokenString,this.appId=this.authToken.scope.app.id,tl.debug("SkyWayContext spawned",{appId:this.appId}),this._setTokenExpireTimer(),function(e){var t=new Qu;e.registerPlugin(t)}(this),this._api=t,this._api.onFatalError.once((function(e){tl.error("onFatalError",{appId:a.appId,error:e}),a.onFatalError.emit(new rc({type:"networkError",message:"There was a problem with the api server",payload:e})),a.dispose()}))}return Pt(e,[{key:"authTokenString",get:function(){return this._authTokenString}},{key:"_setTokenExpireTimer",value:function(){var e=this,t=this.authToken.exp-Date.now()/1e3;if(t<0)throw new rc({type:"invalidParameter",message:"exp is invalid value"});this.tokenUpdateReminderTimer&&clearTimeout(this.tokenUpdateReminderTimer);var n=t-this._reminderSec;if(n<0)throw new rc({type:"invalidParameter",message:"exp is less than the reminder value",payload:{expiresInSec:t,reminderSec:this._reminderSec}});tl.debug({tokenExpireReminderTimeSec:n}),this.tokenUpdateReminderTimer=setTimeout((function(){tl.debug("tokenUpdateReminder",{appid:e.appId}),e.onTokenUpdateReminder.emit()}),1e3*n),this.tokenExpiredTimer&&clearTimeout(this.tokenExpiredTimer),tl.debug({expiresInSec:t}),this.tokenExpiredTimer=setTimeout((function(){tl.debug("tokenExpired",{appid:e.appId}),e.onTokenExpired.emit()}),1e3*t)}},{key:"updateAuthToken",value:function(e){if(this._authTokenString=e,this.authToken=uu.Decode(this._authTokenString),this.authToken.scope.app.id!==this.appId)throw new rc({type:"invalidParameter",message:"appId does not match"});this._api.updateAuthToken(e),this._onTokenUpdated.emit(e),this._setTokenExpireTimer()}},{key:"registerPlugin",value:function(e){this.plugins.find((function(t){return t.subtype===e.subtype}))||(e._attachContext(this),this.plugins.push(e))}},{key:"_createRemoteMember",value:function(e,t){var n=e._getMember(t.id);if(n)return n;tl.debug("createRemoteMember",{memberDto:t}),t.type=t.type.toLowerCase(),t.subtype=t.subtype.toLowerCase();var r=this.plugins.find((function(e){return e.subtype===t.subtype}));return r||(r=this._unknownPlugin,tl.warn("unknown remote member type. plugin not exist. should install ".concat(t.subtype," plugin"),{memberDto:t})),r._createRemoteMember(e,t)}},{key:"dispose",value:function(){this.disposed||(this.disposed=!0,tl.debug("disposed",{appid:this.appId}),this._onDisposed.emit(),this._events.dispose(),this._api.close())}}],[{key:"Create",value:function(t){return Ss(this,arguments,wr().mark((function t(n){var r,a,i,s,o=arguments;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=o.length>1&&void 0!==o[1]?o[1]:{},a=new $c(r),tc.level=a.log.level,tc.format=a.log.format,i=uu.Decode(n),tl.debug("config",a),t.prev=6,t.next=9,zc.Create({appId:i.scope.app.id,token:n,log:a.log,rtcApi:a.rtcApi});case 9:return s=t.sent,t.abrupt("return",new e(s,a,i));case 13:throw t.prev=13,t.t0=t.catch(6),new rc({type:"internalError",message:"create api client failed",payload:{error:t.t0}});case 16:case"end":return t.stop()}}),t,null,[[6,13]])})))}}]),e}();Rs();var rl=new tc("packages/core/src/external/ice.ts"),al=function(){function e(t,n,r,a){St(this,e),this.domain=t,this.version=n,this.secure=r,this.turnPolicy=a,this.stunServers=[],this._endpoint="http".concat(this.secure?"s":"","://").concat(this.domain,"/v").concat(this.version),this.http=new sc(this._endpoint)}return Pt(e,[{key:"setupIceServers",value:function(e,t,n){return Ss(this,null,wr().mark((function r(){var a,i,s,o;return wr().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return a={memberId:t,ttl:n},r.next=3,this.http.post("/ice-params",a,{headers:{authorization:"Bearer ".concat(e)}});case 3:i=r.sent,s=i.turn,o=i.stun,rl.debug("iceServer params",{turn:s,stun:o}),s&&(this.turnServer={credential:s.credential,urls:"turn:".concat(s.domain,":").concat(s.port),username:s.username}),this.stunServers=[{urls:"stun:".concat(o.domain,":").concat(o.port)}];case 9:case"end":return r.stop()}}),r,this)})))}},{key:"iceServers",get:function(){var e=xt(this.stunServers);return"disable"!==this.turnPolicy&&this.turnServer&&e.push(this.turnServer),e}}]),e}();Rs(),Rs(),Rs(),Rs();var il=function(e){mn(n,e);var t=_n(n);function n(e,r){var a;if(St(this,n),(a=t.call(this,e,"audio")).track=r,a.contentType="audio",a._mutedTrack=function(){var e=(new(window.AudioContext||window.webkitAudioContext)).createMediaStreamDestination();return Object.assign(e.stream.getAudioTracks()[0],{enabled:!1})}(),a._onReplaceTrack=new Jo,"audio"!==r.kind)throw new rc({type:"invalidParameter",message:"invalid track kind",payload:{track:r}});return a}return Pt(n,[{key:"attach",value:function(e){this._element=e,mu(e,this.track)}},{key:"detach",value:function(){this._element&&(vu(this._element,this.track),this._element=void 0)}},{key:"replaceTrack",value:function(e){this._onReplaceTrack.emit(e)}},{key:"release",value:function(){this.track.stop()}}]),n}(Cu);Rs(),Rs();var sl=function(e){mn(n,e);var t=_n(n);function n(e,r){var a;if(St(this,n),(a=t.call(this,e,"video")).track=r,a.contentType="video",a._mutedTrack=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.width,n=void 0===t?640:t,r=e.height,a=void 0===r?480:r,i=Object.assign(document.createElement("canvas"),{width:n,height:a});return i.getContext("2d").fillRect(0,0,n,a),i.captureStream().getVideoTracks()[0]}({width:a.track.getSettings().width,height:a.track.getSettings().height}),a._onReplaceTrack=new Jo,"video"!==r.kind)throw new rc({type:"invalidParameter",message:"invalid track kind",payload:{track:r}});return a}return Pt(n,[{key:"attach",value:function(e){this._element=e,mu(e,this.track)}},{key:"detach",value:function(){this._element&&(vu(this._element,this.track),this._element=void 0)}},{key:"replaceTrack",value:function(e){this._onReplaceTrack.emit(e)}},{key:"release",value:function(){this.track.stop()}}]),n}(Cu),ol=function(){function e(){var t=this;if(St(this,e),this.onDeviceChange=new Jo,this._devices=[],!(null==navigator?void 0:navigator.mediaDevices))throw new rc({type:"forbidden",message:"mediaDevices not exist. maybe not under https or localhost or 127.0.0.1 environment"});navigator.mediaDevices.addEventListener("devicechange",(function(){return Ss(t,null,wr().mark((function e(){var t,n,r,a=this;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._enumerateDevicesArray();case 2:t=e.sent,n=[],this._devices.forEach((function(e){t.map((function(e){return e.id})).includes(e.id)||n.push(e)})),r=[],t.map((function(e){return e.id})).forEach((function(e){a._devices.map((function(e){return e.id})).includes(e)||r.push(t.find((function(t){return t.id===e})))})),n.forEach((function(e){a.onDeviceChange.emit({state:"removed",device:e})})),r.forEach((function(e){a.onDeviceChange.emit({state:"added",device:e})})),this._devices=t;case 10:case"end":return e.stop()}}),e,this)})))}))}return Pt(e,[{key:"_enumerateDevicesArray",value:function(){return Ss(this,null,wr().mark((function e(){var t;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,navigator.mediaDevices.enumerateDevices();case 2:return t=e.sent,e.abrupt("return",t.map((function(e){return new ul(e)})).filter((function(e){return e.id.length>0})));case 4:case"end":return e.stop()}}),e)})))}},{key:"_enumerateDevicesWithAuth",value:function(){return Ss(this,arguments,wr().mark((function e(){var t,n,r,a=arguments;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=a.length>0&&void 0!==a[0]?a[0]:{audio:!0,video:!0},n=t.video,r=t.audio,!n&&!r){e.next=4;break}return e.next=4,navigator.mediaDevices.getUserMedia({video:n,audio:r});case 4:return e.next=6,this._enumerateDevicesArray();case 6:return this._devices=e.sent,e.abrupt("return",this._devices);case 8:case"end":return e.stop()}}),e,this)})))}},{key:"enumerateDevices",value:function(){return Ss(this,null,wr().mark((function e(){var t;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._enumerateDevicesWithAuth();case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}}),e,this)})))}},{key:"enumerateInputVideoDevices",value:function(){return Ss(this,null,wr().mark((function e(){var t;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._enumerateDevicesWithAuth({video:!0});case 2:return t=e.sent,e.abrupt("return",t.filter((function(e){return"videoinput"===e.kind})));case 4:case"end":return e.stop()}}),e,this)})))}},{key:"enumerateInputAudioDevices",value:function(){return Ss(this,null,wr().mark((function e(){var t;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._enumerateDevicesWithAuth({audio:!0});case 2:return t=e.sent,e.abrupt("return",t.filter((function(e){return"audioinput"===e.kind})));case 4:case"end":return e.stop()}}),e,this)})))}},{key:"enumerateOutputAudioDevices",value:function(){return Ss(this,null,wr().mark((function e(){var t;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._enumerateDevicesWithAuth({audio:!0});case 2:return t=e.sent,e.abrupt("return",t.filter((function(e){return"audiooutput"===e.kind})));case 4:case"end":return e.stop()}}),e,this)})))}},{key:"createCameraVideoStream",value:function(){return Ss(this,arguments,wr().mark((function e(){var t,n,r,a,i=arguments;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=i.length>0&&void 0!==i[0]?i[0]:{},e.next=3,navigator.mediaDevices.getUserMedia({video:t});case 3:return n=e.sent.getTracks(),r=s(n,1),a=r[0],e.abrupt("return",new sl("camera",a));case 7:case"end":return e.stop()}}),e)})))}},{key:"createMicrophoneAudioStream",value:function(){return Ss(this,arguments,wr().mark((function e(){var t,n,r,a,i=arguments;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=i.length>0&&void 0!==i[0]?i[0]:{},e.next=3,navigator.mediaDevices.getUserMedia({audio:t});case 3:return n=e.sent.getTracks(),r=s(n,1),a=r[0],e.abrupt("return",new il("microphone",a));case 7:case"end":return e.stop()}}),e)})))}},{key:"createDataStream",value:function(){return Ss(this,arguments,wr().mark((function e(){var t,n=arguments;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.length>0&&void 0!==n[0]?n[0]:{},e.abrupt("return",new Tu(t));case 2:case"end":return e.stop()}}),e)})))}},{key:"createMicrophoneAudioAndCameraStream",value:function(){return Ss(this,arguments,wr().mark((function e(){var t,n,r,a,i,o,c,u,l,d,p=arguments;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=p.length>0&&void 0!==p[0]?p[0]:{},n=t.audio,r=t.video,e.next=3,navigator.mediaDevices.getUserMedia({audio:null==n||n,video:null==r||r});case 3:return a=e.sent,i=a.getAudioTracks(),o=s(i,1),c=o[0],u=a.getVideoTracks(),l=s(u,1),d=l[0],e.abrupt("return",{audio:new il("microphone",c),video:new sl("camera",d)});case 7:case"end":return e.stop()}}),e)})))}}]),e}(),cl=new ol,ul=Pt((function e(t){St(this,e),this.id=t.deviceId,this.label=t.label,this.kind=t.kind}));Rs(),Rs(),Rs(),Rs(),Rs();var ll=new tc("packages/core/src/dataPlane/agent/publishing.ts"),dl=function(){function e(t){St(this,e),this._localPerson=t,this.context=this._localPerson.context}return Pt(e,[{key:"startPublishing",value:function(e,t){return Ss(this,null,wr().mark((function n(){var r;return wr().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!this.context.config.debug.disableDPlane){n.next=4;break}return n.next=3,new Promise((function(e){return setTimeout(e,500)}));case 3:return n.abrupt("return");case 4:if(e.stream){n.next=7;break}return n.next=7,this._localPerson.onStreamPublished.watch((function(t){return t.publication.id===e.id}),this.context.config.rtcApi.timeout).catch((function(){throw new rc({type:"timeout",message:"PublishingAgent onStreamPublished",payload:e})}));case 7:if(!(r=t._getOrCreateConnection(this._localPerson)).startPublishing){n.next=11;break}return n.next=11,r.startPublishing(e);case 11:case"end":return n.stop()}}),n,this)})))}},{key:"stopPublishing",value:function(e,t){return Ss(this,null,wr().mark((function n(){var r;return wr().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:(null==(r=t._getConnection(this._localPerson.id))?void 0:r.stopPublishing)&&r.stopPublishing(e).catch((function(e){ll.error("stopPublishing failed",e)}));case 2:case"end":return n.stop()}}),n,this)})))}}]),e}();Rs();var pl=function(){function e(t){St(this,e),this._localPerson=t,this._context=this._localPerson.context}return Pt(e,[{key:"startSubscribing",value:function(e){return Ss(this,null,wr().mark((function t(){var n,r;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this._context.config.debug.disableDPlane){t.next=4;break}return t.next=3,new Promise((function(e){return setTimeout(e,500)}));case 3:return t.abrupt("return");case 4:if(n=e.publication.publisher,!(r=n._getOrCreateConnection(this._localPerson)).startSubscribing){t.next=9;break}return t.next=9,r.startSubscribing(e);case 9:case"end":return t.stop()}}),t,this)})))}},{key:"stopSubscribing",value:function(e){return Ss(this,null,wr().mark((function t(){var n,r;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.publication.publisher,!(null==(r=n._getConnection(this._localPerson.id))?void 0:r.stopSubscribing)){t.next=5;break}return t.next=5,r.stopSubscribing(e);case 5:case"end":return t.stop()}}),t,this)})))}}]),e}();Rs();var fl=function(){function e(t){St(this,e),this._impl=t,this._events=new Yo,this.onLeft=this._events.make(),this.onMetadataUpdated=this._events.make(),this.onStreamPublished=this._events.make(),this.onStreamUnpublished=this._events.make(),this.onPublicationChanged=this._events.make(),this.onStreamSubscribed=this._events.make(),this.onStreamUnsubscribed=this._events.make(),this.onSubscriptionChanged=this._events.make(),this.onFatalError=this._events.make(),this.apply(t)}return Pt(e,[{key:"keepaliveIntervalSec",get:function(){return this._impl.keepaliveIntervalSec}},{key:"type",get:function(){return this._impl.type}},{key:"subtype",get:function(){return this._impl.subtype}},{key:"side",get:function(){return this._impl.side}},{key:"id",get:function(){return this._impl.id}},{key:"name",get:function(){return this._impl.name}},{key:"channel",get:function(){return this._impl.channel}},{key:"metadata",get:function(){return this._impl.metadata}},{key:"status",get:function(){return this._impl.status}},{key:"publications",get:function(){return this._impl.publications}},{key:"subscriptions",get:function(){return this._impl.subscriptions}},{key:"apply",value:function(e){this._impl=e,e.onLeft.pipe(this.onLeft),e.onMetadataUpdated.pipe(this.onMetadataUpdated),e.onStreamPublished.pipe(this.onStreamPublished),e.onStreamUnpublished.pipe(this.onStreamUnpublished),e.onPublicationChanged.pipe(this.onPublicationChanged),e.onStreamSubscribed.pipe(this.onStreamSubscribed),e.onStreamUnsubscribed.pipe(this.onStreamUnsubscribed),e.onSubscriptionChanged.pipe(this.onSubscriptionChanged),e.onFatalError.pipe(this.onFatalError)}},{key:"subscribe",value:function(e){return this._impl.subscribe(e)}},{key:"unsubscribe",value:function(e){return this._impl.unsubscribe(e)}},{key:"publish",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this._impl.publish(e,t)}},{key:"unpublish",value:function(e){return this._impl.unpublish(e)}},{key:"updateMetadata",value:function(e){return this._impl.updateMetadata(e)}},{key:"leave",value:function(){return Ss(this,null,wr().mark((function e(){return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._impl.leave();case 2:case"end":return e.stop()}}),e,this)})))}},{key:"getConnections",value:function(){return this._impl.getConnections()}},{key:"filterConnections",value:function(e){return this._impl.filterConnections(e)}},{key:"dispose",value:function(){this._impl.dispose()}}]),e}();Rs(),Rs(),Rs();var hl,ml=xs($o());Rs(),Rs();var vl=new Uint8Array(16);function gl(){if(!hl&&!(hl="undefined"!==typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!==typeof msCrypto&&"function"===typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return hl(vl)}Rs(),Rs(),Rs();var bl=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;var yl,_l=function(e){return"string"===typeof e&&bl.test(e)},wl=[];for(yl=0;yl<256;++yl)wl.push((yl+256).toString(16).substr(1));var kl=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(wl[e[t+0]]+wl[e[t+1]]+wl[e[t+2]]+wl[e[t+3]]+"-"+wl[e[t+4]]+wl[e[t+5]]+"-"+wl[e[t+6]]+wl[e[t+7]]+"-"+wl[e[t+8]]+wl[e[t+9]]+"-"+wl[e[t+10]]+wl[e[t+11]]+wl[e[t+12]]+wl[e[t+13]]+wl[e[t+14]]+wl[e[t+15]]).toLowerCase();if(!_l(n))throw TypeError("Stringified UUID is invalid");return n};Rs();var xl=function(e,t,n){var r=(e=e||{}).random||(e.rng||gl)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t){n=n||0;for(var a=0;a<16;++a)t[n+a]=r[a];return t}return kl(r)};Rs();var Sl=Pt((function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(St(this,e),this.name=t,this.payload=n,this.id=xl(),this.data=this.payload==={}?JSON.stringify({order:this.name,orderId:this.id}):JSON.stringify({order:this.name,orderId:this.id,payload:this.payload}),this.data.length>20480)throw new Error("payload size exceeds the upper limit")}));Rs();var Rl=["indicate","request","response"];function Pl(e){return void 0!==e&&!Array.isArray(e)&&("object"===typeof e&&("string"===typeof e.id&&("undefined"===typeof e.name||"string"===typeof e.name)))}Rs();var Cl=xs(to());Rs();var Tl=Pt((function e(){var t=this;St(this,e),this._listeners=new Map,this._listenerIndex=0,this.emit=function(e){t._listeners.forEach((function(t){return t(e)}))},this.removeAllListeners=function(){t._listeners.clear()},this.addListener=function(e){var n=t._listenerIndex;t._listeners.set(n,e),t._listenerIndex++;return{removeListener:function(){t._listeners.delete(n)}}},this.addOneTimeListener=function(e){var n=t.addListener((function(t){n.removeListener(),e(t)}));return n},this.asPromise=function(e){return new Promise((function(n,r){var a=function(){},i=e&&setTimeout((function(){r("Event asPromise timeout"),a()}),e),s=t.addOneTimeListener((function(e){i&&clearTimeout(i),n(e)}));a=s.removeListener}))}}));Rs();var El=function(){function e(t){var n=t.channelId,r=t.channelName,a=t.memberId,i=t.memberName,s=t.sessionEndpoint,o=t.token,c=t.connectivityCheckIntervalSec,u=t.logger;St(this,e),this._isOpen=!1,this._isDestroyed=!1,this._reconnectCount=0,this.onOpened=new Tl,this.onEventReceived=new Tl,this.onConnectionFailed=new Tl,this._sessionEndpoint=s,this._channelId=n,this._channelName=r,this._memberId=a,this._memberName=i,this._token=o,this._connectivityCheckIntervalSec=c,this._logger=u,this._connect()}return Pt(e,[{key:"_reconnect",value:function(){var e,t=this;if(this._ws=void 0,this._isOpen=!1,this._reconnectCount>=3)this.onConnectionFailed.emit(),this.destroy(),this._logger.error("Failed to reconnect for three times",new Error);else{var n=(e=this._reconnectCount,1e3*(bs(2,e)+Math.random()));setTimeout((function(){t._connect(),t._reconnectCount++,t._logger.debug("Try to reconnect: count = ".concat(t._reconnectCount))}),n)}}},{key:"_connect",value:function(){var e,t=this;try{var n="SkyWayJWT!".concat(this._token),r={channelId:this._channelId,channelName:this._channelName,memberId:this._memberId,memberName:this._memberName,connectivityCheckIntervalSec:this._connectivityCheckIntervalSec,platform:"javascript",version:"0.2.0-beta.0"},a=Object.entries(r).filter((function(e){var t=s(e,2);t[0];return void 0!==t[1]})).map((function(e){return e.join("=")})).join("&"),i="".concat(this._sessionEndpoint,"?").concat(a);e="object"===typeof is&&null!==is.versions&&null!==is.versions.node?new Cl.default(i,n,{headers:{"User-Agent":"skyway-message-js-client/".concat(is.version)}}):new Cl.default(i,n),this._logger.debug("Connecting to message-server: ".concat(this._sessionEndpoint)),e.onerror=function(e){t._logger.error("WebSocket error occurred",e.error),t._reconnect()}}catch(c){var o=c instanceof Error?c:new Error;return this._logger.error("Failed to create WebSocket instance",o),void this._reconnect()}e.onopen=function(){t._logger.debug("Connected to message-server")},e.onclose=function(e){t._logger.debug("Close event fired: "+JSON.stringify(e)),1e3===e.code||4e3<=e.code&&e.code<=4199?(t._logger.debug("Closed the connection to message-server"),t.onConnectionFailed.emit(),t.destroy()):t._reconnect()},e.onmessage=function(e){t._messageHandler(e.data)},this._ws=e}},{key:"destroy",value:function(){this._isDestroyed=!0,this.onOpened.removeAllListeners(),this.onEventReceived.removeAllListeners(),this.onConnectionFailed.removeAllListeners(),void 0!==this._ws&&this._ws.close(1e3)}},{key:"send",value:function(e){var t=this;return new Promise((function(n,r){var a=function(){t.onOpened.addOneTimeListener((function(){t.send(e).then((function(){n()})).catch((function(e){r(e)}))})),t.onConnectionFailed.addOneTimeListener((function(){r(new Error("Connection failed"))}))};if(t._isDestroyed)r(new Error("The socket is already destroyed"));else{if(void 0===t._ws||!t._isOpen)return t._logger.debug("Retry send the order when connected because WebSocket is undefined or isOpen = false"),void a();t._logger.debug("Send the event: ".concat(e.data)),t._ws.send(e.data,(function(e){if(e){if(void 0===t._ws||!t._isOpen||t._ws.readyState!==Cl.default.OPEN)return t._logger.debug("Retry send the order when connected because WebSocket.send failed"),void a();r(e)}else n()}))}}))}},{key:"_messageHandler",value:function(e){if("string"===typeof e){var t;try{t=JSON.parse(e)}catch(r){var n=r instanceof Error?r:new Error;return void this._logger.error("Received invalid message: parse error",n)}!function(e){return!(!e||"object"!==typeof e)&&("string"===typeof e.event&&(!e.payload||"object"===typeof e.payload))}(t)?this._logger.error("Received invalid message: ".concat(t),new Error):"open"===t.event?(this._logger.debug("Received a open event"),this._isOpen=!0,0!==this._reconnectCount&&(this._reconnectCount=0,this._logger.debug("Succeeded to reconnect")),this.onOpened.emit()):(this._logger.debug("Received the event: ".concat(t.event,", payload: ").concat(t.payload)),this.onEventReceived.emit(t))}else this._logger.error("Received invalid message: not string",new Error)}}]),e}();var Ol=function(){function e(t,n){var r=t.token,a=t.channelId,i=t.channelName,s=t.memberId,o=t.memberName;St(this,e),this.onConnectionFailed=new Tl,this.onRequested=new Tl,this.onIndicated=new Tl,this._responseCallbacks={},this._orderAcceptedCallbacks={},this._orderRejectedCallbacks={},this._token=r,this._channelId=a,this._channelName=i,this._memberId=s,this._memberName=o;var c={connectivityCheckIntervalSec:30,msasDomain:"b-msas.beta.skyway.ntt.com",secure:!0,logger:{debug:function(e){console.debug(e)},error:function(e){console.error(e)}}};this._options=Object.assign({},c,null!=n?n:{}),this._logger=this._options.logger,this._logger.debug("Created instance with the options: ".concat(this._options))}return Pt(e,[{key:"connect",value:function(){return Ss(this,null,wr().mark((function e(){var t,n,r,a,i,s=this;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this._options.secure?"https":"http",n="channelId=".concat(this._channelId),e.prev=2,e.next=5,(0,ml.default)("".concat(t,"://").concat(this._options.msasDomain,"/").concat("v1","/sessions?").concat(n),{headers:{Authorization:"Bearer ".concat(this._token)}}).then((function(e){return e.json()}));case 5:a=e.sent,r=a.domain,e.next=12;break;case 9:e.prev=9,e.t0=e.catch(2),console.error(e.t0);case 12:if(r){e.next=14;break}throw new Error("The response from SkyWay Server (MSAS) is empty");case 14:return i=this._options.secure?"wss":"ws",this._socket=new El({sessionEndpoint:"".concat(i,"://").concat(r,"/").concat("v1","/ws"),channelId:this._channelId,channelName:this._channelName,memberId:this._memberId,memberName:this._memberName,token:this._token,connectivityCheckIntervalSec:this._options.connectivityCheckIntervalSec,logger:this._logger}),this._socket.onEventReceived.addListener((function(e){s._eventReceivedHandler(e)})),this._socket.onConnectionFailed.addListener((function(){s.onConnectionFailed.emit()})),e.next=20,this._socket.onOpened.asPromise(15e3);case 20:this._startConnectivityCheck();case 21:case"end":return e.stop()}}),e,this,[[2,9]])})))}},{key:"disconnect",value:function(){var e;this._stopConnectivityCheck(),null==(e=this._socket)||e.destroy(),this._socket=void 0}},{key:"_startConnectivityCheck",value:function(){var e=this;this._connectivityCheckTimer?this._logger.debug("connectivity check timer is already set"):(this._connectivityCheckTimer=setInterval((function(){var t;null==(t=e._socket)||t.send(new Sl("connectivityCheck")).catch((function(){}))}),1e3*this._options.connectivityCheckIntervalSec),this._logger.debug("Started connectivity check timer"))}},{key:"_stopConnectivityCheck",value:function(){this._connectivityCheckTimer?(clearInterval(this._connectivityCheckTimer),this._connectivityCheckTimer=void 0,this._logger.debug("Stopped connectivity check timer")):this._logger.debug("connectivity check timer is not set")}},{key:"indicate",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10;return new Promise((function(a,i){if(Array.isArray(e)||(e=[e]),0!==e.length){var s,o=kr(e);try{for(o.s();!(s=o.n()).done;){Il(s.value)}}catch(l){o.e(l)}finally{o.f()}if(Ml(t),void 0!==n._socket){var c=new Sl("message",{kind:"indicate",isBroadcast:!1,dst:e,data:t}),u=setTimeout((function(){n._clearOrderCallbacks(c.id),i(new Error("indicate timeout"))}),1e3*r);n._setOrderAcceptedCallback(c.id,(function(){clearTimeout(u),a()})),n._setOrderRejectedCallback(c.id,(function(e){clearTimeout(u),i(e)})),n._socket.send(c).catch((function(e){n._clearOrderCallbacks(c.id),clearTimeout(u),i(e)}))}else i(new Error("websocket is not connected"))}else i(new Error("targets is empty"))}))}},{key:"indicateAll",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;return new Promise((function(r,a){if(Ml(e),void 0!==t._socket){var i=new Sl("message",{kind:"indicate",isBroadcast:!0,data:e}),s=setTimeout((function(){t._clearOrderCallbacks(i.id),a(new Error("indicateAll timeout"))}),1e3*n);t._setOrderAcceptedCallback(i.id,(function(){clearTimeout(s),r()})),t._setOrderRejectedCallback(i.id,(function(e){clearTimeout(s),a(e)})),t._socket.send(i).catch((function(e){t._clearOrderCallbacks(i.id),clearTimeout(s),a(e)}))}else a(new Error("websocket is not connected"))}))}},{key:"request",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10;return Il(e),Ml(t),new Promise((function(a,i){if(void 0!==n._socket){var s=new Sl("message",{kind:"request",dst:e,data:t}),o=setTimeout((function(){delete n._responseCallbacks[s.id],delete n._orderRejectedCallbacks[s.id],i(new Error("request timeout"))}),1e3*r);n._setResponseCallback(s.id,(function(e){clearTimeout(o),a(e)})),n._setOrderRejectedCallback(s.id,(function(e){clearTimeout(o),i(e)})),n._setOrderAcceptedCallback(s.id,(function(){})),n._socket.send(s).catch((function(e){delete n._responseCallbacks[s.id],delete n._orderRejectedCallbacks[s.id],clearTimeout(o),i(e)}))}else i(new Error("websocket is not connected"))}))}},{key:"_response",value:function(e,t,n,r){var a=this;return new Promise((function(i,s){if(Ml(n),void 0!==a._socket){var o=new Sl("message",{kind:"response",dst:e,requestOrderId:t,data:n}),c=setTimeout((function(){a._clearOrderCallbacks(o.id),s(new Error("response timeout"))}),1e3*r);a._setOrderAcceptedCallback(o.id,(function(){clearTimeout(c),i()})),a._setOrderRejectedCallback(o.id,(function(e){clearTimeout(c),s(e)})),a._socket.send(o).catch((function(e){a._clearOrderCallbacks(o.id),clearTimeout(c),s(e)}))}else s(new Error("websocket is not connected"))}))}},{key:"_eventReceivedHandler",value:function(e){switch(e.event){case"orderAccepted":this._orderAcceptedHandler(e.payload);break;case"orderRejected":this._orderRejectedHandler(e.payload);break;case"message":this._eventMessageHandler(e.payload)}}},{key:"_orderAcceptedHandler",value:function(e){if(!function(e){return!(!e||"object"!==typeof e)&&"string"===typeof e.orderId}(e))throw new Error("Invalid payload");var t=e.orderId;if(!this._orderAcceptedCallbacks[t])throw new Error("accepted event has unknown orderId: ".concat(t));var n=this._orderAcceptedCallbacks[t];this._clearOrderCallbacks(t),n()}},{key:"_orderRejectedHandler",value:function(e){if(!function(e){return!(!e||"object"!==typeof e)&&"string"===typeof e.orderId&&"string"===typeof e.reason}(e))throw new Error("Invalid payload");var t=e.orderId;if(!this._orderRejectedCallbacks[t])throw new Error("rejected event has unknown orderId: ".concat(t));var n=this._orderRejectedCallbacks[t];this._clearOrderCallbacks(t),n(e)}},{key:"_eventMessageHandler",value:function(e){if(!function(e){return!(!e||"object"!==typeof e)&&!!Pl(e.src)&&!("string"!==typeof e.kind||!Rl.includes(e.kind))&&("indicate"!==e.kind||"boolean"===typeof e.isBroadcast)&&("request"!==e.kind&&"response"!==e.kind||"string"===typeof e.requestOrderId)&&!(!e.data||"object"!==typeof e.data)}(e))throw new Error("Invalid payload");switch(e.kind){case"indicate":this._eventMessageIndicateHandler(e);break;case"request":this._eventMessageRequestHandler(e);break;case"response":this._eventMessageResponseHandler(e)}}},{key:"_eventMessageIndicateHandler",value:function(e){this.onIndicated.emit({data:e.data,src:e.src})}},{key:"_eventMessageRequestHandler",value:function(e){var t=this;if(!e.requestOrderId)throw new Error("Invalid payload");var n=e.src,r=e.requestOrderId;this.onRequested.emit({data:e.data,reply:function(e){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;return Ss(t,null,wr().mark((function t(){return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._response(n,r,e,a);case 2:case"end":return t.stop()}}),t,this)})))},requestOrderId:e.requestOrderId,src:e.src})}},{key:"_eventMessageResponseHandler",value:function(e){if(!e.requestOrderId||!this._responseCallbacks[e.requestOrderId])throw new Error("received response has unknown orderId: ".concat(e.requestOrderId));var t=this._responseCallbacks[e.requestOrderId];delete this._responseCallbacks[e.requestOrderId],t(e.data)}},{key:"_setResponseCallback",value:function(e,t){this._responseCallbacks[e]=t}},{key:"_setOrderAcceptedCallback",value:function(e,t){this._orderAcceptedCallbacks[e]=t}},{key:"_setOrderRejectedCallback",value:function(e,t){this._orderRejectedCallbacks[e]=t}},{key:"_clearOrderCallbacks",value:function(e){delete this._orderAcceptedCallbacks[e],delete this._orderRejectedCallbacks[e]}}]),e}();function Ml(e){if(!e||"object"!==typeof e)throw new Error("the type of data must be object")}function Il(e){if(!Pl(e))throw new Error("the type of target must be {id: string, name: string}");if(!_l(e.id))throw new Error("the type of target.id must be uuid format")}Rs(),Rs();var Dl=86400,jl=new tc("packages/core/src/member/person/local/factory.ts");function Ll(e,t,n){return Ss(this,arguments,wr().mark((function e(t,n,r){var a,i,s,o,c,u,l,d,p,f,h,m,v,g=this,b=arguments;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=b.length>3&&void 0!==b[3]?b[3]:{},i=a.keepaliveIntervalSec,jl.debug("createLocalPerson",{channel:n,memberDto:r,keepaliveIntervalSec:i}),o=t.config,c=o.messageService,u=o.iceParamServer,l=o.rtcConfig,d=new Ol({token:t.authTokenString,channelId:n.id,channelName:n.name,memberId:r.id,memberName:r.name},{logger:{error:function(e){jl.error(new rc({type:"internalError",message:"messageClient error",payload:{error:e}}))},debug:function(){}},msasDomain:c.domain,secure:c.secure}),jl.debug("[start] connect messageService"),e.next=7,d.connect().catch((function(e){throw new rc({type:"internalError",message:"messageClient failed to connect MessagingService",payload:e})}));case 7:return jl.debug("[end] connect messageService"),p=new al(u.domain,u.version,u.secure,l.turnPolicy),jl.debug("[start] fetch iceParams"),e.next=12,p.setupIceServers(t.authTokenString,r.id,Dl).catch((function(e){throw new rc({type:"internalError",message:"iceManager failed to connect iceServer",payload:e})}));case 12:return jl.debug("[end] fetch iceParams"),e.next=15,Fl.Create({iceManager:p,channel:n,messaging:d,metadata:r.metadata,name:r.name,id:r.id,keepaliveIntervalSec:i});case 15:f=e.sent,h=kr(t.plugins),e.prev=17,v=wr().mark((function e(){var t;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=m.value,e.next=3,null==(s=t._whenCreateLocalPerson)?void 0:s.call(t,f);case 3:f._onDisposed.once((function(){return Ss(g,null,wr().mark((function e(){var n;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null==(n=t._whenDisposeLocalPerson)?void 0:n.call(t,f);case 2:case"end":return e.stop()}}),e)})))}));case 4:case"end":return e.stop()}}),e)})),h.s();case 20:if((m=h.n()).done){e.next=24;break}return e.delegateYield(v(),"t0",22);case 22:e.next=20;break;case 24:e.next=29;break;case 26:e.prev=26,e.t1=e.catch(17),h.e(e.t1);case 29:return e.prev=29,h.f(),e.finish(29);case 32:return e.abrupt("return",f);case 33:case"end":return e.stop()}}),e,null,[[17,26,29,32]])})))}var Al=new tc("packages/core/src/member/person/local/index.ts"),Fl=function(e){mn(n,e);var t=_n(n);function n(e){var r;return St(this,n),(r=t.call(this,e)).args=e,r.type="person",r.subtype="person",r.side="local",r.keepaliveIntervalSec=r.args.keepaliveIntervalSec,r.iceManager=r.args.iceManager,r.context=r.args.channel._context,r.onStreamPublished=r._events.make(),r.onStreamUnpublished=r._events.make(),r.onPublicationChanged=r._events.make(),r.onStreamSubscribed=r._events.make(),r.onStreamUnsubscribed=r._events.make(),r.onSubscriptionChanged=r._events.make(),r.onFatalError=r._events.make(),r._onStreamSubscribeFailed=r._events.make(),r._onDisposed=r._events.make(),r._disposed=!1,r._publishingAgent=new dl(bn(r)),r._subscribingAgent=new pl(bn(r)),r._messaging=e.messaging,r._listenChannelEvent(),r._listenBeforeUnload(),r._messaging.onConnectionFailed.addOneTimeListener((function(){Al.error("onFatalError"),r.onFatalError.emit(new rc({type:"networkError",message:"failed to reconnect messagingService"})),r.dispose()})),r}return Pt(n,[{key:"_listenChannelEvent",value:function(){var e=this;this.channel.onStreamSubscribed.add((function(t){return Ss(e,[t],wr().mark((function e(t){var n;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.subscription,e.abrupt("return",this._handleOnStreamSubscribe(n));case 2:case"end":return e.stop()}}),e,this)})))})),this.channel.onStreamUnsubscribed.add((function(t){var n=t.subscription;return e._handleOnStreamUnsubscribe(n)})),this.channel._onDisposed.once((function(){e.dispose()})),this.onLeft.once((function(){e.dispose()}))}},{key:"_setupTtlTimer",value:function(){return Ss(this,null,wr().mark((function e(){var t,n=this;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=this.keepaliveIntervalSec){e.next=2;break}return e.abrupt("return");case 2:return t=function(){return Ss(n,null,wr().mark((function e(){var t;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._disposed){e.next=2;break}return e.abrupt("return");case 2:return t=Math.floor(Date.now()/1e3),this.ttlSec=Math.ceil(t+this.keepaliveIntervalSec+this.keepaliveIntervalSec/2),e.prev=4,e.next=7,this.channel._updateMemberTtl(this.id,this.ttlSec);case 7:Al.debug("updateTtl",{now:t,ttlSec:this.ttlSec,keepalive:this.keepaliveIntervalSec,diff:this.ttlSec-t}),e.next=15;break;case 10:if(e.prev=10,e.t0=e.catch(4),!this._disposed){e.next=14;break}return e.abrupt("return");case 14:throw e.t0;case 15:case"end":return e.stop()}}),e,this,[[4,10]])})))},e.next=5,t();case 5:this.ttlInterval=setInterval((function(){return Ss(n,null,wr().mark((function e(){var n=this;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t().catch((function(){n._disposed||(Al.error("updateMemberTtl failed",{id:n.id}),n.dispose())}));case 2:case"end":return e.stop()}}),e)})))}),1e3*this.keepaliveIntervalSec);case 6:case"end":return e.stop()}}),e,this)})))}},{key:"_listenBeforeUnload",value:function(){var e=this;window.addEventListener("beforeunload",(function t(){return Ss(e,null,wr().mark((function e(){return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(window.removeEventListener("beforeunload",t),"joined"===this.status){e.next=3;break}return e.abrupt("return");case 3:return Al.debug("leave by beforeunload"),e.next=6,this.leave();case 6:case"end":return e.stop()}}),e,this)})))}))}},{key:"_handleOnStreamSubscribe",value:function(e){return Ss(this,null,wr().mark((function t(){var n;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.subscriberId!==this.id){t.next=14;break}return t.prev=1,Al.debug("[start] startSubscribing",{subscription:e}),t.next=5,this._subscribingAgent.startSubscribing(e);case 5:this.onStreamSubscribed.emit({subscription:e,stream:e.stream}),this.onSubscriptionChanged.emit(),Al.debug("[end] startSubscribing",{subscription:e}),t.next=14;break;case 10:t.prev=10,t.t0=t.catch(1),Al.warn("[failed] startSubscribing",{subscription:e,error:t.t0}),this._onStreamSubscribeFailed.emit({error:t.t0,subscription:e});case 14:if((null==(n=e.publication)?void 0:n.publisherId)!==this.id){t.next=27;break}if(e.subscriberId!==this.id){t.next=17;break}throw new rc({type:"forbidden",message:"can not subscribe own Publication"});case 17:return t.prev=17,Al.debug("[start] startPublishing",{subscription:e}),t.next=21,this._publishingAgent.startPublishing(e.publication,e.subscriber);case 21:Al.debug("[end] startPublishing",{subscription:e}),t.next=27;break;case 24:t.prev=24,t.t1=t.catch(17),Al.debug("[failed] startPublishing",{subscription:e,error:t.t1});case 27:case"end":return t.stop()}}),t,this,[[1,10],[17,24]])})))}},{key:"_handleOnStreamUnsubscribe",value:function(e){return Ss(this,null,wr().mark((function t(){var n;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if((null==(n=e.publication)?void 0:n.publisherId)!==this.id){t.next=3;break}return t.next=3,this._publishingAgent.stopPublishing(e.publication,e.subscriber);case 3:if(e.subscriberId!==this.id){t.next=14;break}return t.prev=4,t.next=7,this._subscribingAgent.stopSubscribing(e);case 7:this.onStreamUnsubscribed.emit({subscription:e}),this.onSubscriptionChanged.emit(),t.next=14;break;case 11:t.prev=11,t.t0=t.catch(4),Al.warn("failed to stopSubscribing",{subscription:e,error:t.t0});case 14:case"end":return t.stop()}}),t,this,[[4,11]])})))}},{key:"publish",value:function(e){return Ss(this,arguments,wr().mark((function e(t){var n,r,a,i,s,o,c,u,l=arguments;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=l.length>1&&void 0!==l[1]?l[1]:{},"joined"===this.status){e.next=3;break}throw new rc({type:"forbidden",message:"channel stopped"});case 3:return o={metadata:n.metadata,publisher:this.id,channel:this.channel.id,contentType:t.contentType,codecCapabilities:null!=(r=n.codecCapabilities)?r:[],encodings:null!=(a=n.encodings)?a:[]},Al.debug("[start] publish",{init:o}),e.prev=5,e.next=8,this.channel._publish(o);case 8:return c=e.sent,(u=this.channel._addPublication(c)).stream=t,u.codecCapabilities=null!=(i=n.codecCapabilities)?i:[],u.encodings=null!=(s=n.encodings)?s:[],this.onStreamPublished.emit({publication:u}),this.onPublicationChanged.emit(),Al.debug("[end] publish",{publication:u}),e.abrupt("return",u);case 19:throw e.prev=19,e.t0=e.catch(5),new rc({type:"internalError",message:"[failed] publish",payload:{error:e.t0,init:o}});case 22:case"end":return e.stop()}}),e,this,[[5,19]])})))}},{key:"unpublish",value:function(e){return Ss(this,null,wr().mark((function t(){var n,r,a=this;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n="string"===typeof e?e:e.id,"joined"===this.status){t.next=3;break}throw new rc({type:"forbidden",message:"channel stopped"});case 3:if(r=this.channel._getPublication(n)){t.next=6;break}throw new rc({type:"forbidden",message:"can not unpublish not exist publication",payload:{publicationId:n}});case 6:return Al.debug("[start] unpublish",{publication:r}),t.next=9,this.channel._unpublish(n);case 9:r.subscriptions.map((function(e){return e.subscriber})).forEach((function(e){var t;void 0!=(t=e)&&"remote"===t.side&&a._publishingAgent.stopPublishing(r,e)})),this.onStreamUnpublished.emit({publication:r}),this.onPublicationChanged.emit(),Al.debug("[end] unpublish",{publication:r});case 13:case"end":return t.stop()}}),t,this)})))}},{key:"subscribe",value:function(e){return Ss(this,null,wr().mark((function t(){var n,r,a,i,s,o=this;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n="string"===typeof e?e:e.id,"joined"===this.status){t.next=3;break}throw new rc({type:"forbidden",message:"channel stopped"});case 3:return r=this.channel._getPublication(n),this._validatePublicationForSubscribe(r),Al.debug("[start] subscribe",{publication:r}),a=!0,t.prev=7,t.next=10,this.channel._subscribe(this.id,n);case 10:if(i=t.sent,(s=this.channel._addSubscription(i)).stream){t.next=15;break}return t.next=15,Promise.race([new Promise((function(e,t){o.onStreamSubscribed.watch((function(e){return e.subscription.publication.id===n}),o.context.config.rtcApi.timeout).catch((function(e){return Ss(o,null,wr().mark((function n(){return wr().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:a&&t(new rc({type:"timeout",message:"failed to subscribe publication. maybe publisher already left room",payload:{error:e,stream:!!s.stream}}));case 1:case"end":return n.stop()}}),n)})))})).then(e)})),new Promise((function(e,t){o.channel.onMemberLeft.watch((function(e){return e.member.id===r.publisherId}),o.context.config.rtcApi.timeout+1e3).then((function(){a&&t(new rc({type:"deleted",message:"failed to subscribe publication. publisher already left room"}))})).catch(e)})),new Promise((function(e,t){o._onStreamSubscribeFailed.watch((function(e){return e.subscription.publication.id===r.id}),o.context.config.rtcApi.timeout+1e3).then((function(e){a&&t(new rc({type:"internalError",message:"subscribe _onStreamSubscribeFailed",payload:{error:e}}))})).catch(e)}))]);case 15:return a=!1,Al.debug("[end] subscribe",{subscription:s}),t.abrupt("return",{subscription:s,stream:s.stream});case 20:throw t.prev=20,t.t0=t.catch(7),a=!1,new rc({type:"internalError",message:"[failed] subscribe",payload:{error:t.t0,publication:r}});case 24:case"end":return t.stop()}}),t,this,[[7,20]])})))}},{key:"_validatePublicationForSubscribe",value:function(e){if(void 0==e)throw new rc({type:"notFound",message:"can not subscribe not exist publication",payload:{publication:e,memberId:this.id}});if(e.publisher.id===this.id)throw new rc({type:"forbidden",message:"can not subscribe own Publication",payload:{publication:e,memberId:this.id}});if(e.publisher instanceof Zu)throw new rc({type:"forbidden",message:"can't subscribe publication. publisher subtype ".concat(e.publisher.subtype," plugin is not registered"),payload:{publication:e,memberId:this.id}});if(this.subscriptions.find((function(t){return t.publication.id===e.id})))throw new rc({type:"forbidden",message:"can not subscribe already subscribed Publication",payload:{publication:e,memberId:this.id}})}},{key:"unsubscribe",value:function(e){return Ss(this,null,wr().mark((function t(){var n,r;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n="string"===typeof e?e:e.id,"joined"===this.status){t.next=3;break}throw new rc({type:"forbidden",message:"channel stopped"});case 3:if(r=this.subscriptions.find((function(e){return e.id===n}))){t.next=6;break}throw new rc({type:"forbidden",message:"can not unsubscribe not exist subscription",payload:{subscriptionId:n}});case 6:return Al.debug("[start] unsubscribe",{subscription:r}),t.next=9,this.channel._unsubscribe(n);case 9:Al.debug("[end] unsubscribe",{subscription:r});case 10:case"end":return t.stop()}}),t,this)})))}},{key:"getConnections",value:function(){var e=this;return this.channel.members.map((function(t){return t._getConnection(e.id)})).filter((function(e){return!1===(null==e?void 0:e.closed)}))}},{key:"filterConnections",value:function(e){var t=this.getConnections();if(e instanceof dc)return t.filter((function(t){return t.remoteMember.id===e.publication.publisher.id}));if(e instanceof uc)return t.filter((function(t){return e.subscriptions.map((function(e){return e.subscriber.id})).includes(t.remoteMember.id)}));throw new rc({type:"invalidParameter",message:""})}},{key:"leave",value:function(){return Ss(this,null,wr().mark((function e(){return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("left"!==this.status){e.next=2;break}throw new rc({type:"forbidden",message:"already left"});case 2:return e.next=4,this.channel.leave(this);case 4:case"end":return e.stop()}}),e,this)})))}},{key:"dispose",value:function(){this._disposed||(this._disposed=!0,Al.debug("disposed",{id:this.id}),clearInterval(this.ttlInterval),this._messaging.disconnect(),this.getConnections().forEach((function(e){return e.close()})),this._onDisposed.emit(),this._events.dispose())}}],[{key:"Create",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return Ss(this,null,wr().mark((function e(){var r;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=rs(n,t),e.next=3,r._setupTtlTimer().catch((function(e){Al.error("setupTtlTimer failed",e)}));case 3:return e.abrupt("return",r);case 4:case"end":return e.stop()}}),e)})))}}]),n}(fu);Rs(),Rs();var Nl,Bl=Object.create,Ul=Object.defineProperty,zl=Object.defineProperties,Vl=Object.getOwnPropertyDescriptor,Hl=Object.getOwnPropertyDescriptors,Wl=Object.getOwnPropertyNames,ql=Object.getOwnPropertySymbols,Gl=Object.getPrototypeOf,Kl=Object.prototype.hasOwnProperty,Xl=Object.prototype.propertyIsEnumerable,Ql=Math.pow,$l=function(e,t,n){return t in e?Ul(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n},Jl=function(e,t){for(var n in t||(t={}))Kl.call(t,n)&&$l(e,n,t[n]);if(ql){var r,a=kr(ql(t));try{for(a.s();!(r=a.n()).done;){n=r.value;Xl.call(t,n)&&$l(e,n,t[n])}}catch(i){a.e(i)}finally{a.f()}}return e},Yl=function(e,t){return zl(e,Hl(t))},Zl=function(e,t){return function(){return t||(0,e[Wl(e)[0]])((t={exports:{}}).exports,t),t.exports}},ed=function(e,t,n){return n=null!=e?Bl(Gl(e)):{},function(e,t,n,r){if(t&&"object"===typeof t||"function"===typeof t){var a,i=kr(Wl(t));try{var s=function(){var i=a.value;Kl.call(e,i)||i===n||Ul(e,i,{get:function(){return t[i]},enumerable:!(r=Vl(t,i))||r.enumerable})};for(i.s();!(a=i.n()).done;)s()}catch(o){i.e(o)}finally{i.f()}}return e}(!t&&e&&e.__esModule?n:Ul(n,"default",{value:e,enumerable:!0}),e)},td=function(e,t,n){return new Promise((function(r,a){var i=function(e){try{o(n.next(e))}catch(t){a(t)}},s=function(e){try{o(n.throw(e))}catch(t){a(t)}},o=function(e){return e.done?r(e.value):Promise.resolve(e.value).then(i,s)};o((n=n.apply(e,t)).next())}))},nd=function(e,t){return function(){return e&&(t=(0,e[Wl(e)[0]])(e=0)),t}}({"shims/process.js":function(){Nl=void 0}}),rd=Zl({"../../node_modules/axios/lib/helpers/bind.js":function(e,t){nd(),t.exports=function(e,t){return function(){for(var n=new Array(arguments.length),r=0;r<n.length;r++)n[r]=arguments[r];return e.apply(t,n)}}}}),ad=Zl({"../../node_modules/axios/lib/utils.js":function(e,t){nd();var n=rd(),r=Object.prototype.toString;function a(e){return"[object Array]"===r.call(e)}function i(e){return"undefined"===typeof e}function s(e){return null!==e&&"object"===typeof e}function o(e){if("[object Object]"!==r.call(e))return!1;var t=Object.getPrototypeOf(e);return null===t||t===Object.prototype}function c(e){return"[object Function]"===r.call(e)}function u(e,t){if(null!==e&&"undefined"!==typeof e)if("object"!==typeof e&&(e=[e]),a(e))for(var n=0,r=e.length;n<r;n++)t.call(null,e[n],n,e);else for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.call(null,e[i],i,e)}t.exports={isArray:a,isArrayBuffer:function(e){return"[object ArrayBuffer]"===r.call(e)},isBuffer:function(e){return null!==e&&!i(e)&&null!==e.constructor&&!i(e.constructor)&&"function"===typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)},isFormData:function(e){return"undefined"!==typeof FormData&&e instanceof FormData},isArrayBufferView:function(e){return"undefined"!==typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&e.buffer instanceof ArrayBuffer},isString:function(e){return"string"===typeof e},isNumber:function(e){return"number"===typeof e},isObject:s,isPlainObject:o,isUndefined:i,isDate:function(e){return"[object Date]"===r.call(e)},isFile:function(e){return"[object File]"===r.call(e)},isBlob:function(e){return"[object Blob]"===r.call(e)},isFunction:c,isStream:function(e){return s(e)&&c(e.pipe)},isURLSearchParams:function(e){return"undefined"!==typeof URLSearchParams&&e instanceof URLSearchParams},isStandardBrowserEnv:function(){return("undefined"===typeof navigator||"ReactNative"!==navigator.product&&"NativeScript"!==navigator.product&&"NS"!==navigator.product)&&("undefined"!==typeof window&&"undefined"!==typeof document)},forEach:u,merge:function e(){var t={};function n(n,r){o(t[r])&&o(n)?t[r]=e(t[r],n):o(n)?t[r]=e({},n):a(n)?t[r]=n.slice():t[r]=n}for(var r=0,i=arguments.length;r<i;r++)u(arguments[r],n);return t},extend:function(e,t,r){return u(t,(function(t,a){e[a]=r&&"function"===typeof t?n(t,r):t})),e},trim:function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")},stripBOM:function(e){return 65279===e.charCodeAt(0)&&(e=e.slice(1)),e}}}}),id=Zl({"../../node_modules/axios/lib/helpers/buildURL.js":function(e,t){nd();var n=ad();function r(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}t.exports=function(e,t,a){if(!t)return e;var i;if(a)i=a(t);else if(n.isURLSearchParams(t))i=t.toString();else{var s=[];n.forEach(t,(function(e,t){null!==e&&"undefined"!==typeof e&&(n.isArray(e)?t+="[]":e=[e],n.forEach(e,(function(e){n.isDate(e)?e=e.toISOString():n.isObject(e)&&(e=JSON.stringify(e)),s.push(r(t)+"="+r(e))})))})),i=s.join("&")}if(i){var o=e.indexOf("#");-1!==o&&(e=e.slice(0,o)),e+=(-1===e.indexOf("?")?"?":"&")+i}return e}}}),sd=Zl({"../../node_modules/axios/lib/core/InterceptorManager.js":function(e,t){nd();var n=ad();function r(){this.handlers=[]}r.prototype.use=function(e,t,n){return this.handlers.push({fulfilled:e,rejected:t,synchronous:!!n&&n.synchronous,runWhen:n?n.runWhen:null}),this.handlers.length-1},r.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)},r.prototype.forEach=function(e){n.forEach(this.handlers,(function(t){null!==t&&e(t)}))},t.exports=r}}),od=Zl({"../../node_modules/axios/lib/helpers/normalizeHeaderName.js":function(e,t){nd();var n=ad();t.exports=function(e,t){n.forEach(e,(function(n,r){r!==t&&r.toUpperCase()===t.toUpperCase()&&(e[t]=n,delete e[r])}))}}}),cd=Zl({"../../node_modules/axios/lib/core/enhanceError.js":function(e,t){nd(),t.exports=function(e,t,n,r,a){return e.config=t,n&&(e.code=n),e.request=r,e.response=a,e.isAxiosError=!0,e.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code,status:this.response&&this.response.status?this.response.status:null}},e}}}),ud=Zl({"../../node_modules/axios/lib/core/createError.js":function(e,t){nd();var n=cd();t.exports=function(e,t,r,a,i){var s=new Error(e);return n(s,t,r,a,i)}}}),ld=Zl({"../../node_modules/axios/lib/core/settle.js":function(e,t){nd();var n=ud();t.exports=function(e,t,r){var a=r.config.validateStatus;r.status&&a&&!a(r.status)?t(n("Request failed with status code "+r.status,r.config,null,r.request,r)):e(r)}}}),dd=Zl({"../../node_modules/axios/lib/helpers/cookies.js":function(e,t){nd();var n=ad();t.exports=n.isStandardBrowserEnv()?{write:function(e,t,r,a,i,s){var o=[];o.push(e+"="+encodeURIComponent(t)),n.isNumber(r)&&o.push("expires="+new Date(r).toGMTString()),n.isString(a)&&o.push("path="+a),n.isString(i)&&o.push("domain="+i),!0===s&&o.push("secure"),document.cookie=o.join("; ")},read:function(e){var t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}}}}),pd=Zl({"../../node_modules/axios/lib/helpers/isAbsoluteURL.js":function(e,t){nd(),t.exports=function(e){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(e)}}}),fd=Zl({"../../node_modules/axios/lib/helpers/combineURLs.js":function(e,t){nd(),t.exports=function(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e}}}),hd=Zl({"../../node_modules/axios/lib/core/buildFullPath.js":function(e,t){nd();var n=pd(),r=fd();t.exports=function(e,t){return e&&!n(t)?r(e,t):t}}}),md=Zl({"../../node_modules/axios/lib/helpers/parseHeaders.js":function(e,t){nd();var n=ad(),r=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];t.exports=function(e){var t,a,i,s={};return e?(n.forEach(e.split("\n"),(function(e){if(i=e.indexOf(":"),t=n.trim(e.substr(0,i)).toLowerCase(),a=n.trim(e.substr(i+1)),t){if(s[t]&&r.indexOf(t)>=0)return;s[t]="set-cookie"===t?(s[t]?s[t]:[]).concat([a]):s[t]?s[t]+", "+a:a}})),s):s}}}),vd=Zl({"../../node_modules/axios/lib/helpers/isURLSameOrigin.js":function(e,t){nd();var n=ad();t.exports=n.isStandardBrowserEnv()?function(){var e,t=/(msie|trident)/i.test(navigator.userAgent),r=document.createElement("a");function a(e){var n=e;return t&&(r.setAttribute("href",n),n=r.href),r.setAttribute("href",n),{href:r.href,protocol:r.protocol?r.protocol.replace(/:$/,""):"",host:r.host,search:r.search?r.search.replace(/^\?/,""):"",hash:r.hash?r.hash.replace(/^#/,""):"",hostname:r.hostname,port:r.port,pathname:"/"===r.pathname.charAt(0)?r.pathname:"/"+r.pathname}}return e=a(window.location.href),function(t){var r=n.isString(t)?a(t):t;return r.protocol===e.protocol&&r.host===e.host}}():function(){return!0}}}),gd=Zl({"../../node_modules/axios/lib/cancel/Cancel.js":function(e,t){function n(e){this.message=e}nd(),n.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},n.prototype.__CANCEL__=!0,t.exports=n}}),bd=Zl({"../../node_modules/axios/lib/adapters/xhr.js":function(e,t){nd();var n=ad(),r=ld(),a=dd(),i=id(),s=hd(),o=md(),c=vd(),u=ud(),l=yd(),d=gd();t.exports=function(e){return new Promise((function(t,p){var f,h=e.data,m=e.headers,v=e.responseType;function g(){e.cancelToken&&e.cancelToken.unsubscribe(f),e.signal&&e.signal.removeEventListener("abort",f)}n.isFormData(h)&&delete m["Content-Type"];var b=new XMLHttpRequest;if(e.auth){var y=e.auth.username||"",_=e.auth.password?unescape(encodeURIComponent(e.auth.password)):"";m.Authorization="Basic "+btoa(y+":"+_)}var w=s(e.baseURL,e.url);function k(){if(b){var n="getAllResponseHeaders"in b?o(b.getAllResponseHeaders()):null,a={data:v&&"text"!==v&&"json"!==v?b.response:b.responseText,status:b.status,statusText:b.statusText,headers:n,config:e,request:b};r((function(e){t(e),g()}),(function(e){p(e),g()}),a),b=null}}if(b.open(e.method.toUpperCase(),i(w,e.params,e.paramsSerializer),!0),b.timeout=e.timeout,"onloadend"in b?b.onloadend=k:b.onreadystatechange=function(){b&&4===b.readyState&&(0!==b.status||b.responseURL&&0===b.responseURL.indexOf("file:"))&&setTimeout(k)},b.onabort=function(){b&&(p(u("Request aborted",e,"ECONNABORTED",b)),b=null)},b.onerror=function(){p(u("Network Error",e,null,b)),b=null},b.ontimeout=function(){var t=e.timeout?"timeout of "+e.timeout+"ms exceeded":"timeout exceeded",n=e.transitional||l.transitional;e.timeoutErrorMessage&&(t=e.timeoutErrorMessage),p(u(t,e,n.clarifyTimeoutError?"ETIMEDOUT":"ECONNABORTED",b)),b=null},n.isStandardBrowserEnv()){var x=(e.withCredentials||c(w))&&e.xsrfCookieName?a.read(e.xsrfCookieName):void 0;x&&(m[e.xsrfHeaderName]=x)}"setRequestHeader"in b&&n.forEach(m,(function(e,t){"undefined"===typeof h&&"content-type"===t.toLowerCase()?delete m[t]:b.setRequestHeader(t,e)})),n.isUndefined(e.withCredentials)||(b.withCredentials=!!e.withCredentials),v&&"json"!==v&&(b.responseType=e.responseType),"function"===typeof e.onDownloadProgress&&b.addEventListener("progress",e.onDownloadProgress),"function"===typeof e.onUploadProgress&&b.upload&&b.upload.addEventListener("progress",e.onUploadProgress),(e.cancelToken||e.signal)&&(f=function(e){b&&(p(!e||e&&e.type?new d("canceled"):e),b.abort(),b=null)},e.cancelToken&&e.cancelToken.subscribe(f),e.signal&&(e.signal.aborted?f():e.signal.addEventListener("abort",f))),h||(h=null),b.send(h)}))}}}),yd=Zl({"../../node_modules/axios/lib/defaults.js":function(e,t){nd();var n=ad(),r=od(),a=cd(),i={"Content-Type":"application/x-www-form-urlencoded"};function s(e,t){!n.isUndefined(e)&&n.isUndefined(e["Content-Type"])&&(e["Content-Type"]=t)}var o={transitional:{silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},adapter:function(){var e;return("undefined"!==typeof XMLHttpRequest||"undefined"!==typeof Nl&&"[object process]"===Object.prototype.toString.call(Nl))&&(e=bd()),e}(),transformRequest:[function(e,t){return r(t,"Accept"),r(t,"Content-Type"),n.isFormData(e)||n.isArrayBuffer(e)||n.isBuffer(e)||n.isStream(e)||n.isFile(e)||n.isBlob(e)?e:n.isArrayBufferView(e)?e.buffer:n.isURLSearchParams(e)?(s(t,"application/x-www-form-urlencoded;charset=utf-8"),e.toString()):n.isObject(e)||t&&"application/json"===t["Content-Type"]?(s(t,"application/json"),function(e,t,r){if(n.isString(e))try{return(t||JSON.parse)(e),n.trim(e)}catch(a){if("SyntaxError"!==a.name)throw a}return(r||JSON.stringify)(e)}(e)):e}],transformResponse:[function(e){var t=this.transitional||o.transitional,r=t&&t.silentJSONParsing,i=t&&t.forcedJSONParsing,s=!r&&"json"===this.responseType;if(s||i&&n.isString(e)&&e.length)try{return JSON.parse(e)}catch(c){if(s){if("SyntaxError"===c.name)throw a(c,this,"E_JSON_PARSE");throw c}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};n.forEach(["delete","get","head"],(function(e){o.headers[e]={}})),n.forEach(["post","put","patch"],(function(e){o.headers[e]=n.merge(i)})),t.exports=o}}),_d=Zl({"../../node_modules/axios/lib/core/transformData.js":function(e,t){nd();var n=ad(),r=yd();t.exports=function(e,t,a){var i=this||r;return n.forEach(a,(function(n){e=n.call(i,e,t)})),e}}}),wd=Zl({"../../node_modules/axios/lib/cancel/isCancel.js":function(e,t){nd(),t.exports=function(e){return!(!e||!e.__CANCEL__)}}}),kd=Zl({"../../node_modules/axios/lib/core/dispatchRequest.js":function(e,t){nd();var n=ad(),r=_d(),a=wd(),i=yd(),s=gd();function o(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new s("canceled")}t.exports=function(e){return o(e),e.headers=e.headers||{},e.data=r.call(e,e.data,e.headers,e.transformRequest),e.headers=n.merge(e.headers.common||{},e.headers[e.method]||{},e.headers),n.forEach(["delete","get","head","post","put","patch","common"],(function(t){delete e.headers[t]})),(e.adapter||i.adapter)(e).then((function(t){return o(e),t.data=r.call(e,t.data,t.headers,e.transformResponse),t}),(function(t){return a(t)||(o(e),t&&t.response&&(t.response.data=r.call(e,t.response.data,t.response.headers,e.transformResponse))),Promise.reject(t)}))}}}),xd=Zl({"../../node_modules/axios/lib/core/mergeConfig.js":function(e,t){nd();var n=ad();t.exports=function(e,t){t=t||{};var r={};function a(e,t){return n.isPlainObject(e)&&n.isPlainObject(t)?n.merge(e,t):n.isPlainObject(t)?n.merge({},t):n.isArray(t)?t.slice():t}function i(r){return n.isUndefined(t[r])?n.isUndefined(e[r])?void 0:a(void 0,e[r]):a(e[r],t[r])}function s(e){if(!n.isUndefined(t[e]))return a(void 0,t[e])}function o(r){return n.isUndefined(t[r])?n.isUndefined(e[r])?void 0:a(void 0,e[r]):a(void 0,t[r])}function c(n){return n in t?a(e[n],t[n]):n in e?a(void 0,e[n]):void 0}var u={url:s,method:s,data:s,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:c};return n.forEach(Object.keys(e).concat(Object.keys(t)),(function(e){var t=u[e]||i,a=t(e);n.isUndefined(a)&&t!==c||(r[e]=a)})),r}}}),Sd=Zl({"../../node_modules/axios/lib/env/data.js":function(e,t){nd(),t.exports={version:"0.23.0"}}}),Rd=Zl({"../../node_modules/axios/lib/helpers/validator.js":function(e,t){nd();var n=Sd().version,r={};["object","boolean","number","function","string","symbol"].forEach((function(e,t){r[e]=function(n){return typeof n===e||"a"+(t<1?"n ":" ")+e}}));var a={};r.transitional=function(e,t,r){function i(e,t){return"[Axios v"+n+"] Transitional option '"+e+"'"+t+(r?". "+r:"")}return function(n,r,s){if(!1===e)throw new Error(i(r," has been removed"+(t?" in "+t:"")));return t&&!a[r]&&(a[r]=!0,console.warn(i(r," has been deprecated since v"+t+" and will be removed in the near future"))),!e||e(n,r,s)}},t.exports={assertOptions:function(e,t,n){if("object"!==typeof e)throw new TypeError("options must be an object");for(var r=Object.keys(e),a=r.length;a-- >0;){var i=r[a],s=t[i];if(s){var o=e[i],c=void 0===o||s(o,i,e);if(!0!==c)throw new TypeError("option "+i+" must be "+c)}else if(!0!==n)throw Error("Unknown option "+i)}},validators:r}}}),Pd=Zl({"../../node_modules/axios/lib/core/Axios.js":function(e,t){nd();var n=ad(),r=id(),a=sd(),i=kd(),s=xd(),o=Rd(),c=o.validators;function u(e){this.defaults=e,this.interceptors={request:new a,response:new a}}u.prototype.request=function(e){"string"===typeof e?(e=arguments[1]||{}).url=arguments[0]:e=e||{},(e=s(this.defaults,e)).method?e.method=e.method.toLowerCase():this.defaults.method?e.method=this.defaults.method.toLowerCase():e.method="get";var t=e.transitional;void 0!==t&&o.assertOptions(t,{silentJSONParsing:c.transitional(c.boolean),forcedJSONParsing:c.transitional(c.boolean),clarifyTimeoutError:c.transitional(c.boolean)},!1);var n=[],r=!0;this.interceptors.request.forEach((function(t){"function"===typeof t.runWhen&&!1===t.runWhen(e)||(r=r&&t.synchronous,n.unshift(t.fulfilled,t.rejected))}));var a,u=[];if(this.interceptors.response.forEach((function(e){u.push(e.fulfilled,e.rejected)})),!r){var l=[i,void 0];for(Array.prototype.unshift.apply(l,n),l=l.concat(u),a=Promise.resolve(e);l.length;)a=a.then(l.shift(),l.shift());return a}for(var d=e;n.length;){var p=n.shift(),f=n.shift();try{d=p(d)}catch(h){f(h);break}}try{a=i(d)}catch(h){return Promise.reject(h)}for(;u.length;)a=a.then(u.shift(),u.shift());return a},u.prototype.getUri=function(e){return e=s(this.defaults,e),r(e.url,e.params,e.paramsSerializer).replace(/^\?/,"")},n.forEach(["delete","get","head","options"],(function(e){u.prototype[e]=function(t,n){return this.request(s(n||{},{method:e,url:t,data:(n||{}).data}))}})),n.forEach(["post","put","patch"],(function(e){u.prototype[e]=function(t,n,r){return this.request(s(r||{},{method:e,url:t,data:n}))}})),t.exports=u}}),Cd=Zl({"../../node_modules/axios/lib/cancel/CancelToken.js":function(e,t){nd();var n=gd();function r(e){if("function"!==typeof e)throw new TypeError("executor must be a function.");var t;this.promise=new Promise((function(e){t=e}));var r=this;this.promise.then((function(e){if(r._listeners){var t,n=r._listeners.length;for(t=0;t<n;t++)r._listeners[t](e);r._listeners=null}})),this.promise.then=function(e){var t,n=new Promise((function(e){r.subscribe(e),t=e})).then(e);return n.cancel=function(){r.unsubscribe(t)},n},e((function(e){r.reason||(r.reason=new n(e),t(r.reason))}))}r.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},r.prototype.subscribe=function(e){this.reason?e(this.reason):this._listeners?this._listeners.push(e):this._listeners=[e]},r.prototype.unsubscribe=function(e){if(this._listeners){var t=this._listeners.indexOf(e);-1!==t&&this._listeners.splice(t,1)}},r.source=function(){var e;return{token:new r((function(t){e=t})),cancel:e}},t.exports=r}}),Td=Zl({"../../node_modules/axios/lib/helpers/spread.js":function(e,t){nd(),t.exports=function(e){return function(t){return e.apply(null,t)}}}}),Ed=Zl({"../../node_modules/axios/lib/helpers/isAxiosError.js":function(e,t){nd(),t.exports=function(e){return"object"===typeof e&&!0===e.isAxiosError}}}),Od=Zl({"../../node_modules/axios/lib/axios.js":function(e,t){nd();var n=ad(),r=rd(),a=Pd(),i=xd();var s=function e(t){var s=new a(t),o=r(a.prototype.request,s);return n.extend(o,a.prototype,s),n.extend(o,s),o.create=function(n){return e(i(t,n))},o}(yd());s.Axios=a,s.Cancel=gd(),s.CancelToken=Cd(),s.isCancel=wd(),s.VERSION=Sd().version,s.all=function(e){return Promise.all(e)},s.spread=Td(),s.isAxiosError=Ed(),t.exports=s,t.exports.default=s}}),Md=Zl({"../../node_modules/axios/index.js":function(e,t){nd(),t.exports=Od()}}),Id=Zl({"../../node_modules/isomorphic-ws/browser.js":function(e,t){nd();var n=null;"undefined"!==typeof WebSocket?n=WebSocket:"undefined"!==typeof MozWebSocket?n=MozWebSocket:"undefined"!==typeof global?n=global.WebSocket||global.MozWebSocket:"undefined"!==typeof window?n=window.WebSocket||window.MozWebSocket:"undefined"!==typeof self&&(n=self.WebSocket||self.MozWebSocket),t.exports=n}}),Dd=Zl({"../../node_modules/deepmerge/dist/cjs.js":function(e,t){nd();var n=function(e){return function(e){return!!e&&"object"===typeof e}(e)&&!function(e){var t=Object.prototype.toString.call(e);return"[object RegExp]"===t||"[object Date]"===t||function(e){return e.$$typeof===r}(e)}(e)};var r="function"===typeof Symbol&&Symbol.for?Symbol.for("react.element"):60103;function a(e,t){return!1!==t.clone&&t.isMergeableObject(e)?u((n=e,Array.isArray(n)?[]:{}),e,t):e;var n}function i(e,t,n){return e.concat(t).map((function(e){return a(e,n)}))}function s(e){return Object.keys(e).concat(function(e){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(e).filter((function(t){return e.propertyIsEnumerable(t)})):[]}(e))}function o(e,t){try{return t in e}catch(n){return!1}}function c(e,t,n){var r={};return n.isMergeableObject(e)&&s(e).forEach((function(t){r[t]=a(e[t],n)})),s(t).forEach((function(i){(function(e,t){return o(e,t)&&!(Object.hasOwnProperty.call(e,t)&&Object.propertyIsEnumerable.call(e,t))})(e,i)||(o(e,i)&&n.isMergeableObject(t[i])?r[i]=function(e,t){if(!t.customMerge)return u;var n=t.customMerge(e);return"function"===typeof n?n:u}(i,n)(e[i],t[i],n):r[i]=a(t[i],n))})),r}function u(e,t,r){(r=r||{}).arrayMerge=r.arrayMerge||i,r.isMergeableObject=r.isMergeableObject||n,r.cloneUnlessOtherwiseSpecified=a;var s=Array.isArray(t);return s===Array.isArray(e)?s?r.arrayMerge(e,t,r):c(e,t,r):a(t,r)}u.all=function(e,t){if(!Array.isArray(e))throw new Error("first argument should be an array");return e.reduce((function(e,n){return u(e,n,t)}),{})};var l=u;t.exports=l}}),jd=Zl({"../../node_modules/ts.cryptojs256/ts.cryptojs256.js":function(e){nd();var t=t||function(e,t){var n={},r=n.lib={},a=function(){},i=r.Base={extend:function(e){a.prototype=this;var t=new a;return e&&t.mixIn(e),t.hasOwnProperty("init")||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},s=r.WordArray=i.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=undefined!=t?t:4*e.length},toString:function(e){return(e||c).stringify(this)},concat:function(e){var t=this.words,n=e.words,r=this.sigBytes;if(e=e.sigBytes,this.clamp(),r%4)for(var a=0;a<e;a++)t[r+a>>>2]|=(n[a>>>2]>>>24-a%4*8&255)<<24-(r+a)%4*8;else if(65535<n.length)for(a=0;a<e;a+=4)t[r+a>>>2]=n[a>>>2];else t.push.apply(t,n);return this.sigBytes+=e,this},clamp:function(){var t=this.words,n=this.sigBytes;t[n>>>2]&=4294967295<<32-n%4*8,t.length=e.ceil(n/4)},clone:function(){var e=i.clone.call(this);return e.words=this.words.slice(0),e},random:function(t){for(var n=[],r=0;r<t;r+=4)n.push(4294967296*e.random()|0);return new s.init(n,t)}}),o=n.enc={},c=o.Hex={stringify:function(e){var t=e.words;e=e.sigBytes;for(var n=[],r=0;r<e;r++){var a=t[r>>>2]>>>24-r%4*8&255;n.push((a>>>4).toString(16)),n.push((15&a).toString(16))}return n.join("")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r+=2)n[r>>>3]|=parseInt(e.substr(r,2),16)<<24-r%8*4;return new s.init(n,t/2)}},u=o.Latin1={stringify:function(e){var t=e.words;e=e.sigBytes;for(var n=[],r=0;r<e;r++)n.push(String.fromCharCode(t[r>>>2]>>>24-r%4*8&255));return n.join("")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r++)n[r>>>2]|=(255&e.charCodeAt(r))<<24-r%4*8;return new s.init(n,t)}},l=o.Utf8={stringify:function(e){try{return decodeURIComponent(escape(u.stringify(e)))}catch(t){throw Error("Malformed UTF-8 data")}},parse:function(e){return u.parse(unescape(encodeURIComponent(e)))}},d=r.BufferedBlockAlgorithm=i.extend({reset:function(){this._data=new s.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=l.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var n=this._data,r=n.words,a=n.sigBytes,i=this.blockSize,o=a/(4*i);if(t=(o=t?e.ceil(o):e.max((0|o)-this._minBufferSize,0))*i,a=e.min(4*t,a),t){for(var c=0;c<t;c+=i)this._doProcessBlock(r,c);c=r.splice(0,t),n.sigBytes-=a}return new s.init(c,a)},clone:function(){var e=i.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0});r.Hasher=d.extend({cfg:i.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){d.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,n){return new e.init(n).finalize(t)}},_createHmacHelper:function(e){return function(t,n){return new p.HMAC.init(e,n).finalize(t)}}});var p=n.algo={};return n}(Math);!function(e){for(var n=t,r=(i=n.lib).WordArray,a=i.Hasher,i=n.algo,s=[],o=[],c=function(e){return 4294967296*(e-(0|e))|0},u=2,l=0;64>l;){var d;e:{d=u;for(var p=e.sqrt(d),f=2;f<=p;f++)if(!(d%f)){d=!1;break e}d=!0}d&&(8>l&&(s[l]=c(e.pow(u,.5))),o[l]=c(e.pow(u,1/3)),l++),u++}var h=[];i=i.SHA256=a.extend({_doReset:function(){this._hash=new r.init(s.slice(0))},_doProcessBlock:function(e,t){for(var n=this._hash.words,r=n[0],a=n[1],i=n[2],s=n[3],c=n[4],u=n[5],l=n[6],d=n[7],p=0;64>p;p++){if(16>p)h[p]=0|e[t+p];else{var f=h[p-15],m=h[p-2];h[p]=((f<<25|f>>>7)^(f<<14|f>>>18)^f>>>3)+h[p-7]+((m<<15|m>>>17)^(m<<13|m>>>19)^m>>>10)+h[p-16]}f=d+((c<<26|c>>>6)^(c<<21|c>>>11)^(c<<7|c>>>25))+(c&u^~c&l)+o[p]+h[p],m=((r<<30|r>>>2)^(r<<19|r>>>13)^(r<<10|r>>>22))+(r&a^r&i^a&i),d=l,l=u,u=c,c=s+f|0,s=i,i=a,a=r,r=f+m|0}n[0]=n[0]+r|0,n[1]=n[1]+a|0,n[2]=n[2]+i|0,n[3]=n[3]+s|0,n[4]=n[4]+c|0,n[5]=n[5]+u|0,n[6]=n[6]+l|0,n[7]=n[7]+d|0},_doFinalize:function(){var t=this._data,n=t.words,r=8*this._nDataBytes,a=8*t.sigBytes;return n[a>>>5]|=128<<24-a%32,n[14+(a+64>>>9<<4)]=e.floor(r/4294967296),n[15+(a+64>>>9<<4)]=r,t.sigBytes=4*n.length,this._process(),this._hash},clone:function(){var e=a.clone.call(this);return e._hash=this._hash.clone(),e}});n.SHA256=a._createHelper(i),n.HmacSHA256=a._createHmacHelper(i)}(Math),function(){var e=t,n=e.enc.Utf8;e.algo.HMAC=e.lib.Base.extend({init:function(e,t){e=this._hasher=new e.init,"string"==typeof t&&(t=n.parse(t));var r=e.blockSize,a=4*r;t.sigBytes>a&&(t=e.finalize(t)),t.clamp();for(var i=this._oKey=t.clone(),s=this._iKey=t.clone(),o=i.words,c=s.words,u=0;u<r;u++)o[u]^=1549556828,c[u]^=909522486;i.sigBytes=s.sigBytes=a,this.reset()},reset:function(){var e=this._hasher;e.reset(),e.update(this._iKey)},update:function(e){return this._hasher.update(e),this},finalize:function(e){var t=this._hasher;return e=t.finalize(e),t.reset(),t.finalize(this._oKey.clone().concat(e))}})}(),function(){var e=t,n=e.lib.WordArray;e.enc.Base64={stringify:function(e){var t=e.words,n=e.sigBytes,r=this._map;e.clamp(),e=[];for(var a=0;a<n;a+=3)for(var i=(t[a>>>2]>>>24-a%4*8&255)<<16|(t[a+1>>>2]>>>24-(a+1)%4*8&255)<<8|t[a+2>>>2]>>>24-(a+2)%4*8&255,s=0;4>s&&a+.75*s<n;s++)e.push(r.charAt(i>>>6*(3-s)&63));if(t=r.charAt(64))for(;e.length%4;)e.push(t);return e.join("")},parse:function(e){var t=e.length,r=this._map;(a=r.charAt(64))&&(-1!=(a=e.indexOf(a))&&(t=a));for(var a=[],i=0,s=0;s<t;s++)if(s%4){var o=r.indexOf(e.charAt(s-1))<<s%4*2,c=r.indexOf(e.charAt(s))>>>6-s%4*2;a[i>>>2]|=(o|c)<<24-i%4*8,i++}return n.create(a,i)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),function(e){for(var n=t,r=(i=n.lib).WordArray,a=i.Hasher,i=n.algo,s=[],o=[],c=function(e){return 4294967296*(e-(0|e))|0},u=2,l=0;64>l;){var d;e:{d=u;for(var p=e.sqrt(d),f=2;f<=p;f++)if(!(d%f)){d=!1;break e}d=!0}d&&(8>l&&(s[l]=c(e.pow(u,.5))),o[l]=c(e.pow(u,1/3)),l++),u++}var h=[];i=i.SHA256=a.extend({_doReset:function(){this._hash=new r.init(s.slice(0))},_doProcessBlock:function(e,t){for(var n=this._hash.words,r=n[0],a=n[1],i=n[2],s=n[3],c=n[4],u=n[5],l=n[6],d=n[7],p=0;64>p;p++){if(16>p)h[p]=0|e[t+p];else{var f=h[p-15],m=h[p-2];h[p]=((f<<25|f>>>7)^(f<<14|f>>>18)^f>>>3)+h[p-7]+((m<<15|m>>>17)^(m<<13|m>>>19)^m>>>10)+h[p-16]}f=d+((c<<26|c>>>6)^(c<<21|c>>>11)^(c<<7|c>>>25))+(c&u^~c&l)+o[p]+h[p],m=((r<<30|r>>>2)^(r<<19|r>>>13)^(r<<10|r>>>22))+(r&a^r&i^a&i),d=l,l=u,u=c,c=s+f|0,s=i,i=a,a=r,r=f+m|0}n[0]=n[0]+r|0,n[1]=n[1]+a|0,n[2]=n[2]+i|0,n[3]=n[3]+s|0,n[4]=n[4]+c|0,n[5]=n[5]+u|0,n[6]=n[6]+l|0,n[7]=n[7]+d|0},_doFinalize:function(){var t=this._data,n=t.words,r=8*this._nDataBytes,a=8*t.sigBytes;return n[a>>>5]|=128<<24-a%32,n[14+(a+64>>>9<<4)]=e.floor(r/4294967296),n[15+(a+64>>>9<<4)]=r,t.sigBytes=4*n.length,this._process(),this._hash},clone:function(){var e=a.clone.call(this);return e._hash=this._hash.clone(),e}});n.SHA256=a._createHelper(i),n.HmacSHA256=a._createHmacHelper(i)}(Math),e.enc={Base64:t.enc.Base64,Utf8:t.enc.Utf8,Latin1:t.enc.Latin1},e.SHA256=t.SHA256,e.HmacSHA256=t.HmacSHA256}}),Ld=Zl({"../../node_modules/jwt-encode/src/index.js":function(e,t){nd();var n=jd(),r={alg:"HS256",typ:"JWT"};function a(e){return n.enc.Base64.stringify(e).replace(/=+$/,"").replace(/\+/g,"-").replace(/\//g,"_")}function i(e){return a(n.enc.Utf8.parse(JSON.stringify(e)))}t.exports=function(e,t){var s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=Object.assign(r,s);if("HS256"!==o.alg&&"JWT"!==o.typ)throw new Error("jwt-encode only support the HS256 algorithm and the JWT type of hash");var c=i(o),u=i(e),l="".concat(c,".").concat(u);return l=a(l=n.HmacSHA256(l,t)),"".concat(c,".").concat(u,".").concat(l)}}}),Ad=Zl({"../../node_modules/sdp-transform/lib/grammar.js":function(e,t){nd();var n=t.exports={v:[{name:"version",reg:/^(\d*)$/}],o:[{name:"origin",reg:/^(\S*) (\d*) (\d*) (\S*) IP(\d) (\S*)/,names:["username","sessionId","sessionVersion","netType","ipVer","address"],format:"%s %s %d %s IP%d %s"}],s:[{name:"name"}],i:[{name:"description"}],u:[{name:"uri"}],e:[{name:"email"}],p:[{name:"phone"}],z:[{name:"timezones"}],r:[{name:"repeats"}],t:[{name:"timing",reg:/^(\d*) (\d*)/,names:["start","stop"],format:"%d %d"}],c:[{name:"connection",reg:/^IN IP(\d) (\S*)/,names:["version","ip"],format:"IN IP%d %s"}],b:[{push:"bandwidth",reg:/^(TIAS|AS|CT|RR|RS):(\d*)/,names:["type","limit"],format:"%s:%s"}],m:[{reg:/^(\w*) (\d*) ([\w/]*)(?: (.*))?/,names:["type","port","protocol","payloads"],format:"%s %d %s %s"}],a:[{push:"rtp",reg:/^rtpmap:(\d*) ([\w\-.]*)(?:\s*\/(\d*)(?:\s*\/(\S*))?)?/,names:["payload","codec","rate","encoding"],format:function(e){return e.encoding?"rtpmap:%d %s/%s/%s":e.rate?"rtpmap:%d %s/%s":"rtpmap:%d %s"}},{push:"fmtp",reg:/^fmtp:(\d*) ([\S| ]*)/,names:["payload","config"],format:"fmtp:%d %s"},{name:"control",reg:/^control:(.*)/,format:"control:%s"},{name:"rtcp",reg:/^rtcp:(\d*)(?: (\S*) IP(\d) (\S*))?/,names:["port","netType","ipVer","address"],format:function(e){return null!=e.address?"rtcp:%d %s IP%d %s":"rtcp:%d"}},{push:"rtcpFbTrrInt",reg:/^rtcp-fb:(\*|\d*) trr-int (\d*)/,names:["payload","value"],format:"rtcp-fb:%s trr-int %d"},{push:"rtcpFb",reg:/^rtcp-fb:(\*|\d*) ([\w-_]*)(?: ([\w-_]*))?/,names:["payload","type","subtype"],format:function(e){return null!=e.subtype?"rtcp-fb:%s %s %s":"rtcp-fb:%s %s"}},{push:"ext",reg:/^extmap:(\d+)(?:\/(\w+))?(?: (urn:ietf:params:rtp-hdrext:encrypt))? (\S*)(?: (\S*))?/,names:["value","direction","encrypt-uri","uri","config"],format:function(e){return"extmap:%d"+(e.direction?"/%s":"%v")+(e["encrypt-uri"]?" %s":"%v")+" %s"+(e.config?" %s":"")}},{name:"extmapAllowMixed",reg:/^(extmap-allow-mixed)/},{push:"crypto",reg:/^crypto:(\d*) ([\w_]*) (\S*)(?: (\S*))?/,names:["id","suite","config","sessionConfig"],format:function(e){return null!=e.sessionConfig?"crypto:%d %s %s %s":"crypto:%d %s %s"}},{name:"setup",reg:/^setup:(\w*)/,format:"setup:%s"},{name:"connectionType",reg:/^connection:(new|existing)/,format:"connection:%s"},{name:"mid",reg:/^mid:([^\s]*)/,format:"mid:%s"},{name:"msid",reg:/^msid:(.*)/,format:"msid:%s"},{name:"ptime",reg:/^ptime:(\d*(?:\.\d*)*)/,format:"ptime:%d"},{name:"maxptime",reg:/^maxptime:(\d*(?:\.\d*)*)/,format:"maxptime:%d"},{name:"direction",reg:/^(sendrecv|recvonly|sendonly|inactive)/},{name:"icelite",reg:/^(ice-lite)/},{name:"iceUfrag",reg:/^ice-ufrag:(\S*)/,format:"ice-ufrag:%s"},{name:"icePwd",reg:/^ice-pwd:(\S*)/,format:"ice-pwd:%s"},{name:"fingerprint",reg:/^fingerprint:(\S*) (\S*)/,names:["type","hash"],format:"fingerprint:%s %s"},{push:"candidates",reg:/^candidate:(\S*) (\d*) (\S*) (\d*) (\S*) (\d*) typ (\S*)(?: raddr (\S*) rport (\d*))?(?: tcptype (\S*))?(?: generation (\d*))?(?: network-id (\d*))?(?: network-cost (\d*))?/,names:["foundation","component","transport","priority","ip","port","type","raddr","rport","tcptype","generation","network-id","network-cost"],format:function(e){var t="candidate:%s %d %s %d %s %d typ %s";return t+=null!=e.raddr?" raddr %s rport %d":"%v%v",t+=null!=e.tcptype?" tcptype %s":"%v",null!=e.generation&&(t+=" generation %d"),t+=null!=e["network-id"]?" network-id %d":"%v",t+=null!=e["network-cost"]?" network-cost %d":"%v"}},{name:"endOfCandidates",reg:/^(end-of-candidates)/},{name:"remoteCandidates",reg:/^remote-candidates:(.*)/,format:"remote-candidates:%s"},{name:"iceOptions",reg:/^ice-options:(\S*)/,format:"ice-options:%s"},{push:"ssrcs",reg:/^ssrc:(\d*) ([\w_-]*)(?::(.*))?/,names:["id","attribute","value"],format:function(e){var t="ssrc:%d";return null!=e.attribute&&(t+=" %s",null!=e.value&&(t+=":%s")),t}},{push:"ssrcGroups",reg:/^ssrc-group:([\x21\x23\x24\x25\x26\x27\x2A\x2B\x2D\x2E\w]*) (.*)/,names:["semantics","ssrcs"],format:"ssrc-group:%s %s"},{name:"msidSemantic",reg:/^msid-semantic:\s?(\w*) (\S*)/,names:["semantic","token"],format:"msid-semantic: %s %s"},{push:"groups",reg:/^group:(\w*) (.*)/,names:["type","mids"],format:"group:%s %s"},{name:"rtcpMux",reg:/^(rtcp-mux)/},{name:"rtcpRsize",reg:/^(rtcp-rsize)/},{name:"sctpmap",reg:/^sctpmap:([\w_/]*) (\S*)(?: (\S*))?/,names:["sctpmapNumber","app","maxMessageSize"],format:function(e){return null!=e.maxMessageSize?"sctpmap:%s %s %s":"sctpmap:%s %s"}},{name:"xGoogleFlag",reg:/^x-google-flag:([^\s]*)/,format:"x-google-flag:%s"},{push:"rids",reg:/^rid:([\d\w]+) (\w+)(?: ([\S| ]*))?/,names:["id","direction","params"],format:function(e){return e.params?"rid:%s %s %s":"rid:%s %s"}},{push:"imageattrs",reg:new RegExp("^imageattr:(\\d+|\\*)[\\s\\t]+(send|recv)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*)(?:[\\s\\t]+(recv|send)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*))?"),names:["pt","dir1","attrs1","dir2","attrs2"],format:function(e){return"imageattr:%s %s %s"+(e.dir2?" %s %s":"")}},{name:"simulcast",reg:new RegExp("^simulcast:(send|recv) ([a-zA-Z0-9\\-_~;,]+)(?:\\s?(send|recv) ([a-zA-Z0-9\\-_~;,]+))?$"),names:["dir1","list1","dir2","list2"],format:function(e){return"simulcast:%s %s"+(e.dir2?" %s %s":"")}},{name:"simulcast_03",reg:/^simulcast:[\s\t]+([\S+\s\t]+)$/,names:["value"],format:"simulcast: %s"},{name:"framerate",reg:/^framerate:(\d+(?:$|\.\d+))/,format:"framerate:%s"},{name:"sourceFilter",reg:/^source-filter: *(excl|incl) (\S*) (IP4|IP6|\*) (\S*) (.*)/,names:["filterMode","netType","addressTypes","destAddress","srcList"],format:"source-filter: %s %s %s %s %s"},{name:"bundleOnly",reg:/^(bundle-only)/},{name:"label",reg:/^label:(.+)/,format:"label:%s"},{name:"sctpPort",reg:/^sctp-port:(\d+)$/,format:"sctp-port:%s"},{name:"maxMessageSize",reg:/^max-message-size:(\d+)$/,format:"max-message-size:%s"},{push:"tsRefClocks",reg:/^ts-refclk:([^\s=]*)(?:=(\S*))?/,names:["clksrc","clksrcExt"],format:function(e){return"ts-refclk:%s"+(null!=e.clksrcExt?"=%s":"")}},{name:"mediaClk",reg:/^mediaclk:(?:id=(\S*))? *([^\s=]*)(?:=(\S*))?(?: *rate=(\d+)\/(\d+))?/,names:["id","mediaClockName","mediaClockValue","rateNumerator","rateDenominator"],format:function(e){var t="mediaclk:";return t+=null!=e.id?"id=%s %s":"%v%s",t+=null!=e.mediaClockValue?"=%s":"",t+=null!=e.rateNumerator?" rate=%s":"",t+=null!=e.rateDenominator?"/%s":""}},{name:"keywords",reg:/^keywds:(.+)$/,format:"keywds:%s"},{name:"content",reg:/^content:(.+)/,format:"content:%s"},{name:"bfcpFloorCtrl",reg:/^floorctrl:(c-only|s-only|c-s)/,format:"floorctrl:%s"},{name:"bfcpConfId",reg:/^confid:(\d+)/,format:"confid:%s"},{name:"bfcpUserId",reg:/^userid:(\d+)/,format:"userid:%s"},{name:"bfcpFloorId",reg:/^floorid:(.+) (?:m-stream|mstrm):(.+)/,names:["id","mStream"],format:"floorid:%s mstrm:%s"},{push:"invalid",names:["value"]}]};Object.keys(n).forEach((function(e){n[e].forEach((function(e){e.reg||(e.reg=/(.*)/),e.format||(e.format="%s")}))}))}}),Fd=Zl({"../../node_modules/sdp-transform/lib/parser.js":function(e){nd();var t=function(e){return String(Number(e))===e?Number(e):e},n=function(e,n,r){var a=e.name&&e.names;e.push&&!n[e.push]?n[e.push]=[]:a&&!n[e.name]&&(n[e.name]={});var i=e.push?{}:a?n[e.name]:n;!function(e,n,r,a){if(a&&!r)n[a]=t(e[1]);else for(var i=0;i<r.length;i+=1)null!=e[i+1]&&(n[r[i]]=t(e[i+1]))}(r.match(e.reg),i,e.names,e.name),e.push&&n[e.push].push(i)},r=Ad(),a=RegExp.prototype.test.bind(/^([a-z])=(.*)/);e.parse=function(e){var t={},i=[],s=t;return e.split(/(\r\n|\r|\n)/).filter(a).forEach((function(e){var t=e[0],a=e.slice(2);"m"===t&&(i.push({rtp:[],fmtp:[]}),s=i[i.length-1]);for(var o=0;o<(r[t]||[]).length;o+=1){var c=r[t][o];if(c.reg.test(a))return n(c,s,a)}})),t.media=i,t};var i=function(e,n){var r=n.split(/=(.+)/,2);return 2===r.length?e[r[0]]=t(r[1]):1===r.length&&n.length>1&&(e[r[0]]=void 0),e};e.parseParams=function(e){return e.split(/;\s?/).reduce(i,{})},e.parseFmtpConfig=e.parseParams,e.parsePayloads=function(e){return e.toString().split(" ").map(Number)},e.parseRemoteCandidates=function(e){for(var n=[],r=e.split(" ").map(t),a=0;a<r.length;a+=3)n.push({component:r[a],ip:r[a+1],port:r[a+2]});return n},e.parseImageAttributes=function(e){return e.split(" ").map((function(e){return e.substring(1,e.length-1).split(",").reduce(i,{})}))},e.parseSimulcastStreamList=function(e){return e.split(";").map((function(e){return e.split(",").map((function(e){var n,r=!1;return"~"!==e[0]?n=t(e):(n=t(e.substring(1,e.length)),r=!0),{scid:n,paused:r}}))}))}}}),Nd=Zl({"../../node_modules/sdp-transform/lib/writer.js":function(e,t){nd();var n=Ad(),r=/%[sdv%]/g,a=function(e){var t=1,n=arguments,a=n.length;return e.replace(r,(function(e){if(t>=a)return e;var r=n[t];switch(t+=1,e){case"%%":return"%";case"%s":return String(r);case"%d":return Number(r);case"%v":return""}}))},i=function(e,t,n){var r=[e+"="+(t.format instanceof Function?t.format(t.push?n:n[t.name]):t.format)];if(t.names)for(var i=0;i<t.names.length;i+=1){var s=t.names[i];t.name?r.push(n[t.name][s]):r.push(n[t.names[i]])}else r.push(n[t.name]);return a.apply(null,r)},s=["v","o","s","i","u","e","p","c","b","t","r","z","a"],o=["i","c","b","a"];t.exports=function(e,t){t=t||{},null==e.version&&(e.version=0),null==e.name&&(e.name=" "),e.media.forEach((function(e){null==e.payloads&&(e.payloads="")}));var r=t.outerOrder||s,a=t.innerOrder||o,c=[];return r.forEach((function(t){n[t].forEach((function(n){n.name in e&&null!=e[n.name]?c.push(i(t,n,e)):n.push in e&&null!=e[n.push]&&e[n.push].forEach((function(e){c.push(i(t,n,e))}))}))})),e.media.forEach((function(e){c.push(i("m",n.m[0],e)),a.forEach((function(t){n[t].forEach((function(n){n.name in e&&null!=e[n.name]?c.push(i(t,n,e)):n.push in e&&null!=e[n.push]&&e[n.push].forEach((function(e){c.push(i(t,n,e))}))}))}))})),c.join("\r\n")+"\r\n"}}}),Bd=Zl({"../../node_modules/sdp-transform/lib/index.js":function(e){nd();var t=Fd(),n=Nd();e.write=n,e.parse=t.parse,e.parseParams=t.parseParams,e.parseFmtpConfig=t.parseFmtpConfig,e.parsePayloads=t.parsePayloads,e.parseRemoteCandidates=t.parseRemoteCandidates,e.parseImageAttributes=t.parseImageAttributes,e.parseSimulcastStreamList=t.parseSimulcastStreamList}}),Ud=Zl({"../../node_modules/ms/index.js":function(e,t){nd();var n=1e3,r=60*n,a=60*r,i=24*a,s=7*i,o=365.25*i;function c(e,t,n,r){var a=t>=1.5*n;return Math.round(e/n)+" "+r+(a?"s":"")}t.exports=function(e,t){t=t||{};var u=typeof e;if("string"===u&&e.length>0)return function(e){if((e=String(e)).length>100)return;var t=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(!t)return;var c=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return c*o;case"weeks":case"week":case"w":return c*s;case"days":case"day":case"d":return c*i;case"hours":case"hour":case"hrs":case"hr":case"h":return c*a;case"minutes":case"minute":case"mins":case"min":case"m":return c*r;case"seconds":case"second":case"secs":case"sec":case"s":return c*n;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return c;default:return}}(e);if("number"===u&&isFinite(e))return t.long?function(e){var t=Math.abs(e);if(t>=i)return c(e,t,i,"day");if(t>=a)return c(e,t,a,"hour");if(t>=r)return c(e,t,r,"minute");if(t>=n)return c(e,t,n,"second");return e+" ms"}(e):function(e){var t=Math.abs(e);if(t>=i)return Math.round(e/i)+"d";if(t>=a)return Math.round(e/a)+"h";if(t>=r)return Math.round(e/r)+"m";if(t>=n)return Math.round(e/n)+"s";return e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}}}),zd=Zl({"../../node_modules/debug/src/common.js":function(e,t){nd(),t.exports=function(e){function t(e){var r,a,i,s=null;function o(){for(var e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];if(o.enabled){var i=o,s=Number(new Date),c=s-(r||s);i.diff=c,i.prev=r,i.curr=s,r=s,n[0]=t.coerce(n[0]),"string"!==typeof n[0]&&n.unshift("%O");var u=0;n[0]=n[0].replace(/%([a-zA-Z%])/g,(function(e,r){if("%%"===e)return"%";u++;var a=t.formatters[r];if("function"===typeof a){var s=n[u];e=a.call(i,s),n.splice(u,1),u--}return e})),t.formatArgs.call(i,n);var l=i.log||t.log;l.apply(i,n)}}return o.namespace=e,o.useColors=t.useColors(),o.color=t.selectColor(e),o.extend=n,o.destroy=t.destroy,Object.defineProperty(o,"enabled",{enumerable:!0,configurable:!1,get:function(){return null!==s?s:(a!==t.namespaces&&(a=t.namespaces,i=t.enabled(e)),i)},set:function(e){s=e}}),"function"===typeof t.init&&t.init(o),o}function n(e,n){var r=t(this.namespace+("undefined"===typeof n?":":n)+e);return r.log=this.log,r}function r(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return t.debug=t,t.default=t,t.coerce=function(e){if(e instanceof Error)return e.stack||e.message;return e},t.disable=function(){var e=[].concat(xt(t.names.map(r)),xt(t.skips.map(r).map((function(e){return"-"+e})))).join(",");return t.enable(""),e},t.enable=function(e){var n;t.save(e),t.namespaces=e,t.names=[],t.skips=[];var r=("string"===typeof e?e:"").split(/[\s,]+/),a=r.length;for(n=0;n<a;n++)r[n]&&("-"===(e=r[n].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.slice(1)+"$")):t.names.push(new RegExp("^"+e+"$")))},t.enabled=function(e){if("*"===e[e.length-1])return!0;var n,r;for(n=0,r=t.skips.length;n<r;n++)if(t.skips[n].test(e))return!1;for(n=0,r=t.names.length;n<r;n++)if(t.names[n].test(e))return!0;return!1},t.humanize=Ud(),t.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(e).forEach((function(n){t[n]=e[n]})),t.names=[],t.skips=[],t.formatters={},t.selectColor=function(e){for(var n=0,r=0;r<e.length;r++)n=(n<<5)-n+e.charCodeAt(r),n|=0;return t.colors[Math.abs(n)%t.colors.length]},t.enable(t.load()),t}}}),Vd=Zl({"../../node_modules/debug/src/browser.js":function(e,t){nd(),e.formatArgs=function(e){if(e[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+e[0]+(this.useColors?"%c ":" ")+"+"+t.exports.humanize(this.diff),!this.useColors)return;var n="color: "+this.color;e.splice(1,0,n,"color: inherit");var r=0,a=0;e[0].replace(/%[a-zA-Z%]/g,(function(e){"%%"!==e&&(r++,"%c"===e&&(a=r))})),e.splice(a,0,n)},e.save=function(t){try{t?e.storage.setItem("debug",t):e.storage.removeItem("debug")}catch(n){}},e.load=function(){var t;try{t=e.storage.getItem("debug")}catch(n){}!t&&"undefined"!==typeof Nl&&"env"in Nl&&(t=Nl.env.DEBUG);return t},e.useColors=function(){if("undefined"!==typeof window&&window.process&&("renderer"===window.process.type||window.process.__nwjs))return!0;if("undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!==typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!==typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},e.storage=function(){try{return localStorage}catch(e){}}(),e.destroy=function(){var e=!1;return function(){e||(e=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}}(),e.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],e.log=console.debug||console.log||function(){},t.exports=zd()(e),t.exports.formatters.j=function(e){try{return JSON.stringify(e)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}}}}),Hd=Zl({"../../node_modules/bowser/es5.js":function(e,t){nd(),function(n,r){"object"==typeof e&&"object"==typeof t?t.exports=r():"function"==typeof define&&define.amd?define([],r):"object"==typeof e?e.bowser=r():n.bowser=r()}(e,(function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var a=t[r]={i:r,l:!1,exports:{}};return e[r].call(a.exports,a,a.exports,n),a.l=!0,a.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)n.d(r,a,function(t){return e[t]}.bind(null,a));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=90)}({17:function(e,t,n){t.__esModule=!0,t.default=void 0;var r=n(18),a=function(){function e(){}return e.getFirstMatch=function(e,t){var n=t.match(e);return n&&n.length>0&&n[1]||""},e.getSecondMatch=function(e,t){var n=t.match(e);return n&&n.length>1&&n[2]||""},e.matchAndReturnConst=function(e,t,n){if(e.test(t))return n},e.getWindowsVersionName=function(e){switch(e){case"NT":return"NT";case"XP":case"NT 5.1":return"XP";case"NT 5.0":return"2000";case"NT 5.2":return"2003";case"NT 6.0":return"Vista";case"NT 6.1":return"7";case"NT 6.2":return"8";case"NT 6.3":return"8.1";case"NT 10.0":return"10";default:return}},e.getMacOSVersionName=function(e){var t=e.split(".").splice(0,2).map((function(e){return parseInt(e,10)||0}));if(t.push(0),10===t[0])switch(t[1]){case 5:return"Leopard";case 6:return"Snow Leopard";case 7:return"Lion";case 8:return"Mountain Lion";case 9:return"Mavericks";case 10:return"Yosemite";case 11:return"El Capitan";case 12:return"Sierra";case 13:return"High Sierra";case 14:return"Mojave";case 15:return"Catalina";default:return}},e.getAndroidVersionName=function(e){var t=e.split(".").splice(0,2).map((function(e){return parseInt(e,10)||0}));if(t.push(0),!(1===t[0]&&t[1]<5))return 1===t[0]&&t[1]<6?"Cupcake":1===t[0]&&t[1]>=6?"Donut":2===t[0]&&t[1]<2?"Eclair":2===t[0]&&2===t[1]?"Froyo":2===t[0]&&t[1]>2?"Gingerbread":3===t[0]?"Honeycomb":4===t[0]&&t[1]<1?"Ice Cream Sandwich":4===t[0]&&t[1]<4?"Jelly Bean":4===t[0]&&t[1]>=4?"KitKat":5===t[0]?"Lollipop":6===t[0]?"Marshmallow":7===t[0]?"Nougat":8===t[0]?"Oreo":9===t[0]?"Pie":void 0},e.getVersionPrecision=function(e){return e.split(".").length},e.compareVersions=function(t,n,r){void 0===r&&(r=!1);var a=e.getVersionPrecision(t),i=e.getVersionPrecision(n),s=Math.max(a,i),o=0,c=e.map([t,n],(function(t){var n=s-e.getVersionPrecision(t),r=t+new Array(n+1).join(".0");return e.map(r.split("."),(function(e){return new Array(20-e.length).join("0")+e})).reverse()}));for(r&&(o=s-Math.min(a,i)),s-=1;s>=o;){if(c[0][s]>c[1][s])return 1;if(c[0][s]===c[1][s]){if(s===o)return 0;s-=1}else if(c[0][s]<c[1][s])return-1}},e.map=function(e,t){var n,r=[];if(Array.prototype.map)return Array.prototype.map.call(e,t);for(n=0;n<e.length;n+=1)r.push(t(e[n]));return r},e.find=function(e,t){var n,r;if(Array.prototype.find)return Array.prototype.find.call(e,t);for(n=0,r=e.length;n<r;n+=1){var a=e[n];if(t(a,n))return a}},e.assign=function(e){for(var t,n,r=e,a=arguments.length,i=new Array(a>1?a-1:0),s=1;s<a;s++)i[s-1]=arguments[s];if(Object.assign)return Object.assign.apply(Object,[e].concat(i));var o=function(){var e=i[t];"object"==typeof e&&null!==e&&Object.keys(e).forEach((function(t){r[t]=e[t]}))};for(t=0,n=i.length;t<n;t+=1)o();return e},e.getBrowserAlias=function(e){return r.BROWSER_ALIASES_MAP[e]},e.getBrowserTypeByAlias=function(e){return r.BROWSER_MAP[e]||""},e}();t.default=a,e.exports=t.default},18:function(e,t,n){t.__esModule=!0,t.ENGINE_MAP=t.OS_MAP=t.PLATFORMS_MAP=t.BROWSER_MAP=t.BROWSER_ALIASES_MAP=void 0,t.BROWSER_ALIASES_MAP={"Amazon Silk":"amazon_silk","Android Browser":"android",Bada:"bada",BlackBerry:"blackberry",Chrome:"chrome",Chromium:"chromium",Electron:"electron",Epiphany:"epiphany",Firefox:"firefox",Focus:"focus",Generic:"generic","Google Search":"google_search",Googlebot:"googlebot","Internet Explorer":"ie","K-Meleon":"k_meleon",Maxthon:"maxthon","Microsoft Edge":"edge","MZ Browser":"mz","NAVER Whale Browser":"naver",Opera:"opera","Opera Coast":"opera_coast",PhantomJS:"phantomjs",Puffin:"puffin",QupZilla:"qupzilla",QQ:"qq",QQLite:"qqlite",Safari:"safari",Sailfish:"sailfish","Samsung Internet for Android":"samsung_internet",SeaMonkey:"seamonkey",Sleipnir:"sleipnir",Swing:"swing",Tizen:"tizen","UC Browser":"uc",Vivaldi:"vivaldi","WebOS Browser":"webos",WeChat:"wechat","Yandex Browser":"yandex",Roku:"roku"},t.BROWSER_MAP={amazon_silk:"Amazon Silk",android:"Android Browser",bada:"Bada",blackberry:"BlackBerry",chrome:"Chrome",chromium:"Chromium",electron:"Electron",epiphany:"Epiphany",firefox:"Firefox",focus:"Focus",generic:"Generic",googlebot:"Googlebot",google_search:"Google Search",ie:"Internet Explorer",k_meleon:"K-Meleon",maxthon:"Maxthon",edge:"Microsoft Edge",mz:"MZ Browser",naver:"NAVER Whale Browser",opera:"Opera",opera_coast:"Opera Coast",phantomjs:"PhantomJS",puffin:"Puffin",qupzilla:"QupZilla",qq:"QQ Browser",qqlite:"QQ Browser Lite",safari:"Safari",sailfish:"Sailfish",samsung_internet:"Samsung Internet for Android",seamonkey:"SeaMonkey",sleipnir:"Sleipnir",swing:"Swing",tizen:"Tizen",uc:"UC Browser",vivaldi:"Vivaldi",webos:"WebOS Browser",wechat:"WeChat",yandex:"Yandex Browser"},t.PLATFORMS_MAP={tablet:"tablet",mobile:"mobile",desktop:"desktop",tv:"tv"},t.OS_MAP={WindowsPhone:"Windows Phone",Windows:"Windows",MacOS:"macOS",iOS:"iOS",Android:"Android",WebOS:"WebOS",BlackBerry:"BlackBerry",Bada:"Bada",Tizen:"Tizen",Linux:"Linux",ChromeOS:"Chrome OS",PlayStation4:"PlayStation 4",Roku:"Roku"},t.ENGINE_MAP={EdgeHTML:"EdgeHTML",Blink:"Blink",Trident:"Trident",Presto:"Presto",Gecko:"Gecko",WebKit:"WebKit"}},90:function(e,t,n){t.__esModule=!0,t.default=void 0;var r,a=(r=n(91))&&r.__esModule?r:{default:r},i=n(18);function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var o=function(){function e(){}var t,n;return e.getParser=function(e,t){if(void 0===t&&(t=!1),"string"!=typeof e)throw new Error("UserAgent should be a string");return new a.default(e,t)},e.parse=function(e){return new a.default(e).getResult()},t=e,n=[{key:"BROWSER_MAP",get:function(){return i.BROWSER_MAP}},{key:"ENGINE_MAP",get:function(){return i.ENGINE_MAP}},{key:"OS_MAP",get:function(){return i.OS_MAP}},{key:"PLATFORMS_MAP",get:function(){return i.PLATFORMS_MAP}}],null&&s(t.prototype,null),n&&s(t,n),e}();t.default=o,e.exports=t.default},91:function(e,t,n){t.__esModule=!0,t.default=void 0;var r=c(n(92)),a=c(n(93)),i=c(n(94)),s=c(n(95)),o=c(n(17));function c(e){return e&&e.__esModule?e:{default:e}}var u=function(){function e(e,t){if(void 0===t&&(t=!1),null==e||""===e)throw new Error("UserAgent parameter can't be empty");this._ua=e,this.parsedResult={},!0!==t&&this.parse()}var t=e.prototype;return t.getUA=function(){return this._ua},t.test=function(e){return e.test(this._ua)},t.parseBrowser=function(){var e=this;this.parsedResult.browser={};var t=o.default.find(r.default,(function(t){if("function"==typeof t.test)return t.test(e);if(t.test instanceof Array)return t.test.some((function(t){return e.test(t)}));throw new Error("Browser's test function is not valid")}));return t&&(this.parsedResult.browser=t.describe(this.getUA())),this.parsedResult.browser},t.getBrowser=function(){return this.parsedResult.browser?this.parsedResult.browser:this.parseBrowser()},t.getBrowserName=function(e){return e?String(this.getBrowser().name).toLowerCase()||"":this.getBrowser().name||""},t.getBrowserVersion=function(){return this.getBrowser().version},t.getOS=function(){return this.parsedResult.os?this.parsedResult.os:this.parseOS()},t.parseOS=function(){var e=this;this.parsedResult.os={};var t=o.default.find(a.default,(function(t){if("function"==typeof t.test)return t.test(e);if(t.test instanceof Array)return t.test.some((function(t){return e.test(t)}));throw new Error("Browser's test function is not valid")}));return t&&(this.parsedResult.os=t.describe(this.getUA())),this.parsedResult.os},t.getOSName=function(e){var t=this.getOS().name;return e?String(t).toLowerCase()||"":t||""},t.getOSVersion=function(){return this.getOS().version},t.getPlatform=function(){return this.parsedResult.platform?this.parsedResult.platform:this.parsePlatform()},t.getPlatformType=function(e){void 0===e&&(e=!1);var t=this.getPlatform().type;return e?String(t).toLowerCase()||"":t||""},t.parsePlatform=function(){var e=this;this.parsedResult.platform={};var t=o.default.find(i.default,(function(t){if("function"==typeof t.test)return t.test(e);if(t.test instanceof Array)return t.test.some((function(t){return e.test(t)}));throw new Error("Browser's test function is not valid")}));return t&&(this.parsedResult.platform=t.describe(this.getUA())),this.parsedResult.platform},t.getEngine=function(){return this.parsedResult.engine?this.parsedResult.engine:this.parseEngine()},t.getEngineName=function(e){return e?String(this.getEngine().name).toLowerCase()||"":this.getEngine().name||""},t.parseEngine=function(){var e=this;this.parsedResult.engine={};var t=o.default.find(s.default,(function(t){if("function"==typeof t.test)return t.test(e);if(t.test instanceof Array)return t.test.some((function(t){return e.test(t)}));throw new Error("Browser's test function is not valid")}));return t&&(this.parsedResult.engine=t.describe(this.getUA())),this.parsedResult.engine},t.parse=function(){return this.parseBrowser(),this.parseOS(),this.parsePlatform(),this.parseEngine(),this},t.getResult=function(){return o.default.assign({},this.parsedResult)},t.satisfies=function(e){var t=this,n={},r=0,a={},i=0;if(Object.keys(e).forEach((function(t){var s=e[t];"string"==typeof s?(a[t]=s,i+=1):"object"==typeof s&&(n[t]=s,r+=1)})),r>0){var s=Object.keys(n),c=o.default.find(s,(function(e){return t.isOS(e)}));if(c){var u=this.satisfies(n[c]);if(void 0!==u)return u}var l=o.default.find(s,(function(e){return t.isPlatform(e)}));if(l){var d=this.satisfies(n[l]);if(void 0!==d)return d}}if(i>0){var p=Object.keys(a),f=o.default.find(p,(function(e){return t.isBrowser(e,!0)}));if(void 0!==f)return this.compareVersion(a[f])}},t.isBrowser=function(e,t){void 0===t&&(t=!1);var n=this.getBrowserName().toLowerCase(),r=e.toLowerCase(),a=o.default.getBrowserTypeByAlias(r);return t&&a&&(r=a.toLowerCase()),r===n},t.compareVersion=function(e){var t=[0],n=e,r=!1,a=this.getBrowserVersion();if("string"==typeof a)return">"===e[0]||"<"===e[0]?(n=e.substr(1),"="===e[1]?(r=!0,n=e.substr(2)):t=[],">"===e[0]?t.push(1):t.push(-1)):"="===e[0]?n=e.substr(1):"~"===e[0]&&(r=!0,n=e.substr(1)),t.indexOf(o.default.compareVersions(a,n,r))>-1},t.isOS=function(e){return this.getOSName(!0)===String(e).toLowerCase()},t.isPlatform=function(e){return this.getPlatformType(!0)===String(e).toLowerCase()},t.isEngine=function(e){return this.getEngineName(!0)===String(e).toLowerCase()},t.is=function(e,t){return void 0===t&&(t=!1),this.isBrowser(e,t)||this.isOS(e)||this.isPlatform(e)},t.some=function(e){var t=this;return void 0===e&&(e=[]),e.some((function(e){return t.is(e)}))},e}();t.default=u,e.exports=t.default},92:function(e,t,n){t.__esModule=!0,t.default=void 0;var r,a=(r=n(17))&&r.__esModule?r:{default:r},i=/version\/(\d+(\.?_?\d+)+)/i,s=[{test:[/googlebot/i],describe:function(e){var t={name:"Googlebot"},n=a.default.getFirstMatch(/googlebot\/(\d+(\.\d+))/i,e)||a.default.getFirstMatch(i,e);return n&&(t.version=n),t}},{test:[/opera/i],describe:function(e){var t={name:"Opera"},n=a.default.getFirstMatch(i,e)||a.default.getFirstMatch(/(?:opera)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/opr\/|opios/i],describe:function(e){var t={name:"Opera"},n=a.default.getFirstMatch(/(?:opr|opios)[\s/](\S+)/i,e)||a.default.getFirstMatch(i,e);return n&&(t.version=n),t}},{test:[/SamsungBrowser/i],describe:function(e){var t={name:"Samsung Internet for Android"},n=a.default.getFirstMatch(i,e)||a.default.getFirstMatch(/(?:SamsungBrowser)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/Whale/i],describe:function(e){var t={name:"NAVER Whale Browser"},n=a.default.getFirstMatch(i,e)||a.default.getFirstMatch(/(?:whale)[\s/](\d+(?:\.\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/MZBrowser/i],describe:function(e){var t={name:"MZ Browser"},n=a.default.getFirstMatch(/(?:MZBrowser)[\s/](\d+(?:\.\d+)+)/i,e)||a.default.getFirstMatch(i,e);return n&&(t.version=n),t}},{test:[/focus/i],describe:function(e){var t={name:"Focus"},n=a.default.getFirstMatch(/(?:focus)[\s/](\d+(?:\.\d+)+)/i,e)||a.default.getFirstMatch(i,e);return n&&(t.version=n),t}},{test:[/swing/i],describe:function(e){var t={name:"Swing"},n=a.default.getFirstMatch(/(?:swing)[\s/](\d+(?:\.\d+)+)/i,e)||a.default.getFirstMatch(i,e);return n&&(t.version=n),t}},{test:[/coast/i],describe:function(e){var t={name:"Opera Coast"},n=a.default.getFirstMatch(i,e)||a.default.getFirstMatch(/(?:coast)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/opt\/\d+(?:.?_?\d+)+/i],describe:function(e){var t={name:"Opera Touch"},n=a.default.getFirstMatch(/(?:opt)[\s/](\d+(\.?_?\d+)+)/i,e)||a.default.getFirstMatch(i,e);return n&&(t.version=n),t}},{test:[/yabrowser/i],describe:function(e){var t={name:"Yandex Browser"},n=a.default.getFirstMatch(/(?:yabrowser)[\s/](\d+(\.?_?\d+)+)/i,e)||a.default.getFirstMatch(i,e);return n&&(t.version=n),t}},{test:[/ucbrowser/i],describe:function(e){var t={name:"UC Browser"},n=a.default.getFirstMatch(i,e)||a.default.getFirstMatch(/(?:ucbrowser)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/Maxthon|mxios/i],describe:function(e){var t={name:"Maxthon"},n=a.default.getFirstMatch(i,e)||a.default.getFirstMatch(/(?:Maxthon|mxios)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/epiphany/i],describe:function(e){var t={name:"Epiphany"},n=a.default.getFirstMatch(i,e)||a.default.getFirstMatch(/(?:epiphany)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/puffin/i],describe:function(e){var t={name:"Puffin"},n=a.default.getFirstMatch(i,e)||a.default.getFirstMatch(/(?:puffin)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/sleipnir/i],describe:function(e){var t={name:"Sleipnir"},n=a.default.getFirstMatch(i,e)||a.default.getFirstMatch(/(?:sleipnir)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/k-meleon/i],describe:function(e){var t={name:"K-Meleon"},n=a.default.getFirstMatch(i,e)||a.default.getFirstMatch(/(?:k-meleon)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/micromessenger/i],describe:function(e){var t={name:"WeChat"},n=a.default.getFirstMatch(/(?:micromessenger)[\s/](\d+(\.?_?\d+)+)/i,e)||a.default.getFirstMatch(i,e);return n&&(t.version=n),t}},{test:[/qqbrowser/i],describe:function(e){var t={name:/qqbrowserlite/i.test(e)?"QQ Browser Lite":"QQ Browser"},n=a.default.getFirstMatch(/(?:qqbrowserlite|qqbrowser)[/](\d+(\.?_?\d+)+)/i,e)||a.default.getFirstMatch(i,e);return n&&(t.version=n),t}},{test:[/msie|trident/i],describe:function(e){var t={name:"Internet Explorer"},n=a.default.getFirstMatch(/(?:msie |rv:)(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/\sedg\//i],describe:function(e){var t={name:"Microsoft Edge"},n=a.default.getFirstMatch(/\sedg\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/edg([ea]|ios)/i],describe:function(e){var t={name:"Microsoft Edge"},n=a.default.getSecondMatch(/edg([ea]|ios)\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/vivaldi/i],describe:function(e){var t={name:"Vivaldi"},n=a.default.getFirstMatch(/vivaldi\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/seamonkey/i],describe:function(e){var t={name:"SeaMonkey"},n=a.default.getFirstMatch(/seamonkey\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/sailfish/i],describe:function(e){var t={name:"Sailfish"},n=a.default.getFirstMatch(/sailfish\s?browser\/(\d+(\.\d+)?)/i,e);return n&&(t.version=n),t}},{test:[/silk/i],describe:function(e){var t={name:"Amazon Silk"},n=a.default.getFirstMatch(/silk\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/phantom/i],describe:function(e){var t={name:"PhantomJS"},n=a.default.getFirstMatch(/phantomjs\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/slimerjs/i],describe:function(e){var t={name:"SlimerJS"},n=a.default.getFirstMatch(/slimerjs\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe:function(e){var t={name:"BlackBerry"},n=a.default.getFirstMatch(i,e)||a.default.getFirstMatch(/blackberry[\d]+\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/(web|hpw)[o0]s/i],describe:function(e){var t={name:"WebOS Browser"},n=a.default.getFirstMatch(i,e)||a.default.getFirstMatch(/w(?:eb)?[o0]sbrowser\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/bada/i],describe:function(e){var t={name:"Bada"},n=a.default.getFirstMatch(/dolfin\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/tizen/i],describe:function(e){var t={name:"Tizen"},n=a.default.getFirstMatch(/(?:tizen\s?)?browser\/(\d+(\.?_?\d+)+)/i,e)||a.default.getFirstMatch(i,e);return n&&(t.version=n),t}},{test:[/qupzilla/i],describe:function(e){var t={name:"QupZilla"},n=a.default.getFirstMatch(/(?:qupzilla)[\s/](\d+(\.?_?\d+)+)/i,e)||a.default.getFirstMatch(i,e);return n&&(t.version=n),t}},{test:[/firefox|iceweasel|fxios/i],describe:function(e){var t={name:"Firefox"},n=a.default.getFirstMatch(/(?:firefox|iceweasel|fxios)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/electron/i],describe:function(e){var t={name:"Electron"},n=a.default.getFirstMatch(/(?:electron)\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/MiuiBrowser/i],describe:function(e){var t={name:"Miui"},n=a.default.getFirstMatch(/(?:MiuiBrowser)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/chromium/i],describe:function(e){var t={name:"Chromium"},n=a.default.getFirstMatch(/(?:chromium)[\s/](\d+(\.?_?\d+)+)/i,e)||a.default.getFirstMatch(i,e);return n&&(t.version=n),t}},{test:[/chrome|crios|crmo/i],describe:function(e){var t={name:"Chrome"},n=a.default.getFirstMatch(/(?:chrome|crios|crmo)\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/GSA/i],describe:function(e){var t={name:"Google Search"},n=a.default.getFirstMatch(/(?:GSA)\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:function(e){var t=!e.test(/like android/i),n=e.test(/android/i);return t&&n},describe:function(e){var t={name:"Android Browser"},n=a.default.getFirstMatch(i,e);return n&&(t.version=n),t}},{test:[/playstation 4/i],describe:function(e){var t={name:"PlayStation 4"},n=a.default.getFirstMatch(i,e);return n&&(t.version=n),t}},{test:[/safari|applewebkit/i],describe:function(e){var t={name:"Safari"},n=a.default.getFirstMatch(i,e);return n&&(t.version=n),t}},{test:[/.*/i],describe:function(e){var t=-1!==e.search("\\(")?/^(.*)\/(.*)[ \t]\((.*)/:/^(.*)\/(.*) /;return{name:a.default.getFirstMatch(t,e),version:a.default.getSecondMatch(t,e)}}}];t.default=s,e.exports=t.default},93:function(e,t,n){t.__esModule=!0,t.default=void 0;var r,a=(r=n(17))&&r.__esModule?r:{default:r},i=n(18),s=[{test:[/Roku\/DVP/],describe:function(e){var t=a.default.getFirstMatch(/Roku\/DVP-(\d+\.\d+)/i,e);return{name:i.OS_MAP.Roku,version:t}}},{test:[/windows phone/i],describe:function(e){var t=a.default.getFirstMatch(/windows phone (?:os)?\s?(\d+(\.\d+)*)/i,e);return{name:i.OS_MAP.WindowsPhone,version:t}}},{test:[/windows /i],describe:function(e){var t=a.default.getFirstMatch(/Windows ((NT|XP)( \d\d?.\d)?)/i,e),n=a.default.getWindowsVersionName(t);return{name:i.OS_MAP.Windows,version:t,versionName:n}}},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe:function(e){var t={name:i.OS_MAP.iOS},n=a.default.getSecondMatch(/(Version\/)(\d[\d.]+)/,e);return n&&(t.version=n),t}},{test:[/macintosh/i],describe:function(e){var t=a.default.getFirstMatch(/mac os x (\d+(\.?_?\d+)+)/i,e).replace(/[_\s]/g,"."),n=a.default.getMacOSVersionName(t),r={name:i.OS_MAP.MacOS,version:t};return n&&(r.versionName=n),r}},{test:[/(ipod|iphone|ipad)/i],describe:function(e){var t=a.default.getFirstMatch(/os (\d+([_\s]\d+)*) like mac os x/i,e).replace(/[_\s]/g,".");return{name:i.OS_MAP.iOS,version:t}}},{test:function(e){var t=!e.test(/like android/i),n=e.test(/android/i);return t&&n},describe:function(e){var t=a.default.getFirstMatch(/android[\s/-](\d+(\.\d+)*)/i,e),n=a.default.getAndroidVersionName(t),r={name:i.OS_MAP.Android,version:t};return n&&(r.versionName=n),r}},{test:[/(web|hpw)[o0]s/i],describe:function(e){var t=a.default.getFirstMatch(/(?:web|hpw)[o0]s\/(\d+(\.\d+)*)/i,e),n={name:i.OS_MAP.WebOS};return t&&t.length&&(n.version=t),n}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe:function(e){var t=a.default.getFirstMatch(/rim\stablet\sos\s(\d+(\.\d+)*)/i,e)||a.default.getFirstMatch(/blackberry\d+\/(\d+([_\s]\d+)*)/i,e)||a.default.getFirstMatch(/\bbb(\d+)/i,e);return{name:i.OS_MAP.BlackBerry,version:t}}},{test:[/bada/i],describe:function(e){var t=a.default.getFirstMatch(/bada\/(\d+(\.\d+)*)/i,e);return{name:i.OS_MAP.Bada,version:t}}},{test:[/tizen/i],describe:function(e){var t=a.default.getFirstMatch(/tizen[/\s](\d+(\.\d+)*)/i,e);return{name:i.OS_MAP.Tizen,version:t}}},{test:[/linux/i],describe:function(){return{name:i.OS_MAP.Linux}}},{test:[/CrOS/],describe:function(){return{name:i.OS_MAP.ChromeOS}}},{test:[/PlayStation 4/],describe:function(e){var t=a.default.getFirstMatch(/PlayStation 4[/\s](\d+(\.\d+)*)/i,e);return{name:i.OS_MAP.PlayStation4,version:t}}}];t.default=s,e.exports=t.default},94:function(e,t,n){t.__esModule=!0,t.default=void 0;var r,a=(r=n(17))&&r.__esModule?r:{default:r},i=n(18),s=[{test:[/googlebot/i],describe:function(){return{type:"bot",vendor:"Google"}}},{test:[/huawei/i],describe:function(e){var t=a.default.getFirstMatch(/(can-l01)/i,e)&&"Nova",n={type:i.PLATFORMS_MAP.mobile,vendor:"Huawei"};return t&&(n.model=t),n}},{test:[/nexus\s*(?:7|8|9|10).*/i],describe:function(){return{type:i.PLATFORMS_MAP.tablet,vendor:"Nexus"}}},{test:[/ipad/i],describe:function(){return{type:i.PLATFORMS_MAP.tablet,vendor:"Apple",model:"iPad"}}},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe:function(){return{type:i.PLATFORMS_MAP.tablet,vendor:"Apple",model:"iPad"}}},{test:[/kftt build/i],describe:function(){return{type:i.PLATFORMS_MAP.tablet,vendor:"Amazon",model:"Kindle Fire HD 7"}}},{test:[/silk/i],describe:function(){return{type:i.PLATFORMS_MAP.tablet,vendor:"Amazon"}}},{test:[/tablet(?! pc)/i],describe:function(){return{type:i.PLATFORMS_MAP.tablet}}},{test:function(e){var t=e.test(/ipod|iphone/i),n=e.test(/like (ipod|iphone)/i);return t&&!n},describe:function(e){var t=a.default.getFirstMatch(/(ipod|iphone)/i,e);return{type:i.PLATFORMS_MAP.mobile,vendor:"Apple",model:t}}},{test:[/nexus\s*[0-6].*/i,/galaxy nexus/i],describe:function(){return{type:i.PLATFORMS_MAP.mobile,vendor:"Nexus"}}},{test:[/[^-]mobi/i],describe:function(){return{type:i.PLATFORMS_MAP.mobile}}},{test:function(e){return"blackberry"===e.getBrowserName(!0)},describe:function(){return{type:i.PLATFORMS_MAP.mobile,vendor:"BlackBerry"}}},{test:function(e){return"bada"===e.getBrowserName(!0)},describe:function(){return{type:i.PLATFORMS_MAP.mobile}}},{test:function(e){return"windows phone"===e.getBrowserName()},describe:function(){return{type:i.PLATFORMS_MAP.mobile,vendor:"Microsoft"}}},{test:function(e){var t=Number(String(e.getOSVersion()).split(".")[0]);return"android"===e.getOSName(!0)&&t>=3},describe:function(){return{type:i.PLATFORMS_MAP.tablet}}},{test:function(e){return"android"===e.getOSName(!0)},describe:function(){return{type:i.PLATFORMS_MAP.mobile}}},{test:function(e){return"macos"===e.getOSName(!0)},describe:function(){return{type:i.PLATFORMS_MAP.desktop,vendor:"Apple"}}},{test:function(e){return"windows"===e.getOSName(!0)},describe:function(){return{type:i.PLATFORMS_MAP.desktop}}},{test:function(e){return"linux"===e.getOSName(!0)},describe:function(){return{type:i.PLATFORMS_MAP.desktop}}},{test:function(e){return"playstation 4"===e.getOSName(!0)},describe:function(){return{type:i.PLATFORMS_MAP.tv}}},{test:function(e){return"roku"===e.getOSName(!0)},describe:function(){return{type:i.PLATFORMS_MAP.tv}}}];t.default=s,e.exports=t.default},95:function(e,t,n){t.__esModule=!0,t.default=void 0;var r,a=(r=n(17))&&r.__esModule?r:{default:r},i=n(18),s=[{test:function(e){return"microsoft edge"===e.getBrowserName(!0)},describe:function(e){if(/\sedg\//i.test(e))return{name:i.ENGINE_MAP.Blink};var t=a.default.getFirstMatch(/edge\/(\d+(\.?_?\d+)+)/i,e);return{name:i.ENGINE_MAP.EdgeHTML,version:t}}},{test:[/trident/i],describe:function(e){var t={name:i.ENGINE_MAP.Trident},n=a.default.getFirstMatch(/trident\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:function(e){return e.test(/presto/i)},describe:function(e){var t={name:i.ENGINE_MAP.Presto},n=a.default.getFirstMatch(/presto\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:function(e){var t=e.test(/gecko/i),n=e.test(/like gecko/i);return t&&!n},describe:function(e){var t={name:i.ENGINE_MAP.Gecko},n=a.default.getFirstMatch(/gecko\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/(apple)?webkit\/537\.36/i],describe:function(){return{name:i.ENGINE_MAP.Blink}}},{test:[/(apple)?webkit/i],describe:function(e){var t={name:i.ENGINE_MAP.WebKit},n=a.default.getFirstMatch(/webkit\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}}];t.default=s,e.exports=t.default}})}))}}),Wd=Zl({"../../node_modules/mediasoup-client/lib/Logger.js":function(e){nd();var t=e&&e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(e,"__esModule",{value:!0}),e.Logger=void 0;var n=t(Vd()),r="mediasoup-client",a=function(){function e(t){St(this,e),t?(this._debug=(0,n.default)("".concat(r,":").concat(t)),this._warn=(0,n.default)("".concat(r,":WARN:").concat(t)),this._error=(0,n.default)("".concat(r,":ERROR:").concat(t))):(this._debug=(0,n.default)(r),this._warn=(0,n.default)("".concat(r,":WARN")),this._error=(0,n.default)("".concat(r,":ERROR"))),this._debug.log=console.info.bind(console),this._warn.log=console.warn.bind(console),this._error.log=console.error.bind(console)}return Pt(e,[{key:"debug",get:function(){return this._debug}},{key:"warn",get:function(){return this._warn}},{key:"error",get:function(){return this._error}}]),e}();e.Logger=a}}),qd=Zl({"../../node_modules/events/events.js":function(e,t){nd();var n,r="object"===typeof Reflect?Reflect:null,a=r&&"function"===typeof r.apply?r.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)};n=r&&"function"===typeof r.ownKeys?r.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var i=Number.isNaN||function(e){return e!==e};function s(){s.init.call(this)}t.exports=s,t.exports.once=function(e,t){return new Promise((function(n,r){function a(n){e.removeListener(t,i),r(n)}function i(){"function"===typeof e.removeListener&&e.removeListener("error",a),n([].slice.call(arguments))}v(e,t,i,{once:!0}),"error"!==t&&function(e,t,n){"function"===typeof e.on&&v(e,"error",t,n)}(e,a,{once:!0})}))},s.EventEmitter=s,s.prototype._events=void 0,s.prototype._eventsCount=0,s.prototype._maxListeners=void 0;var o=10;function c(e){if("function"!==typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function u(e){return void 0===e._maxListeners?s.defaultMaxListeners:e._maxListeners}function l(e,t,n,r){var a,i,s;if(c(n),void 0===(i=e._events)?(i=e._events=Object.create(null),e._eventsCount=0):(void 0!==i.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),i=e._events),s=i[t]),void 0===s)s=i[t]=n,++e._eventsCount;else if("function"===typeof s?s=i[t]=r?[n,s]:[s,n]:r?s.unshift(n):s.push(n),(a=u(e))>0&&s.length>a&&!s.warned){s.warned=!0;var o=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");o.name="MaxListenersExceededWarning",o.emitter=e,o.type=t,o.count=s.length,function(e){console&&console.warn&&console.warn(e)}(o)}return e}function d(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function p(e,t,n){var r={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},a=d.bind(r);return a.listener=n,r.wrapFn=a,a}function f(e,t,n){var r=e._events;if(void 0===r)return[];var a=r[t];return void 0===a?[]:"function"===typeof a?n?[a.listener||a]:[a]:n?function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(a):m(a,a.length)}function h(e){var t=this._events;if(void 0!==t){var n=t[e];if("function"===typeof n)return 1;if(void 0!==n)return n.length}return 0}function m(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e[r];return n}function v(e,t,n,r){if("function"===typeof e.on)r.once?e.once(t,n):e.on(t,n);else{if("function"!==typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function a(i){r.once&&e.removeEventListener(t,a),n(i)}))}}Object.defineProperty(s,"defaultMaxListeners",{enumerable:!0,get:function(){return o},set:function(e){if("number"!==typeof e||e<0||i(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");o=e}}),s.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},s.prototype.setMaxListeners=function(e){if("number"!==typeof e||e<0||i(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},s.prototype.getMaxListeners=function(){return u(this)},s.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var r="error"===e,i=this._events;if(void 0!==i)r=r&&void 0===i.error;else if(!r)return!1;if(r){var s;if(t.length>0&&(s=t[0]),s instanceof Error)throw s;var o=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw o.context=s,o}var c=i[e];if(void 0===c)return!1;if("function"===typeof c)a(c,this,t);else{var u=c.length,l=m(c,u);for(n=0;n<u;++n)a(l[n],this,t)}return!0},s.prototype.addListener=function(e,t){return l(this,e,t,!1)},s.prototype.on=s.prototype.addListener,s.prototype.prependListener=function(e,t){return l(this,e,t,!0)},s.prototype.once=function(e,t){return c(t),this.on(e,p(this,e,t)),this},s.prototype.prependOnceListener=function(e,t){return c(t),this.prependListener(e,p(this,e,t)),this},s.prototype.removeListener=function(e,t){var n,r,a,i,s;if(c(t),void 0===(r=this._events))return this;if(void 0===(n=r[e]))return this;if(n===t||n.listener===t)0===--this._eventsCount?this._events=Object.create(null):(delete r[e],r.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!==typeof n){for(a=-1,i=n.length-1;i>=0;i--)if(n[i]===t||n[i].listener===t){s=n[i].listener,a=i;break}if(a<0)return this;0===a?n.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(n,a),1===n.length&&(r[e]=n[0]),void 0!==r.removeListener&&this.emit("removeListener",e,s||t)}return this},s.prototype.off=s.prototype.removeListener,s.prototype.removeAllListeners=function(e){var t,n,r;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[e]&&(0===--this._eventsCount?this._events=Object.create(null):delete n[e]),this;if(0===arguments.length){var a,i=Object.keys(n);for(r=0;r<i.length;++r)"removeListener"!==(a=i[r])&&this.removeAllListeners(a);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"===typeof(t=n[e]))this.removeListener(e,t);else if(void 0!==t)for(r=t.length-1;r>=0;r--)this.removeListener(e,t[r]);return this},s.prototype.listeners=function(e){return f(this,e,!0)},s.prototype.rawListeners=function(e){return f(this,e,!1)},s.listenerCount=function(e,t){return"function"===typeof e.listenerCount?e.listenerCount(t):h.call(e,t)},s.prototype.listenerCount=h,s.prototype.eventNames=function(){return this._eventsCount>0?n(this._events):[]}}}),Gd=Zl({"../../node_modules/mediasoup-client/lib/EnhancedEventEmitter.js":function(e){nd(),Object.defineProperty(e,"__esModule",{value:!0}),e.EnhancedEventEmitter=void 0;var t=qd(),n=new(Wd().Logger)("EnhancedEventEmitter"),r=function(e){mn(r,e);var t=_n(r);function r(){var e;return St(this,r),(e=t.call(this)).setMaxListeners(1/0),e}return Pt(r,[{key:"safeEmit",value:function(e){var t=this.listenerCount(e);try{for(var r=arguments.length,a=new Array(r>1?r-1:0),i=1;i<r;i++)a[i-1]=arguments[i];return this.emit.apply(this,[e].concat(a))}catch(s){return n.error("safeEmit() | event listener threw an error [event:%s]:%o",e,s),Boolean(t)}}},{key:"safeEmitAsPromise",value:function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];return td(this,null,wr().mark((function t(){var a=this;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,i){try{a.emit.apply(a,[e].concat(r,[t,i]))}catch(s){n.error("safeEmitAsPromise() | event listener threw an error [event:%s]:%o",e,s),i(s)}})));case 1:case"end":return t.stop()}}),t)})))}}]),r}(t.EventEmitter);e.EnhancedEventEmitter=r}}),Kd=Zl({"../../node_modules/mediasoup-client/lib/errors.js":function(e){nd(),Object.defineProperty(e,"__esModule",{value:!0}),e.InvalidStateError=e.UnsupportedError=void 0;var t=function(e){mn(n,e);var t=_n(n);function n(e){var r;return St(this,n),(r=t.call(this,e)).name="UnsupportedError",Error.hasOwnProperty("captureStackTrace")?Error.captureStackTrace(bn(r),n):r.stack=new Error(e).stack,r}return Pt(n)}(as(Error));e.UnsupportedError=t;var n=function(e){mn(n,e);var t=_n(n);function n(e){var r;return St(this,n),(r=t.call(this,e)).name="InvalidStateError",Error.hasOwnProperty("captureStackTrace")?Error.captureStackTrace(bn(r),n):r.stack=new Error(e).stack,r}return Pt(n)}(as(Error));e.InvalidStateError=n}}),Xd=Zl({"../../node_modules/mediasoup-client/lib/utils.js":function(e){nd(),Object.defineProperty(e,"__esModule",{value:!0}),e.generateRandomNumber=e.clone=void 0,e.clone=function(e,t){return"undefined"===typeof e?t:JSON.parse(JSON.stringify(e))},e.generateRandomNumber=function(){return Math.round(1e7*Math.random())}}}),Qd=Zl({"../../node_modules/h264-profile-level-id/index.js":function(e){nd();var t=Vd()("h264-profile-level-id");t.log=console.info.bind(console);e.ProfileConstrainedBaseline=1,e.ProfileBaseline=2,e.ProfileMain=3,e.ProfileConstrainedHigh=4,e.ProfileHigh=5;e.Level1_b=0,e.Level1=10,e.Level1_1=11,e.Level1_2=12,e.Level1_3=13,e.Level2=20,e.Level2_1=21,e.Level2_2=22,e.Level3=30,e.Level3_1=31,e.Level3_2=32,e.Level4=40,e.Level4_1=41,e.Level4_2=42,e.Level5=50,e.Level5_1=51,e.Level5_2=52;var n=Pt((function e(t,n){St(this,e),this.profile=t,this.level=n}));e.ProfileLevelId=n;var r=new n(1,31),a=function(){function e(t){St(this,e),this._mask=~o("x",t),this._maskedValue=o("1",t)}return Pt(e,[{key:"isMatch",value:function(e){return this._maskedValue===(e&this._mask)}}]),e}(),i=Pt((function e(t,n,r){St(this,e),this.profile_idc=t,this.profile_iop=n,this.profile=r})),s=[new i(66,new a("x1xx0000"),1),new i(77,new a("1xxx0000"),1),new i(88,new a("11xx0000"),1),new i(66,new a("x0xx0000"),2),new i(88,new a("10xx0000"),2),new i(77,new a("0x0x0000"),3),new i(100,new a("00000000"),5),new i(100,new a("00001100"),4)];function o(e,t){return(t[0]===e)<<7|(t[1]===e)<<6|(t[2]===e)<<5|(t[3]===e)<<4|(t[4]===e)<<3|(t[5]===e)<<2|(t[6]===e)<<1|(t[7]===e)<<0}function c(e,t){return function(e,t){return 0===e?10!==t&&0!==t:0===t?10!==e:e<t}(e,t)?e:t}function u(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e["level-asymmetry-allowed"];return 1===t||"1"===t}e.parseProfileLevelId=function(e){if("string"!==typeof e||6!==e.length)return null;var r=parseInt(e,16);if(0===r)return null;var a,i=255&r,o=r>>8&255,c=r>>16&255;switch(i){case 11:a=0!==(16&o)?0:11;break;case 10:case 12:case 13:case 20:case 21:case 22:case 30:case 31:case 32:case 40:case 41:case 42:case 50:case 51:case 52:a=i;break;default:return t("parseProfileLevelId() | unrecognized level_idc:%s",i),null}var u,l=kr(s);try{for(l.s();!(u=l.n()).done;){var d=u.value;if(c===d.profile_idc&&d.profile_iop.isMatch(o))return new n(d.profile,a)}}catch(p){l.e(p)}finally{l.f()}return t("parseProfileLevelId() | unrecognized profile_idc/profile_iop combination"),null},e.profileLevelIdToString=function(e){if(0==e.level)switch(e.profile){case 1:return"42f00b";case 2:return"42100b";case 3:return"4d100b";default:return t("profileLevelIdToString() | Level 1_b not is allowed for profile:%s",e.profile),null}var n;switch(e.profile){case 1:n="42e0";break;case 2:n="4200";break;case 3:n="4d00";break;case 4:n="640c";break;case 5:n="6400";break;default:return t("profileLevelIdToString() | unrecognized profile:%s",e.profile),null}var r=e.level.toString(16);return 1===r.length&&(r="0".concat(r)),"".concat(n).concat(r)},e.parseSdpProfileLevelId=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t["profile-level-id"];return n?e.parseProfileLevelId(n):r},e.isSameProfile=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=e.parseSdpProfileLevelId(t),a=e.parseSdpProfileLevelId(n);return Boolean(r&&a&&r.profile===a.profile)},e.generateProfileLevelIdForAnswer=function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!r["profile-level-id"]&&!a["profile-level-id"])return t("generateProfileLevelIdForAnswer() | no profile-level-id in local and remote params"),null;var i=e.parseSdpProfileLevelId(r),s=e.parseSdpProfileLevelId(a);if(!i)throw new TypeError("invalid local_profile_level_id");if(!s)throw new TypeError("invalid remote_profile_level_id");if(i.profile!==s.profile)throw new TypeError("H264 Profile mismatch");var o=u(r)&&u(a),l=i.level,d=s.level,p=c(l,d),f=o?l:p;return t("generateProfileLevelIdForAnswer() | result: [profile:%s, level:%s]",i.profile,f),e.profileLevelIdToString(new n(i.profile,f))}}}),$d=Zl({"../../node_modules/mediasoup-client/lib/ortc.js":function(e){nd();var t=e&&e.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var a=Object.getOwnPropertyDescriptor(t,n);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,a)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),n=e&&e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=e&&e.__importStar||function(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var a in e)"default"!==a&&Object.prototype.hasOwnProperty.call(e,a)&&t(r,e,a);return n(r,e),r};Object.defineProperty(e,"__esModule",{value:!0}),e.canReceive=e.canSend=e.generateProbatorRtpParameters=e.reduceCodecs=e.getSendingRemoteRtpParameters=e.getSendingRtpParameters=e.getRecvRtpCapabilities=e.getExtendedRtpCapabilities=e.validateSctpStreamParameters=e.validateSctpParameters=e.validateNumSctpStreams=e.validateSctpCapabilities=e.validateRtcpParameters=e.validateRtpEncodingParameters=e.validateRtpHeaderExtensionParameters=e.validateRtpCodecParameters=e.validateRtpParameters=e.validateRtpHeaderExtension=e.validateRtcpFeedback=e.validateRtpCodecCapability=e.validateRtpCapabilities=void 0;var a=r(Qd()),i=r(Xd());function s(e){var t=new RegExp("^(audio|video)/(.+)","i");if("object"!==typeof e)throw new TypeError("codec is not an object");if(!e.mimeType||"string"!==typeof e.mimeType)throw new TypeError("missing codec.mimeType");var n=t.exec(e.mimeType);if(!n)throw new TypeError("invalid codec.mimeType");if(e.kind=n[1].toLowerCase(),e.preferredPayloadType&&"number"!==typeof e.preferredPayloadType)throw new TypeError("invalid codec.preferredPayloadType");if("number"!==typeof e.clockRate)throw new TypeError("missing codec.clockRate");"audio"===e.kind?"number"!==typeof e.channels&&(e.channels=1):delete e.channels,e.parameters&&"object"===typeof e.parameters||(e.parameters={});for(var r=0,a=Object.keys(e.parameters);r<a.length;r++){var i=a[r],s=e.parameters[i];if(void 0===s&&(e.parameters[i]="",s=""),"string"!==typeof s&&"number"!==typeof s)throw new TypeError("invalid codec parameter [key:".concat(i,"s, value:").concat(s,"]"));if("apt"===i&&"number"!==typeof s)throw new TypeError("invalid codec apt parameter")}e.rtcpFeedback&&Array.isArray(e.rtcpFeedback)||(e.rtcpFeedback=[]);var c,u=kr(e.rtcpFeedback);try{for(u.s();!(c=u.n()).done;){o(c.value)}}catch(l){u.e(l)}finally{u.f()}}function o(e){if("object"!==typeof e)throw new TypeError("fb is not an object");if(!e.type||"string"!==typeof e.type)throw new TypeError("missing fb.type");e.parameter&&"string"===typeof e.parameter||(e.parameter="")}function c(e){if("object"!==typeof e)throw new TypeError("ext is not an object");if("audio"!==e.kind&&"video"!==e.kind)throw new TypeError("invalid ext.kind");if(!e.uri||"string"!==typeof e.uri)throw new TypeError("missing ext.uri");if("number"!==typeof e.preferredId)throw new TypeError("missing ext.preferredId");if(e.preferredEncrypt&&"boolean"!==typeof e.preferredEncrypt)throw new TypeError("invalid ext.preferredEncrypt");if(e.preferredEncrypt||(e.preferredEncrypt=!1),e.direction&&"string"!==typeof e.direction)throw new TypeError("invalid ext.direction");e.direction||(e.direction="sendrecv")}function u(e){if("object"!==typeof e)throw new TypeError("params is not an object");if(e.mid&&"string"!==typeof e.mid)throw new TypeError("params.mid is not a string");if(!Array.isArray(e.codecs))throw new TypeError("missing params.codecs");var t,n=kr(e.codecs);try{for(n.s();!(t=n.n()).done;){l(t.value)}}catch(o){n.e(o)}finally{n.f()}if(e.headerExtensions&&!Array.isArray(e.headerExtensions))throw new TypeError("params.headerExtensions is not an array");e.headerExtensions||(e.headerExtensions=[]);var r,a=kr(e.headerExtensions);try{for(a.s();!(r=a.n()).done;){d(r.value)}}catch(o){a.e(o)}finally{a.f()}if(e.encodings&&!Array.isArray(e.encodings))throw new TypeError("params.encodings is not an array");e.encodings||(e.encodings=[]);var i,s=kr(e.encodings);try{for(s.s();!(i=s.n()).done;){p(i.value)}}catch(o){s.e(o)}finally{s.f()}if(e.rtcp&&"object"!==typeof e.rtcp)throw new TypeError("params.rtcp is not an object");e.rtcp||(e.rtcp={}),f(e.rtcp)}function l(e){var t=new RegExp("^(audio|video)/(.+)","i");if("object"!==typeof e)throw new TypeError("codec is not an object");if(!e.mimeType||"string"!==typeof e.mimeType)throw new TypeError("missing codec.mimeType");var n=t.exec(e.mimeType);if(!n)throw new TypeError("invalid codec.mimeType");if("number"!==typeof e.payloadType)throw new TypeError("missing codec.payloadType");if("number"!==typeof e.clockRate)throw new TypeError("missing codec.clockRate");"audio"===n[1].toLowerCase()?"number"!==typeof e.channels&&(e.channels=1):delete e.channels,e.parameters&&"object"===typeof e.parameters||(e.parameters={});for(var r=0,a=Object.keys(e.parameters);r<a.length;r++){var i=a[r],s=e.parameters[i];if(void 0===s&&(e.parameters[i]="",s=""),"string"!==typeof s&&"number"!==typeof s)throw new TypeError("invalid codec parameter [key:".concat(i,"s, value:").concat(s,"]"));if("apt"===i&&"number"!==typeof s)throw new TypeError("invalid codec apt parameter")}e.rtcpFeedback&&Array.isArray(e.rtcpFeedback)||(e.rtcpFeedback=[]);var c,u=kr(e.rtcpFeedback);try{for(u.s();!(c=u.n()).done;){o(c.value)}}catch(l){u.e(l)}finally{u.f()}}function d(e){if("object"!==typeof e)throw new TypeError("ext is not an object");if(!e.uri||"string"!==typeof e.uri)throw new TypeError("missing ext.uri");if("number"!==typeof e.id)throw new TypeError("missing ext.id");if(e.encrypt&&"boolean"!==typeof e.encrypt)throw new TypeError("invalid ext.encrypt");e.encrypt||(e.encrypt=!1),e.parameters&&"object"===typeof e.parameters||(e.parameters={});for(var t=0,n=Object.keys(e.parameters);t<n.length;t++){var r=n[t],a=e.parameters[r];if(void 0===a&&(e.parameters[r]="",a=""),"string"!==typeof a&&"number"!==typeof a)throw new TypeError("invalid header extension parameter")}}function p(e){if("object"!==typeof e)throw new TypeError("encoding is not an object");if(e.ssrc&&"number"!==typeof e.ssrc)throw new TypeError("invalid encoding.ssrc");if(e.rid&&"string"!==typeof e.rid)throw new TypeError("invalid encoding.rid");if(e.rtx&&"object"!==typeof e.rtx)throw new TypeError("invalid encoding.rtx");if(e.rtx&&"number"!==typeof e.rtx.ssrc)throw new TypeError("missing encoding.rtx.ssrc");if(e.dtx&&"boolean"===typeof e.dtx||(e.dtx=!1),e.scalabilityMode&&"string"!==typeof e.scalabilityMode)throw new TypeError("invalid encoding.scalabilityMode")}function f(e){if("object"!==typeof e)throw new TypeError("rtcp is not an object");if(e.cname&&"string"!==typeof e.cname)throw new TypeError("invalid rtcp.cname");e.reducedSize&&"boolean"===typeof e.reducedSize||(e.reducedSize=!0)}function h(e){if("object"!==typeof e)throw new TypeError("numStreams is not an object");if("number"!==typeof e.OS)throw new TypeError("missing numStreams.OS");if("number"!==typeof e.MIS)throw new TypeError("missing numStreams.MIS")}function m(e){return!!e&&/.+\/rtx$/i.test(e.mimeType)}function v(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.strict,i=void 0!==r&&r,s=n.modify,o=void 0!==s&&s,c=e.mimeType.toLowerCase(),u=t.mimeType.toLowerCase();if(c!==u)return!1;if(e.clockRate!==t.clockRate)return!1;if(e.channels!==t.channels)return!1;switch(c){case"video/h264":if(i){var l,d=e.parameters["packetization-mode"]||0,p=t.parameters["packetization-mode"]||0;if(d!==p)return!1;if(!a.isSameProfile(e.parameters,t.parameters))return!1;try{l=a.generateProfileLevelIdForAnswer(e.parameters,t.parameters)}catch(m){return!1}o&&(l?(e.parameters["profile-level-id"]=l,t.parameters["profile-level-id"]=l):(delete e.parameters["profile-level-id"],delete t.parameters["profile-level-id"]))}break;case"video/vp9":if(i){var f=e.parameters["profile-id"]||0,h=t.parameters["profile-id"]||0;if(f!==h)return!1}}return!0}function g(e,t){var n,r=[],a=kr(e.rtcpFeedback||[]);try{var i=function(){var e=n.value,a=(t.rtcpFeedback||[]).find((function(t){return t.type===e.type&&(t.parameter===e.parameter||!t.parameter&&!e.parameter)}));a&&r.push(a)};for(a.s();!(n=a.n()).done;)i()}catch(s){a.e(s)}finally{a.f()}return r}e.validateRtpCapabilities=function(e){if("object"!==typeof e)throw new TypeError("caps is not an object");if(e.codecs&&!Array.isArray(e.codecs))throw new TypeError("caps.codecs is not an array");e.codecs||(e.codecs=[]);var t,n=kr(e.codecs);try{for(n.s();!(t=n.n()).done;){s(t.value)}}catch(i){n.e(i)}finally{n.f()}if(e.headerExtensions&&!Array.isArray(e.headerExtensions))throw new TypeError("caps.headerExtensions is not an array");e.headerExtensions||(e.headerExtensions=[]);var r,a=kr(e.headerExtensions);try{for(a.s();!(r=a.n()).done;){c(r.value)}}catch(i){a.e(i)}finally{a.f()}},e.validateRtpCodecCapability=s,e.validateRtcpFeedback=o,e.validateRtpHeaderExtension=c,e.validateRtpParameters=u,e.validateRtpCodecParameters=l,e.validateRtpHeaderExtensionParameters=d,e.validateRtpEncodingParameters=p,e.validateRtcpParameters=f,e.validateSctpCapabilities=function(e){if("object"!==typeof e)throw new TypeError("caps is not an object");if(!e.numStreams||"object"!==typeof e.numStreams)throw new TypeError("missing caps.numStreams");h(e.numStreams)},e.validateNumSctpStreams=h,e.validateSctpParameters=function(e){if("object"!==typeof e)throw new TypeError("params is not an object");if("number"!==typeof e.port)throw new TypeError("missing params.port");if("number"!==typeof e.OS)throw new TypeError("missing params.OS");if("number"!==typeof e.MIS)throw new TypeError("missing params.MIS");if("number"!==typeof e.maxMessageSize)throw new TypeError("missing params.maxMessageSize")},e.validateSctpStreamParameters=function(e){if("object"!==typeof e)throw new TypeError("params is not an object");if("number"!==typeof e.streamId)throw new TypeError("missing params.streamId");var t=!1;if("boolean"===typeof e.ordered?t=!0:e.ordered=!0,e.maxPacketLifeTime&&"number"!==typeof e.maxPacketLifeTime)throw new TypeError("invalid params.maxPacketLifeTime");if(e.maxRetransmits&&"number"!==typeof e.maxRetransmits)throw new TypeError("invalid params.maxRetransmits");if(e.maxPacketLifeTime&&e.maxRetransmits)throw new TypeError("cannot provide both maxPacketLifeTime and maxRetransmits");if(t&&e.ordered&&(e.maxPacketLifeTime||e.maxRetransmits))throw new TypeError("cannot be ordered with maxPacketLifeTime or maxRetransmits");if(t||!e.maxPacketLifeTime&&!e.maxRetransmits||(e.ordered=!1),e.label&&"string"!==typeof e.label)throw new TypeError("invalid params.label");if(e.protocol&&"string"!==typeof e.protocol)throw new TypeError("invalid params.protocol")},e.getExtendedRtpCapabilities=function(e,t){var n,r={codecs:[],headerExtensions:[]},a=kr(t.codecs||[]);try{var i=function(){var t=n.value;if(m(t))return"continue";var a=(e.codecs||[]).find((function(e){return v(e,t,{strict:!0,modify:!0})}));if(!a)return"continue";var i={mimeType:a.mimeType,kind:a.kind,clockRate:a.clockRate,channels:a.channels,localPayloadType:a.preferredPayloadType,localRtxPayloadType:void 0,remotePayloadType:t.preferredPayloadType,remoteRtxPayloadType:void 0,localParameters:a.parameters,remoteParameters:t.parameters,rtcpFeedback:g(a,t)};r.codecs.push(i)};for(a.s();!(n=a.n()).done;)i()}catch(p){a.e(p)}finally{a.f()}var s,o=kr(r.codecs);try{var c=function(){var n=s.value,r=e.codecs.find((function(e){return m(e)&&e.parameters.apt===n.localPayloadType})),a=t.codecs.find((function(e){return m(e)&&e.parameters.apt===n.remotePayloadType}));r&&a&&(n.localRtxPayloadType=r.preferredPayloadType,n.remoteRtxPayloadType=a.preferredPayloadType)};for(o.s();!(s=o.n()).done;)c()}catch(p){o.e(p)}finally{o.f()}var u,l=kr(t.headerExtensions);try{var d=function(){var t=u.value,n=e.headerExtensions.find((function(e){return r=t,(!(n=e).kind||!r.kind||n.kind===r.kind)&&n.uri===r.uri;var n,r}));if(!n)return"continue";var a={kind:t.kind,uri:t.uri,sendId:n.preferredId,recvId:t.preferredId,encrypt:n.preferredEncrypt,direction:"sendrecv"};switch(t.direction){case"sendrecv":a.direction="sendrecv";break;case"recvonly":a.direction="sendonly";break;case"sendonly":a.direction="recvonly";break;case"inactive":a.direction="inactive"}r.headerExtensions.push(a)};for(l.s();!(u=l.n()).done;)d()}catch(p){l.e(p)}finally{l.f()}return r},e.getRecvRtpCapabilities=function(e){var t,n={codecs:[],headerExtensions:[]},r=kr(e.codecs);try{for(r.s();!(t=r.n()).done;){var a=t.value,i={mimeType:a.mimeType,kind:a.kind,preferredPayloadType:a.remotePayloadType,clockRate:a.clockRate,channels:a.channels,parameters:a.localParameters,rtcpFeedback:a.rtcpFeedback};if(n.codecs.push(i),a.remoteRtxPayloadType){var s={mimeType:"".concat(a.kind,"/rtx"),kind:a.kind,preferredPayloadType:a.remoteRtxPayloadType,clockRate:a.clockRate,parameters:{apt:a.remotePayloadType},rtcpFeedback:[]};n.codecs.push(s)}}}catch(d){r.e(d)}finally{r.f()}var o,c=kr(e.headerExtensions);try{for(c.s();!(o=c.n()).done;){var u=o.value;if("sendrecv"===u.direction||"recvonly"===u.direction){var l={kind:u.kind,uri:u.uri,preferredId:u.recvId,preferredEncrypt:u.encrypt,direction:u.direction};n.headerExtensions.push(l)}}}catch(d){c.e(d)}finally{c.f()}return n},e.getSendingRtpParameters=function(e,t){var n,r={mid:void 0,codecs:[],headerExtensions:[],encodings:[],rtcp:{}},a=kr(t.codecs);try{for(a.s();!(n=a.n()).done;){var i=n.value;if(i.kind===e){var s={mimeType:i.mimeType,payloadType:i.localPayloadType,clockRate:i.clockRate,channels:i.channels,parameters:i.localParameters,rtcpFeedback:i.rtcpFeedback};if(r.codecs.push(s),i.localRtxPayloadType){var o={mimeType:"".concat(i.kind,"/rtx"),payloadType:i.localRtxPayloadType,clockRate:i.clockRate,parameters:{apt:i.localPayloadType},rtcpFeedback:[]};r.codecs.push(o)}}}}catch(p){a.e(p)}finally{a.f()}var c,u=kr(t.headerExtensions);try{for(u.s();!(c=u.n()).done;){var l=c.value;if(!(l.kind&&l.kind!==e||"sendrecv"!==l.direction&&"sendonly"!==l.direction)){var d={uri:l.uri,id:l.sendId,encrypt:l.encrypt,parameters:{}};r.headerExtensions.push(d)}}}catch(p){u.e(p)}finally{u.f()}return r},e.getSendingRemoteRtpParameters=function(e,t){var n,r={mid:void 0,codecs:[],headerExtensions:[],encodings:[],rtcp:{}},a=kr(t.codecs);try{for(a.s();!(n=a.n()).done;){var i=n.value;if(i.kind===e){var s={mimeType:i.mimeType,payloadType:i.localPayloadType,clockRate:i.clockRate,channels:i.channels,parameters:i.remoteParameters,rtcpFeedback:i.rtcpFeedback};if(r.codecs.push(s),i.localRtxPayloadType){var o={mimeType:"".concat(i.kind,"/rtx"),payloadType:i.localRtxPayloadType,clockRate:i.clockRate,parameters:{apt:i.localPayloadType},rtcpFeedback:[]};r.codecs.push(o)}}}}catch(w){a.e(w)}finally{a.f()}var c,u=kr(t.headerExtensions);try{for(u.s();!(c=u.n()).done;){var l=c.value;if(!(l.kind&&l.kind!==e||"sendrecv"!==l.direction&&"sendonly"!==l.direction)){var d={uri:l.uri,id:l.sendId,encrypt:l.encrypt,parameters:{}};r.headerExtensions.push(d)}}}catch(w){u.e(w)}finally{u.f()}if(r.headerExtensions.some((function(e){return"http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01"===e.uri}))){var p,f=kr(r.codecs);try{for(f.s();!(p=f.n()).done;){var h=p.value;h.rtcpFeedback=(h.rtcpFeedback||[]).filter((function(e){return"goog-remb"!==e.type}))}}catch(w){f.e(w)}finally{f.f()}}else if(r.headerExtensions.some((function(e){return"http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time"===e.uri}))){var m,v=kr(r.codecs);try{for(v.s();!(m=v.n()).done;){var g=m.value;g.rtcpFeedback=(g.rtcpFeedback||[]).filter((function(e){return"transport-cc"!==e.type}))}}catch(w){v.e(w)}finally{v.f()}}else{var b,y=kr(r.codecs);try{for(y.s();!(b=y.n()).done;){var _=b.value;_.rtcpFeedback=(_.rtcpFeedback||[]).filter((function(e){return"transport-cc"!==e.type&&"goog-remb"!==e.type}))}}catch(w){y.e(w)}finally{y.f()}}return r},e.reduceCodecs=function(e,t){var n=[];if(t){for(var r=0;r<e.length;++r)if(v(e[r],t)){n.push(e[r]),m(e[r+1])&&n.push(e[r+1]);break}if(0===n.length)throw new TypeError("no matching codec found")}else n.push(e[0]),m(e[1])&&n.push(e[1]);return n},e.generateProbatorRtpParameters=function(e){u(e=i.clone(e,{}));var t={mid:"probator",codecs:[],headerExtensions:[],encodings:[{ssrc:1234}],rtcp:{cname:"probator"}};return t.codecs.push(e.codecs[0]),t.codecs[0].payloadType=127,t.headerExtensions=e.headerExtensions,t},e.canSend=function(e,t){return t.codecs.some((function(t){return t.kind===e}))},e.canReceive=function(e,t){if(u(e),0===e.codecs.length)return!1;var n=e.codecs[0];return t.codecs.some((function(e){return e.remotePayloadType===n.payloadType}))}}}),Jd=Zl({"../../node_modules/awaitqueue/lib/index.js":function(e){nd();var t=e&&e.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(a,i){function s(e){try{c(r.next(e))}catch(t){i(t)}}function o(e){try{c(r.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,o)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{ClosedErrorClass:Error,StoppedErrorClass:Error,RemovedTaskErrorClass:Error},n=t.ClosedErrorClass,r=void 0===n?Error:n,a=t.StoppedErrorClass,i=void 0===a?Error:a,s=t.RemovedTaskErrorClass,o=void 0===s?Error:s;St(this,e),this.closed=!1,this.pendingTasks=[],this.ClosedErrorClass=Error,this.StoppedErrorClass=Error,this.RemovedTaskErrorClass=Error,this.ClosedErrorClass=r,this.StoppedErrorClass=i,this.RemovedTaskErrorClass=o}return Pt(e,[{key:"size",get:function(){return this.pendingTasks.length}},{key:"close",value:function(){if(!this.closed){this.closed=!0;var e,t=kr(this.pendingTasks);try{for(t.s();!(e=t.n()).done;){var n=e.value;n.stopped=!0,n.reject(new this.ClosedErrorClass("AwaitQueue closed"))}}catch(r){t.e(r)}finally{t.f()}this.pendingTasks.length=0}}},{key:"push",value:function(e,n){return t(this,void 0,void 0,wr().mark((function t(){var r=this;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.closed){t.next=2;break}throw new this.ClosedErrorClass("AwaitQueue closed");case 2:if("function"===typeof e){t.next=4;break}throw new TypeError("given task is not a function");case 4:if(!e.name&&n)try{Object.defineProperty(e,"name",{value:n})}catch(a){}return t.abrupt("return",new Promise((function(t,a){var i={task:e,name:n,resolve:t,reject:a,stopped:!1,enqueuedAt:new Date,executedAt:void 0};r.pendingTasks.push(i),1===r.pendingTasks.length&&r.next()})));case 6:case"end":return t.stop()}}),t,this)})))}},{key:"removeTask",value:function(e){if(0===e)throw new TypeError("cannot remove task with index 0");var t=this.pendingTasks[e];t&&(this.pendingTasks.splice(e,1),t.reject(new this.RemovedTaskErrorClass("task removed from the queue")))}},{key:"stop",value:function(){if(!this.closed){var e,t=kr(this.pendingTasks);try{for(t.s();!(e=t.n()).done;){var n=e.value;n.stopped=!0,n.reject(new this.StoppedErrorClass("AwaitQueue stopped"))}}catch(r){t.e(r)}finally{t.f()}this.pendingTasks.length=0}}},{key:"dump",value:function(){var e=new Date,t=0;return this.pendingTasks.map((function(n){return{idx:t++,task:n.task,name:n.name,enqueuedTime:n.executedAt?n.executedAt.getTime()-n.enqueuedAt.getTime():e.getTime()-n.enqueuedAt.getTime(),executingTime:n.executedAt?e.getTime()-n.executedAt.getTime():0}}))}},{key:"next",value:function(){return t(this,void 0,void 0,wr().mark((function e(){var t;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.pendingTasks[0]){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,this.executeTask(t);case 5:this.pendingTasks.shift(),this.next();case 7:case"end":return e.stop()}}),e,this)})))}},{key:"executeTask",value:function(e){return t(this,void 0,void 0,wr().mark((function t(){var n;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.stopped){t.next=2;break}return t.abrupt("return");case 2:return e.executedAt=new Date,t.prev=3,t.next=6,e.task();case 6:if(n=t.sent,!e.stopped){t.next=9;break}return t.abrupt("return");case 9:e.resolve(n),t.next=17;break;case 12:if(t.prev=12,t.t0=t.catch(3),!e.stopped){t.next=16;break}return t.abrupt("return");case 16:e.reject(t.t0);case 17:case"end":return t.stop()}}),t,null,[[3,12]])})))}}]),e}();e.AwaitQueue=n}}),Yd=Zl({"../../node_modules/mediasoup-client/lib/Producer.js":function(e){nd(),Object.defineProperty(e,"__esModule",{value:!0}),e.Producer=void 0;var t=Wd(),n=Gd(),r=Kd(),a=new t.Logger("Producer"),i=function(e){mn(i,e);var t=_n(i);function i(e){var r,s=e.id,o=e.localId,c=e.rtpSender,u=e.track,l=e.rtpParameters,d=e.stopTracks,p=e.disableTrackOnPause,f=e.zeroRtpOnPause,h=e.appData;return St(this,i),(r=t.call(this))._closed=!1,r._observer=new n.EnhancedEventEmitter,a.debug("constructor()"),r._id=s,r._localId=o,r._rtpSender=c,r._track=u,r._kind=u.kind,r._rtpParameters=l,r._paused=!!p&&!u.enabled,r._maxSpatialLayer=void 0,r._stopTracks=d,r._disableTrackOnPause=p,r._zeroRtpOnPause=f,r._appData=h||{},r._onTrackEnded=r._onTrackEnded.bind(bn(r)),r._handleTrack(),r}return Pt(i,[{key:"id",get:function(){return this._id}},{key:"localId",get:function(){return this._localId}},{key:"closed",get:function(){return this._closed}},{key:"kind",get:function(){return this._kind}},{key:"rtpSender",get:function(){return this._rtpSender}},{key:"track",get:function(){return this._track}},{key:"rtpParameters",get:function(){return this._rtpParameters}},{key:"paused",get:function(){return this._paused}},{key:"maxSpatialLayer",get:function(){return this._maxSpatialLayer}},{key:"appData",get:function(){return this._appData},set:function(e){throw new Error("cannot override appData object")}},{key:"observer",get:function(){return this._observer}},{key:"close",value:function(){this._closed||(a.debug("close()"),this._closed=!0,this._destroyTrack(),this.emit("@close"),this._observer.safeEmit("close"))}},{key:"transportClosed",value:function(){this._closed||(a.debug("transportClosed()"),this._closed=!0,this._destroyTrack(),this.safeEmit("transportclose"),this._observer.safeEmit("close"))}},{key:"getStats",value:function(){return td(this,null,wr().mark((function e(){return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._closed){e.next=2;break}throw new r.InvalidStateError("closed");case 2:return e.abrupt("return",this.safeEmitAsPromise("@getstats"));case 3:case"end":return e.stop()}}),e,this)})))}},{key:"pause",value:function(){a.debug("pause()"),this._closed?a.error("pause() | Producer closed"):(this._paused=!0,this._track&&this._disableTrackOnPause&&(this._track.enabled=!1),this._zeroRtpOnPause&&this.safeEmitAsPromise("@replacetrack",null).catch((function(){})),this._observer.safeEmit("pause"))}},{key:"resume",value:function(){a.debug("resume()"),this._closed?a.error("resume() | Producer closed"):(this._paused=!1,this._track&&this._disableTrackOnPause&&(this._track.enabled=!0),this._zeroRtpOnPause&&this.safeEmitAsPromise("@replacetrack",this._track).catch((function(){})),this._observer.safeEmit("resume"))}},{key:"replaceTrack",value:function(e){return td(this,arguments,wr().mark((function e(t){var n;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.track,a.debug("replaceTrack() [track:%o]",n),!this._closed){e.next=7;break}if(n&&this._stopTracks)try{n.stop()}catch(i){}throw new r.InvalidStateError("closed");case 7:if(!n||"ended"!==n.readyState){e.next=9;break}throw new r.InvalidStateError("track ended");case 9:if(n!==this._track){e.next=12;break}return a.debug("replaceTrack() | same track, ignored"),e.abrupt("return");case 12:if(this._zeroRtpOnPause&&this._paused){e.next=15;break}return e.next=15,this.safeEmitAsPromise("@replacetrack",n);case 15:this._destroyTrack(),this._track=n,this._track&&this._disableTrackOnPause&&(this._paused?this._paused&&(this._track.enabled=!1):this._track.enabled=!0),this._handleTrack();case 19:case"end":return e.stop()}}),e,this)})))}},{key:"setMaxSpatialLayer",value:function(e){return td(this,null,wr().mark((function t(){return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this._closed){t.next=4;break}throw new r.InvalidStateError("closed");case 4:if("video"===this._kind){t.next=8;break}throw new r.UnsupportedError("not a video Producer");case 8:if("number"===typeof e){t.next=10;break}throw new TypeError("invalid spatialLayer");case 10:if(e!==this._maxSpatialLayer){t.next=12;break}return t.abrupt("return");case 12:return t.next=14,this.safeEmitAsPromise("@setmaxspatiallayer",e);case 14:this._maxSpatialLayer=e;case 15:case"end":return t.stop()}}),t,this)})))}},{key:"setRtpEncodingParameters",value:function(e){return td(this,null,wr().mark((function t(){return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this._closed){t.next=4;break}throw new r.InvalidStateError("closed");case 4:if("object"===typeof e){t.next=6;break}throw new TypeError("invalid params");case 6:return t.next=8,this.safeEmitAsPromise("@setrtpencodingparameters",e);case 8:case"end":return t.stop()}}),t,this)})))}},{key:"_onTrackEnded",value:function(){a.debug('track "ended" event'),this.safeEmit("trackended"),this._observer.safeEmit("trackended")}},{key:"_handleTrack",value:function(){this._track&&this._track.addEventListener("ended",this._onTrackEnded)}},{key:"_destroyTrack",value:function(){if(this._track)try{this._track.removeEventListener("ended",this._onTrackEnded),this._stopTracks&&this._track.stop()}catch(e){}}}]),i}(n.EnhancedEventEmitter);e.Producer=i}}),Zd=Zl({"../../node_modules/mediasoup-client/lib/Consumer.js":function(e){nd(),Object.defineProperty(e,"__esModule",{value:!0}),e.Consumer=void 0;var t=Wd(),n=Gd(),r=Kd(),a=new t.Logger("Consumer"),i=function(e){mn(i,e);var t=_n(i);function i(e){var r,s=e.id,o=e.localId,c=e.producerId,u=e.rtpReceiver,l=e.track,d=e.rtpParameters,p=e.appData;return St(this,i),(r=t.call(this))._closed=!1,r._observer=new n.EnhancedEventEmitter,a.debug("constructor()"),r._id=s,r._localId=o,r._producerId=c,r._rtpReceiver=u,r._track=l,r._rtpParameters=d,r._paused=!l.enabled,r._appData=p||{},r._onTrackEnded=r._onTrackEnded.bind(bn(r)),r._handleTrack(),r}return Pt(i,[{key:"id",get:function(){return this._id}},{key:"localId",get:function(){return this._localId}},{key:"producerId",get:function(){return this._producerId}},{key:"closed",get:function(){return this._closed}},{key:"kind",get:function(){return this._track.kind}},{key:"rtpReceiver",get:function(){return this._rtpReceiver}},{key:"track",get:function(){return this._track}},{key:"rtpParameters",get:function(){return this._rtpParameters}},{key:"paused",get:function(){return this._paused}},{key:"appData",get:function(){return this._appData},set:function(e){throw new Error("cannot override appData object")}},{key:"observer",get:function(){return this._observer}},{key:"close",value:function(){this._closed||(a.debug("close()"),this._closed=!0,this._destroyTrack(),this.emit("@close"),this._observer.safeEmit("close"))}},{key:"transportClosed",value:function(){this._closed||(a.debug("transportClosed()"),this._closed=!0,this._destroyTrack(),this.safeEmit("transportclose"),this._observer.safeEmit("close"))}},{key:"getStats",value:function(){return td(this,null,wr().mark((function e(){return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._closed){e.next=2;break}throw new r.InvalidStateError("closed");case 2:return e.abrupt("return",this.safeEmitAsPromise("@getstats"));case 3:case"end":return e.stop()}}),e,this)})))}},{key:"pause",value:function(){a.debug("pause()"),this._closed?a.error("pause() | Consumer closed"):(this._paused=!0,this._track.enabled=!1,this.emit("@pause"),this._observer.safeEmit("pause"))}},{key:"resume",value:function(){a.debug("resume()"),this._closed?a.error("resume() | Consumer closed"):(this._paused=!1,this._track.enabled=!0,this.emit("@resume"),this._observer.safeEmit("resume"))}},{key:"_onTrackEnded",value:function(){a.debug('track "ended" event'),this.safeEmit("trackended"),this._observer.safeEmit("trackended")}},{key:"_handleTrack",value:function(){this._track.addEventListener("ended",this._onTrackEnded)}},{key:"_destroyTrack",value:function(){try{this._track.removeEventListener("ended",this._onTrackEnded),this._track.stop()}catch(e){}}}]),i}(n.EnhancedEventEmitter);e.Consumer=i}}),ep=Zl({"../../node_modules/mediasoup-client/lib/DataProducer.js":function(e){nd(),Object.defineProperty(e,"__esModule",{value:!0}),e.DataProducer=void 0;var t=Wd(),n=Gd(),r=Kd(),a=new t.Logger("DataProducer"),i=function(e){mn(i,e);var t=_n(i);function i(e){var r,s=e.id,o=e.dataChannel,c=e.sctpStreamParameters,u=e.appData;return St(this,i),(r=t.call(this))._closed=!1,r._observer=new n.EnhancedEventEmitter,a.debug("constructor()"),r._id=s,r._dataChannel=o,r._sctpStreamParameters=c,r._appData=u||{},r._handleDataChannel(),r}return Pt(i,[{key:"id",get:function(){return this._id}},{key:"closed",get:function(){return this._closed}},{key:"sctpStreamParameters",get:function(){return this._sctpStreamParameters}},{key:"readyState",get:function(){return this._dataChannel.readyState}},{key:"label",get:function(){return this._dataChannel.label}},{key:"protocol",get:function(){return this._dataChannel.protocol}},{key:"bufferedAmount",get:function(){return this._dataChannel.bufferedAmount}},{key:"bufferedAmountLowThreshold",get:function(){return this._dataChannel.bufferedAmountLowThreshold},set:function(e){this._dataChannel.bufferedAmountLowThreshold=e}},{key:"appData",get:function(){return this._appData},set:function(e){throw new Error("cannot override appData object")}},{key:"observer",get:function(){return this._observer}},{key:"close",value:function(){this._closed||(a.debug("close()"),this._closed=!0,this._dataChannel.close(),this.emit("@close"),this._observer.safeEmit("close"))}},{key:"transportClosed",value:function(){this._closed||(a.debug("transportClosed()"),this._closed=!0,this._dataChannel.close(),this.safeEmit("transportclose"),this._observer.safeEmit("close"))}},{key:"send",value:function(e){if(a.debug("send()"),this._closed)throw new r.InvalidStateError("closed");this._dataChannel.send(e)}},{key:"_handleDataChannel",value:function(){var e=this;this._dataChannel.addEventListener("open",(function(){e._closed||(a.debug('DataChannel "open" event'),e.safeEmit("open"))})),this._dataChannel.addEventListener("error",(function(t){if(!e._closed){var n=t.error;n||(n=new Error("unknown DataChannel error")),"sctp-failure"===n.errorDetail?a.error("DataChannel SCTP error [sctpCauseCode:%s]: %s",n.sctpCauseCode,n.message):a.error('DataChannel "error" event: %o',n),e.safeEmit("error",n)}})),this._dataChannel.addEventListener("close",(function(){e._closed||(a.warn('DataChannel "close" event'),e._closed=!0,e.emit("@close"),e.safeEmit("close"))})),this._dataChannel.addEventListener("message",(function(){e._closed||a.warn('DataChannel "message" event in a DataProducer, message discarded')})),this._dataChannel.addEventListener("bufferedamountlow",(function(){e._closed||e.safeEmit("bufferedamountlow")}))}}]),i}(n.EnhancedEventEmitter);e.DataProducer=i}}),tp=Zl({"../../node_modules/mediasoup-client/lib/DataConsumer.js":function(e){nd(),Object.defineProperty(e,"__esModule",{value:!0}),e.DataConsumer=void 0;var t=Wd(),n=Gd(),r=new t.Logger("DataConsumer"),a=function(e){mn(a,e);var t=_n(a);function a(e){var i,s=e.id,o=e.dataProducerId,c=e.dataChannel,u=e.sctpStreamParameters,l=e.appData;return St(this,a),(i=t.call(this))._closed=!1,i._observer=new n.EnhancedEventEmitter,r.debug("constructor()"),i._id=s,i._dataProducerId=o,i._dataChannel=c,i._sctpStreamParameters=u,i._appData=l||{},i._handleDataChannel(),i}return Pt(a,[{key:"id",get:function(){return this._id}},{key:"dataProducerId",get:function(){return this._dataProducerId}},{key:"closed",get:function(){return this._closed}},{key:"sctpStreamParameters",get:function(){return this._sctpStreamParameters}},{key:"readyState",get:function(){return this._dataChannel.readyState}},{key:"label",get:function(){return this._dataChannel.label}},{key:"protocol",get:function(){return this._dataChannel.protocol}},{key:"binaryType",get:function(){return this._dataChannel.binaryType},set:function(e){this._dataChannel.binaryType=e}},{key:"appData",get:function(){return this._appData},set:function(e){throw new Error("cannot override appData object")}},{key:"observer",get:function(){return this._observer}},{key:"close",value:function(){this._closed||(r.debug("close()"),this._closed=!0,this._dataChannel.close(),this.emit("@close"),this._observer.safeEmit("close"))}},{key:"transportClosed",value:function(){this._closed||(r.debug("transportClosed()"),this._closed=!0,this._dataChannel.close(),this.safeEmit("transportclose"),this._observer.safeEmit("close"))}},{key:"_handleDataChannel",value:function(){var e=this;this._dataChannel.addEventListener("open",(function(){e._closed||(r.debug('DataChannel "open" event'),e.safeEmit("open"))})),this._dataChannel.addEventListener("error",(function(t){if(!e._closed){var n=t.error;n||(n=new Error("unknown DataChannel error")),"sctp-failure"===n.errorDetail?r.error("DataChannel SCTP error [sctpCauseCode:%s]: %s",n.sctpCauseCode,n.message):r.error('DataChannel "error" event: %o',n),e.safeEmit("error",n)}})),this._dataChannel.addEventListener("close",(function(){e._closed||(r.warn('DataChannel "close" event'),e._closed=!0,e.emit("@close"),e.safeEmit("close"))})),this._dataChannel.addEventListener("message",(function(t){e._closed||e.safeEmit("message",t.data)}))}}]),a}(n.EnhancedEventEmitter);e.DataConsumer=a}}),np=Zl({"../../node_modules/mediasoup-client/lib/Transport.js":function(e){nd();var t=e&&e.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var a=Object.getOwnPropertyDescriptor(t,n);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,a)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),n=e&&e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=e&&e.__importStar||function(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var a in e)"default"!==a&&Object.prototype.hasOwnProperty.call(e,a)&&t(r,e,a);return n(r,e),r};Object.defineProperty(e,"__esModule",{value:!0}),e.Transport=void 0;var a=Jd(),i=Wd(),s=Gd(),o=Kd(),c=r(Xd()),u=r($d()),l=Yd(),d=Zd(),p=ep(),f=tp(),h=Pt((function e(t){var n=this;St(this,e),this.consumerOptions=t,this.promise=new Promise((function(e,t){n.resolve=e,n.reject=t}))})),m=new i.Logger("Transport"),v=function(e){mn(n,e);var t=_n(n);function n(e){var r,i=e.direction,u=e.id,l=e.iceParameters,d=e.iceCandidates,p=e.dtlsParameters,f=e.sctpParameters,h=e.iceServers,v=e.iceTransportPolicy,g=e.additionalSettings,b=e.proprietaryConstraints,y=e.appData,_=e.handlerFactory,w=e.extendedRtpCapabilities,k=e.canProduceByKind;return St(this,n),(r=t.call(this))._closed=!1,r._connectionState="new",r._producers=new Map,r._consumers=new Map,r._dataProducers=new Map,r._dataConsumers=new Map,r._probatorConsumerCreated=!1,r._awaitQueue=new a.AwaitQueue({ClosedErrorClass:o.InvalidStateError}),r._pendingConsumerTasks=[],r._consumerCreationInProgress=!1,r._pendingPauseConsumers=new Map,r._consumerPauseInProgress=!1,r._pendingResumeConsumers=new Map,r._consumerResumeInProgress=!1,r._observer=new s.EnhancedEventEmitter,m.debug("constructor() [id:%s, direction:%s]",u,i),r._id=u,r._direction=i,r._extendedRtpCapabilities=w,r._canProduceByKind=k,r._maxSctpMessageSize=f?f.maxMessageSize:null,delete(g=c.clone(g,{})).iceServers,delete g.iceTransportPolicy,delete g.bundlePolicy,delete g.rtcpMuxPolicy,delete g.sdpSemantics,r._handler=_(),r._handler.run({direction:i,iceParameters:l,iceCandidates:d,dtlsParameters:p,sctpParameters:f,iceServers:h,iceTransportPolicy:v,additionalSettings:g,proprietaryConstraints:b,extendedRtpCapabilities:w}),r._appData=y||{},r._handleHandler(),r}return Pt(n,[{key:"id",get:function(){return this._id}},{key:"closed",get:function(){return this._closed}},{key:"direction",get:function(){return this._direction}},{key:"handler",get:function(){return this._handler}},{key:"connectionState",get:function(){return this._connectionState}},{key:"appData",get:function(){return this._appData},set:function(e){throw new Error("cannot override appData object")}},{key:"observer",get:function(){return this._observer}},{key:"close",value:function(){if(!this._closed){m.debug("close()"),this._closed=!0,this._awaitQueue.close(),this._handler.close();var e,t=kr(this._producers.values());try{for(t.s();!(e=t.n()).done;){e.value.transportClosed()}}catch(c){t.e(c)}finally{t.f()}this._producers.clear();var n,r=kr(this._consumers.values());try{for(r.s();!(n=r.n()).done;){n.value.transportClosed()}}catch(c){r.e(c)}finally{r.f()}this._consumers.clear();var a,i=kr(this._dataProducers.values());try{for(i.s();!(a=i.n()).done;){a.value.transportClosed()}}catch(c){i.e(c)}finally{i.f()}this._dataProducers.clear();var s,o=kr(this._dataConsumers.values());try{for(o.s();!(s=o.n()).done;){s.value.transportClosed()}}catch(c){o.e(c)}finally{o.f()}this._dataConsumers.clear(),this._observer.safeEmit("close")}}},{key:"getStats",value:function(){return td(this,null,wr().mark((function e(){return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._closed){e.next=2;break}throw new o.InvalidStateError("closed");case 2:return e.abrupt("return",this._handler.getTransportStats());case 3:case"end":return e.stop()}}),e,this)})))}},{key:"restartIce",value:function(e){return td(this,arguments,wr().mark((function e(t){var n,r=this;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.iceParameters,m.debug("restartIce()"),!this._closed){e.next=6;break}throw new o.InvalidStateError("closed");case 6:if(n){e.next=8;break}throw new TypeError("missing iceParameters");case 8:return e.abrupt("return",this._awaitQueue.push((function(){return td(r,null,wr().mark((function e(){return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._handler.restartIce(n));case 1:case"end":return e.stop()}}),e,this)})))}),"transport.restartIce()"));case 9:case"end":return e.stop()}}),e,this)})))}},{key:"updateIceServers",value:function(){return td(this,arguments,wr().mark((function e(){var t,n,r=this,a=arguments;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=a.length>0&&void 0!==a[0]?a[0]:{},n=t.iceServers,m.debug("updateIceServers()"),!this._closed){e.next=6;break}throw new o.InvalidStateError("closed");case 6:if(Array.isArray(n)){e.next=8;break}throw new TypeError("missing iceServers");case 8:return e.abrupt("return",this._awaitQueue.push((function(){return td(r,null,wr().mark((function e(){return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._handler.updateIceServers(n));case 1:case"end":return e.stop()}}),e,this)})))}),"transport.updateIceServers()"));case 9:case"end":return e.stop()}}),e,this)})))}},{key:"produce",value:function(){return td(this,arguments,wr().mark((function e(){var t,n,r,a,i,s,c,d,p,f,h,v,g,b=this,y=arguments;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=y.length>0&&void 0!==y[0]?y[0]:{},n=t.track,r=t.encodings,a=t.codecOptions,i=t.codec,s=t.stopTracks,c=void 0===s||s,d=t.disableTrackOnPause,p=void 0===d||d,f=t.zeroRtpOnPause,h=void 0!==f&&f,v=t.appData,g=void 0===v?{}:v,m.debug("produce() [track:%o]",n),n){e.next=6;break}throw new TypeError("missing track");case 6:if("send"===this._direction){e.next=10;break}throw new o.UnsupportedError("not a sending Transport");case 10:if(this._canProduceByKind[n.kind]){e.next=14;break}throw new o.UnsupportedError("cannot produce ".concat(n.kind));case 14:if("ended"!==n.readyState){e.next=18;break}throw new o.InvalidStateError("track ended");case 18:if(0!==this.listenerCount("connect")||"new"!==this._connectionState){e.next=22;break}throw new TypeError('no "connect" listener set into this transport');case 22:if(0!==this.listenerCount("produce")){e.next=26;break}throw new TypeError('no "produce" listener set into this transport');case 26:if(!g||"object"===typeof g){e.next=28;break}throw new TypeError("if given, appData must be an object");case 28:return e.abrupt("return",this._awaitQueue.push((function(){return td(b,null,wr().mark((function e(){var t,s,o,d,f,m,v,b;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!r||Array.isArray(r)){e.next=4;break}throw TypeError("encodings must be an array");case 4:r&&0===r.length?t=void 0:r&&(t=r.map((function(e){var t={active:!0};return!1===e.active&&(t.active=!1),"boolean"===typeof e.dtx&&(t.dtx=e.dtx),"string"===typeof e.scalabilityMode&&(t.scalabilityMode=e.scalabilityMode),"number"===typeof e.scaleResolutionDownBy&&(t.scaleResolutionDownBy=e.scaleResolutionDownBy),"number"===typeof e.maxBitrate&&(t.maxBitrate=e.maxBitrate),"number"===typeof e.maxFramerate&&(t.maxFramerate=e.maxFramerate),"boolean"===typeof e.adaptivePtime&&(t.adaptivePtime=e.adaptivePtime),"string"===typeof e.priority&&(t.priority=e.priority),"string"===typeof e.networkPriority&&(t.networkPriority=e.networkPriority),t})));case 5:return e.next=7,this._handler.send({track:n,encodings:t,codecOptions:a,codec:i});case 7:return s=e.sent,o=s.localId,d=s.rtpParameters,f=s.rtpSender,e.prev=11,u.validateRtpParameters(d),e.next=15,this.safeEmitAsPromise("produce",{kind:n.kind,rtpParameters:d,appData:g});case 15:return m=e.sent,v=m.id,b=new l.Producer({id:v,localId:o,rtpSender:f,track:n,rtpParameters:d,stopTracks:c,disableTrackOnPause:p,zeroRtpOnPause:h,appData:g}),this._producers.set(b.id,b),this._handleProducer(b),this._observer.safeEmit("newproducer",b),e.abrupt("return",b);case 24:throw e.prev=24,e.t0=e.catch(11),this._handler.stopSending(o).catch((function(){})),e.t0;case 28:case"end":return e.stop()}}),e,this,[[11,24]])})))}),"transport.produce()").catch((function(e){if(c)try{n.stop()}catch(t){}throw e})));case 29:case"end":return e.stop()}}),e,this)})))}},{key:"consume",value:function(e){return td(this,arguments,wr().mark((function e(t){var n,r,a,i,s,l,d;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.id,r=t.producerId,a=t.kind,i=t.rtpParameters,s=t.appData,l=void 0===s?{}:s,m.debug("consume()"),i=c.clone(i,void 0),!this._closed){e.next=7;break}throw new o.InvalidStateError("closed");case 7:if("recv"===this._direction){e.next=11;break}throw new o.UnsupportedError("not a receiving Transport");case 11:if("string"===typeof n){e.next=15;break}throw new TypeError("missing id");case 15:if("string"===typeof r){e.next=19;break}throw new TypeError("missing producerId");case 19:if("audio"===a||"video"===a){e.next=23;break}throw new TypeError("invalid kind '".concat(a,"'"));case 23:if(0!==this.listenerCount("connect")||"new"!==this._connectionState){e.next=27;break}throw new TypeError('no "connect" listener set into this transport');case 27:if(!l||"object"===typeof l){e.next=29;break}throw new TypeError("if given, appData must be an object");case 29:if(u.canReceive(i,this._extendedRtpCapabilities)){e.next=32;break}throw new o.UnsupportedError("cannot consume this Producer");case 32:return d=new h({id:n,producerId:r,kind:a,rtpParameters:i,appData:l}),this._pendingConsumerTasks.push(d),!1===this._consumerCreationInProgress&&this._createPendingConsumers(),e.abrupt("return",d.promise);case 36:case"end":return e.stop()}}),e,this)})))}},{key:"produceData",value:function(){return td(this,arguments,wr().mark((function e(){var t,n,r,a,i,s,c,l,d,f,h,v=this,g=arguments;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=g.length>0&&void 0!==g[0]?g[0]:{},n=t.ordered,r=void 0===n||n,a=t.maxPacketLifeTime,i=t.maxRetransmits,s=t.label,c=void 0===s?"":s,l=t.protocol,d=void 0===l?"":l,f=t.appData,h=void 0===f?{}:f,m.debug("produceData()"),"send"===this._direction){e.next=6;break}throw new o.UnsupportedError("not a sending Transport");case 6:if(this._maxSctpMessageSize){e.next=10;break}throw new o.UnsupportedError("SCTP not enabled by remote Transport");case 10:if(0!==this.listenerCount("connect")||"new"!==this._connectionState){e.next=14;break}throw new TypeError('no "connect" listener set into this transport');case 14:if(0!==this.listenerCount("producedata")){e.next=18;break}throw new TypeError('no "producedata" listener set into this transport');case 18:if(!h||"object"===typeof h){e.next=20;break}throw new TypeError("if given, appData must be an object");case 20:return(a||i)&&(r=!1),e.abrupt("return",this._awaitQueue.push((function(){return td(v,null,wr().mark((function e(){var t,n,s,o,l,f;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._handler.sendDataChannel({ordered:r,maxPacketLifeTime:a,maxRetransmits:i,label:c,protocol:d});case 2:return t=e.sent,n=t.dataChannel,s=t.sctpStreamParameters,u.validateSctpStreamParameters(s),e.next=8,this.safeEmitAsPromise("producedata",{sctpStreamParameters:s,label:c,protocol:d,appData:h});case 8:return o=e.sent,l=o.id,f=new p.DataProducer({id:l,dataChannel:n,sctpStreamParameters:s,appData:h}),this._dataProducers.set(f.id,f),this._handleDataProducer(f),this._observer.safeEmit("newdataproducer",f),e.abrupt("return",f);case 15:case"end":return e.stop()}}),e,this)})))}),"transport.produceData()"));case 22:case"end":return e.stop()}}),e,this)})))}},{key:"consumeData",value:function(e){return td(this,arguments,wr().mark((function e(t){var n,r,a,i,s,l,d,p,h,v=this;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.id,r=t.dataProducerId,a=t.sctpStreamParameters,i=t.label,s=void 0===i?"":i,l=t.protocol,d=void 0===l?"":l,p=t.appData,h=void 0===p?{}:p,m.debug("consumeData()"),a=c.clone(a,void 0),!this._closed){e.next=7;break}throw new o.InvalidStateError("closed");case 7:if("recv"===this._direction){e.next=11;break}throw new o.UnsupportedError("not a receiving Transport");case 11:if(this._maxSctpMessageSize){e.next=15;break}throw new o.UnsupportedError("SCTP not enabled by remote Transport");case 15:if("string"===typeof n){e.next=19;break}throw new TypeError("missing id");case 19:if("string"===typeof r){e.next=23;break}throw new TypeError("missing dataProducerId");case 23:if(0!==this.listenerCount("connect")||"new"!==this._connectionState){e.next=27;break}throw new TypeError('no "connect" listener set into this transport');case 27:if(!h||"object"===typeof h){e.next=29;break}throw new TypeError("if given, appData must be an object");case 29:return u.validateSctpStreamParameters(a),e.abrupt("return",this._awaitQueue.push((function(){return td(v,null,wr().mark((function e(){var t,i,o;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._handler.receiveDataChannel({sctpStreamParameters:a,label:s,protocol:d});case 2:return t=e.sent,i=t.dataChannel,o=new f.DataConsumer({id:n,dataProducerId:r,dataChannel:i,sctpStreamParameters:a,appData:h}),this._dataConsumers.set(o.id,o),this._handleDataConsumer(o),this._observer.safeEmit("newdataconsumer",o),e.abrupt("return",o);case 9:case"end":return e.stop()}}),e,this)})))}),"transport.consumeData()"));case 31:case"end":return e.stop()}}),e,this)})))}},{key:"_createPendingConsumers",value:function(){return td(this,null,wr().mark((function e(){var t=this;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this._awaitQueue.push((function(){return td(t,null,wr().mark((function e(){var t,n,r,a,i,s,o,c,l,p,f,h,v,g,b,y,_,w,k,x,S,R,P,C,T,E,O;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this._consumerCreationInProgress=!0,t=xt(this._pendingConsumerTasks),this._pendingConsumerTasks=[],n=void 0,r=[],a=kr(t);try{for(a.s();!(i=a.n()).done;)s=i.value,o=s.consumerOptions,c=o.id,l=o.kind,p=o.rtpParameters,r.push({trackId:c,kind:l,rtpParameters:p})}catch(M){a.e(M)}finally{a.f()}return e.prev=7,e.next=10,this._handler.receive(r);case 10:for(f=e.sent,h=0;h<f.length;h++)v=t[h],g=f[h],b=v.consumerOptions,y=b.id,_=b.producerId,w=b.kind,k=b.rtpParameters,x=b.appData,S=g.localId,R=g.rtpReceiver,P=g.track,C=new d.Consumer({id:y,localId:S,producerId:_,rtpReceiver:R,track:P,rtpParameters:k,appData:x}),this._consumers.set(C.id,C),this._handleConsumer(C),this._probatorConsumerCreated||n||"video"!==w||(n=C),this._observer.safeEmit("newconsumer",C),v.resolve(C);e.next=18;break;case 14:e.prev=14,e.t0=e.catch(7),T=kr(t);try{for(T.s();!(E=T.n()).done;)E.value.reject(e.t0)}catch(M){T.e(M)}finally{T.f()}case 18:if(!n){e.next=30;break}return e.prev=19,O=u.generateProbatorRtpParameters(n.rtpParameters),e.next=23,this._handler.receive([{trackId:"probator",kind:"video",rtpParameters:O}]);case 23:m.debug("_createPendingConsumers() | Consumer for RTP probation created"),this._probatorConsumerCreated=!0,e.next=30;break;case 27:e.prev=27,e.t1=e.catch(19),m.error("_createPendingConsumers() | failed to create Consumer for RTP probation:%o",e.t1);case 30:this._consumerCreationInProgress=!1;case 31:case"end":return e.stop()}}),e,this,[[7,14],[19,27]])})))}),"transport._createPendingConsumers()").then((function(){t._pendingConsumerTasks.length>0&&t._createPendingConsumers()})).catch((function(){}));case 1:case"end":return e.stop()}}),e,this)})))}},{key:"_pausePendingConsumers",value:function(){var e=this;this._awaitQueue.push((function(){return td(e,null,wr().mark((function e(){var t;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this._consumerPauseInProgress=!0,t=Array.from(this._pendingPauseConsumers.values()),this._pendingPauseConsumers.clear(),e.prev=3,e.next=6,this._handler.pauseReceiving(t.map((function(e){return e.localId})));case 6:e.next=11;break;case 8:e.prev=8,e.t0=e.catch(3),m.error("_pausePendingConsumers() | failed to pause Consumers:",e.t0);case 11:this._consumerPauseInProgress=!1;case 12:case"end":return e.stop()}}),e,this,[[3,8]])})))}),"consumer @pause event").then((function(){e._pendingPauseConsumers.size>0&&e._pausePendingConsumers()})).catch((function(){}))}},{key:"_resumePendingConsumers",value:function(){var e=this;this._awaitQueue.push((function(){return td(e,null,wr().mark((function e(){var t;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this._consumerResumeInProgress=!0,t=Array.from(this._pendingResumeConsumers.values()),this._pendingResumeConsumers.clear(),e.prev=3,e.next=6,this._handler.resumeReceiving(t.map((function(e){return e.localId})));case 6:e.next=11;break;case 8:e.prev=8,e.t0=e.catch(3),m.error("_resumePendingConsumers() | failed to resume Consumers:",e.t0);case 11:case"end":return e.stop()}}),e,this,[[3,8]])})))}),"consumer @resume event").then((function(){e._consumerResumeInProgress=!1,e._pendingResumeConsumers.size>0&&e._resumePendingConsumers()})).catch((function(){}))}},{key:"_handleHandler",value:function(){var e=this,t=this._handler;t.on("@connect",(function(t,n,r){var a=t.dtlsParameters;e._closed?r(new o.InvalidStateError("closed")):e.safeEmit("connect",{dtlsParameters:a},n,r)})),t.on("@connectionstatechange",(function(t){t!==e._connectionState&&(m.debug("connection state changed to %s",t),e._connectionState=t,e._closed||e.safeEmit("connectionstatechange",t))}))}},{key:"_handleProducer",value:function(e){var t=this;e.on("@close",(function(){t._producers.delete(e.id),t._closed||t._awaitQueue.push((function(){return td(t,null,wr().mark((function t(){return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this._handler.stopSending(e.localId));case 1:case"end":return t.stop()}}),t,this)})))}),"producer @close event").catch((function(e){return m.warn("producer.close() failed:%o",e)}))})),e.on("@replacetrack",(function(n,r,a){t._awaitQueue.push((function(){return td(t,null,wr().mark((function t(){return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this._handler.replaceTrack(e.localId,n));case 1:case"end":return t.stop()}}),t,this)})))}),"producer @replacetrack event").then(r).catch(a)})),e.on("@setmaxspatiallayer",(function(n,r,a){t._awaitQueue.push((function(){return td(t,null,wr().mark((function t(){return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this._handler.setMaxSpatialLayer(e.localId,n));case 1:case"end":return t.stop()}}),t,this)})))}),"producer @setmaxspatiallayer event").then(r).catch(a)})),e.on("@setrtpencodingparameters",(function(n,r,a){t._awaitQueue.push((function(){return td(t,null,wr().mark((function t(){return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this._handler.setRtpEncodingParameters(e.localId,n));case 1:case"end":return t.stop()}}),t,this)})))}),"producer @setrtpencodingparameters event").then(r).catch(a)})),e.on("@getstats",(function(n,r){if(t._closed)return r(new o.InvalidStateError("closed"));t._handler.getSenderStats(e.localId).then(n).catch(r)}))}},{key:"_handleConsumer",value:function(e){var t=this;e.on("@close",(function(){t._consumers.delete(e.id),t._pendingPauseConsumers.delete(e.id),t._pendingResumeConsumers.delete(e.id),t._closed||t._awaitQueue.push((function(){return td(t,null,wr().mark((function t(){return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this._handler.stopReceiving(e.localId));case 1:case"end":return t.stop()}}),t,this)})))}),"consumer @close event").catch((function(){}))})),e.on("@pause",(function(){t._pendingResumeConsumers.has(e.id)&&t._pendingResumeConsumers.delete(e.id),t._pendingPauseConsumers.set(e.id,e),!1===t._consumerPauseInProgress&&t._pausePendingConsumers()})),e.on("@resume",(function(){t._pendingPauseConsumers.has(e.id)&&t._pendingPauseConsumers.delete(e.id),t._pendingResumeConsumers.set(e.id,e),!1===t._consumerResumeInProgress&&t._resumePendingConsumers()})),e.on("@getstats",(function(n,r){if(t._closed)return r(new o.InvalidStateError("closed"));t._handler.getReceiverStats(e.localId).then(n).catch(r)}))}},{key:"_handleDataProducer",value:function(e){var t=this;e.on("@close",(function(){t._dataProducers.delete(e.id)}))}},{key:"_handleDataConsumer",value:function(e){var t=this;e.on("@close",(function(){t._dataConsumers.delete(e.id)}))}}]),n}(s.EnhancedEventEmitter);e.Transport=v}}),rp=Zl({"../../node_modules/mediasoup-client/lib/handlers/sdp/commonUtils.js":function(e){nd();var t=e&&e.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var a=Object.getOwnPropertyDescriptor(t,n);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,a)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),n=e&&e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=e&&e.__importStar||function(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var a in e)"default"!==a&&Object.prototype.hasOwnProperty.call(e,a)&&t(r,e,a);return n(r,e),r};Object.defineProperty(e,"__esModule",{value:!0}),e.applyCodecParameters=e.getCname=e.extractDtlsParameters=e.extractRtpCapabilities=void 0;var a=r(Bd());e.extractRtpCapabilities=function(e){var t,n=e.sdpObject,r=new Map,i=[],s=!1,o=!1,c=kr(n.media);try{for(c.s();!(t=c.n()).done;){var u=t.value,l=u.type;switch(l){case"audio":if(s)continue;s=!0;break;case"video":if(o)continue;o=!0;break;default:continue}var d,p=kr(u.rtp);try{for(p.s();!(d=p.n()).done;){var f=d.value,h={kind:l,mimeType:"".concat(l,"/").concat(f.codec),preferredPayloadType:f.payload,clockRate:f.rate,channels:f.encoding,parameters:{},rtcpFeedback:[]};r.set(h.preferredPayloadType,h)}}catch(E){p.e(E)}finally{p.f()}var m,v=kr(u.fmtp||[]);try{for(v.s();!(m=v.n()).done;){var g=m.value,b=a.parseParams(g.config),y=r.get(g.payload);y&&(b&&b.hasOwnProperty("profile-level-id")&&(b["profile-level-id"]=String(b["profile-level-id"])),y.parameters=b)}}catch(E){v.e(E)}finally{v.f()}var _,w=kr(u.rtcpFb||[]);try{for(w.s();!(_=w.n()).done;){var k=_.value,x=r.get(k.payload);if(x){var S={type:k.type,parameter:k.subtype};S.parameter||delete S.parameter,x.rtcpFeedback.push(S)}}}catch(E){w.e(E)}finally{w.f()}var R,P=kr(u.ext||[]);try{for(P.s();!(R=P.n()).done;){var C=R.value;if(!C["encrypt-uri"]){var T={kind:l,uri:C.uri,preferredId:C.value};i.push(T)}}}catch(E){P.e(E)}finally{P.f()}}}catch(E){c.e(E)}finally{c.f()}return{codecs:Array.from(r.values()),headerExtensions:i}},e.extractDtlsParameters=function(e){var t=e.sdpObject,n=(t.media||[]).find((function(e){return e.iceUfrag&&0!==e.port}));if(!n)throw new Error("no active media section found");var r,a=n.fingerprint||t.fingerprint;switch(n.setup){case"active":r="client";break;case"passive":r="server";break;case"actpass":r="auto"}return{role:r,fingerprints:[{algorithm:a.type,value:a.hash}]}},e.getCname=function(e){var t=(e.offerMediaObject.ssrcs||[]).find((function(e){return"cname"===e.attribute}));return t?t.value:""},e.applyCodecParameters=function(e){var t,n=e.offerRtpParameters,r=e.answerMediaObject,i=kr(n.codecs);try{var s=function(){var e=t.value,n=e.mimeType.toLowerCase();if("audio/opus"!==n)return"continue";if(!(r.rtp||[]).find((function(t){return t.payload===e.payloadType})))return"continue";r.fmtp=r.fmtp||[];var i=r.fmtp.find((function(t){return t.payload===e.payloadType}));i||(i={payload:e.payloadType,config:""},r.fmtp.push(i));var s=a.parseParams(i.config);if("audio/opus"===n){var o=e.parameters["sprop-stereo"];void 0!==o&&(s.stereo=o?1:0)}i.config="";for(var c=0,u=Object.keys(s);c<u.length;c++){var l=u[c];i.config&&(i.config+=";"),i.config+="".concat(l,"=").concat(s[l])}};for(i.s();!(t=i.n()).done;)s()}catch(o){i.e(o)}finally{i.f()}}}}),ap=Zl({"../../node_modules/mediasoup-client/lib/handlers/sdp/unifiedPlanUtils.js":function(e){nd(),Object.defineProperty(e,"__esModule",{value:!0}),e.addLegacySimulcast=e.getRtpEncodings=void 0,e.getRtpEncodings=function(e){var t,n=e.offerMediaObject,r=new Set,a=kr(n.ssrcs||[]);try{for(a.s();!(t=a.n()).done;){var i=t.value.id;r.add(i)}}catch(S){a.e(S)}finally{a.f()}if(0===r.size)throw new Error("no a=ssrc lines found");var o,c=new Map,u=kr(n.ssrcGroups||[]);try{for(u.s();!(o=u.n()).done;){var l=o.value;if("FID"===l.semantics){var d=s(l.ssrcs.split(/\s+/),2),p=d[0],f=d[1];p=Number(p),f=Number(f),r.has(p)&&(r.delete(p),r.delete(f),c.set(p,f))}}}catch(S){u.e(S)}finally{u.f()}var h,m=kr(r);try{for(m.s();!(h=m.n()).done;){var v=h.value;c.set(v,null)}}catch(S){m.e(S)}finally{m.f()}var g,b=[],y=kr(c);try{for(y.s();!(g=y.n()).done;){var _=s(g.value,2),w=_[0],k=_[1],x={ssrc:w};k&&(x.rtx={ssrc:k}),b.push(x)}}catch(S){y.e(S)}finally{y.f()}return b},e.addLegacySimulcast=function(e){var t=e.offerMediaObject,n=e.numStreams;if(n<=1)throw new TypeError("numStreams must be greater than 1");var r=(t.ssrcs||[]).find((function(e){return"msid"===e.attribute}));if(!r)throw new Error("a=ssrc line with msid information not found");var a,i=s(r.value.split(" "),2),o=i[0],c=i[1],u=r.id;(t.ssrcGroups||[]).some((function(e){if("FID"!==e.semantics)return!1;var t=e.ssrcs.split(/\s+/);return Number(t[0])===u&&(a=Number(t[1]),!0)}));var l=t.ssrcs.find((function(e){return"cname"===e.attribute}));if(!l)throw new Error("a=ssrc line with cname information not found");for(var d=l.value,p=[],f=[],h=0;h<n;++h)p.push(u+h),a&&f.push(a+h);t.ssrcGroups=[],t.ssrcs=[],t.ssrcGroups.push({semantics:"SIM",ssrcs:p.join(" ")});for(var m=0;m<p.length;++m){var v=p[m];t.ssrcs.push({id:v,attribute:"cname",value:d}),t.ssrcs.push({id:v,attribute:"msid",value:"".concat(o," ").concat(c)})}for(var g=0;g<f.length;++g){var b=p[g],y=f[g];t.ssrcs.push({id:y,attribute:"cname",value:d}),t.ssrcs.push({id:y,attribute:"msid",value:"".concat(o," ").concat(c)}),t.ssrcGroups.push({semantics:"FID",ssrcs:"".concat(b," ").concat(y)})}}}}),ip=Zl({"../../node_modules/mediasoup-client/lib/handlers/HandlerInterface.js":function(e){nd(),Object.defineProperty(e,"__esModule",{value:!0}),e.HandlerInterface=void 0;var t=function(e){mn(n,e);var t=_n(n);function n(){return St(this,n),t.call(this)}return Pt(n)}(Gd().EnhancedEventEmitter);e.HandlerInterface=t}}),sp=Zl({"../../node_modules/mediasoup-client/lib/handlers/sdp/MediaSection.js":function(e){nd();var t=e&&e.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var a=Object.getOwnPropertyDescriptor(t,n);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,a)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),n=e&&e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=e&&e.__importStar||function(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var a in e)"default"!==a&&Object.prototype.hasOwnProperty.call(e,a)&&t(r,e,a);return n(r,e),r};Object.defineProperty(e,"__esModule",{value:!0}),e.OfferMediaSection=e.AnswerMediaSection=e.MediaSection=void 0;var a=r(Xd()),i=function(){function e(t){var n=t.iceParameters,r=t.iceCandidates,a=t.dtlsParameters,i=t.planB,s=void 0!==i&&i;if(St(this,e),this._mediaObject={},this._planB=s,n&&this.setIceParameters(n),r){this._mediaObject.candidates=[];var o,c=kr(r);try{for(c.s();!(o=c.n()).done;){var u=o.value,l={component:1};l.foundation=u.foundation,l.ip=u.ip,l.port=u.port,l.priority=u.priority,l.transport=u.protocol,l.type=u.type,u.tcpType&&(l.tcptype=u.tcpType),this._mediaObject.candidates.push(l)}}catch(d){c.e(d)}finally{c.f()}this._mediaObject.endOfCandidates="end-of-candidates",this._mediaObject.iceOptions="renomination"}a&&this.setDtlsRole(a.role)}return Pt(e,[{key:"mid",get:function(){return String(this._mediaObject.mid)}},{key:"closed",get:function(){return 0===this._mediaObject.port}},{key:"getObject",value:function(){return this._mediaObject}},{key:"setIceParameters",value:function(e){this._mediaObject.iceUfrag=e.usernameFragment,this._mediaObject.icePwd=e.password}},{key:"disable",value:function(){this._mediaObject.direction="inactive",delete this._mediaObject.ext,delete this._mediaObject.ssrcs,delete this._mediaObject.ssrcGroups,delete this._mediaObject.simulcast,delete this._mediaObject.simulcast_03,delete this._mediaObject.rids}},{key:"close",value:function(){this._mediaObject.direction="inactive",this._mediaObject.port=0,delete this._mediaObject.ext,delete this._mediaObject.ssrcs,delete this._mediaObject.ssrcGroups,delete this._mediaObject.simulcast,delete this._mediaObject.simulcast_03,delete this._mediaObject.rids,delete this._mediaObject.extmapAllowMixed}}]),e}();e.MediaSection=i;var s=function(e){mn(n,e);var t=_n(n);function n(e){var r,i=e.iceParameters,s=e.iceCandidates,o=e.dtlsParameters,u=e.sctpParameters,l=e.plainRtpParameters,d=e.planB,p=void 0!==d&&d,f=e.offerMediaObject,h=e.offerRtpParameters,m=e.answerRtpParameters,v=e.codecOptions,g=e.extmapAllowMixed,b=void 0!==g&&g;switch(St(this,n),(r=t.call(this,{iceParameters:i,iceCandidates:s,dtlsParameters:o,planB:p}))._mediaObject.mid=String(f.mid),r._mediaObject.type=f.type,r._mediaObject.protocol=f.protocol,l?(r._mediaObject.connection={ip:l.ip,version:l.ipVersion},r._mediaObject.port=l.port):(r._mediaObject.connection={ip:"127.0.0.1",version:4},r._mediaObject.port=7),f.type){case"audio":case"video":r._mediaObject.direction="recvonly",r._mediaObject.rtp=[],r._mediaObject.rtcpFb=[],r._mediaObject.fmtp=[];var y,_=kr(m.codecs);try{var w=function(){var e=y.value,t={payload:e.payloadType,codec:c(e),rate:e.clockRate};e.channels>1&&(t.encoding=e.channels),r._mediaObject.rtp.push(t);var n=a.clone(e.parameters,{});if(v){var i=v.opusStereo,s=v.opusFec,o=v.opusDtx,u=v.opusMaxPlaybackRate,l=v.opusMaxAverageBitrate,d=v.opusPtime,p=v.videoGoogleStartBitrate,f=v.videoGoogleMaxBitrate,m=v.videoGoogleMinBitrate,g=h.codecs.find((function(t){return t.payloadType===e.payloadType}));switch(e.mimeType.toLowerCase()){case"audio/opus":void 0!==i&&(g.parameters["sprop-stereo"]=i?1:0,n.stereo=i?1:0),void 0!==s&&(g.parameters.useinbandfec=s?1:0,n.useinbandfec=s?1:0),void 0!==o&&(g.parameters.usedtx=o?1:0,n.usedtx=o?1:0),void 0!==u&&(n.maxplaybackrate=u),void 0!==l&&(n.maxaveragebitrate=l),void 0!==d&&(g.parameters.ptime=d,n.ptime=d);break;case"video/vp8":case"video/vp9":case"video/h264":case"video/h265":void 0!==p&&(n["x-google-start-bitrate"]=p),void 0!==f&&(n["x-google-max-bitrate"]=f),void 0!==m&&(n["x-google-min-bitrate"]=m)}}for(var b={payload:e.payloadType,config:""},_=0,w=Object.keys(n);_<w.length;_++){var k=w[_];b.config&&(b.config+=";"),b.config+="".concat(k,"=").concat(n[k])}b.config&&r._mediaObject.fmtp.push(b);var x,S=kr(e.rtcpFeedback);try{for(S.s();!(x=S.n()).done;){var R=x.value;r._mediaObject.rtcpFb.push({payload:e.payloadType,type:R.type,subtype:R.parameter})}}catch(P){S.e(P)}finally{S.f()}};for(_.s();!(y=_.n()).done;)w()}catch(M){_.e(M)}finally{_.f()}r._mediaObject.payloads=m.codecs.map((function(e){return e.payloadType})).join(" "),r._mediaObject.ext=[];var k,x=kr(m.headerExtensions);try{var S=function(){var e=k.value;if(!(f.ext||[]).some((function(t){return t.uri===e.uri})))return"continue";r._mediaObject.ext.push({uri:e.uri,value:e.id})};for(x.s();!(k=x.n()).done;)S()}catch(M){x.e(M)}finally{x.f()}if(b&&"extmap-allow-mixed"===f.extmapAllowMixed&&(r._mediaObject.extmapAllowMixed="extmap-allow-mixed"),f.simulcast){r._mediaObject.simulcast={dir1:"recv",list1:f.simulcast.list1},r._mediaObject.rids=[];var R,P=kr(f.rids||[]);try{for(P.s();!(R=P.n()).done;){var C=R.value;"send"===C.direction&&r._mediaObject.rids.push({id:C.id,direction:"recv"})}}catch(M){P.e(M)}finally{P.f()}}else if(f.simulcast_03){r._mediaObject.simulcast_03={value:f.simulcast_03.value.replace(/send/g,"recv")},r._mediaObject.rids=[];var T,E=kr(f.rids||[]);try{for(E.s();!(T=E.n()).done;){var O=T.value;"send"===O.direction&&r._mediaObject.rids.push({id:O.id,direction:"recv"})}}catch(M){E.e(M)}finally{E.f()}}r._mediaObject.rtcpMux="rtcp-mux",r._mediaObject.rtcpRsize="rtcp-rsize",r._planB&&"video"===r._mediaObject.type&&(r._mediaObject.xGoogleFlag="conference");break;case"application":"number"===typeof f.sctpPort?(r._mediaObject.payloads="webrtc-datachannel",r._mediaObject.sctpPort=u.port,r._mediaObject.maxMessageSize=u.maxMessageSize):f.sctpmap&&(r._mediaObject.payloads=u.port,r._mediaObject.sctpmap={app:"webrtc-datachannel",sctpmapNumber:u.port,maxMessageSize:u.maxMessageSize})}return r}return Pt(n,[{key:"setDtlsRole",value:function(e){switch(e){case"client":this._mediaObject.setup="active";break;case"server":this._mediaObject.setup="passive";break;case"auto":this._mediaObject.setup="actpass"}}}]),n}(i);e.AnswerMediaSection=s;var o=function(e){mn(n,e);var t=_n(n);function n(e){var r,a=e.iceParameters,i=e.iceCandidates,s=e.dtlsParameters,o=e.sctpParameters,u=e.plainRtpParameters,l=e.planB,d=void 0!==l&&l,p=e.mid,f=e.kind,h=e.offerRtpParameters,m=e.streamId,v=e.trackId,g=e.oldDataChannelSpec,b=void 0!==g&&g;switch(St(this,n),(r=t.call(this,{iceParameters:a,iceCandidates:i,dtlsParameters:s,planB:d}))._mediaObject.mid=String(p),r._mediaObject.type=f,u?(r._mediaObject.connection={ip:u.ip,version:u.ipVersion},r._mediaObject.protocol="RTP/AVP",r._mediaObject.port=u.port):(r._mediaObject.connection={ip:"127.0.0.1",version:4},r._mediaObject.protocol=o?"UDP/DTLS/SCTP":"UDP/TLS/RTP/SAVPF",r._mediaObject.port=7),f){case"audio":case"video":r._mediaObject.direction="sendonly",r._mediaObject.rtp=[],r._mediaObject.rtcpFb=[],r._mediaObject.fmtp=[],r._planB||(r._mediaObject.msid="".concat(m||"-"," ").concat(v));var y,_=kr(h.codecs);try{for(_.s();!(y=_.n()).done;){var w=y.value,k={payload:w.payloadType,codec:c(w),rate:w.clockRate};w.channels>1&&(k.encoding=w.channels),r._mediaObject.rtp.push(k);for(var x={payload:w.payloadType,config:""},S=0,R=Object.keys(w.parameters);S<R.length;S++){var P=R[S];x.config&&(x.config+=";"),x.config+="".concat(P,"=").concat(w.parameters[P])}x.config&&r._mediaObject.fmtp.push(x);var C,T=kr(w.rtcpFeedback);try{for(T.s();!(C=T.n()).done;){var E=C.value;r._mediaObject.rtcpFb.push({payload:w.payloadType,type:E.type,subtype:E.parameter})}}catch(A){T.e(A)}finally{T.f()}}}catch(A){_.e(A)}finally{_.f()}r._mediaObject.payloads=h.codecs.map((function(e){return e.payloadType})).join(" "),r._mediaObject.ext=[];var O,M=kr(h.headerExtensions);try{for(M.s();!(O=M.n()).done;){var I=O.value;r._mediaObject.ext.push({uri:I.uri,value:I.id})}}catch(A){M.e(A)}finally{M.f()}r._mediaObject.rtcpMux="rtcp-mux",r._mediaObject.rtcpRsize="rtcp-rsize";var D=h.encodings[0],j=D.ssrc,L=D.rtx&&D.rtx.ssrc?D.rtx.ssrc:void 0;r._mediaObject.ssrcs=[],r._mediaObject.ssrcGroups=[],h.rtcp.cname&&r._mediaObject.ssrcs.push({id:j,attribute:"cname",value:h.rtcp.cname}),r._planB&&r._mediaObject.ssrcs.push({id:j,attribute:"msid",value:"".concat(m||"-"," ").concat(v)}),L&&(h.rtcp.cname&&r._mediaObject.ssrcs.push({id:L,attribute:"cname",value:h.rtcp.cname}),r._planB&&r._mediaObject.ssrcs.push({id:L,attribute:"msid",value:"".concat(m||"-"," ").concat(v)}),r._mediaObject.ssrcGroups.push({semantics:"FID",ssrcs:"".concat(j," ").concat(L)}));break;case"application":b?(r._mediaObject.payloads=o.port,r._mediaObject.sctpmap={app:"webrtc-datachannel",sctpmapNumber:o.port,maxMessageSize:o.maxMessageSize}):(r._mediaObject.payloads="webrtc-datachannel",r._mediaObject.sctpPort=o.port,r._mediaObject.maxMessageSize=o.maxMessageSize)}return r}return Pt(n,[{key:"setDtlsRole",value:function(e){this._mediaObject.setup="actpass"}},{key:"planBReceive",value:function(e){var t,n=this,r=e.offerRtpParameters,a=e.streamId,i=e.trackId,s=r.encodings[0],o=s.ssrc,u=s.rtx&&s.rtx.ssrc?s.rtx.ssrc:void 0,l=this._mediaObject.payloads.split(" "),d=kr(r.codecs);try{for(d.s();!(t=d.n()).done;){var p=t.value;if(!l.includes(String(p.payloadType))){var f={payload:p.payloadType,codec:c(p),rate:p.clockRate};p.channels>1&&(f.encoding=p.channels),this._mediaObject.rtp.push(f);for(var h={payload:p.payloadType,config:""},m=0,v=Object.keys(p.parameters);m<v.length;m++){var g=v[m];h.config&&(h.config+=";"),h.config+="".concat(g,"=").concat(p.parameters[g])}h.config&&this._mediaObject.fmtp.push(h);var b,y=kr(p.rtcpFeedback);try{for(y.s();!(b=y.n()).done;){var _=b.value;this._mediaObject.rtcpFb.push({payload:p.payloadType,type:_.type,subtype:_.parameter})}}catch(w){y.e(w)}finally{y.f()}}}}catch(w){d.e(w)}finally{d.f()}this._mediaObject.payloads+=" ".concat(r.codecs.filter((function(e){return!n._mediaObject.payloads.includes(e.payloadType)})).map((function(e){return e.payloadType})).join(" ")),this._mediaObject.payloads=this._mediaObject.payloads.trim(),r.rtcp.cname&&this._mediaObject.ssrcs.push({id:o,attribute:"cname",value:r.rtcp.cname}),this._mediaObject.ssrcs.push({id:o,attribute:"msid",value:"".concat(a||"-"," ").concat(i)}),u&&(r.rtcp.cname&&this._mediaObject.ssrcs.push({id:u,attribute:"cname",value:r.rtcp.cname}),this._mediaObject.ssrcs.push({id:u,attribute:"msid",value:"".concat(a||"-"," ").concat(i)}),this._mediaObject.ssrcGroups.push({semantics:"FID",ssrcs:"".concat(o," ").concat(u)}))}},{key:"planBStopReceiving",value:function(e){var t=e.offerRtpParameters.encodings[0],n=t.ssrc,r=t.rtx&&t.rtx.ssrc?t.rtx.ssrc:void 0;this._mediaObject.ssrcs=this._mediaObject.ssrcs.filter((function(e){return e.id!==n&&e.id!==r})),r&&(this._mediaObject.ssrcGroups=this._mediaObject.ssrcGroups.filter((function(e){return e.ssrcs!=="".concat(n," ").concat(r)})))}}]),n}(i);function c(e){var t=new RegExp("^(audio|video)/(.+)","i").exec(e.mimeType);if(!t)throw new TypeError("invalid codec.mimeType");return t[2]}e.OfferMediaSection=o}}),op=Zl({"../../node_modules/mediasoup-client/lib/handlers/sdp/RemoteSdp.js":function(e){nd();var t=e&&e.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var a=Object.getOwnPropertyDescriptor(t,n);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,a)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),n=e&&e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=e&&e.__importStar||function(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var a in e)"default"!==a&&Object.prototype.hasOwnProperty.call(e,a)&&t(r,e,a);return n(r,e),r};Object.defineProperty(e,"__esModule",{value:!0}),e.RemoteSdp=void 0;var a=r(Bd()),i=Wd(),s=sp(),o=new i.Logger("RemoteSdp"),c=function(){function e(t){var n=t.iceParameters,r=t.iceCandidates,a=t.dtlsParameters,i=t.sctpParameters,s=t.plainRtpParameters,o=t.planB,c=void 0!==o&&o;if(St(this,e),this._mediaSections=[],this._midToIndex=new Map,this._iceParameters=n,this._iceCandidates=r,this._dtlsParameters=a,this._sctpParameters=i,this._plainRtpParameters=s,this._planB=c,this._sdpObject={version:0,origin:{address:"0.0.0.0",ipVer:4,netType:"IN",sessionId:1e4,sessionVersion:0,username:"mediasoup-client"},name:"-",timing:{start:0,stop:0},media:[]},n&&n.iceLite&&(this._sdpObject.icelite="ice-lite"),a){this._sdpObject.msidSemantic={semantic:"WMS",token:"*"};var u=this._dtlsParameters.fingerprints.length;this._sdpObject.fingerprint={type:a.fingerprints[u-1].algorithm,hash:a.fingerprints[u-1].value},this._sdpObject.groups=[{type:"BUNDLE",mids:""}]}s&&(this._sdpObject.origin.address=s.ip,this._sdpObject.origin.ipVer=s.ipVersion)}return Pt(e,[{key:"updateIceParameters",value:function(e){o.debug("updateIceParameters() [iceParameters:%o]",e),this._iceParameters=e,this._sdpObject.icelite=e.iceLite?"ice-lite":void 0;var t,n=kr(this._mediaSections);try{for(n.s();!(t=n.n()).done;){t.value.setIceParameters(e)}}catch(r){n.e(r)}finally{n.f()}}},{key:"updateDtlsRole",value:function(e){o.debug("updateDtlsRole() [role:%s]",e),this._dtlsParameters.role=e;var t,n=kr(this._mediaSections);try{for(n.s();!(t=n.n()).done;){t.value.setDtlsRole(e)}}catch(r){n.e(r)}finally{n.f()}}},{key:"getNextMediaSectionIdx",value:function(){for(var e=0;e<this._mediaSections.length;++e){var t=this._mediaSections[e];if(t.closed)return{idx:e,reuseMid:t.mid}}return{idx:this._mediaSections.length}}},{key:"send",value:function(e){var t=e.offerMediaObject,n=e.reuseMid,r=e.offerRtpParameters,a=e.answerRtpParameters,i=e.codecOptions,o=e.extmapAllowMixed,c=void 0!==o&&o,u=new s.AnswerMediaSection({iceParameters:this._iceParameters,iceCandidates:this._iceCandidates,dtlsParameters:this._dtlsParameters,plainRtpParameters:this._plainRtpParameters,planB:this._planB,offerMediaObject:t,offerRtpParameters:r,answerRtpParameters:a,codecOptions:i,extmapAllowMixed:c});n?this._replaceMediaSection(u,n):this._midToIndex.has(u.mid)?this._replaceMediaSection(u):this._addMediaSection(u)}},{key:"receive",value:function(e){var t,n=e.mid,r=e.kind,a=e.offerRtpParameters,i=e.streamId,o=e.trackId,c=this._midToIndex.get(n);if(void 0!==c&&(t=this._mediaSections[c]),t)t.planBReceive({offerRtpParameters:a,streamId:i,trackId:o}),this._replaceMediaSection(t);else{t=new s.OfferMediaSection({iceParameters:this._iceParameters,iceCandidates:this._iceCandidates,dtlsParameters:this._dtlsParameters,plainRtpParameters:this._plainRtpParameters,planB:this._planB,mid:n,kind:r,offerRtpParameters:a,streamId:i,trackId:o});var u=this._mediaSections.find((function(e){return e.closed}));u?this._replaceMediaSection(t,u.mid):this._addMediaSection(t)}}},{key:"disableMediaSection",value:function(e){var t=this._midToIndex.get(e);if(void 0===t)throw new Error("no media section found with mid '".concat(e,"'"));this._mediaSections[t].disable()}},{key:"closeMediaSection",value:function(e){var t=this._midToIndex.get(e);if(void 0===t)throw new Error("no media section found with mid '".concat(e,"'"));var n=this._mediaSections[t];if(e===this._firstMid)return o.debug("closeMediaSection() | cannot close first media section, disabling it instead [mid:%s]",e),void this.disableMediaSection(e);n.close(),this._regenerateBundleMids()}},{key:"planBStopReceiving",value:function(e){var t=e.mid,n=e.offerRtpParameters,r=this._midToIndex.get(t);if(void 0===r)throw new Error("no media section found with mid '".concat(t,"'"));var a=this._mediaSections[r];a.planBStopReceiving({offerRtpParameters:n}),this._replaceMediaSection(a)}},{key:"sendSctpAssociation",value:function(e){var t=e.offerMediaObject,n=new s.AnswerMediaSection({iceParameters:this._iceParameters,iceCandidates:this._iceCandidates,dtlsParameters:this._dtlsParameters,sctpParameters:this._sctpParameters,plainRtpParameters:this._plainRtpParameters,offerMediaObject:t});this._addMediaSection(n)}},{key:"receiveSctpAssociation",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.oldDataChannelSpec,n=void 0!==t&&t,r=new s.OfferMediaSection({iceParameters:this._iceParameters,iceCandidates:this._iceCandidates,dtlsParameters:this._dtlsParameters,sctpParameters:this._sctpParameters,plainRtpParameters:this._plainRtpParameters,mid:"datachannel",kind:"application",oldDataChannelSpec:n});this._addMediaSection(r)}},{key:"getSdp",value:function(){return this._sdpObject.origin.sessionVersion++,a.write(this._sdpObject)}},{key:"_addMediaSection",value:function(e){this._firstMid||(this._firstMid=e.mid),this._mediaSections.push(e),this._midToIndex.set(e.mid,this._mediaSections.length-1),this._sdpObject.media.push(e.getObject()),this._regenerateBundleMids()}},{key:"_replaceMediaSection",value:function(e,t){if("string"===typeof t){var n=this._midToIndex.get(t);if(void 0===n)throw new Error("no media section found for reuseMid '".concat(t,"'"));var r=this._mediaSections[n];this._mediaSections[n]=e,this._midToIndex.delete(r.mid),this._midToIndex.set(e.mid,n),this._sdpObject.media[n]=e.getObject(),this._regenerateBundleMids()}else{var a=this._midToIndex.get(e.mid);if(void 0===a)throw new Error("no media section found with mid '".concat(e.mid,"'"));this._mediaSections[a]=e,this._sdpObject.media[a]=e.getObject()}}},{key:"_regenerateBundleMids",value:function(){this._dtlsParameters&&(this._sdpObject.groups[0].mids=this._mediaSections.filter((function(e){return!e.closed})).map((function(e){return e.mid})).join(" "))}}]),e}();e.RemoteSdp=c}}),cp=Zl({"../../node_modules/mediasoup-client/lib/scalabilityModes.js":function(e){nd(),Object.defineProperty(e,"__esModule",{value:!0}),e.parse=void 0;var t=new RegExp("^[LS]([1-9]\\d{0,1})T([1-9]\\d{0,1})");e.parse=function(e){var n=t.exec(e||"");return n?{spatialLayers:Number(n[1]),temporalLayers:Number(n[2])}:{spatialLayers:1,temporalLayers:1}}}}),up=Zl({"../../node_modules/mediasoup-client/lib/handlers/Chrome74.js":function(e){nd();var t=e&&e.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var a=Object.getOwnPropertyDescriptor(t,n);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,a)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),n=e&&e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=e&&e.__importStar||function(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var a in e)"default"!==a&&Object.prototype.hasOwnProperty.call(e,a)&&t(r,e,a);return n(r,e),r};Object.defineProperty(e,"__esModule",{value:!0}),e.Chrome74=void 0;var a=r(Bd()),i=Wd(),s=r(Xd()),o=r($d()),c=r(rp()),u=r(ap()),l=ip(),d=op(),p=cp(),f=new i.Logger("Chrome74"),h={OS:1024,MIS:1024},m=function(e){mn(n,e);var t=_n(n);function n(){var e;return St(this,n),(e=t.call(this))._mapMidTransceiver=new Map,e._sendStream=new MediaStream,e._hasDataChannelMediaSection=!1,e._nextSendSctpStreamId=0,e._transportReady=!1,e}return Pt(n,[{key:"name",get:function(){return"Chrome74"}},{key:"close",value:function(){if(f.debug("close()"),this._pc)try{this._pc.close()}catch(e){}}},{key:"getNativeRtpCapabilities",value:function(){return td(this,null,wr().mark((function e(){var t,n,r,i;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return f.debug("getNativeRtpCapabilities()"),t=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"unified-plan"}),e.prev=2,t.addTransceiver("audio"),t.addTransceiver("video"),e.next=7,t.createOffer();case 7:n=e.sent;try{t.close()}catch(s){}return r=a.parse(n.sdp),i=c.extractRtpCapabilities({sdpObject:r}),e.abrupt("return",i);case 14:e.prev=14,e.t0=e.catch(2);try{t.close()}catch(o){}throw e.t0;case 18:case"end":return e.stop()}}),e,null,[[2,14]])})))}},{key:"getNativeSctpCapabilities",value:function(){return td(this,null,wr().mark((function e(){return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return f.debug("getNativeSctpCapabilities()"),e.abrupt("return",{numStreams:h});case 2:case"end":return e.stop()}}),e)})))}},{key:"run",value:function(e){var t=this,n=e.direction,r=e.iceParameters,a=e.iceCandidates,i=e.dtlsParameters,s=e.sctpParameters,c=e.iceServers,u=e.iceTransportPolicy,l=e.additionalSettings,p=e.proprietaryConstraints,h=e.extendedRtpCapabilities;f.debug("run()"),this._direction=n,this._remoteSdp=new d.RemoteSdp({iceParameters:r,iceCandidates:a,dtlsParameters:i,sctpParameters:s}),this._sendingRtpParametersByKind={audio:o.getSendingRtpParameters("audio",h),video:o.getSendingRtpParameters("video",h)},this._sendingRemoteRtpParametersByKind={audio:o.getSendingRemoteRtpParameters("audio",h),video:o.getSendingRemoteRtpParameters("video",h)},i.role&&"auto"!==i.role&&(this._forcedLocalDtlsRole="server"===i.role?"client":"server"),this._pc=new RTCPeerConnection(Jl({iceServers:c||[],iceTransportPolicy:u||"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"unified-plan"},l),p),this._pc.addEventListener("iceconnectionstatechange",(function(){switch(t._pc.iceConnectionState){case"checking":t.emit("@connectionstatechange","connecting");break;case"connected":case"completed":t.emit("@connectionstatechange","connected");break;case"failed":t.emit("@connectionstatechange","failed");break;case"disconnected":t.emit("@connectionstatechange","disconnected");break;case"closed":t.emit("@connectionstatechange","closed")}}))}},{key:"updateIceServers",value:function(e){return td(this,null,wr().mark((function t(){var n;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:f.debug("updateIceServers()"),(n=this._pc.getConfiguration()).iceServers=e,this._pc.setConfiguration(n);case 4:case"end":return t.stop()}}),t,this)})))}},{key:"restartIce",value:function(e){return td(this,null,wr().mark((function t(){var n,r,a,i;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(f.debug("restartIce()"),this._remoteSdp.updateIceParameters(e),this._transportReady){t.next=4;break}return t.abrupt("return");case 4:if("send"!==this._direction){t.next=17;break}return t.next=7,this._pc.createOffer({iceRestart:!0});case 7:return n=t.sent,f.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",n),t.next=11,this._pc.setLocalDescription(n);case 11:return r={type:"answer",sdp:this._remoteSdp.getSdp()},f.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",r),t.next=15,this._pc.setRemoteDescription(r);case 15:t.next=27;break;case 17:return a={type:"offer",sdp:this._remoteSdp.getSdp()},f.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",a),t.next=21,this._pc.setRemoteDescription(a);case 21:return t.next=23,this._pc.createAnswer();case 23:return i=t.sent,f.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",i),t.next=27,this._pc.setLocalDescription(i);case 27:case"end":return t.stop()}}),t,this)})))}},{key:"getTransportStats",value:function(){return td(this,null,wr().mark((function e(){return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._pc.getStats());case 1:case"end":return e.stop()}}),e,this)})))}},{key:"send",value:function(e){return td(this,arguments,wr().mark((function e(t){var n,r,i,l,d,h,m,v,g,b,y,_,w,k,x,S,R,P,C;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.track,r=t.encodings,i=t.codecOptions,l=t.codec,this._assertSendDirection(),f.debug("send() [kind:%s, track.id:%s]",n.kind,n.id),r&&r.length>1&&r.forEach((function(e,t){e.rid="r".concat(t)})),(h=s.clone(this._sendingRtpParametersByKind[n.kind],{})).codecs=o.reduceCodecs(h.codecs,l),(m=s.clone(this._sendingRemoteRtpParametersByKind[n.kind],{})).codecs=o.reduceCodecs(m.codecs,l),v=this._remoteSdp.getNextMediaSectionIdx(),g=this._pc.addTransceiver(n,{direction:"sendonly",streams:[this._sendStream],sendEncodings:r}),e.next=12,this._pc.createOffer();case 12:if(b=e.sent,y=a.parse(b.sdp),this._transportReady){e.next=17;break}return e.next=17,this._setupTransport({localDtlsRole:null!==(d=this._forcedLocalDtlsRole)&&void 0!==d?d:"client",localSdpObject:y});case 17:return w=!1,k=(0,p.parse)((r||[{}])[0].scalabilityMode),r&&1===r.length&&k.spatialLayers>1&&"video/vp9"===h.codecs[0].mimeType.toLowerCase()&&(f.debug("send() | enabling legacy simulcast for VP9 SVC"),w=!0,y=a.parse(b.sdp),_=y.media[v.idx],u.addLegacySimulcast({offerMediaObject:_,numStreams:k.spatialLayers}),b={type:"offer",sdp:a.write(y)}),f.debug("send() | calling pc.setLocalDescription() [offer:%o]",b),e.next=23,this._pc.setLocalDescription(b);case 23:if(x=g.mid,h.mid=x,y=a.parse(this._pc.localDescription.sdp),_=y.media[v.idx],h.rtcp.cname=c.getCname({offerMediaObject:_}),r?1===r.length?(S=u.getRtpEncodings({offerMediaObject:_}),Object.assign(S[0],r[0]),w&&(S=[S[0]]),h.encodings=S):h.encodings=r:h.encodings=u.getRtpEncodings({offerMediaObject:_}),h.encodings.length>1&&("video/vp8"===h.codecs[0].mimeType.toLowerCase()||"video/h264"===h.codecs[0].mimeType.toLowerCase())){R=kr(h.encodings);try{for(R.s();!(P=R.n()).done;)P.value.scalabilityMode="S1T3"}catch(T){R.e(T)}finally{R.f()}}return this._remoteSdp.send({offerMediaObject:_,reuseMid:v.reuseMid,offerRtpParameters:h,answerRtpParameters:m,codecOptions:i,extmapAllowMixed:!0}),C={type:"answer",sdp:this._remoteSdp.getSdp()},f.debug("send() | calling pc.setRemoteDescription() [answer:%o]",C),e.next=35,this._pc.setRemoteDescription(C);case 35:return this._mapMidTransceiver.set(x,g),e.abrupt("return",{localId:x,rtpParameters:h,rtpSender:g.sender});case 37:case"end":return e.stop()}}),e,this)})))}},{key:"stopSending",value:function(e){return td(this,null,wr().mark((function t(){var n,r,a;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._assertSendDirection(),f.debug("stopSending() [localId:%s]",e),n=this._mapMidTransceiver.get(e)){t.next=5;break}throw new Error("associated RTCRtpTransceiver not found");case 5:return n.sender.replaceTrack(null),this._pc.removeTrack(n.sender),this._remoteSdp.closeMediaSection(n.mid),t.next=10,this._pc.createOffer();case 10:return r=t.sent,f.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",r),t.next=14,this._pc.setLocalDescription(r);case 14:return a={type:"answer",sdp:this._remoteSdp.getSdp()},f.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",a),t.next=18,this._pc.setRemoteDescription(a);case 18:this._mapMidTransceiver.delete(e);case 19:case"end":return t.stop()}}),t,this)})))}},{key:"replaceTrack",value:function(e,t){return td(this,null,wr().mark((function n(){var r;return wr().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(this._assertSendDirection(),t?f.debug("replaceTrack() [localId:%s, track.id:%s]",e,t.id):f.debug("replaceTrack() [localId:%s, no track]",e),r=this._mapMidTransceiver.get(e)){n.next=5;break}throw new Error("associated RTCRtpTransceiver not found");case 5:return n.next=7,r.sender.replaceTrack(t);case 7:case"end":return n.stop()}}),n,this)})))}},{key:"setMaxSpatialLayer",value:function(e,t){return td(this,null,wr().mark((function n(){var r,a;return wr().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(this._assertSendDirection(),f.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",e,t),r=this._mapMidTransceiver.get(e)){n.next=5;break}throw new Error("associated RTCRtpTransceiver not found");case 5:return(a=r.sender.getParameters()).encodings.forEach((function(e,n){e.active=n<=t})),n.next=9,r.sender.setParameters(a);case 9:case"end":return n.stop()}}),n,this)})))}},{key:"setRtpEncodingParameters",value:function(e,t){return td(this,null,wr().mark((function n(){var r,a;return wr().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(this._assertSendDirection(),f.debug("setRtpEncodingParameters() [localId:%s, params:%o]",e,t),r=this._mapMidTransceiver.get(e)){n.next=5;break}throw new Error("associated RTCRtpTransceiver not found");case 5:return(a=r.sender.getParameters()).encodings.forEach((function(e,n){a.encodings[n]=Jl(Jl({},e),t)})),n.next=9,r.sender.setParameters(a);case 9:case"end":return n.stop()}}),n,this)})))}},{key:"getSenderStats",value:function(e){return td(this,null,wr().mark((function t(){var n;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._assertSendDirection(),n=this._mapMidTransceiver.get(e)){t.next=4;break}throw new Error("associated RTCRtpTransceiver not found");case 4:return t.abrupt("return",n.sender.getStats());case 5:case"end":return t.stop()}}),t,this)})))}},{key:"sendDataChannel",value:function(e){return td(this,arguments,wr().mark((function e(t){var n,r,i,s,o,c,u,l,d,p,m,v,g;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.ordered,r=t.maxPacketLifeTime,i=t.maxRetransmits,s=t.label,o=t.protocol,this._assertSendDirection(),u={negotiated:!0,id:this._nextSendSctpStreamId,ordered:n,maxPacketLifeTime:r,maxRetransmits:i,protocol:o},f.debug("sendDataChannel() [options:%o]",u),l=this._pc.createDataChannel(s,u),this._nextSendSctpStreamId=++this._nextSendSctpStreamId%h.MIS,this._hasDataChannelMediaSection){e.next=24;break}return e.next=9,this._pc.createOffer();case 9:if(d=e.sent,p=a.parse(d.sdp),m=p.media.find((function(e){return"application"===e.type})),this._transportReady){e.next=15;break}return e.next=15,this._setupTransport({localDtlsRole:null!==(c=this._forcedLocalDtlsRole)&&void 0!==c?c:"client",localSdpObject:p});case 15:return f.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",d),e.next=18,this._pc.setLocalDescription(d);case 18:return this._remoteSdp.sendSctpAssociation({offerMediaObject:m}),v={type:"answer",sdp:this._remoteSdp.getSdp()},f.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",v),e.next=23,this._pc.setRemoteDescription(v);case 23:this._hasDataChannelMediaSection=!0;case 24:return g={streamId:u.id,ordered:u.ordered,maxPacketLifeTime:u.maxPacketLifeTime,maxRetransmits:u.maxRetransmits},e.abrupt("return",{dataChannel:l,sctpStreamParameters:g});case 26:case"end":return e.stop()}}),e,this)})))}},{key:"receive",value:function(e){return td(this,null,wr().mark((function t(){var n,r,i,s,o,u,l,d,p,h,m,v,g,b,y,_,w,k,x,S=this;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this._assertRecvDirection(),r=[],i=new Map,s=kr(e);try{for(s.s();!(o=s.n()).done;)u=o.value,l=u.trackId,d=u.kind,p=u.rtpParameters,f.debug("receive() [trackId:%s, kind:%s]",l,d),h=p.mid||String(this._mapMidTransceiver.size),i.set(l,h),this._remoteSdp.receive({mid:h,kind:d,offerRtpParameters:p,streamId:p.rtcp.cname,trackId:l})}catch(R){s.e(R)}finally{s.f()}return m={type:"offer",sdp:this._remoteSdp.getSdp()},f.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",m),t.next=9,this._pc.setRemoteDescription(m);case 9:return t.next=11,this._pc.createAnswer();case 11:v=t.sent,g=a.parse(v.sdp),b=kr(e);try{for(_=function(){var e=y.value,t=e.trackId,n=e.rtpParameters,r=i.get(t),a=g.media.find((function(e){return String(e.mid)===r}));c.applyCodecParameters({offerRtpParameters:n,answerMediaObject:a})},b.s();!(y=b.n()).done;)_()}catch(R){b.e(R)}finally{b.f()}if(v={type:"answer",sdp:a.write(g)},this._transportReady){t.next=19;break}return t.next=19,this._setupTransport({localDtlsRole:null!==(n=this._forcedLocalDtlsRole)&&void 0!==n?n:"client",localSdpObject:g});case 19:return f.debug("receive() | calling pc.setLocalDescription() [answer:%o]",v),t.next=22,this._pc.setLocalDescription(v);case 22:w=kr(e);try{for(x=function(){var e=k.value.trackId,t=i.get(e),n=S._pc.getTransceivers().find((function(e){return e.mid===t}));if(!n)throw new Error("new RTCRtpTransceiver not found");S._mapMidTransceiver.set(t,n),r.push({localId:t,track:n.receiver.track,rtpReceiver:n.receiver})},w.s();!(k=w.n()).done;)x()}catch(R){w.e(R)}finally{w.f()}return t.abrupt("return",r);case 25:case"end":return t.stop()}}),t,this)})))}},{key:"stopReceiving",value:function(e){return td(this,null,wr().mark((function t(){var n,r,a;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._assertRecvDirection(),f.debug("stopReceiving() [localId:%s]",e),n=this._mapMidTransceiver.get(e)){t.next=5;break}throw new Error("associated RTCRtpTransceiver not found");case 5:return this._remoteSdp.closeMediaSection(n.mid),r={type:"offer",sdp:this._remoteSdp.getSdp()},f.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",r),t.next=10,this._pc.setRemoteDescription(r);case 10:return t.next=12,this._pc.createAnswer();case 12:return a=t.sent,f.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",a),t.next=16,this._pc.setLocalDescription(a);case 16:this._mapMidTransceiver.delete(e);case 17:case"end":return t.stop()}}),t,this)})))}},{key:"pauseReceiving",value:function(e){return td(this,null,wr().mark((function t(){var n,r,a,i,s,o;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this._assertRecvDirection(),n=kr(e),t.prev=2,n.s();case 4:if((r=n.n()).done){t.next=13;break}if(a=r.value,f.debug("pauseReceiving() [localId:%s]",a),i=this._mapMidTransceiver.get(a)){t.next=10;break}throw new Error("associated RTCRtpTransceiver not found");case 10:i.direction="inactive";case 11:t.next=4;break;case 13:t.next=18;break;case 15:t.prev=15,t.t0=t.catch(2),n.e(t.t0);case 18:return t.prev=18,n.f(),t.finish(18);case 21:return s={type:"offer",sdp:this._remoteSdp.getSdp()},f.debug("pauseReceiving() | calling pc.setRemoteDescription() [offer:%o]",s),t.next=25,this._pc.setRemoteDescription(s);case 25:return t.next=27,this._pc.createAnswer();case 27:return o=t.sent,f.debug("pauseReceiving() | calling pc.setLocalDescription() [answer:%o]",o),t.next=31,this._pc.setLocalDescription(o);case 31:case"end":return t.stop()}}),t,this,[[2,15,18,21]])})))}},{key:"resumeReceiving",value:function(e){return td(this,null,wr().mark((function t(){var n,r,a,i,s,o;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this._assertRecvDirection(),n=kr(e),t.prev=2,n.s();case 4:if((r=n.n()).done){t.next=13;break}if(a=r.value,f.debug("resumeReceiving() [localId:%s]",a),i=this._mapMidTransceiver.get(a)){t.next=10;break}throw new Error("associated RTCRtpTransceiver not found");case 10:i.direction="recvonly";case 11:t.next=4;break;case 13:t.next=18;break;case 15:t.prev=15,t.t0=t.catch(2),n.e(t.t0);case 18:return t.prev=18,n.f(),t.finish(18);case 21:return s={type:"offer",sdp:this._remoteSdp.getSdp()},f.debug("resumeReceiving() | calling pc.setRemoteDescription() [offer:%o]",s),t.next=25,this._pc.setRemoteDescription(s);case 25:return t.next=27,this._pc.createAnswer();case 27:return o=t.sent,f.debug("resumeReceiving() | calling pc.setLocalDescription() [answer:%o]",o),t.next=31,this._pc.setLocalDescription(o);case 31:case"end":return t.stop()}}),t,this,[[2,15,18,21]])})))}},{key:"getReceiverStats",value:function(e){return td(this,null,wr().mark((function t(){var n;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._assertRecvDirection(),n=this._mapMidTransceiver.get(e)){t.next=4;break}throw new Error("associated RTCRtpTransceiver not found");case 4:return t.abrupt("return",n.receiver.getStats());case 5:case"end":return t.stop()}}),t,this)})))}},{key:"receiveDataChannel",value:function(e){return td(this,arguments,wr().mark((function e(t){var n,r,i,s,o,c,u,l,d,p,h,m,v;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.sctpStreamParameters,r=t.label,i=t.protocol,this._assertRecvDirection(),o=n.streamId,c=n.ordered,u=n.maxPacketLifeTime,l=n.maxRetransmits,d={negotiated:!0,id:o,ordered:c,maxPacketLifeTime:u,maxRetransmits:l,protocol:i},f.debug("receiveDataChannel() [options:%o]",d),p=this._pc.createDataChannel(r,d),this._hasDataChannelMediaSection){e.next=23;break}return this._remoteSdp.receiveSctpAssociation(),h={type:"offer",sdp:this._remoteSdp.getSdp()},f.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",h),e.next=12,this._pc.setRemoteDescription(h);case 12:return e.next=14,this._pc.createAnswer();case 14:if(m=e.sent,this._transportReady){e.next=19;break}return v=a.parse(m.sdp),e.next=19,this._setupTransport({localDtlsRole:null!==(s=this._forcedLocalDtlsRole)&&void 0!==s?s:"client",localSdpObject:v});case 19:return f.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",m),e.next=22,this._pc.setLocalDescription(m);case 22:this._hasDataChannelMediaSection=!0;case 23:return e.abrupt("return",{dataChannel:p});case 24:case"end":return e.stop()}}),e,this)})))}},{key:"_setupTransport",value:function(e){return td(this,arguments,wr().mark((function e(t){var n,r,i;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.localDtlsRole,(r=t.localSdpObject)||(r=a.parse(this._pc.localDescription.sdp)),(i=c.extractDtlsParameters({sdpObject:r})).role=n,this._remoteSdp.updateDtlsRole("client"===n?"server":"client"),e.next=7,this.safeEmitAsPromise("@connect",{dtlsParameters:i});case 7:this._transportReady=!0;case 8:case"end":return e.stop()}}),e,this)})))}},{key:"_assertSendDirection",value:function(){if("send"!==this._direction)throw new Error('method can just be called for handlers with "send" direction')}},{key:"_assertRecvDirection",value:function(){if("recv"!==this._direction)throw new Error('method can just be called for handlers with "recv" direction')}}],[{key:"createFactory",value:function(){return function(){return new n}}}]),n}(l.HandlerInterface);e.Chrome74=m}}),lp=Zl({"../../node_modules/mediasoup-client/lib/handlers/Chrome70.js":function(e){nd();var t=e&&e.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var a=Object.getOwnPropertyDescriptor(t,n);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,a)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),n=e&&e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=e&&e.__importStar||function(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var a in e)"default"!==a&&Object.prototype.hasOwnProperty.call(e,a)&&t(r,e,a);return n(r,e),r};Object.defineProperty(e,"__esModule",{value:!0}),e.Chrome70=void 0;var a=r(Bd()),i=Wd(),s=r(Xd()),o=r($d()),c=r(rp()),u=r(ap()),l=ip(),d=op(),p=cp(),f=new i.Logger("Chrome70"),h={OS:1024,MIS:1024},m=function(e){mn(n,e);var t=_n(n);function n(){var e;return St(this,n),(e=t.call(this))._mapMidTransceiver=new Map,e._sendStream=new MediaStream,e._hasDataChannelMediaSection=!1,e._nextSendSctpStreamId=0,e._transportReady=!1,e}return Pt(n,[{key:"name",get:function(){return"Chrome70"}},{key:"close",value:function(){if(f.debug("close()"),this._pc)try{this._pc.close()}catch(e){}}},{key:"getNativeRtpCapabilities",value:function(){return td(this,null,wr().mark((function e(){var t,n,r,i;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return f.debug("getNativeRtpCapabilities()"),t=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"unified-plan"}),e.prev=2,t.addTransceiver("audio"),t.addTransceiver("video"),e.next=7,t.createOffer();case 7:n=e.sent;try{t.close()}catch(s){}return r=a.parse(n.sdp),i=c.extractRtpCapabilities({sdpObject:r}),e.abrupt("return",i);case 14:e.prev=14,e.t0=e.catch(2);try{t.close()}catch(o){}throw e.t0;case 18:case"end":return e.stop()}}),e,null,[[2,14]])})))}},{key:"getNativeSctpCapabilities",value:function(){return td(this,null,wr().mark((function e(){return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return f.debug("getNativeSctpCapabilities()"),e.abrupt("return",{numStreams:h});case 2:case"end":return e.stop()}}),e)})))}},{key:"run",value:function(e){var t=this,n=e.direction,r=e.iceParameters,a=e.iceCandidates,i=e.dtlsParameters,s=e.sctpParameters,c=e.iceServers,u=e.iceTransportPolicy,l=e.additionalSettings,p=e.proprietaryConstraints,h=e.extendedRtpCapabilities;f.debug("run()"),this._direction=n,this._remoteSdp=new d.RemoteSdp({iceParameters:r,iceCandidates:a,dtlsParameters:i,sctpParameters:s}),this._sendingRtpParametersByKind={audio:o.getSendingRtpParameters("audio",h),video:o.getSendingRtpParameters("video",h)},this._sendingRemoteRtpParametersByKind={audio:o.getSendingRemoteRtpParameters("audio",h),video:o.getSendingRemoteRtpParameters("video",h)},i.role&&"auto"!==i.role&&(this._forcedLocalDtlsRole="server"===i.role?"client":"server"),this._pc=new RTCPeerConnection(Jl({iceServers:c||[],iceTransportPolicy:u||"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"unified-plan"},l),p),this._pc.addEventListener("iceconnectionstatechange",(function(){switch(t._pc.iceConnectionState){case"checking":t.emit("@connectionstatechange","connecting");break;case"connected":case"completed":t.emit("@connectionstatechange","connected");break;case"failed":t.emit("@connectionstatechange","failed");break;case"disconnected":t.emit("@connectionstatechange","disconnected");break;case"closed":t.emit("@connectionstatechange","closed")}}))}},{key:"updateIceServers",value:function(e){return td(this,null,wr().mark((function t(){var n;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:f.debug("updateIceServers()"),(n=this._pc.getConfiguration()).iceServers=e,this._pc.setConfiguration(n);case 4:case"end":return t.stop()}}),t,this)})))}},{key:"restartIce",value:function(e){return td(this,null,wr().mark((function t(){var n,r,a,i;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(f.debug("restartIce()"),this._remoteSdp.updateIceParameters(e),this._transportReady){t.next=4;break}return t.abrupt("return");case 4:if("send"!==this._direction){t.next=17;break}return t.next=7,this._pc.createOffer({iceRestart:!0});case 7:return n=t.sent,f.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",n),t.next=11,this._pc.setLocalDescription(n);case 11:return r={type:"answer",sdp:this._remoteSdp.getSdp()},f.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",r),t.next=15,this._pc.setRemoteDescription(r);case 15:t.next=27;break;case 17:return a={type:"offer",sdp:this._remoteSdp.getSdp()},f.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",a),t.next=21,this._pc.setRemoteDescription(a);case 21:return t.next=23,this._pc.createAnswer();case 23:return i=t.sent,f.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",i),t.next=27,this._pc.setLocalDescription(i);case 27:case"end":return t.stop()}}),t,this)})))}},{key:"getTransportStats",value:function(){return td(this,null,wr().mark((function e(){return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._pc.getStats());case 1:case"end":return e.stop()}}),e,this)})))}},{key:"send",value:function(e){return td(this,arguments,wr().mark((function e(t){var n,r,i,l,d,h,m,v,g,b,y,_,w,k,x,S,R,P,C,T,E,O,M;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.track,r=t.encodings,i=t.codecOptions,l=t.codec,this._assertSendDirection(),f.debug("send() [kind:%s, track.id:%s]",n.kind,n.id),(h=s.clone(this._sendingRtpParametersByKind[n.kind],{})).codecs=o.reduceCodecs(h.codecs,l),(m=s.clone(this._sendingRemoteRtpParametersByKind[n.kind],{})).codecs=o.reduceCodecs(m.codecs,l),v=this._remoteSdp.getNextMediaSectionIdx(),g=this._pc.addTransceiver(n,{direction:"sendonly",streams:[this._sendStream]}),e.next=11,this._pc.createOffer();case 11:if(b=e.sent,y=a.parse(b.sdp),this._transportReady){e.next=16;break}return e.next=16,this._setupTransport({localDtlsRole:null!==(d=this._forcedLocalDtlsRole)&&void 0!==d?d:"client",localSdpObject:y});case 16:return r&&r.length>1&&(f.debug("send() | enabling legacy simulcast"),y=a.parse(b.sdp),_=y.media[v.idx],u.addLegacySimulcast({offerMediaObject:_,numStreams:r.length}),b={type:"offer",sdp:a.write(y)}),w=!1,k=(0,p.parse)((r||[{}])[0].scalabilityMode),r&&1===r.length&&k.spatialLayers>1&&"video/vp9"===h.codecs[0].mimeType.toLowerCase()&&(f.debug("send() | enabling legacy simulcast for VP9 SVC"),w=!0,y=a.parse(b.sdp),_=y.media[v.idx],u.addLegacySimulcast({offerMediaObject:_,numStreams:k.spatialLayers}),b={type:"offer",sdp:a.write(y)}),f.debug("send() | calling pc.setLocalDescription() [offer:%o]",b),e.next=23,this._pc.setLocalDescription(b);case 23:if(!r){e.next=38;break}f.debug("send() | applying given encodings"),x=g.sender.getParameters(),S=0;case 27:if(!(S<(x.encodings||[]).length)){e.next=36;break}if(R=x.encodings[S],P=r[S]){e.next=32;break}return e.abrupt("break",36);case 32:x.encodings[S]=Object.assign(R,P);case 33:++S,e.next=27;break;case 36:return e.next=38,g.sender.setParameters(x);case 38:if(C=g.mid,h.mid=C,y=a.parse(this._pc.localDescription.sdp),_=y.media[v.idx],h.rtcp.cname=c.getCname({offerMediaObject:_}),h.encodings=u.getRtpEncodings({offerMediaObject:_}),r)for(T=0;T<h.encodings.length;++T)r[T]&&Object.assign(h.encodings[T],r[T]);if(w&&(h.encodings=[h.encodings[0]]),h.encodings.length>1&&("video/vp8"===h.codecs[0].mimeType.toLowerCase()||"video/h264"===h.codecs[0].mimeType.toLowerCase())){E=kr(h.encodings);try{for(E.s();!(O=E.n()).done;)O.value.scalabilityMode="S1T3"}catch(I){E.e(I)}finally{E.f()}}return this._remoteSdp.send({offerMediaObject:_,reuseMid:v.reuseMid,offerRtpParameters:h,answerRtpParameters:m,codecOptions:i}),M={type:"answer",sdp:this._remoteSdp.getSdp()},f.debug("send() | calling pc.setRemoteDescription() [answer:%o]",M),e.next=52,this._pc.setRemoteDescription(M);case 52:return this._mapMidTransceiver.set(C,g),e.abrupt("return",{localId:C,rtpParameters:h,rtpSender:g.sender});case 54:case"end":return e.stop()}}),e,this)})))}},{key:"stopSending",value:function(e){return td(this,null,wr().mark((function t(){var n,r,a;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._assertSendDirection(),f.debug("stopSending() [localId:%s]",e),n=this._mapMidTransceiver.get(e)){t.next=5;break}throw new Error("associated RTCRtpTransceiver not found");case 5:return n.sender.replaceTrack(null),this._pc.removeTrack(n.sender),this._remoteSdp.closeMediaSection(n.mid),t.next=10,this._pc.createOffer();case 10:return r=t.sent,f.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",r),t.next=14,this._pc.setLocalDescription(r);case 14:return a={type:"answer",sdp:this._remoteSdp.getSdp()},f.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",a),t.next=18,this._pc.setRemoteDescription(a);case 18:this._mapMidTransceiver.delete(e);case 19:case"end":return t.stop()}}),t,this)})))}},{key:"replaceTrack",value:function(e,t){return td(this,null,wr().mark((function n(){var r;return wr().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(this._assertSendDirection(),t?f.debug("replaceTrack() [localId:%s, track.id:%s]",e,t.id):f.debug("replaceTrack() [localId:%s, no track]",e),r=this._mapMidTransceiver.get(e)){n.next=5;break}throw new Error("associated RTCRtpTransceiver not found");case 5:return n.next=7,r.sender.replaceTrack(t);case 7:case"end":return n.stop()}}),n,this)})))}},{key:"setMaxSpatialLayer",value:function(e,t){return td(this,null,wr().mark((function n(){var r,a;return wr().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(this._assertSendDirection(),f.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",e,t),r=this._mapMidTransceiver.get(e)){n.next=5;break}throw new Error("associated RTCRtpTransceiver not found");case 5:return(a=r.sender.getParameters()).encodings.forEach((function(e,n){e.active=n<=t})),n.next=9,r.sender.setParameters(a);case 9:case"end":return n.stop()}}),n,this)})))}},{key:"setRtpEncodingParameters",value:function(e,t){return td(this,null,wr().mark((function n(){var r,a;return wr().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(this._assertSendDirection(),f.debug("setRtpEncodingParameters() [localId:%s, params:%o]",e,t),r=this._mapMidTransceiver.get(e)){n.next=5;break}throw new Error("associated RTCRtpTransceiver not found");case 5:return(a=r.sender.getParameters()).encodings.forEach((function(e,n){a.encodings[n]=Jl(Jl({},e),t)})),n.next=9,r.sender.setParameters(a);case 9:case"end":return n.stop()}}),n,this)})))}},{key:"getSenderStats",value:function(e){return td(this,null,wr().mark((function t(){var n;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._assertSendDirection(),n=this._mapMidTransceiver.get(e)){t.next=4;break}throw new Error("associated RTCRtpTransceiver not found");case 4:return t.abrupt("return",n.sender.getStats());case 5:case"end":return t.stop()}}),t,this)})))}},{key:"sendDataChannel",value:function(e){return td(this,arguments,wr().mark((function e(t){var n,r,i,s,o,c,u,l,d,p,m,v,g;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.ordered,r=t.maxPacketLifeTime,i=t.maxRetransmits,s=t.label,o=t.protocol,this._assertSendDirection(),u={negotiated:!0,id:this._nextSendSctpStreamId,ordered:n,maxPacketLifeTime:r,maxRetransmitTime:r,maxRetransmits:i,protocol:o},f.debug("sendDataChannel() [options:%o]",u),l=this._pc.createDataChannel(s,u),this._nextSendSctpStreamId=++this._nextSendSctpStreamId%h.MIS,this._hasDataChannelMediaSection){e.next=24;break}return e.next=9,this._pc.createOffer();case 9:if(d=e.sent,p=a.parse(d.sdp),m=p.media.find((function(e){return"application"===e.type})),this._transportReady){e.next=15;break}return e.next=15,this._setupTransport({localDtlsRole:null!==(c=this._forcedLocalDtlsRole)&&void 0!==c?c:"client",localSdpObject:p});case 15:return f.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",d),e.next=18,this._pc.setLocalDescription(d);case 18:return this._remoteSdp.sendSctpAssociation({offerMediaObject:m}),v={type:"answer",sdp:this._remoteSdp.getSdp()},f.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",v),e.next=23,this._pc.setRemoteDescription(v);case 23:this._hasDataChannelMediaSection=!0;case 24:return g={streamId:u.id,ordered:u.ordered,maxPacketLifeTime:u.maxPacketLifeTime,maxRetransmits:u.maxRetransmits},e.abrupt("return",{dataChannel:l,sctpStreamParameters:g});case 26:case"end":return e.stop()}}),e,this)})))}},{key:"receive",value:function(e){return td(this,null,wr().mark((function t(){var n,r,i,s,o,u,l,d,p,h,m,v,g,b,y,_,w,k,x,S=this;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this._assertRecvDirection(),r=[],i=new Map,s=kr(e);try{for(s.s();!(o=s.n()).done;)u=o.value,l=u.trackId,d=u.kind,p=u.rtpParameters,f.debug("receive() [trackId:%s, kind:%s]",l,d),h=p.mid||String(this._mapMidTransceiver.size),i.set(l,h),this._remoteSdp.receive({mid:h,kind:d,offerRtpParameters:p,streamId:p.rtcp.cname,trackId:l})}catch(R){s.e(R)}finally{s.f()}return m={type:"offer",sdp:this._remoteSdp.getSdp()},f.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",m),t.next=9,this._pc.setRemoteDescription(m);case 9:return t.next=11,this._pc.createAnswer();case 11:v=t.sent,g=a.parse(v.sdp),b=kr(e);try{for(_=function(){var e=y.value,t=e.trackId,n=e.rtpParameters,r=i.get(t),a=g.media.find((function(e){return String(e.mid)===r}));c.applyCodecParameters({offerRtpParameters:n,answerMediaObject:a})},b.s();!(y=b.n()).done;)_()}catch(R){b.e(R)}finally{b.f()}if(v={type:"answer",sdp:a.write(g)},this._transportReady){t.next=19;break}return t.next=19,this._setupTransport({localDtlsRole:null!==(n=this._forcedLocalDtlsRole)&&void 0!==n?n:"client",localSdpObject:g});case 19:return f.debug("receive() | calling pc.setLocalDescription() [answer:%o]",v),t.next=22,this._pc.setLocalDescription(v);case 22:w=kr(e);try{for(x=function(){var e=k.value.trackId,t=i.get(e),n=S._pc.getTransceivers().find((function(e){return e.mid===t}));if(!n)throw new Error("new RTCRtpTransceiver not found");S._mapMidTransceiver.set(t,n),r.push({localId:t,track:n.receiver.track,rtpReceiver:n.receiver})},w.s();!(k=w.n()).done;)x()}catch(R){w.e(R)}finally{w.f()}return t.abrupt("return",r);case 25:case"end":return t.stop()}}),t,this)})))}},{key:"stopReceiving",value:function(e){return td(this,null,wr().mark((function t(){var n,r,a;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._assertRecvDirection(),f.debug("stopReceiving() [localId:%s]",e),n=this._mapMidTransceiver.get(e)){t.next=5;break}throw new Error("associated RTCRtpTransceiver not found");case 5:return this._remoteSdp.closeMediaSection(n.mid),r={type:"offer",sdp:this._remoteSdp.getSdp()},f.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",r),t.next=10,this._pc.setRemoteDescription(r);case 10:return t.next=12,this._pc.createAnswer();case 12:return a=t.sent,f.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",a),t.next=16,this._pc.setLocalDescription(a);case 16:this._mapMidTransceiver.delete(e);case 17:case"end":return t.stop()}}),t,this)})))}},{key:"pauseReceiving",value:function(e){return td(this,null,wr().mark((function e(){return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})))}},{key:"resumeReceiving",value:function(e){return td(this,null,wr().mark((function e(){return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})))}},{key:"getReceiverStats",value:function(e){return td(this,null,wr().mark((function t(){var n;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._assertRecvDirection(),n=this._mapMidTransceiver.get(e)){t.next=4;break}throw new Error("associated RTCRtpTransceiver not found");case 4:return t.abrupt("return",n.receiver.getStats());case 5:case"end":return t.stop()}}),t,this)})))}},{key:"receiveDataChannel",value:function(e){return td(this,arguments,wr().mark((function e(t){var n,r,i,s,o,c,u,l,d,p,h,m,v;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.sctpStreamParameters,r=t.label,i=t.protocol,this._assertRecvDirection(),o=n.streamId,c=n.ordered,u=n.maxPacketLifeTime,l=n.maxRetransmits,d={negotiated:!0,id:o,ordered:c,maxPacketLifeTime:u,maxRetransmitTime:u,maxRetransmits:l,protocol:i},f.debug("receiveDataChannel() [options:%o]",d),p=this._pc.createDataChannel(r,d),this._hasDataChannelMediaSection){e.next=23;break}return this._remoteSdp.receiveSctpAssociation(),h={type:"offer",sdp:this._remoteSdp.getSdp()},f.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",h),e.next=12,this._pc.setRemoteDescription(h);case 12:return e.next=14,this._pc.createAnswer();case 14:if(m=e.sent,this._transportReady){e.next=19;break}return v=a.parse(m.sdp),e.next=19,this._setupTransport({localDtlsRole:null!==(s=this._forcedLocalDtlsRole)&&void 0!==s?s:"client",localSdpObject:v});case 19:return f.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",m),e.next=22,this._pc.setLocalDescription(m);case 22:this._hasDataChannelMediaSection=!0;case 23:return e.abrupt("return",{dataChannel:p});case 24:case"end":return e.stop()}}),e,this)})))}},{key:"_setupTransport",value:function(e){return td(this,arguments,wr().mark((function e(t){var n,r,i;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.localDtlsRole,(r=t.localSdpObject)||(r=a.parse(this._pc.localDescription.sdp)),(i=c.extractDtlsParameters({sdpObject:r})).role=n,this._remoteSdp.updateDtlsRole("client"===n?"server":"client"),e.next=7,this.safeEmitAsPromise("@connect",{dtlsParameters:i});case 7:this._transportReady=!0;case 8:case"end":return e.stop()}}),e,this)})))}},{key:"_assertSendDirection",value:function(){if("send"!==this._direction)throw new Error('method can just be called for handlers with "send" direction')}},{key:"_assertRecvDirection",value:function(){if("recv"!==this._direction)throw new Error('method can just be called for handlers with "recv" direction')}}],[{key:"createFactory",value:function(){return function(){return new n}}}]),n}(l.HandlerInterface);e.Chrome70=m}}),dp=Zl({"../../node_modules/mediasoup-client/lib/handlers/sdp/planBUtils.js":function(e){nd(),Object.defineProperty(e,"__esModule",{value:!0}),e.addLegacySimulcast=e.getRtpEncodings=void 0,e.getRtpEncodings=function(e){var t,n,r=e.offerMediaObject,a=e.track,i=new Set,o=kr(r.ssrcs||[]);try{for(o.s();!(n=o.n()).done;){var c=n.value;if("msid"===c.attribute)if(c.value.split(" ")[1]===a.id){var u=c.id;i.add(u),t||(t=u)}}}catch(C){o.e(C)}finally{o.f()}if(0===i.size)throw new Error("a=ssrc line with msid information not found [track.id:".concat(a.id,"]"));var l,d=new Map,p=kr(r.ssrcGroups||[]);try{for(p.s();!(l=p.n()).done;){var f=l.value;if("FID"===f.semantics){var h=s(f.ssrcs.split(/\s+/),2),m=h[0],v=h[1];m=Number(m),v=Number(v),i.has(m)&&(i.delete(m),i.delete(v),d.set(m,v))}}}catch(C){p.e(C)}finally{p.f()}var g,b=kr(i);try{for(b.s();!(g=b.n()).done;){var y=g.value;d.set(y,null)}}catch(C){b.e(C)}finally{b.f()}var _,w=[],k=kr(d);try{for(k.s();!(_=k.n()).done;){var x=s(_.value,2),S=x[0],R=x[1],P={ssrc:S};R&&(P.rtx={ssrc:R}),w.push(P)}}catch(C){k.e(C)}finally{k.f()}return w},e.addLegacySimulcast=function(e){var t,n,r,a=e.offerMediaObject,i=e.track,s=e.numStreams;if(s<=1)throw new TypeError("numStreams must be greater than 1");if(!(a.ssrcs||[]).find((function(e){return"msid"===e.attribute&&(e.value.split(" ")[1]===i.id&&(t=e.id,r=e.value.split(" ")[0],!0))})))throw new Error("a=ssrc line with msid information not found [track.id:".concat(i.id,"]"));(a.ssrcGroups||[]).some((function(e){if("FID"!==e.semantics)return!1;var r=e.ssrcs.split(/\s+/);return Number(r[0])===t&&(n=Number(r[1]),!0)}));var o=a.ssrcs.find((function(e){return"cname"===e.attribute&&e.id===t}));if(!o)throw new Error("a=ssrc line with cname information not found [track.id:".concat(i.id,"]"));for(var c=o.value,u=[],l=[],d=0;d<s;++d)u.push(t+d),n&&l.push(n+d);a.ssrcGroups=a.ssrcGroups||[],a.ssrcs=a.ssrcs||[],a.ssrcGroups.push({semantics:"SIM",ssrcs:u.join(" ")});for(var p=0;p<u.length;++p){var f=u[p];a.ssrcs.push({id:f,attribute:"cname",value:c}),a.ssrcs.push({id:f,attribute:"msid",value:"".concat(r," ").concat(i.id)})}for(var h=0;h<l.length;++h){var m=u[h],v=l[h];a.ssrcs.push({id:v,attribute:"cname",value:c}),a.ssrcs.push({id:v,attribute:"msid",value:"".concat(r," ").concat(i.id)}),a.ssrcGroups.push({semantics:"FID",ssrcs:"".concat(m," ").concat(v)})}}}}),pp=Zl({"../../node_modules/mediasoup-client/lib/handlers/Chrome67.js":function(e){nd();var t=e&&e.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var a=Object.getOwnPropertyDescriptor(t,n);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,a)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),n=e&&e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=e&&e.__importStar||function(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var a in e)"default"!==a&&Object.prototype.hasOwnProperty.call(e,a)&&t(r,e,a);return n(r,e),r};Object.defineProperty(e,"__esModule",{value:!0}),e.Chrome67=void 0;var a=r(Bd()),i=Wd(),s=r(Xd()),o=r($d()),c=r(rp()),u=r(dp()),l=ip(),d=op(),p=new i.Logger("Chrome67"),f={OS:1024,MIS:1024},h=function(e){mn(n,e);var t=_n(n);function n(){var e;return St(this,n),(e=t.call(this))._sendStream=new MediaStream,e._mapSendLocalIdRtpSender=new Map,e._nextSendLocalId=0,e._mapRecvLocalIdInfo=new Map,e._hasDataChannelMediaSection=!1,e._nextSendSctpStreamId=0,e._transportReady=!1,e}return Pt(n,[{key:"name",get:function(){return"Chrome67"}},{key:"close",value:function(){if(p.debug("close()"),this._pc)try{this._pc.close()}catch(e){}}},{key:"getNativeRtpCapabilities",value:function(){return td(this,null,wr().mark((function e(){var t,n,r,i;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return p.debug("getNativeRtpCapabilities()"),t=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"plan-b"}),e.prev=2,e.next=5,t.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0});case 5:n=e.sent;try{t.close()}catch(s){}return r=a.parse(n.sdp),i=c.extractRtpCapabilities({sdpObject:r}),e.abrupt("return",i);case 12:e.prev=12,e.t0=e.catch(2);try{t.close()}catch(o){}throw e.t0;case 16:case"end":return e.stop()}}),e,null,[[2,12]])})))}},{key:"getNativeSctpCapabilities",value:function(){return td(this,null,wr().mark((function e(){return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return p.debug("getNativeSctpCapabilities()"),e.abrupt("return",{numStreams:f});case 2:case"end":return e.stop()}}),e)})))}},{key:"run",value:function(e){var t=this,n=e.direction,r=e.iceParameters,a=e.iceCandidates,i=e.dtlsParameters,s=e.sctpParameters,c=e.iceServers,u=e.iceTransportPolicy,l=e.additionalSettings,f=e.proprietaryConstraints,h=e.extendedRtpCapabilities;p.debug("run()"),this._direction=n,this._remoteSdp=new d.RemoteSdp({iceParameters:r,iceCandidates:a,dtlsParameters:i,sctpParameters:s,planB:!0}),this._sendingRtpParametersByKind={audio:o.getSendingRtpParameters("audio",h),video:o.getSendingRtpParameters("video",h)},this._sendingRemoteRtpParametersByKind={audio:o.getSendingRemoteRtpParameters("audio",h),video:o.getSendingRemoteRtpParameters("video",h)},i.role&&"auto"!==i.role&&(this._forcedLocalDtlsRole="server"===i.role?"client":"server"),this._pc=new RTCPeerConnection(Jl({iceServers:c||[],iceTransportPolicy:u||"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"plan-b"},l),f),this._pc.addEventListener("iceconnectionstatechange",(function(){switch(t._pc.iceConnectionState){case"checking":t.emit("@connectionstatechange","connecting");break;case"connected":case"completed":t.emit("@connectionstatechange","connected");break;case"failed":t.emit("@connectionstatechange","failed");break;case"disconnected":t.emit("@connectionstatechange","disconnected");break;case"closed":t.emit("@connectionstatechange","closed")}}))}},{key:"updateIceServers",value:function(e){return td(this,null,wr().mark((function t(){var n;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:p.debug("updateIceServers()"),(n=this._pc.getConfiguration()).iceServers=e,this._pc.setConfiguration(n);case 4:case"end":return t.stop()}}),t,this)})))}},{key:"restartIce",value:function(e){return td(this,null,wr().mark((function t(){var n,r,a,i;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(p.debug("restartIce()"),this._remoteSdp.updateIceParameters(e),this._transportReady){t.next=4;break}return t.abrupt("return");case 4:if("send"!==this._direction){t.next=17;break}return t.next=7,this._pc.createOffer({iceRestart:!0});case 7:return n=t.sent,p.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",n),t.next=11,this._pc.setLocalDescription(n);case 11:return r={type:"answer",sdp:this._remoteSdp.getSdp()},p.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",r),t.next=15,this._pc.setRemoteDescription(r);case 15:t.next=27;break;case 17:return a={type:"offer",sdp:this._remoteSdp.getSdp()},p.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",a),t.next=21,this._pc.setRemoteDescription(a);case 21:return t.next=23,this._pc.createAnswer();case 23:return i=t.sent,p.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",i),t.next=27,this._pc.setLocalDescription(i);case 27:case"end":return t.stop()}}),t,this)})))}},{key:"getTransportStats",value:function(){return td(this,null,wr().mark((function e(){return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._pc.getStats());case 1:case"end":return e.stop()}}),e,this)})))}},{key:"send",value:function(e){return td(this,arguments,wr().mark((function e(t){var n,r,i,l,d,f,h,m,v,g,b,y,_,w,k,x;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.track,r=t.encodings,i=t.codecOptions,l=t.codec,this._assertSendDirection(),p.debug("send() [kind:%s, track.id:%s]",n.kind,n.id),l&&p.warn("send() | codec selection is not available in %s handler",this.name),this._sendStream.addTrack(n),this._pc.addTrack(n,this._sendStream),e.next=8,this._pc.createOffer();case 8:if(f=e.sent,h=a.parse(f.sdp),(v=s.clone(this._sendingRtpParametersByKind[n.kind],{})).codecs=o.reduceCodecs(v.codecs),(g=s.clone(this._sendingRemoteRtpParametersByKind[n.kind],{})).codecs=o.reduceCodecs(g.codecs),this._transportReady){e.next=17;break}return e.next=17,this._setupTransport({localDtlsRole:null!==(d=this._forcedLocalDtlsRole)&&void 0!==d?d:"client",localSdpObject:h});case 17:return"video"===n.kind&&r&&r.length>1&&(p.debug("send() | enabling simulcast"),h=a.parse(f.sdp),m=h.media.find((function(e){return"video"===e.type})),u.addLegacySimulcast({offerMediaObject:m,track:n,numStreams:r.length}),f={type:"offer",sdp:a.write(h)}),p.debug("send() | calling pc.setLocalDescription() [offer:%o]",f),e.next=21,this._pc.setLocalDescription(f);case 21:if(h=a.parse(this._pc.localDescription.sdp),m=h.media.find((function(e){return e.type===n.kind})),v.rtcp.cname=c.getCname({offerMediaObject:m}),v.encodings=u.getRtpEncodings({offerMediaObject:m,track:n}),r)for(b=0;b<v.encodings.length;++b)r[b]&&Object.assign(v.encodings[b],r[b]);if(v.encodings.length>1&&"video/vp8"===v.codecs[0].mimeType.toLowerCase()){y=kr(v.encodings);try{for(y.s();!(_=y.n()).done;)_.value.scalabilityMode="S1T3"}catch(S){y.e(S)}finally{y.f()}}return this._remoteSdp.send({offerMediaObject:m,offerRtpParameters:v,answerRtpParameters:g,codecOptions:i}),w={type:"answer",sdp:this._remoteSdp.getSdp()},p.debug("send() | calling pc.setRemoteDescription() [answer:%o]",w),e.next=32,this._pc.setRemoteDescription(w);case 32:return k=String(this._nextSendLocalId),this._nextSendLocalId++,x=this._pc.getSenders().find((function(e){return e.track===n})),this._mapSendLocalIdRtpSender.set(k,x),e.abrupt("return",{localId:k,rtpParameters:v,rtpSender:x});case 37:case"end":return e.stop()}}),e,this)})))}},{key:"stopSending",value:function(e){return td(this,null,wr().mark((function t(){var n,r,a;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._assertSendDirection(),p.debug("stopSending() [localId:%s]",e),n=this._mapSendLocalIdRtpSender.get(e)){t.next=5;break}throw new Error("associated RTCRtpSender not found");case 5:return this._pc.removeTrack(n),n.track&&this._sendStream.removeTrack(n.track),this._mapSendLocalIdRtpSender.delete(e),t.next=10,this._pc.createOffer();case 10:return r=t.sent,p.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",r),t.prev=12,t.next=15,this._pc.setLocalDescription(r);case 15:t.next=23;break;case 17:if(t.prev=17,t.t0=t.catch(12),0!==this._sendStream.getTracks().length){t.next=22;break}return p.warn("stopSending() | ignoring expected error due no sending tracks: %s",t.t0.toString()),t.abrupt("return");case 22:throw t.t0;case 23:if("stable"!==this._pc.signalingState){t.next=25;break}return t.abrupt("return");case 25:return a={type:"answer",sdp:this._remoteSdp.getSdp()},p.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",a),t.next=29,this._pc.setRemoteDescription(a);case 29:case"end":return t.stop()}}),t,this,[[12,17]])})))}},{key:"replaceTrack",value:function(e,t){return td(this,null,wr().mark((function n(){var r,a;return wr().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(this._assertSendDirection(),t?p.debug("replaceTrack() [localId:%s, track.id:%s]",e,t.id):p.debug("replaceTrack() [localId:%s, no track]",e),r=this._mapSendLocalIdRtpSender.get(e)){n.next=5;break}throw new Error("associated RTCRtpSender not found");case 5:return a=r.track,n.next=8,r.replaceTrack(t);case 8:a&&this._sendStream.removeTrack(a),t&&this._sendStream.addTrack(t);case 10:case"end":return n.stop()}}),n,this)})))}},{key:"setMaxSpatialLayer",value:function(e,t){return td(this,null,wr().mark((function n(){var r,a;return wr().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(this._assertSendDirection(),p.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",e,t),r=this._mapSendLocalIdRtpSender.get(e)){n.next=5;break}throw new Error("associated RTCRtpSender not found");case 5:return(a=r.getParameters()).encodings.forEach((function(e,n){e.active=n<=t})),n.next=9,r.setParameters(a);case 9:case"end":return n.stop()}}),n,this)})))}},{key:"setRtpEncodingParameters",value:function(e,t){return td(this,null,wr().mark((function n(){var r,a;return wr().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(this._assertSendDirection(),p.debug("setRtpEncodingParameters() [localId:%s, params:%o]",e,t),r=this._mapSendLocalIdRtpSender.get(e)){n.next=5;break}throw new Error("associated RTCRtpSender not found");case 5:return(a=r.getParameters()).encodings.forEach((function(e,n){a.encodings[n]=Jl(Jl({},e),t)})),n.next=9,r.setParameters(a);case 9:case"end":return n.stop()}}),n,this)})))}},{key:"getSenderStats",value:function(e){return td(this,null,wr().mark((function t(){var n;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._assertSendDirection(),n=this._mapSendLocalIdRtpSender.get(e)){t.next=4;break}throw new Error("associated RTCRtpSender not found");case 4:return t.abrupt("return",n.getStats());case 5:case"end":return t.stop()}}),t,this)})))}},{key:"sendDataChannel",value:function(e){return td(this,arguments,wr().mark((function e(t){var n,r,i,s,o,c,u,l,d,h,m,v,g;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.ordered,r=t.maxPacketLifeTime,i=t.maxRetransmits,s=t.label,o=t.protocol,this._assertSendDirection(),u={negotiated:!0,id:this._nextSendSctpStreamId,ordered:n,maxPacketLifeTime:r,maxRetransmitTime:r,maxRetransmits:i,protocol:o},p.debug("sendDataChannel() [options:%o]",u),l=this._pc.createDataChannel(s,u),this._nextSendSctpStreamId=++this._nextSendSctpStreamId%f.MIS,this._hasDataChannelMediaSection){e.next=24;break}return e.next=9,this._pc.createOffer();case 9:if(d=e.sent,h=a.parse(d.sdp),m=h.media.find((function(e){return"application"===e.type})),this._transportReady){e.next=15;break}return e.next=15,this._setupTransport({localDtlsRole:null!==(c=this._forcedLocalDtlsRole)&&void 0!==c?c:"client",localSdpObject:h});case 15:return p.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",d),e.next=18,this._pc.setLocalDescription(d);case 18:return this._remoteSdp.sendSctpAssociation({offerMediaObject:m}),v={type:"answer",sdp:this._remoteSdp.getSdp()},p.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",v),e.next=23,this._pc.setRemoteDescription(v);case 23:this._hasDataChannelMediaSection=!0;case 24:return g={streamId:u.id,ordered:u.ordered,maxPacketLifeTime:u.maxPacketLifeTime,maxRetransmits:u.maxRetransmits},e.abrupt("return",{dataChannel:l,sctpStreamParameters:g});case 26:case"end":return e.stop()}}),e,this)})))}},{key:"receive",value:function(e){return td(this,null,wr().mark((function t(){var n,r,i,s,o,u,l,d,f,h,m,v,g,b,y,_,w,k,x=this;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this._assertRecvDirection(),r=[],i=kr(e);try{for(i.s();!(s=i.n()).done;)o=s.value,u=o.trackId,l=o.kind,d=o.rtpParameters,p.debug("receive() [trackId:%s, kind:%s]",u,l),f=l,this._remoteSdp.receive({mid:f,kind:l,offerRtpParameters:d,streamId:d.rtcp.cname,trackId:u})}catch(S){i.e(S)}finally{i.f()}return h={type:"offer",sdp:this._remoteSdp.getSdp()},p.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",h),t.next=8,this._pc.setRemoteDescription(h);case 8:return t.next=10,this._pc.createAnswer();case 10:m=t.sent,v=a.parse(m.sdp),g=kr(e);try{for(y=function(){var e=b.value,t=e.kind,n=e.rtpParameters,r=t,a=v.media.find((function(e){return String(e.mid)===r}));c.applyCodecParameters({offerRtpParameters:n,answerMediaObject:a})},g.s();!(b=g.n()).done;)y()}catch(S){g.e(S)}finally{g.f()}if(m={type:"answer",sdp:a.write(v)},this._transportReady){t.next=18;break}return t.next=18,this._setupTransport({localDtlsRole:null!==(n=this._forcedLocalDtlsRole)&&void 0!==n?n:"client",localSdpObject:v});case 18:return p.debug("receive() | calling pc.setLocalDescription() [answer:%o]",m),t.next=21,this._pc.setLocalDescription(m);case 21:_=kr(e);try{for(k=function(){var e=w.value,t=e.kind,n=e.trackId,a=e.rtpParameters,i=n,s=t,o=x._pc.getReceivers().find((function(e){return e.track&&e.track.id===i}));if(!o)throw new Error("new RTCRtpReceiver not");x._mapRecvLocalIdInfo.set(i,{mid:s,rtpParameters:a,rtpReceiver:o}),r.push({localId:i,track:o.track,rtpReceiver:o})},_.s();!(w=_.n()).done;)k()}catch(S){_.e(S)}finally{_.f()}return t.abrupt("return",r);case 24:case"end":return t.stop()}}),t,this)})))}},{key:"stopReceiving",value:function(e){return td(this,null,wr().mark((function t(){var n,r,a,i,s;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this._assertRecvDirection(),p.debug("stopReceiving() [localId:%s]",e),n=this._mapRecvLocalIdInfo.get(e)||{},r=n.mid,a=n.rtpParameters,this._mapRecvLocalIdInfo.delete(e),this._remoteSdp.planBStopReceiving({mid:r,offerRtpParameters:a}),i={type:"offer",sdp:this._remoteSdp.getSdp()},p.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",i),t.next=9,this._pc.setRemoteDescription(i);case 9:return t.next=11,this._pc.createAnswer();case 11:return s=t.sent,p.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",s),t.next=15,this._pc.setLocalDescription(s);case 15:case"end":return t.stop()}}),t,this)})))}},{key:"pauseReceiving",value:function(e){return td(this,null,wr().mark((function e(){return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})))}},{key:"resumeReceiving",value:function(e){return td(this,null,wr().mark((function e(){return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})))}},{key:"getReceiverStats",value:function(e){return td(this,null,wr().mark((function t(){var n,r;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._assertRecvDirection(),n=this._mapRecvLocalIdInfo.get(e)||{},r=n.rtpReceiver){t.next=4;break}throw new Error("associated RTCRtpReceiver not found");case 4:return t.abrupt("return",r.getStats());case 5:case"end":return t.stop()}}),t,this)})))}},{key:"receiveDataChannel",value:function(e){return td(this,arguments,wr().mark((function e(t){var n,r,i,s,o,c,u,l,d,f,h,m,v;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.sctpStreamParameters,r=t.label,i=t.protocol,this._assertRecvDirection(),o=n.streamId,c=n.ordered,u=n.maxPacketLifeTime,l=n.maxRetransmits,d={negotiated:!0,id:o,ordered:c,maxPacketLifeTime:u,maxRetransmitTime:u,maxRetransmits:l,protocol:i},p.debug("receiveDataChannel() [options:%o]",d),f=this._pc.createDataChannel(r,d),this._hasDataChannelMediaSection){e.next=23;break}return this._remoteSdp.receiveSctpAssociation({oldDataChannelSpec:!0}),h={type:"offer",sdp:this._remoteSdp.getSdp()},p.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",h),e.next=12,this._pc.setRemoteDescription(h);case 12:return e.next=14,this._pc.createAnswer();case 14:if(m=e.sent,this._transportReady){e.next=19;break}return v=a.parse(m.sdp),e.next=19,this._setupTransport({localDtlsRole:null!==(s=this._forcedLocalDtlsRole)&&void 0!==s?s:"client",localSdpObject:v});case 19:return p.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",m),e.next=22,this._pc.setLocalDescription(m);case 22:this._hasDataChannelMediaSection=!0;case 23:return e.abrupt("return",{dataChannel:f});case 24:case"end":return e.stop()}}),e,this)})))}},{key:"_setupTransport",value:function(e){return td(this,arguments,wr().mark((function e(t){var n,r,i;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.localDtlsRole,(r=t.localSdpObject)||(r=a.parse(this._pc.localDescription.sdp)),(i=c.extractDtlsParameters({sdpObject:r})).role=n,this._remoteSdp.updateDtlsRole("client"===n?"server":"client"),e.next=7,this.safeEmitAsPromise("@connect",{dtlsParameters:i});case 7:this._transportReady=!0;case 8:case"end":return e.stop()}}),e,this)})))}},{key:"_assertSendDirection",value:function(){if("send"!==this._direction)throw new Error('method can just be called for handlers with "send" direction')}},{key:"_assertRecvDirection",value:function(){if("recv"!==this._direction)throw new Error('method can just be called for handlers with "recv" direction')}}],[{key:"createFactory",value:function(){return function(){return new n}}}]),n}(l.HandlerInterface);e.Chrome67=h}}),fp=Zl({"../../node_modules/mediasoup-client/lib/handlers/Chrome55.js":function(e){nd();var t=e&&e.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var a=Object.getOwnPropertyDescriptor(t,n);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,a)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),n=e&&e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=e&&e.__importStar||function(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var a in e)"default"!==a&&Object.prototype.hasOwnProperty.call(e,a)&&t(r,e,a);return n(r,e),r};Object.defineProperty(e,"__esModule",{value:!0}),e.Chrome55=void 0;var a=r(Bd()),i=Wd(),s=Kd(),o=r(Xd()),c=r($d()),u=r(rp()),l=r(dp()),d=ip(),p=op(),f=new i.Logger("Chrome55"),h={OS:1024,MIS:1024},m=function(e){mn(n,e);var t=_n(n);function n(){var e;return St(this,n),(e=t.call(this))._sendStream=new MediaStream,e._mapSendLocalIdTrack=new Map,e._nextSendLocalId=0,e._mapRecvLocalIdInfo=new Map,e._hasDataChannelMediaSection=!1,e._nextSendSctpStreamId=0,e._transportReady=!1,e}return Pt(n,[{key:"name",get:function(){return"Chrome55"}},{key:"close",value:function(){if(f.debug("close()"),this._pc)try{this._pc.close()}catch(e){}}},{key:"getNativeRtpCapabilities",value:function(){return td(this,null,wr().mark((function e(){var t,n,r,i;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return f.debug("getNativeRtpCapabilities()"),t=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"plan-b"}),e.prev=2,e.next=5,t.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0});case 5:n=e.sent;try{t.close()}catch(s){}return r=a.parse(n.sdp),i=u.extractRtpCapabilities({sdpObject:r}),e.abrupt("return",i);case 12:e.prev=12,e.t0=e.catch(2);try{t.close()}catch(o){}throw e.t0;case 16:case"end":return e.stop()}}),e,null,[[2,12]])})))}},{key:"getNativeSctpCapabilities",value:function(){return td(this,null,wr().mark((function e(){return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return f.debug("getNativeSctpCapabilities()"),e.abrupt("return",{numStreams:h});case 2:case"end":return e.stop()}}),e)})))}},{key:"run",value:function(e){var t=this,n=e.direction,r=e.iceParameters,a=e.iceCandidates,i=e.dtlsParameters,s=e.sctpParameters,o=e.iceServers,u=e.iceTransportPolicy,l=e.additionalSettings,d=e.proprietaryConstraints,h=e.extendedRtpCapabilities;f.debug("run()"),this._direction=n,this._remoteSdp=new p.RemoteSdp({iceParameters:r,iceCandidates:a,dtlsParameters:i,sctpParameters:s,planB:!0}),this._sendingRtpParametersByKind={audio:c.getSendingRtpParameters("audio",h),video:c.getSendingRtpParameters("video",h)},this._sendingRemoteRtpParametersByKind={audio:c.getSendingRemoteRtpParameters("audio",h),video:c.getSendingRemoteRtpParameters("video",h)},i.role&&"auto"!==i.role&&(this._forcedLocalDtlsRole="server"===i.role?"client":"server"),this._pc=new RTCPeerConnection(Jl({iceServers:o||[],iceTransportPolicy:u||"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"plan-b"},l),d),this._pc.addEventListener("iceconnectionstatechange",(function(){switch(t._pc.iceConnectionState){case"checking":t.emit("@connectionstatechange","connecting");break;case"connected":case"completed":t.emit("@connectionstatechange","connected");break;case"failed":t.emit("@connectionstatechange","failed");break;case"disconnected":t.emit("@connectionstatechange","disconnected");break;case"closed":t.emit("@connectionstatechange","closed")}}))}},{key:"updateIceServers",value:function(e){return td(this,null,wr().mark((function t(){var n;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:f.debug("updateIceServers()"),(n=this._pc.getConfiguration()).iceServers=e,this._pc.setConfiguration(n);case 4:case"end":return t.stop()}}),t,this)})))}},{key:"restartIce",value:function(e){return td(this,null,wr().mark((function t(){var n,r,a,i;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(f.debug("restartIce()"),this._remoteSdp.updateIceParameters(e),this._transportReady){t.next=4;break}return t.abrupt("return");case 4:if("send"!==this._direction){t.next=17;break}return t.next=7,this._pc.createOffer({iceRestart:!0});case 7:return n=t.sent,f.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",n),t.next=11,this._pc.setLocalDescription(n);case 11:return r={type:"answer",sdp:this._remoteSdp.getSdp()},f.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",r),t.next=15,this._pc.setRemoteDescription(r);case 15:t.next=27;break;case 17:return a={type:"offer",sdp:this._remoteSdp.getSdp()},f.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",a),t.next=21,this._pc.setRemoteDescription(a);case 21:return t.next=23,this._pc.createAnswer();case 23:return i=t.sent,f.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",i),t.next=27,this._pc.setLocalDescription(i);case 27:case"end":return t.stop()}}),t,this)})))}},{key:"getTransportStats",value:function(){return td(this,null,wr().mark((function e(){return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._pc.getStats());case 1:case"end":return e.stop()}}),e,this)})))}},{key:"send",value:function(e){return td(this,arguments,wr().mark((function e(t){var n,r,i,s,d,p,h,m,v,g,b,y,_,w,k;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.track,r=t.encodings,i=t.codecOptions,s=t.codec,this._assertSendDirection(),f.debug("send() [kind:%s, track.id:%s]",n.kind,n.id),s&&f.warn("send() | codec selection is not available in %s handler",this.name),this._sendStream.addTrack(n),this._pc.addStream(this._sendStream),e.next=8,this._pc.createOffer();case 8:if(p=e.sent,h=a.parse(p.sdp),(v=o.clone(this._sendingRtpParametersByKind[n.kind],{})).codecs=c.reduceCodecs(v.codecs),(g=o.clone(this._sendingRemoteRtpParametersByKind[n.kind],{})).codecs=c.reduceCodecs(g.codecs),this._transportReady){e.next=17;break}return e.next=17,this._setupTransport({localDtlsRole:null!==(d=this._forcedLocalDtlsRole)&&void 0!==d?d:"client",localSdpObject:h});case 17:return"video"===n.kind&&r&&r.length>1&&(f.debug("send() | enabling simulcast"),h=a.parse(p.sdp),m=h.media.find((function(e){return"video"===e.type})),l.addLegacySimulcast({offerMediaObject:m,track:n,numStreams:r.length}),p={type:"offer",sdp:a.write(h)}),f.debug("send() | calling pc.setLocalDescription() [offer:%o]",p),e.next=21,this._pc.setLocalDescription(p);case 21:if(h=a.parse(this._pc.localDescription.sdp),m=h.media.find((function(e){return e.type===n.kind})),v.rtcp.cname=u.getCname({offerMediaObject:m}),v.encodings=l.getRtpEncodings({offerMediaObject:m,track:n}),r)for(b=0;b<v.encodings.length;++b)r[b]&&Object.assign(v.encodings[b],r[b]);if(v.encodings.length>1&&"video/vp8"===v.codecs[0].mimeType.toLowerCase()){y=kr(v.encodings);try{for(y.s();!(_=y.n()).done;)_.value.scalabilityMode="S1T3"}catch(x){y.e(x)}finally{y.f()}}return this._remoteSdp.send({offerMediaObject:m,offerRtpParameters:v,answerRtpParameters:g,codecOptions:i}),w={type:"answer",sdp:this._remoteSdp.getSdp()},f.debug("send() | calling pc.setRemoteDescription() [answer:%o]",w),e.next=32,this._pc.setRemoteDescription(w);case 32:return k=String(this._nextSendLocalId),this._nextSendLocalId++,this._mapSendLocalIdTrack.set(k,n),e.abrupt("return",{localId:k,rtpParameters:v});case 36:case"end":return e.stop()}}),e,this)})))}},{key:"stopSending",value:function(e){return td(this,null,wr().mark((function t(){var n,r,a;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._assertSendDirection(),f.debug("stopSending() [localId:%s]",e),n=this._mapSendLocalIdTrack.get(e)){t.next=5;break}throw new Error("track not found");case 5:return this._mapSendLocalIdTrack.delete(e),this._sendStream.removeTrack(n),this._pc.addStream(this._sendStream),t.next=10,this._pc.createOffer();case 10:return r=t.sent,f.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",r),t.prev=12,t.next=15,this._pc.setLocalDescription(r);case 15:t.next=23;break;case 17:if(t.prev=17,t.t0=t.catch(12),0!==this._sendStream.getTracks().length){t.next=22;break}return f.warn("stopSending() | ignoring expected error due no sending tracks: %s",t.t0.toString()),t.abrupt("return");case 22:throw t.t0;case 23:if("stable"!==this._pc.signalingState){t.next=25;break}return t.abrupt("return");case 25:return a={type:"answer",sdp:this._remoteSdp.getSdp()},f.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",a),t.next=29,this._pc.setRemoteDescription(a);case 29:case"end":return t.stop()}}),t,this,[[12,17]])})))}},{key:"replaceTrack",value:function(e,t){return td(this,null,wr().mark((function e(){return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new s.UnsupportedError("not implemented");case 1:case"end":return e.stop()}}),e)})))}},{key:"setMaxSpatialLayer",value:function(e,t){return td(this,null,wr().mark((function e(){return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new s.UnsupportedError(" not implemented");case 1:case"end":return e.stop()}}),e)})))}},{key:"setRtpEncodingParameters",value:function(e,t){return td(this,null,wr().mark((function e(){return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new s.UnsupportedError("not supported");case 1:case"end":return e.stop()}}),e)})))}},{key:"getSenderStats",value:function(e){return td(this,null,wr().mark((function e(){return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new s.UnsupportedError("not implemented");case 1:case"end":return e.stop()}}),e)})))}},{key:"sendDataChannel",value:function(e){return td(this,arguments,wr().mark((function e(t){var n,r,i,s,o,c,u,l,d,p,m,v,g;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.ordered,r=t.maxPacketLifeTime,i=t.maxRetransmits,s=t.label,o=t.protocol,this._assertSendDirection(),u={negotiated:!0,id:this._nextSendSctpStreamId,ordered:n,maxPacketLifeTime:r,maxRetransmitTime:r,maxRetransmits:i,protocol:o},f.debug("sendDataChannel() [options:%o]",u),l=this._pc.createDataChannel(s,u),this._nextSendSctpStreamId=++this._nextSendSctpStreamId%h.MIS,this._hasDataChannelMediaSection){e.next=24;break}return e.next=9,this._pc.createOffer();case 9:if(d=e.sent,p=a.parse(d.sdp),m=p.media.find((function(e){return"application"===e.type})),this._transportReady){e.next=15;break}return e.next=15,this._setupTransport({localDtlsRole:null!==(c=this._forcedLocalDtlsRole)&&void 0!==c?c:"client",localSdpObject:p});case 15:return f.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",d),e.next=18,this._pc.setLocalDescription(d);case 18:return this._remoteSdp.sendSctpAssociation({offerMediaObject:m}),v={type:"answer",sdp:this._remoteSdp.getSdp()},f.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",v),e.next=23,this._pc.setRemoteDescription(v);case 23:this._hasDataChannelMediaSection=!0;case 24:return g={streamId:u.id,ordered:u.ordered,maxPacketLifeTime:u.maxPacketLifeTime,maxRetransmits:u.maxRetransmits},e.abrupt("return",{dataChannel:l,sctpStreamParameters:g});case 26:case"end":return e.stop()}}),e,this)})))}},{key:"receive",value:function(e){return td(this,null,wr().mark((function t(){var n,r,i,s,o,c,l,d,p,h,m,v,g,b,y,_,w,k,x,S=this;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this._assertRecvDirection(),r=[],i=kr(e);try{for(i.s();!(s=i.n()).done;)o=s.value,c=o.trackId,l=o.kind,d=o.rtpParameters,f.debug("receive() [trackId:%s, kind:%s]",c,l),p=l,h=d.rtcp.cname,this._remoteSdp.receive({mid:p,kind:l,offerRtpParameters:d,streamId:h,trackId:c})}catch(R){i.e(R)}finally{i.f()}return m={type:"offer",sdp:this._remoteSdp.getSdp()},f.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",m),t.next=8,this._pc.setRemoteDescription(m);case 8:return t.next=10,this._pc.createAnswer();case 10:v=t.sent,g=a.parse(v.sdp),b=kr(e);try{for(_=function(){var e=y.value,t=e.kind,n=e.rtpParameters,r=t,a=g.media.find((function(e){return String(e.mid)===r}));u.applyCodecParameters({offerRtpParameters:n,answerMediaObject:a})},b.s();!(y=b.n()).done;)_()}catch(R){b.e(R)}finally{b.f()}if(v={type:"answer",sdp:a.write(g)},this._transportReady){t.next=18;break}return t.next=18,this._setupTransport({localDtlsRole:null!==(n=this._forcedLocalDtlsRole)&&void 0!==n?n:"client",localSdpObject:g});case 18:return f.debug("receive() | calling pc.setLocalDescription() [answer:%o]",v),t.next=21,this._pc.setLocalDescription(v);case 21:w=kr(e);try{for(x=function(){var e=k.value,t=e.kind,n=e.trackId,a=e.rtpParameters,i=t,s=n,o=a.rtcp.cname,c=S._pc.getRemoteStreams().find((function(e){return e.id===o})).getTrackById(s);if(!c)throw new Error("remote track not found");S._mapRecvLocalIdInfo.set(s,{mid:i,rtpParameters:a}),r.push({localId:s,track:c})},w.s();!(k=w.n()).done;)x()}catch(R){w.e(R)}finally{w.f()}return t.abrupt("return",r);case 24:case"end":return t.stop()}}),t,this)})))}},{key:"stopReceiving",value:function(e){return td(this,null,wr().mark((function t(){var n,r,a,i,s;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this._assertRecvDirection(),f.debug("stopReceiving() [localId:%s]",e),n=this._mapRecvLocalIdInfo.get(e)||{},r=n.mid,a=n.rtpParameters,this._mapRecvLocalIdInfo.delete(e),this._remoteSdp.planBStopReceiving({mid:r,offerRtpParameters:a}),i={type:"offer",sdp:this._remoteSdp.getSdp()},f.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",i),t.next=9,this._pc.setRemoteDescription(i);case 9:return t.next=11,this._pc.createAnswer();case 11:return s=t.sent,f.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",s),t.next=15,this._pc.setLocalDescription(s);case 15:case"end":return t.stop()}}),t,this)})))}},{key:"pauseReceiving",value:function(e){return td(this,null,wr().mark((function e(){return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})))}},{key:"resumeReceiving",value:function(e){return td(this,null,wr().mark((function e(){return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})))}},{key:"getReceiverStats",value:function(e){return td(this,null,wr().mark((function e(){return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new s.UnsupportedError("not implemented");case 1:case"end":return e.stop()}}),e)})))}},{key:"receiveDataChannel",value:function(e){return td(this,arguments,wr().mark((function e(t){var n,r,i,s,o,c,u,l,d,p,h,m,v;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.sctpStreamParameters,r=t.label,i=t.protocol,this._assertRecvDirection(),o=n.streamId,c=n.ordered,u=n.maxPacketLifeTime,l=n.maxRetransmits,d={negotiated:!0,id:o,ordered:c,maxPacketLifeTime:u,maxRetransmitTime:u,maxRetransmits:l,protocol:i},f.debug("receiveDataChannel() [options:%o]",d),p=this._pc.createDataChannel(r,d),this._hasDataChannelMediaSection){e.next=23;break}return this._remoteSdp.receiveSctpAssociation({oldDataChannelSpec:!0}),h={type:"offer",sdp:this._remoteSdp.getSdp()},f.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",h),e.next=12,this._pc.setRemoteDescription(h);case 12:return e.next=14,this._pc.createAnswer();case 14:if(m=e.sent,this._transportReady){e.next=19;break}return v=a.parse(m.sdp),e.next=19,this._setupTransport({localDtlsRole:null!==(s=this._forcedLocalDtlsRole)&&void 0!==s?s:"client",localSdpObject:v});case 19:return f.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",m),e.next=22,this._pc.setLocalDescription(m);case 22:this._hasDataChannelMediaSection=!0;case 23:return e.abrupt("return",{dataChannel:p});case 24:case"end":return e.stop()}}),e,this)})))}},{key:"_setupTransport",value:function(e){return td(this,arguments,wr().mark((function e(t){var n,r,i;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.localDtlsRole,(r=t.localSdpObject)||(r=a.parse(this._pc.localDescription.sdp)),(i=u.extractDtlsParameters({sdpObject:r})).role=n,this._remoteSdp.updateDtlsRole("client"===n?"server":"client"),e.next=7,this.safeEmitAsPromise("@connect",{dtlsParameters:i});case 7:this._transportReady=!0;case 8:case"end":return e.stop()}}),e,this)})))}},{key:"_assertSendDirection",value:function(){if("send"!==this._direction)throw new Error('method can just be called for handlers with "send" direction')}},{key:"_assertRecvDirection",value:function(){if("recv"!==this._direction)throw new Error('method can just be called for handlers with "recv" direction')}}],[{key:"createFactory",value:function(){return function(){return new n}}}]),n}(d.HandlerInterface);e.Chrome55=m}}),hp=Zl({"../../node_modules/mediasoup-client/lib/handlers/Firefox60.js":function(e){nd();var t=e&&e.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var a=Object.getOwnPropertyDescriptor(t,n);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,a)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),n=e&&e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=e&&e.__importStar||function(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var a in e)"default"!==a&&Object.prototype.hasOwnProperty.call(e,a)&&t(r,e,a);return n(r,e),r};Object.defineProperty(e,"__esModule",{value:!0}),e.Firefox60=void 0;var a=r(Bd()),i=Wd(),s=Kd(),o=r(Xd()),c=r($d()),u=r(rp()),l=r(ap()),d=ip(),p=op(),f=new i.Logger("Firefox60"),h={OS:16,MIS:2048},m=function(e){mn(n,e);var t=_n(n);function n(){var e;return St(this,n),(e=t.call(this))._mapMidTransceiver=new Map,e._sendStream=new MediaStream,e._hasDataChannelMediaSection=!1,e._nextSendSctpStreamId=0,e._transportReady=!1,e}return Pt(n,[{key:"name",get:function(){return"Firefox60"}},{key:"close",value:function(){if(f.debug("close()"),this._pc)try{this._pc.close()}catch(e){}}},{key:"getNativeRtpCapabilities",value:function(){return td(this,null,wr().mark((function e(){var t,n,r,i,s,o,c,l,d,p;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return f.debug("getNativeRtpCapabilities()"),t=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require"}),(n=document.createElement("canvas")).getContext("2d"),r=n.captureStream(),i=r.getVideoTracks()[0],e.prev=6,t.addTransceiver("audio",{direction:"sendrecv"}),s=t.addTransceiver(i,{direction:"sendrecv"}),o=s.sender.getParameters(),c=[{rid:"r0",maxBitrate:1e5},{rid:"r1",maxBitrate:5e5}],o.encodings=c,e.next=14,s.sender.setParameters(o);case 14:return e.next=16,t.createOffer();case 16:l=e.sent;try{n.remove()}catch(h){}try{i.stop()}catch(h){}try{t.close()}catch(h){}return d=a.parse(l.sdp),p=u.extractRtpCapabilities({sdpObject:d}),e.abrupt("return",p);case 25:e.prev=25,e.t0=e.catch(6);try{n.remove()}catch(m){}try{i.stop()}catch(m){}try{t.close()}catch(m){}throw e.t0;case 31:case"end":return e.stop()}}),e,null,[[6,25]])})))}},{key:"getNativeSctpCapabilities",value:function(){return td(this,null,wr().mark((function e(){return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return f.debug("getNativeSctpCapabilities()"),e.abrupt("return",{numStreams:h});case 2:case"end":return e.stop()}}),e)})))}},{key:"run",value:function(e){var t=this,n=e.direction,r=e.iceParameters,a=e.iceCandidates,i=e.dtlsParameters,s=e.sctpParameters,o=e.iceServers,u=e.iceTransportPolicy,l=e.additionalSettings,d=e.proprietaryConstraints,h=e.extendedRtpCapabilities;f.debug("run()"),this._direction=n,this._remoteSdp=new p.RemoteSdp({iceParameters:r,iceCandidates:a,dtlsParameters:i,sctpParameters:s}),this._sendingRtpParametersByKind={audio:c.getSendingRtpParameters("audio",h),video:c.getSendingRtpParameters("video",h)},this._sendingRemoteRtpParametersByKind={audio:c.getSendingRemoteRtpParameters("audio",h),video:c.getSendingRemoteRtpParameters("video",h)},this._pc=new RTCPeerConnection(Jl({iceServers:o||[],iceTransportPolicy:u||"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require"},l),d),this._pc.addEventListener("iceconnectionstatechange",(function(){switch(t._pc.iceConnectionState){case"checking":t.emit("@connectionstatechange","connecting");break;case"connected":case"completed":t.emit("@connectionstatechange","connected");break;case"failed":t.emit("@connectionstatechange","failed");break;case"disconnected":t.emit("@connectionstatechange","disconnected");break;case"closed":t.emit("@connectionstatechange","closed")}}))}},{key:"updateIceServers",value:function(e){return td(this,null,wr().mark((function e(){return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new s.UnsupportedError("not supported");case 1:case"end":return e.stop()}}),e)})))}},{key:"restartIce",value:function(e){return td(this,null,wr().mark((function t(){var n,r,a,i;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(f.debug("restartIce()"),this._remoteSdp.updateIceParameters(e),this._transportReady){t.next=4;break}return t.abrupt("return");case 4:if("send"!==this._direction){t.next=17;break}return t.next=7,this._pc.createOffer({iceRestart:!0});case 7:return n=t.sent,f.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",n),t.next=11,this._pc.setLocalDescription(n);case 11:return r={type:"answer",sdp:this._remoteSdp.getSdp()},f.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",r),t.next=15,this._pc.setRemoteDescription(r);case 15:t.next=27;break;case 17:return a={type:"offer",sdp:this._remoteSdp.getSdp()},f.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",a),t.next=21,this._pc.setRemoteDescription(a);case 21:return t.next=23,this._pc.createAnswer();case 23:return i=t.sent,f.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",i),t.next=27,this._pc.setLocalDescription(i);case 27:case"end":return t.stop()}}),t,this)})))}},{key:"getTransportStats",value:function(){return td(this,null,wr().mark((function e(){return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._pc.getStats());case 1:case"end":return e.stop()}}),e,this)})))}},{key:"send",value:function(e){return td(this,arguments,wr().mark((function e(t){var n,r,i,s,d,p,h,m,v,g,b,y,_,w,k,x;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.track,r=t.encodings,i=t.codecOptions,s=t.codec,this._assertSendDirection(),f.debug("send() [kind:%s, track.id:%s]",n.kind,n.id),r&&(r=o.clone(r,[])).length>1&&(r.forEach((function(e,t){e.rid="r".concat(t)})),r.reverse()),(d=o.clone(this._sendingRtpParametersByKind[n.kind],{})).codecs=c.reduceCodecs(d.codecs,s),(p=o.clone(this._sendingRemoteRtpParametersByKind[n.kind],{})).codecs=c.reduceCodecs(p.codecs,s),h=this._pc.addTransceiver(n,{direction:"sendonly",streams:[this._sendStream]}),!r){e.next=14;break}return(m=h.sender.getParameters()).encodings=r,e.next=14,h.sender.setParameters(m);case 14:return e.next=16,this._pc.createOffer();case 16:if(v=e.sent,g=a.parse(v.sdp),this._transportReady){e.next=21;break}return e.next=21,this._setupTransport({localDtlsRole:"client",localSdpObject:g});case 21:return f.debug("send() | calling pc.setLocalDescription() [offer:%o]",v),e.next=24,this._pc.setLocalDescription(v);case 24:if(b=h.mid,d.mid=b,g=a.parse(this._pc.localDescription.sdp),y=g.media[g.media.length-1],d.rtcp.cname=u.getCname({offerMediaObject:y}),r?1===r.length?(_=l.getRtpEncodings({offerMediaObject:y}),Object.assign(_[0],r[0]),d.encodings=_):d.encodings=r.reverse():d.encodings=l.getRtpEncodings({offerMediaObject:y}),d.encodings.length>1&&("video/vp8"===d.codecs[0].mimeType.toLowerCase()||"video/h264"===d.codecs[0].mimeType.toLowerCase())){w=kr(d.encodings);try{for(w.s();!(k=w.n()).done;)k.value.scalabilityMode="S1T3"}catch(S){w.e(S)}finally{w.f()}}return this._remoteSdp.send({offerMediaObject:y,offerRtpParameters:d,answerRtpParameters:p,codecOptions:i,extmapAllowMixed:!0}),x={type:"answer",sdp:this._remoteSdp.getSdp()},f.debug("send() | calling pc.setRemoteDescription() [answer:%o]",x),e.next=36,this._pc.setRemoteDescription(x);case 36:return this._mapMidTransceiver.set(b,h),e.abrupt("return",{localId:b,rtpParameters:d,rtpSender:h.sender});case 38:case"end":return e.stop()}}),e,this)})))}},{key:"stopSending",value:function(e){return td(this,null,wr().mark((function t(){var n,r,a;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(f.debug("stopSending() [localId:%s]",e),n=this._mapMidTransceiver.get(e)){t.next=4;break}throw new Error("associated transceiver not found");case 4:return n.sender.replaceTrack(null),this._pc.removeTrack(n.sender),this._remoteSdp.disableMediaSection(n.mid),t.next=9,this._pc.createOffer();case 9:return r=t.sent,f.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",r),t.next=13,this._pc.setLocalDescription(r);case 13:return a={type:"answer",sdp:this._remoteSdp.getSdp()},f.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",a),t.next=17,this._pc.setRemoteDescription(a);case 17:this._mapMidTransceiver.delete(e);case 18:case"end":return t.stop()}}),t,this)})))}},{key:"replaceTrack",value:function(e,t){return td(this,null,wr().mark((function n(){var r;return wr().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(this._assertSendDirection(),t?f.debug("replaceTrack() [localId:%s, track.id:%s]",e,t.id):f.debug("replaceTrack() [localId:%s, no track]",e),r=this._mapMidTransceiver.get(e)){n.next=5;break}throw new Error("associated RTCRtpTransceiver not found");case 5:return n.next=7,r.sender.replaceTrack(t);case 7:case"end":return n.stop()}}),n,this)})))}},{key:"setMaxSpatialLayer",value:function(e,t){return td(this,null,wr().mark((function n(){var r,a;return wr().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(this._assertSendDirection(),f.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",e,t),r=this._mapMidTransceiver.get(e)){n.next=5;break}throw new Error("associated transceiver not found");case 5:return a=r.sender.getParameters(),t=a.encodings.length-1-t,a.encodings.forEach((function(e,n){e.active=n>=t})),n.next=10,r.sender.setParameters(a);case 10:case"end":return n.stop()}}),n,this)})))}},{key:"setRtpEncodingParameters",value:function(e,t){return td(this,null,wr().mark((function n(){var r,a;return wr().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(this._assertSendDirection(),f.debug("setRtpEncodingParameters() [localId:%s, params:%o]",e,t),r=this._mapMidTransceiver.get(e)){n.next=5;break}throw new Error("associated RTCRtpTransceiver not found");case 5:return(a=r.sender.getParameters()).encodings.forEach((function(e,n){a.encodings[n]=Jl(Jl({},e),t)})),n.next=9,r.sender.setParameters(a);case 9:case"end":return n.stop()}}),n,this)})))}},{key:"getSenderStats",value:function(e){return td(this,null,wr().mark((function t(){var n;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._assertSendDirection(),n=this._mapMidTransceiver.get(e)){t.next=4;break}throw new Error("associated RTCRtpTransceiver not found");case 4:return t.abrupt("return",n.sender.getStats());case 5:case"end":return t.stop()}}),t,this)})))}},{key:"sendDataChannel",value:function(e){return td(this,arguments,wr().mark((function e(t){var n,r,i,s,o,c,u,l,d,p,m,v;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.ordered,r=t.maxPacketLifeTime,i=t.maxRetransmits,s=t.label,o=t.protocol,this._assertSendDirection(),c={negotiated:!0,id:this._nextSendSctpStreamId,ordered:n,maxPacketLifeTime:r,maxRetransmits:i,protocol:o},f.debug("sendDataChannel() [options:%o]",c),u=this._pc.createDataChannel(s,c),this._nextSendSctpStreamId=++this._nextSendSctpStreamId%h.MIS,this._hasDataChannelMediaSection){e.next=24;break}return e.next=9,this._pc.createOffer();case 9:if(l=e.sent,d=a.parse(l.sdp),p=d.media.find((function(e){return"application"===e.type})),this._transportReady){e.next=15;break}return e.next=15,this._setupTransport({localDtlsRole:"client",localSdpObject:d});case 15:return f.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",l),e.next=18,this._pc.setLocalDescription(l);case 18:return this._remoteSdp.sendSctpAssociation({offerMediaObject:p}),m={type:"answer",sdp:this._remoteSdp.getSdp()},f.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",m),e.next=23,this._pc.setRemoteDescription(m);case 23:this._hasDataChannelMediaSection=!0;case 24:return v={streamId:c.id,ordered:c.ordered,maxPacketLifeTime:c.maxPacketLifeTime,maxRetransmits:c.maxRetransmits},e.abrupt("return",{dataChannel:u,sctpStreamParameters:v});case 26:case"end":return e.stop()}}),e,this)})))}},{key:"receive",value:function(e){return td(this,null,wr().mark((function t(){var n,r,i,s,o,c,l,d,p,h,m,v,g,b,y,_,w,k,x=this;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this._assertRecvDirection(),n=[],r=new Map,i=kr(e);try{for(i.s();!(s=i.n()).done;)o=s.value,c=o.trackId,l=o.kind,d=o.rtpParameters,f.debug("receive() [trackId:%s, kind:%s]",c,l),p=d.mid||String(this._mapMidTransceiver.size),r.set(c,p),this._remoteSdp.receive({mid:p,kind:l,offerRtpParameters:d,streamId:d.rtcp.cname,trackId:c})}catch(S){i.e(S)}finally{i.f()}return h={type:"offer",sdp:this._remoteSdp.getSdp()},f.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",h),t.next=9,this._pc.setRemoteDescription(h);case 9:return t.next=11,this._pc.createAnswer();case 11:m=t.sent,v=a.parse(m.sdp),g=kr(e);try{for(y=function(){var e=b.value,t=e.trackId,n=e.rtpParameters,i=r.get(t),s=v.media.find((function(e){return String(e.mid)===i}));u.applyCodecParameters({offerRtpParameters:n,answerMediaObject:s}),m={type:"answer",sdp:a.write(v)}},g.s();!(b=g.n()).done;)y()}catch(S){g.e(S)}finally{g.f()}if(this._transportReady){t.next=18;break}return t.next=18,this._setupTransport({localDtlsRole:"client",localSdpObject:v});case 18:return f.debug("receive() | calling pc.setLocalDescription() [answer:%o]",m),t.next=21,this._pc.setLocalDescription(m);case 21:_=kr(e);try{for(k=function(){var e=w.value.trackId,t=r.get(e),a=x._pc.getTransceivers().find((function(e){return e.mid===t}));if(!a)throw new Error("new RTCRtpTransceiver not found");x._mapMidTransceiver.set(t,a),n.push({localId:t,track:a.receiver.track,rtpReceiver:a.receiver})},_.s();!(w=_.n()).done;)k()}catch(S){_.e(S)}finally{_.f()}return t.abrupt("return",n);case 24:case"end":return t.stop()}}),t,this)})))}},{key:"stopReceiving",value:function(e){return td(this,null,wr().mark((function t(){var n,r,a;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._assertRecvDirection(),f.debug("stopReceiving() [localId:%s]",e),n=this._mapMidTransceiver.get(e)){t.next=5;break}throw new Error("associated RTCRtpTransceiver not found");case 5:return this._remoteSdp.closeMediaSection(n.mid),r={type:"offer",sdp:this._remoteSdp.getSdp()},f.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",r),t.next=10,this._pc.setRemoteDescription(r);case 10:return t.next=12,this._pc.createAnswer();case 12:return a=t.sent,f.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",a),t.next=16,this._pc.setLocalDescription(a);case 16:this._mapMidTransceiver.delete(e);case 17:case"end":return t.stop()}}),t,this)})))}},{key:"pauseReceiving",value:function(e){return td(this,null,wr().mark((function t(){var n,r,a,i,s,o;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this._assertRecvDirection(),n=kr(e),t.prev=2,n.s();case 4:if((r=n.n()).done){t.next=13;break}if(a=r.value,f.debug("pauseReceiving() [localId:%s]",a),i=this._mapMidTransceiver.get(a)){t.next=10;break}throw new Error("associated RTCRtpTransceiver not found");case 10:i.direction="inactive";case 11:t.next=4;break;case 13:t.next=18;break;case 15:t.prev=15,t.t0=t.catch(2),n.e(t.t0);case 18:return t.prev=18,n.f(),t.finish(18);case 21:return s={type:"offer",sdp:this._remoteSdp.getSdp()},f.debug("pauseReceiving() | calling pc.setRemoteDescription() [offer:%o]",s),t.next=25,this._pc.setRemoteDescription(s);case 25:return t.next=27,this._pc.createAnswer();case 27:return o=t.sent,f.debug("pauseReceiving() | calling pc.setLocalDescription() [answer:%o]",o),t.next=31,this._pc.setLocalDescription(o);case 31:case"end":return t.stop()}}),t,this,[[2,15,18,21]])})))}},{key:"resumeReceiving",value:function(e){return td(this,null,wr().mark((function t(){var n,r,a,i,s,o;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this._assertRecvDirection(),n=kr(e),t.prev=2,n.s();case 4:if((r=n.n()).done){t.next=13;break}if(a=r.value,f.debug("resumeReceiving() [localId:%s]",a),i=this._mapMidTransceiver.get(a)){t.next=10;break}throw new Error("associated RTCRtpTransceiver not found");case 10:i.direction="recvonly";case 11:t.next=4;break;case 13:t.next=18;break;case 15:t.prev=15,t.t0=t.catch(2),n.e(t.t0);case 18:return t.prev=18,n.f(),t.finish(18);case 21:return s={type:"offer",sdp:this._remoteSdp.getSdp()},f.debug("resumeReceiving() | calling pc.setRemoteDescription() [offer:%o]",s),t.next=25,this._pc.setRemoteDescription(s);case 25:return t.next=27,this._pc.createAnswer();case 27:return o=t.sent,f.debug("resumeReceiving() | calling pc.setLocalDescription() [answer:%o]",o),t.next=31,this._pc.setLocalDescription(o);case 31:case"end":return t.stop()}}),t,this,[[2,15,18,21]])})))}},{key:"getReceiverStats",value:function(e){return td(this,null,wr().mark((function t(){var n;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._assertRecvDirection(),n=this._mapMidTransceiver.get(e)){t.next=4;break}throw new Error("associated RTCRtpTransceiver not found");case 4:return t.abrupt("return",n.receiver.getStats());case 5:case"end":return t.stop()}}),t,this)})))}},{key:"receiveDataChannel",value:function(e){return td(this,arguments,wr().mark((function e(t){var n,r,i,s,o,c,u,l,d,p,h,m;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.sctpStreamParameters,r=t.label,i=t.protocol,this._assertRecvDirection(),s=n.streamId,o=n.ordered,c=n.maxPacketLifeTime,u=n.maxRetransmits,l={negotiated:!0,id:s,ordered:o,maxPacketLifeTime:c,maxRetransmits:u,protocol:i},f.debug("receiveDataChannel() [options:%o]",l),d=this._pc.createDataChannel(r,l),this._hasDataChannelMediaSection){e.next=23;break}return this._remoteSdp.receiveSctpAssociation(),p={type:"offer",sdp:this._remoteSdp.getSdp()},f.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",p),e.next=12,this._pc.setRemoteDescription(p);case 12:return e.next=14,this._pc.createAnswer();case 14:if(h=e.sent,this._transportReady){e.next=19;break}return m=a.parse(h.sdp),e.next=19,this._setupTransport({localDtlsRole:"client",localSdpObject:m});case 19:return f.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",h),e.next=22,this._pc.setLocalDescription(h);case 22:this._hasDataChannelMediaSection=!0;case 23:return e.abrupt("return",{dataChannel:d});case 24:case"end":return e.stop()}}),e,this)})))}},{key:"_setupTransport",value:function(e){return td(this,arguments,wr().mark((function e(t){var n,r,i;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.localDtlsRole,(r=t.localSdpObject)||(r=a.parse(this._pc.localDescription.sdp)),(i=u.extractDtlsParameters({sdpObject:r})).role=n,this._remoteSdp.updateDtlsRole("client"===n?"server":"client"),e.next=7,this.safeEmitAsPromise("@connect",{dtlsParameters:i});case 7:this._transportReady=!0;case 8:case"end":return e.stop()}}),e,this)})))}},{key:"_assertSendDirection",value:function(){if("send"!==this._direction)throw new Error('method can just be called for handlers with "send" direction')}},{key:"_assertRecvDirection",value:function(){if("recv"!==this._direction)throw new Error('method can just be called for handlers with "recv" direction')}}],[{key:"createFactory",value:function(){return function(){return new n}}}]),n}(d.HandlerInterface);e.Firefox60=m}}),mp=Zl({"../../node_modules/mediasoup-client/lib/handlers/Safari12.js":function(e){nd();var t=e&&e.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var a=Object.getOwnPropertyDescriptor(t,n);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,a)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),n=e&&e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=e&&e.__importStar||function(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var a in e)"default"!==a&&Object.prototype.hasOwnProperty.call(e,a)&&t(r,e,a);return n(r,e),r};Object.defineProperty(e,"__esModule",{value:!0}),e.Safari12=void 0;var a=r(Bd()),i=Wd(),s=r(Xd()),o=r($d()),c=r(rp()),u=r(ap()),l=ip(),d=op(),p=new i.Logger("Safari12"),f={OS:1024,MIS:1024},h=function(e){mn(n,e);var t=_n(n);function n(){var e;return St(this,n),(e=t.call(this))._mapMidTransceiver=new Map,e._sendStream=new MediaStream,e._hasDataChannelMediaSection=!1,e._nextSendSctpStreamId=0,e._transportReady=!1,e}return Pt(n,[{key:"name",get:function(){return"Safari12"}},{key:"close",value:function(){if(p.debug("close()"),this._pc)try{this._pc.close()}catch(e){}}},{key:"getNativeRtpCapabilities",value:function(){return td(this,null,wr().mark((function e(){var t,n,r,i;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return p.debug("getNativeRtpCapabilities()"),t=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require"}),e.prev=2,t.addTransceiver("audio"),t.addTransceiver("video"),e.next=7,t.createOffer();case 7:n=e.sent;try{t.close()}catch(s){}return r=a.parse(n.sdp),i=c.extractRtpCapabilities({sdpObject:r}),e.abrupt("return",i);case 14:e.prev=14,e.t0=e.catch(2);try{t.close()}catch(o){}throw e.t0;case 18:case"end":return e.stop()}}),e,null,[[2,14]])})))}},{key:"getNativeSctpCapabilities",value:function(){return td(this,null,wr().mark((function e(){return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return p.debug("getNativeSctpCapabilities()"),e.abrupt("return",{numStreams:f});case 2:case"end":return e.stop()}}),e)})))}},{key:"run",value:function(e){var t=this,n=e.direction,r=e.iceParameters,a=e.iceCandidates,i=e.dtlsParameters,s=e.sctpParameters,c=e.iceServers,u=e.iceTransportPolicy,l=e.additionalSettings,f=e.proprietaryConstraints,h=e.extendedRtpCapabilities;p.debug("run()"),this._direction=n,this._remoteSdp=new d.RemoteSdp({iceParameters:r,iceCandidates:a,dtlsParameters:i,sctpParameters:s}),this._sendingRtpParametersByKind={audio:o.getSendingRtpParameters("audio",h),video:o.getSendingRtpParameters("video",h)},this._sendingRemoteRtpParametersByKind={audio:o.getSendingRemoteRtpParameters("audio",h),video:o.getSendingRemoteRtpParameters("video",h)},i.role&&"auto"!==i.role&&(this._forcedLocalDtlsRole="server"===i.role?"client":"server"),this._pc=new RTCPeerConnection(Jl({iceServers:c||[],iceTransportPolicy:u||"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require"},l),f),this._pc.addEventListener("iceconnectionstatechange",(function(){switch(t._pc.iceConnectionState){case"checking":t.emit("@connectionstatechange","connecting");break;case"connected":case"completed":t.emit("@connectionstatechange","connected");break;case"failed":t.emit("@connectionstatechange","failed");break;case"disconnected":t.emit("@connectionstatechange","disconnected");break;case"closed":t.emit("@connectionstatechange","closed")}}))}},{key:"updateIceServers",value:function(e){return td(this,null,wr().mark((function t(){var n;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:p.debug("updateIceServers()"),(n=this._pc.getConfiguration()).iceServers=e,this._pc.setConfiguration(n);case 4:case"end":return t.stop()}}),t,this)})))}},{key:"restartIce",value:function(e){return td(this,null,wr().mark((function t(){var n,r,a,i;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(p.debug("restartIce()"),this._remoteSdp.updateIceParameters(e),this._transportReady){t.next=4;break}return t.abrupt("return");case 4:if("send"!==this._direction){t.next=17;break}return t.next=7,this._pc.createOffer({iceRestart:!0});case 7:return n=t.sent,p.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",n),t.next=11,this._pc.setLocalDescription(n);case 11:return r={type:"answer",sdp:this._remoteSdp.getSdp()},p.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",r),t.next=15,this._pc.setRemoteDescription(r);case 15:t.next=27;break;case 17:return a={type:"offer",sdp:this._remoteSdp.getSdp()},p.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",a),t.next=21,this._pc.setRemoteDescription(a);case 21:return t.next=23,this._pc.createAnswer();case 23:return i=t.sent,p.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",i),t.next=27,this._pc.setLocalDescription(i);case 27:case"end":return t.stop()}}),t,this)})))}},{key:"getTransportStats",value:function(){return td(this,null,wr().mark((function e(){return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._pc.getStats());case 1:case"end":return e.stop()}}),e,this)})))}},{key:"send",value:function(e){return td(this,arguments,wr().mark((function e(t){var n,r,i,l,d,f,h,m,v,g,b,y,_,w,k,x;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.track,r=t.encodings,i=t.codecOptions,l=t.codec,this._assertSendDirection(),p.debug("send() [kind:%s, track.id:%s]",n.kind,n.id),(f=s.clone(this._sendingRtpParametersByKind[n.kind],{})).codecs=o.reduceCodecs(f.codecs,l),(h=s.clone(this._sendingRemoteRtpParametersByKind[n.kind],{})).codecs=o.reduceCodecs(h.codecs,l),m=this._remoteSdp.getNextMediaSectionIdx(),v=this._pc.addTransceiver(n,{direction:"sendonly",streams:[this._sendStream]}),e.next=11,this._pc.createOffer();case 11:if(g=e.sent,b=a.parse(g.sdp),this._transportReady){e.next=16;break}return e.next=16,this._setupTransport({localDtlsRole:null!==(d=this._forcedLocalDtlsRole)&&void 0!==d?d:"client",localSdpObject:b});case 16:return r&&r.length>1&&(p.debug("send() | enabling legacy simulcast"),b=a.parse(g.sdp),y=b.media[m.idx],u.addLegacySimulcast({offerMediaObject:y,numStreams:r.length}),g={type:"offer",sdp:a.write(b)}),console.debug("send() | calling pc.setLocalDescription() [offer:%o]",g.sdp),e.next=20,this._pc.setLocalDescription(g);case 20:if(_=v.mid,f.mid=_,b=a.parse(this._pc.localDescription.sdp),y=b.media[m.idx],f.rtcp.cname=c.getCname({offerMediaObject:y}),f.encodings=u.getRtpEncodings({offerMediaObject:y}),console.warn(f.encodings,y,r),f.encodings.length>1&&("video/vp8"===f.codecs[0].mimeType.toLowerCase()||"video/h264"===f.codecs[0].mimeType.toLowerCase())){w=kr(f.encodings);try{for(w.s();!(k=w.n()).done;)k.value.scalabilityMode="S1T3"}catch(S){w.e(S)}finally{w.f()}}return this._remoteSdp.send({offerMediaObject:y,reuseMid:m.reuseMid,offerRtpParameters:f,answerRtpParameters:h,codecOptions:i}),x={type:"answer",sdp:this._remoteSdp.getSdp()},console.debug("send() | calling pc.setRemoteDescription() [answer:%o]",x.sdp),e.next=34,this._pc.setRemoteDescription(x);case 34:return this._mapMidTransceiver.set(_,v),e.abrupt("return",{localId:_,rtpParameters:f,rtpSender:v.sender});case 36:case"end":return e.stop()}}),e,this)})))}},{key:"stopSending",value:function(e){return td(this,null,wr().mark((function t(){var n,r,a;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._assertSendDirection(),p.debug("stopSending() [localId:%s]",e),n=this._mapMidTransceiver.get(e)){t.next=5;break}throw new Error("associated RTCRtpTransceiver not found");case 5:return n.sender.replaceTrack(null),this._pc.removeTrack(n.sender),this._remoteSdp.closeMediaSection(n.mid),t.next=10,this._pc.createOffer();case 10:return r=t.sent,p.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",r),t.next=14,this._pc.setLocalDescription(r);case 14:return a={type:"answer",sdp:this._remoteSdp.getSdp()},p.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",a),t.next=18,this._pc.setRemoteDescription(a);case 18:this._mapMidTransceiver.delete(e);case 19:case"end":return t.stop()}}),t,this)})))}},{key:"replaceTrack",value:function(e,t){return td(this,null,wr().mark((function n(){var r;return wr().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(this._assertSendDirection(),t?p.debug("replaceTrack() [localId:%s, track.id:%s]",e,t.id):p.debug("replaceTrack() [localId:%s, no track]",e),r=this._mapMidTransceiver.get(e)){n.next=5;break}throw new Error("associated RTCRtpTransceiver not found");case 5:return n.next=7,r.sender.replaceTrack(t);case 7:case"end":return n.stop()}}),n,this)})))}},{key:"setMaxSpatialLayer",value:function(e,t){return td(this,null,wr().mark((function n(){var r,a;return wr().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(this._assertSendDirection(),console.warn("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",e,t),r=this._mapMidTransceiver.get(e)){n.next=5;break}throw new Error("associated RTCRtpTransceiver not found");case 5:return(a=r.sender.getParameters()).encodings.forEach((function(e,n){e.active=n<=t})),n.next=9,r.sender.setParameters(a);case 9:case"end":return n.stop()}}),n,this)})))}},{key:"setRtpEncodingParameters",value:function(e,t){return td(this,null,wr().mark((function n(){var r,a;return wr().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(this._assertSendDirection(),console.warn("setRtpEncodingParameters() [localId:%s, params:%o]",e,t),r=this._mapMidTransceiver.get(e)){n.next=5;break}throw new Error("associated RTCRtpTransceiver not found");case 5:return(a=r.sender.getParameters()).encodings.forEach((function(e,n){a.encodings[n]=Jl(Jl({},e),t)})),n.next=9,r.sender.setParameters(a);case 9:case"end":return n.stop()}}),n,this)})))}},{key:"getSenderStats",value:function(e){return td(this,null,wr().mark((function t(){var n;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._assertSendDirection(),n=this._mapMidTransceiver.get(e)){t.next=4;break}throw new Error("associated RTCRtpTransceiver not found");case 4:return t.abrupt("return",n.sender.getStats());case 5:case"end":return t.stop()}}),t,this)})))}},{key:"sendDataChannel",value:function(e){return td(this,arguments,wr().mark((function e(t){var n,r,i,s,o,c,u,l,d,h,m,v,g;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.ordered,r=t.maxPacketLifeTime,i=t.maxRetransmits,s=t.label,o=t.protocol,this._assertSendDirection(),u={negotiated:!0,id:this._nextSendSctpStreamId,ordered:n,maxPacketLifeTime:r,maxRetransmits:i,protocol:o},p.debug("sendDataChannel() [options:%o]",u),l=this._pc.createDataChannel(s,u),this._nextSendSctpStreamId=++this._nextSendSctpStreamId%f.MIS,this._hasDataChannelMediaSection){e.next=24;break}return e.next=9,this._pc.createOffer();case 9:if(d=e.sent,h=a.parse(d.sdp),m=h.media.find((function(e){return"application"===e.type})),this._transportReady){e.next=15;break}return e.next=15,this._setupTransport({localDtlsRole:null!==(c=this._forcedLocalDtlsRole)&&void 0!==c?c:"client",localSdpObject:h});case 15:return p.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",d),e.next=18,this._pc.setLocalDescription(d);case 18:return this._remoteSdp.sendSctpAssociation({offerMediaObject:m}),v={type:"answer",sdp:this._remoteSdp.getSdp()},p.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",v),e.next=23,this._pc.setRemoteDescription(v);case 23:this._hasDataChannelMediaSection=!0;case 24:return g={streamId:u.id,ordered:u.ordered,maxPacketLifeTime:u.maxPacketLifeTime,maxRetransmits:u.maxRetransmits},e.abrupt("return",{dataChannel:l,sctpStreamParameters:g});case 26:case"end":return e.stop()}}),e,this)})))}},{key:"receive",value:function(e){return td(this,null,wr().mark((function t(){var n,r,i,s,o,u,l,d,f,h,m,v,g,b,y,_,w,k,x,S=this;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this._assertRecvDirection(),r=[],i=new Map,s=kr(e);try{for(s.s();!(o=s.n()).done;)u=o.value,l=u.trackId,d=u.kind,f=u.rtpParameters,p.debug("receive() [trackId:%s, kind:%s]",l,d),h=f.mid||String(this._mapMidTransceiver.size),i.set(l,h),this._remoteSdp.receive({mid:h,kind:d,offerRtpParameters:f,streamId:f.rtcp.cname,trackId:l})}catch(R){s.e(R)}finally{s.f()}return m={type:"offer",sdp:this._remoteSdp.getSdp()},p.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",m),t.next=9,this._pc.setRemoteDescription(m);case 9:return t.next=11,this._pc.createAnswer();case 11:v=t.sent,g=a.parse(v.sdp),b=kr(e);try{for(_=function(){var e=y.value,t=e.trackId,n=e.rtpParameters,r=i.get(t),a=g.media.find((function(e){return String(e.mid)===r}));c.applyCodecParameters({offerRtpParameters:n,answerMediaObject:a})},b.s();!(y=b.n()).done;)_()}catch(R){b.e(R)}finally{b.f()}if(v={type:"answer",sdp:a.write(g)},this._transportReady){t.next=19;break}return t.next=19,this._setupTransport({localDtlsRole:null!==(n=this._forcedLocalDtlsRole)&&void 0!==n?n:"client",localSdpObject:g});case 19:return p.debug("receive() | calling pc.setLocalDescription() [answer:%o]",v),t.next=22,this._pc.setLocalDescription(v);case 22:w=kr(e);try{for(x=function(){var e=k.value.trackId,t=i.get(e),n=S._pc.getTransceivers().find((function(e){return e.mid===t}));if(!n)throw new Error("new RTCRtpTransceiver not found");S._mapMidTransceiver.set(t,n),r.push({localId:t,track:n.receiver.track,rtpReceiver:n.receiver})},w.s();!(k=w.n()).done;)x()}catch(R){w.e(R)}finally{w.f()}return t.abrupt("return",r);case 25:case"end":return t.stop()}}),t,this)})))}},{key:"stopReceiving",value:function(e){return td(this,null,wr().mark((function t(){var n,r,a;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._assertRecvDirection(),p.debug("stopReceiving() [localId:%s]",e),n=this._mapMidTransceiver.get(e)){t.next=5;break}throw new Error("associated RTCRtpTransceiver not found");case 5:return this._remoteSdp.closeMediaSection(n.mid),r={type:"offer",sdp:this._remoteSdp.getSdp()},p.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",r),t.next=10,this._pc.setRemoteDescription(r);case 10:return t.next=12,this._pc.createAnswer();case 12:return a=t.sent,p.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",a),t.next=16,this._pc.setLocalDescription(a);case 16:this._mapMidTransceiver.delete(e);case 17:case"end":return t.stop()}}),t,this)})))}},{key:"pauseReceiving",value:function(e){return td(this,null,wr().mark((function t(){var n,r,a,i,s,o;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this._assertRecvDirection(),n=kr(e),t.prev=2,n.s();case 4:if((r=n.n()).done){t.next=13;break}if(a=r.value,p.debug("pauseReceiving() [localId:%s]",a),i=this._mapMidTransceiver.get(a)){t.next=10;break}throw new Error("associated RTCRtpTransceiver not found");case 10:i.direction="inactive";case 11:t.next=4;break;case 13:t.next=18;break;case 15:t.prev=15,t.t0=t.catch(2),n.e(t.t0);case 18:return t.prev=18,n.f(),t.finish(18);case 21:return s={type:"offer",sdp:this._remoteSdp.getSdp()},p.debug("pauseReceiving() | calling pc.setRemoteDescription() [offer:%o]",s),t.next=25,this._pc.setRemoteDescription(s);case 25:return t.next=27,this._pc.createAnswer();case 27:return o=t.sent,p.debug("pauseReceiving() | calling pc.setLocalDescription() [answer:%o]",o),t.next=31,this._pc.setLocalDescription(o);case 31:case"end":return t.stop()}}),t,this,[[2,15,18,21]])})))}},{key:"resumeReceiving",value:function(e){return td(this,null,wr().mark((function t(){var n,r,a,i,s,o;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this._assertRecvDirection(),n=kr(e),t.prev=2,n.s();case 4:if((r=n.n()).done){t.next=13;break}if(a=r.value,p.debug("resumeReceiving() [localId:%s]",a),i=this._mapMidTransceiver.get(a)){t.next=10;break}throw new Error("associated RTCRtpTransceiver not found");case 10:i.direction="recvonly";case 11:t.next=4;break;case 13:t.next=18;break;case 15:t.prev=15,t.t0=t.catch(2),n.e(t.t0);case 18:return t.prev=18,n.f(),t.finish(18);case 21:return s={type:"offer",sdp:this._remoteSdp.getSdp()},p.debug("resumeReceiving() | calling pc.setRemoteDescription() [offer:%o]",s),t.next=25,this._pc.setRemoteDescription(s);case 25:return t.next=27,this._pc.createAnswer();case 27:return o=t.sent,p.debug("resumeReceiving() | calling pc.setLocalDescription() [answer:%o]",o),t.next=31,this._pc.setLocalDescription(o);case 31:case"end":return t.stop()}}),t,this,[[2,15,18,21]])})))}},{key:"getReceiverStats",value:function(e){return td(this,null,wr().mark((function t(){var n;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._assertRecvDirection(),n=this._mapMidTransceiver.get(e)){t.next=4;break}throw new Error("associated RTCRtpTransceiver not found");case 4:return t.abrupt("return",n.receiver.getStats());case 5:case"end":return t.stop()}}),t,this)})))}},{key:"receiveDataChannel",value:function(e){return td(this,arguments,wr().mark((function e(t){var n,r,i,s,o,c,u,l,d,f,h,m,v;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.sctpStreamParameters,r=t.label,i=t.protocol,this._assertRecvDirection(),o=n.streamId,c=n.ordered,u=n.maxPacketLifeTime,l=n.maxRetransmits,d={negotiated:!0,id:o,ordered:c,maxPacketLifeTime:u,maxRetransmits:l,protocol:i},p.debug("receiveDataChannel() [options:%o]",d),f=this._pc.createDataChannel(r,d),this._hasDataChannelMediaSection){e.next=23;break}return this._remoteSdp.receiveSctpAssociation(),h={type:"offer",sdp:this._remoteSdp.getSdp()},p.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",h),e.next=12,this._pc.setRemoteDescription(h);case 12:return e.next=14,this._pc.createAnswer();case 14:if(m=e.sent,this._transportReady){e.next=19;break}return v=a.parse(m.sdp),e.next=19,this._setupTransport({localDtlsRole:null!==(s=this._forcedLocalDtlsRole)&&void 0!==s?s:"client",localSdpObject:v});case 19:return p.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",m),e.next=22,this._pc.setLocalDescription(m);case 22:this._hasDataChannelMediaSection=!0;case 23:return e.abrupt("return",{dataChannel:f});case 24:case"end":return e.stop()}}),e,this)})))}},{key:"_setupTransport",value:function(e){return td(this,arguments,wr().mark((function e(t){var n,r,i;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.localDtlsRole,(r=t.localSdpObject)||(r=a.parse(this._pc.localDescription.sdp)),(i=c.extractDtlsParameters({sdpObject:r})).role=n,this._remoteSdp.updateDtlsRole("client"===n?"server":"client"),e.next=7,this.safeEmitAsPromise("@connect",{dtlsParameters:i});case 7:this._transportReady=!0;case 8:case"end":return e.stop()}}),e,this)})))}},{key:"_assertSendDirection",value:function(){if("send"!==this._direction)throw new Error('method can just be called for handlers with "send" direction')}},{key:"_assertRecvDirection",value:function(){if("recv"!==this._direction)throw new Error('method can just be called for handlers with "recv" direction')}}],[{key:"createFactory",value:function(){return function(){return new n}}}]),n}(l.HandlerInterface);e.Safari12=h}}),vp=Zl({"../../node_modules/mediasoup-client/lib/handlers/Safari11.js":function(e){nd();var t=e&&e.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var a=Object.getOwnPropertyDescriptor(t,n);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,a)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),n=e&&e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=e&&e.__importStar||function(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var a in e)"default"!==a&&Object.prototype.hasOwnProperty.call(e,a)&&t(r,e,a);return n(r,e),r};Object.defineProperty(e,"__esModule",{value:!0}),e.Safari11=void 0;var a=r(Bd()),i=Wd(),s=r(Xd()),o=r($d()),c=r(rp()),u=r(dp()),l=ip(),d=op(),p=new i.Logger("Safari11"),f={OS:1024,MIS:1024},h=function(e){mn(n,e);var t=_n(n);function n(){var e;return St(this,n),(e=t.call(this))._sendStream=new MediaStream,e._mapSendLocalIdRtpSender=new Map,e._nextSendLocalId=0,e._mapRecvLocalIdInfo=new Map,e._hasDataChannelMediaSection=!1,e._nextSendSctpStreamId=0,e._transportReady=!1,e}return Pt(n,[{key:"name",get:function(){return"Safari11"}},{key:"close",value:function(){if(p.debug("close()"),this._pc)try{this._pc.close()}catch(e){}}},{key:"getNativeRtpCapabilities",value:function(){return td(this,null,wr().mark((function e(){var t,n,r,i;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return p.debug("getNativeRtpCapabilities()"),t=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"plan-b"}),e.prev=2,e.next=5,t.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0});case 5:n=e.sent;try{t.close()}catch(s){}return r=a.parse(n.sdp),i=c.extractRtpCapabilities({sdpObject:r}),e.abrupt("return",i);case 12:e.prev=12,e.t0=e.catch(2);try{t.close()}catch(o){}throw e.t0;case 16:case"end":return e.stop()}}),e,null,[[2,12]])})))}},{key:"getNativeSctpCapabilities",value:function(){return td(this,null,wr().mark((function e(){return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return p.debug("getNativeSctpCapabilities()"),e.abrupt("return",{numStreams:f});case 2:case"end":return e.stop()}}),e)})))}},{key:"run",value:function(e){var t=this,n=e.direction,r=e.iceParameters,a=e.iceCandidates,i=e.dtlsParameters,s=e.sctpParameters,c=e.iceServers,u=e.iceTransportPolicy,l=e.additionalSettings,f=e.proprietaryConstraints,h=e.extendedRtpCapabilities;p.debug("run()"),this._direction=n,this._remoteSdp=new d.RemoteSdp({iceParameters:r,iceCandidates:a,dtlsParameters:i,sctpParameters:s,planB:!0}),this._sendingRtpParametersByKind={audio:o.getSendingRtpParameters("audio",h),video:o.getSendingRtpParameters("video",h)},this._sendingRemoteRtpParametersByKind={audio:o.getSendingRemoteRtpParameters("audio",h),video:o.getSendingRemoteRtpParameters("video",h)},i.role&&"auto"!==i.role&&(this._forcedLocalDtlsRole="server"===i.role?"client":"server"),this._pc=new RTCPeerConnection(Jl({iceServers:c||[],iceTransportPolicy:u||"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require"},l),f),this._pc.addEventListener("iceconnectionstatechange",(function(){switch(t._pc.iceConnectionState){case"checking":t.emit("@connectionstatechange","connecting");break;case"connected":case"completed":t.emit("@connectionstatechange","connected");break;case"failed":t.emit("@connectionstatechange","failed");break;case"disconnected":t.emit("@connectionstatechange","disconnected");break;case"closed":t.emit("@connectionstatechange","closed")}}))}},{key:"updateIceServers",value:function(e){return td(this,null,wr().mark((function t(){var n;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:p.debug("updateIceServers()"),(n=this._pc.getConfiguration()).iceServers=e,this._pc.setConfiguration(n);case 4:case"end":return t.stop()}}),t,this)})))}},{key:"restartIce",value:function(e){return td(this,null,wr().mark((function t(){var n,r,a,i;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(p.debug("restartIce()"),this._remoteSdp.updateIceParameters(e),this._transportReady){t.next=4;break}return t.abrupt("return");case 4:if("send"!==this._direction){t.next=17;break}return t.next=7,this._pc.createOffer({iceRestart:!0});case 7:return n=t.sent,p.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",n),t.next=11,this._pc.setLocalDescription(n);case 11:return r={type:"answer",sdp:this._remoteSdp.getSdp()},p.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",r),t.next=15,this._pc.setRemoteDescription(r);case 15:t.next=27;break;case 17:return a={type:"offer",sdp:this._remoteSdp.getSdp()},p.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",a),t.next=21,this._pc.setRemoteDescription(a);case 21:return t.next=23,this._pc.createAnswer();case 23:return i=t.sent,p.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",i),t.next=27,this._pc.setLocalDescription(i);case 27:case"end":return t.stop()}}),t,this)})))}},{key:"getTransportStats",value:function(){return td(this,null,wr().mark((function e(){return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._pc.getStats());case 1:case"end":return e.stop()}}),e,this)})))}},{key:"send",value:function(e){return td(this,arguments,wr().mark((function e(t){var n,r,i,l,d,f,h,m,v,g,b,y,_,w,k,x;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.track,r=t.encodings,i=t.codecOptions,l=t.codec,this._assertSendDirection(),p.debug("send() [kind:%s, track.id:%s]",n.kind,n.id),l&&p.warn("send() | codec selection is not available in %s handler",this.name),this._sendStream.addTrack(n),this._pc.addTrack(n,this._sendStream),e.next=8,this._pc.createOffer();case 8:if(f=e.sent,h=a.parse(f.sdp),(v=s.clone(this._sendingRtpParametersByKind[n.kind],{})).codecs=o.reduceCodecs(v.codecs),(g=s.clone(this._sendingRemoteRtpParametersByKind[n.kind],{})).codecs=o.reduceCodecs(g.codecs),this._transportReady){e.next=17;break}return e.next=17,this._setupTransport({localDtlsRole:null!==(d=this._forcedLocalDtlsRole)&&void 0!==d?d:"client",localSdpObject:h});case 17:return"video"===n.kind&&r&&r.length>1&&(p.debug("send() | enabling simulcast"),h=a.parse(f.sdp),m=h.media.find((function(e){return"video"===e.type})),u.addLegacySimulcast({offerMediaObject:m,track:n,numStreams:r.length}),f={type:"offer",sdp:a.write(h)}),p.debug("send() | calling pc.setLocalDescription() [offer:%o]",f),e.next=21,this._pc.setLocalDescription(f);case 21:if(h=a.parse(this._pc.localDescription.sdp),m=h.media.find((function(e){return e.type===n.kind})),v.rtcp.cname=c.getCname({offerMediaObject:m}),v.encodings=u.getRtpEncodings({offerMediaObject:m,track:n}),r)for(b=0;b<v.encodings.length;++b)r[b]&&Object.assign(v.encodings[b],r[b]);if(v.encodings.length>1&&"video/vp8"===v.codecs[0].mimeType.toLowerCase()){y=kr(v.encodings);try{for(y.s();!(_=y.n()).done;)_.value.scalabilityMode="S1T3"}catch(S){y.e(S)}finally{y.f()}}return this._remoteSdp.send({offerMediaObject:m,offerRtpParameters:v,answerRtpParameters:g,codecOptions:i}),w={type:"answer",sdp:this._remoteSdp.getSdp()},p.debug("send() | calling pc.setRemoteDescription() [answer:%o]",w),e.next=32,this._pc.setRemoteDescription(w);case 32:return k=String(this._nextSendLocalId),this._nextSendLocalId++,x=this._pc.getSenders().find((function(e){return e.track===n})),this._mapSendLocalIdRtpSender.set(k,x),e.abrupt("return",{localId:k,rtpParameters:v,rtpSender:x});case 37:case"end":return e.stop()}}),e,this)})))}},{key:"stopSending",value:function(e){return td(this,null,wr().mark((function t(){var n,r,a;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._assertSendDirection(),n=this._mapSendLocalIdRtpSender.get(e)){t.next=4;break}throw new Error("associated RTCRtpSender not found");case 4:return n.track&&this._sendStream.removeTrack(n.track),this._mapSendLocalIdRtpSender.delete(e),t.next=8,this._pc.createOffer();case 8:return r=t.sent,p.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",r),t.prev=10,t.next=13,this._pc.setLocalDescription(r);case 13:t.next=21;break;case 15:if(t.prev=15,t.t0=t.catch(10),0!==this._sendStream.getTracks().length){t.next=20;break}return p.warn("stopSending() | ignoring expected error due no sending tracks: %s",t.t0.toString()),t.abrupt("return");case 20:throw t.t0;case 21:if("stable"!==this._pc.signalingState){t.next=23;break}return t.abrupt("return");case 23:return a={type:"answer",sdp:this._remoteSdp.getSdp()},p.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",a),t.next=27,this._pc.setRemoteDescription(a);case 27:case"end":return t.stop()}}),t,this,[[10,15]])})))}},{key:"replaceTrack",value:function(e,t){return td(this,null,wr().mark((function n(){var r,a;return wr().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(this._assertSendDirection(),t?p.debug("replaceTrack() [localId:%s, track.id:%s]",e,t.id):p.debug("replaceTrack() [localId:%s, no track]",e),r=this._mapSendLocalIdRtpSender.get(e)){n.next=5;break}throw new Error("associated RTCRtpSender not found");case 5:return a=r.track,n.next=8,r.replaceTrack(t);case 8:a&&this._sendStream.removeTrack(a),t&&this._sendStream.addTrack(t);case 10:case"end":return n.stop()}}),n,this)})))}},{key:"setMaxSpatialLayer",value:function(e,t){return td(this,null,wr().mark((function n(){var r,a;return wr().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(this._assertSendDirection(),p.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",e,t),r=this._mapSendLocalIdRtpSender.get(e)){n.next=5;break}throw new Error("associated RTCRtpSender not found");case 5:return(a=r.getParameters()).encodings.forEach((function(e,n){e.active=n<=t})),n.next=9,r.setParameters(a);case 9:case"end":return n.stop()}}),n,this)})))}},{key:"setRtpEncodingParameters",value:function(e,t){return td(this,null,wr().mark((function n(){var r,a;return wr().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(this._assertSendDirection(),p.debug("setRtpEncodingParameters() [localId:%s, params:%o]",e,t),r=this._mapSendLocalIdRtpSender.get(e)){n.next=5;break}throw new Error("associated RTCRtpSender not found");case 5:return(a=r.getParameters()).encodings.forEach((function(e,n){a.encodings[n]=Jl(Jl({},e),t)})),n.next=9,r.setParameters(a);case 9:case"end":return n.stop()}}),n,this)})))}},{key:"getSenderStats",value:function(e){return td(this,null,wr().mark((function t(){var n;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._assertSendDirection(),n=this._mapSendLocalIdRtpSender.get(e)){t.next=4;break}throw new Error("associated RTCRtpSender not found");case 4:return t.abrupt("return",n.getStats());case 5:case"end":return t.stop()}}),t,this)})))}},{key:"sendDataChannel",value:function(e){return td(this,arguments,wr().mark((function e(t){var n,r,i,s,o,c,u,l,d,h,m,v,g;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.ordered,r=t.maxPacketLifeTime,i=t.maxRetransmits,s=t.label,o=t.protocol,this._assertSendDirection(),u={negotiated:!0,id:this._nextSendSctpStreamId,ordered:n,maxPacketLifeTime:r,maxRetransmits:i,protocol:o},p.debug("sendDataChannel() [options:%o]",u),l=this._pc.createDataChannel(s,u),this._nextSendSctpStreamId=++this._nextSendSctpStreamId%f.MIS,this._hasDataChannelMediaSection){e.next=24;break}return e.next=9,this._pc.createOffer();case 9:if(d=e.sent,h=a.parse(d.sdp),m=h.media.find((function(e){return"application"===e.type})),this._transportReady){e.next=15;break}return e.next=15,this._setupTransport({localDtlsRole:null!==(c=this._forcedLocalDtlsRole)&&void 0!==c?c:"client",localSdpObject:h});case 15:return p.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",d),e.next=18,this._pc.setLocalDescription(d);case 18:return this._remoteSdp.sendSctpAssociation({offerMediaObject:m}),v={type:"answer",sdp:this._remoteSdp.getSdp()},p.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",v),e.next=23,this._pc.setRemoteDescription(v);case 23:this._hasDataChannelMediaSection=!0;case 24:return g={streamId:u.id,ordered:u.ordered,maxPacketLifeTime:u.maxPacketLifeTime,maxRetransmits:u.maxRetransmits},e.abrupt("return",{dataChannel:l,sctpStreamParameters:g});case 26:case"end":return e.stop()}}),e,this)})))}},{key:"receive",value:function(e){return td(this,null,wr().mark((function t(){var n,r,i,s,o,u,l,d,f,h,m,v,g,b,y,_,w,k,x=this;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this._assertRecvDirection(),r=[],i=kr(e);try{for(i.s();!(s=i.n()).done;)o=s.value,u=o.trackId,l=o.kind,d=o.rtpParameters,p.debug("receive() [trackId:%s, kind:%s]",u,l),f=l,this._remoteSdp.receive({mid:f,kind:l,offerRtpParameters:d,streamId:d.rtcp.cname,trackId:u})}catch(S){i.e(S)}finally{i.f()}return h={type:"offer",sdp:this._remoteSdp.getSdp()},p.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",h),t.next=8,this._pc.setRemoteDescription(h);case 8:return t.next=10,this._pc.createAnswer();case 10:m=t.sent,v=a.parse(m.sdp),g=kr(e);try{for(y=function(){var e=b.value,t=e.kind,n=e.rtpParameters,r=t,a=v.media.find((function(e){return String(e.mid)===r}));c.applyCodecParameters({offerRtpParameters:n,answerMediaObject:a})},g.s();!(b=g.n()).done;)y()}catch(S){g.e(S)}finally{g.f()}if(m={type:"answer",sdp:a.write(v)},this._transportReady){t.next=18;break}return t.next=18,this._setupTransport({localDtlsRole:null!==(n=this._forcedLocalDtlsRole)&&void 0!==n?n:"client",localSdpObject:v});case 18:return p.debug("receive() | calling pc.setLocalDescription() [answer:%o]",m),t.next=21,this._pc.setLocalDescription(m);case 21:_=kr(e);try{for(k=function(){var e=w.value,t=e.kind,n=e.trackId,a=e.rtpParameters,i=t,s=n,o=x._pc.getReceivers().find((function(e){return e.track&&e.track.id===s}));if(!o)throw new Error("new RTCRtpReceiver not");x._mapRecvLocalIdInfo.set(s,{mid:i,rtpParameters:a,rtpReceiver:o}),r.push({localId:s,track:o.track,rtpReceiver:o})},_.s();!(w=_.n()).done;)k()}catch(S){_.e(S)}finally{_.f()}return t.abrupt("return",r);case 24:case"end":return t.stop()}}),t,this)})))}},{key:"stopReceiving",value:function(e){return td(this,null,wr().mark((function t(){var n,r,a,i,s;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this._assertRecvDirection(),p.debug("stopReceiving() [localId:%s]",e),n=this._mapRecvLocalIdInfo.get(e)||{},r=n.mid,a=n.rtpParameters,this._mapRecvLocalIdInfo.delete(e),this._remoteSdp.planBStopReceiving({mid:r,offerRtpParameters:a}),i={type:"offer",sdp:this._remoteSdp.getSdp()},p.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",i),t.next=9,this._pc.setRemoteDescription(i);case 9:return t.next=11,this._pc.createAnswer();case 11:return s=t.sent,p.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",s),t.next=15,this._pc.setLocalDescription(s);case 15:case"end":return t.stop()}}),t,this)})))}},{key:"getReceiverStats",value:function(e){return td(this,null,wr().mark((function t(){var n,r;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._assertRecvDirection(),n=this._mapRecvLocalIdInfo.get(e)||{},r=n.rtpReceiver){t.next=4;break}throw new Error("associated RTCRtpReceiver not found");case 4:return t.abrupt("return",r.getStats());case 5:case"end":return t.stop()}}),t,this)})))}},{key:"pauseReceiving",value:function(e){return td(this,null,wr().mark((function e(){return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})))}},{key:"resumeReceiving",value:function(e){return td(this,null,wr().mark((function e(){return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})))}},{key:"receiveDataChannel",value:function(e){return td(this,arguments,wr().mark((function e(t){var n,r,i,s,o,c,u,l,d,f,h,m,v;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.sctpStreamParameters,r=t.label,i=t.protocol,this._assertRecvDirection(),o=n.streamId,c=n.ordered,u=n.maxPacketLifeTime,l=n.maxRetransmits,d={negotiated:!0,id:o,ordered:c,maxPacketLifeTime:u,maxRetransmits:l,protocol:i},p.debug("receiveDataChannel() [options:%o]",d),f=this._pc.createDataChannel(r,d),this._hasDataChannelMediaSection){e.next=23;break}return this._remoteSdp.receiveSctpAssociation({oldDataChannelSpec:!0}),h={type:"offer",sdp:this._remoteSdp.getSdp()},p.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",h),e.next=12,this._pc.setRemoteDescription(h);case 12:return e.next=14,this._pc.createAnswer();case 14:if(m=e.sent,this._transportReady){e.next=19;break}return v=a.parse(m.sdp),e.next=19,this._setupTransport({localDtlsRole:null!==(s=this._forcedLocalDtlsRole)&&void 0!==s?s:"client",localSdpObject:v});case 19:return p.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",m),e.next=22,this._pc.setLocalDescription(m);case 22:this._hasDataChannelMediaSection=!0;case 23:return e.abrupt("return",{dataChannel:f});case 24:case"end":return e.stop()}}),e,this)})))}},{key:"_setupTransport",value:function(e){return td(this,arguments,wr().mark((function e(t){var n,r,i;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.localDtlsRole,(r=t.localSdpObject)||(r=a.parse(this._pc.localDescription.sdp)),(i=c.extractDtlsParameters({sdpObject:r})).role=n,this._remoteSdp.updateDtlsRole("client"===n?"server":"client"),e.next=7,this.safeEmitAsPromise("@connect",{dtlsParameters:i});case 7:this._transportReady=!0;case 8:case"end":return e.stop()}}),e,this)})))}},{key:"_assertSendDirection",value:function(){if("send"!==this._direction)throw new Error('method can just be called for handlers with "send" direction')}},{key:"_assertRecvDirection",value:function(){if("recv"!==this._direction)throw new Error('method can just be called for handlers with "recv" direction')}}],[{key:"createFactory",value:function(){return function(){return new n}}}]),n}(l.HandlerInterface);e.Safari11=h}}),gp=Zl({"../../node_modules/mediasoup-client/lib/handlers/ortc/edgeUtils.js":function(e){nd();var t=e&&e.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var a=Object.getOwnPropertyDescriptor(t,n);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,a)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),n=e&&e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=e&&e.__importStar||function(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var a in e)"default"!==a&&Object.prototype.hasOwnProperty.call(e,a)&&t(r,e,a);return n(r,e),r};Object.defineProperty(e,"__esModule",{value:!0}),e.mangleRtpParameters=e.getCapabilities=void 0;var a=r(Xd());e.getCapabilities=function(){var e,t=RTCRtpReceiver.getCapabilities(),n=a.clone(t,{}),r=kr(n.codecs);try{for(r.s();!(e=r.n()).done;){var i=e.value;if(i.channels=i.numChannels,delete i.numChannels,i.mimeType=i.mimeType||"".concat(i.kind,"/").concat(i.name),i.parameters){var s=i.parameters;s.apt&&(s.apt=Number(s.apt)),s["packetization-mode"]&&(s["packetization-mode"]=Number(s["packetization-mode"]))}var o,c=kr(i.rtcpFeedback||[]);try{for(c.s();!(o=c.n()).done;){var u=o.value;u.parameter||(u.parameter="")}}catch(l){c.e(l)}finally{c.f()}}}catch(l){r.e(l)}finally{r.f()}return n},e.mangleRtpParameters=function(e){var t=a.clone(e,{});t.mid&&(t.muxId=t.mid,delete t.mid);var n,r=kr(t.codecs);try{for(r.s();!(n=r.n()).done;){var i=n.value;i.channels&&(i.numChannels=i.channels,delete i.channels),i.mimeType&&!i.name&&(i.name=i.mimeType.split("/")[1]),delete i.mimeType}}catch(s){r.e(s)}finally{r.f()}return t}}}),bp=Zl({"../../node_modules/mediasoup-client/lib/handlers/Edge11.js":function(e){nd();var t=e&&e.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var a=Object.getOwnPropertyDescriptor(t,n);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,a)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),n=e&&e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=e&&e.__importStar||function(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var a in e)"default"!==a&&Object.prototype.hasOwnProperty.call(e,a)&&t(r,e,a);return n(r,e),r};Object.defineProperty(e,"__esModule",{value:!0}),e.Edge11=void 0;var a=Wd(),i=Kd(),s=r(Xd()),o=r($d()),c=r(gp()),u=ip(),l=new a.Logger("Edge11"),d=function(e){mn(n,e);var t=_n(n);function n(){var e;return St(this,n),(e=t.call(this))._rtpSenders=new Map,e._rtpReceivers=new Map,e._nextSendLocalId=0,e._transportReady=!1,e}return Pt(n,[{key:"name",get:function(){return"Edge11"}},{key:"close",value:function(){l.debug("close()");try{this._iceGatherer.close()}catch(s){}try{this._iceTransport.stop()}catch(s){}try{this._dtlsTransport.stop()}catch(s){}var e,t=kr(this._rtpSenders.values());try{for(t.s();!(e=t.n()).done;){var n=e.value;try{n.stop()}catch(s){}}}catch(o){t.e(o)}finally{t.f()}var r,a=kr(this._rtpReceivers.values());try{for(a.s();!(r=a.n()).done;){var i=r.value;try{i.stop()}catch(s){}}}catch(o){a.e(o)}finally{a.f()}}},{key:"getNativeRtpCapabilities",value:function(){return td(this,null,wr().mark((function e(){return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l.debug("getNativeRtpCapabilities()"),e.abrupt("return",c.getCapabilities());case 2:case"end":return e.stop()}}),e)})))}},{key:"getNativeSctpCapabilities",value:function(){return td(this,null,wr().mark((function e(){return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l.debug("getNativeSctpCapabilities()"),e.abrupt("return",{numStreams:{OS:0,MIS:0}});case 2:case"end":return e.stop()}}),e)})))}},{key:"run",value:function(e){e.direction;var t=e.iceParameters,n=e.iceCandidates,r=e.dtlsParameters,a=(e.sctpParameters,e.iceServers),i=e.iceTransportPolicy,c=(e.additionalSettings,e.proprietaryConstraints,e.extendedRtpCapabilities);l.debug("run()"),this._sendingRtpParametersByKind={audio:o.getSendingRtpParameters("audio",c),video:o.getSendingRtpParameters("video",c)},this._remoteIceParameters=t,this._remoteIceCandidates=n,this._remoteDtlsParameters=r,this._cname="CNAME-".concat(s.generateRandomNumber()),this._setIceGatherer({iceServers:a,iceTransportPolicy:i}),this._setIceTransport(),this._setDtlsTransport()}},{key:"updateIceServers",value:function(e){return td(this,null,wr().mark((function e(){return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new i.UnsupportedError("not supported");case 1:case"end":return e.stop()}}),e)})))}},{key:"restartIce",value:function(e){return td(this,null,wr().mark((function t(){var n,r,a;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(l.debug("restartIce()"),this._remoteIceParameters=e,this._transportReady){t.next=4;break}return t.abrupt("return");case 4:l.debug("restartIce() | calling iceTransport.start()"),this._iceTransport.start(this._iceGatherer,e,"controlling"),n=kr(this._remoteIceCandidates);try{for(n.s();!(r=n.n()).done;)a=r.value,this._iceTransport.addRemoteCandidate(a)}catch(i){n.e(i)}finally{n.f()}this._iceTransport.addRemoteCandidate({});case 9:case"end":return t.stop()}}),t,this)})))}},{key:"getTransportStats",value:function(){return td(this,null,wr().mark((function e(){return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._iceTransport.getStats());case 1:case"end":return e.stop()}}),e,this)})))}},{key:"send",value:function(e){return td(this,arguments,wr().mark((function e(t){var n,r,a,i,u,d,p,f,h,m,v;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.track,r=t.encodings,t.codecOptions,a=t.codec,l.debug("send() [kind:%s, track.id:%s]",n.kind,n.id),this._transportReady){e.next=5;break}return e.next=5,this._setupTransport({localDtlsRole:"server"});case 5:l.debug("send() | calling new RTCRtpSender()"),i=new RTCRtpSender(n,this._dtlsTransport),(u=s.clone(this._sendingRtpParametersByKind[n.kind],{})).codecs=o.reduceCodecs(u.codecs,a),d=u.codecs.some((function(e){return/.+\/rtx$/i.test(e.mimeType)})),r||(r=[{}]),p=kr(r);try{for(p.s();!(f=p.n()).done;)(h=f.value).ssrc=s.generateRandomNumber(),d&&(h.rtx={ssrc:s.generateRandomNumber()})}catch(g){p.e(g)}finally{p.f()}return u.encodings=r,u.rtcp={cname:this._cname,reducedSize:!0,mux:!0},m=c.mangleRtpParameters(u),l.debug("send() | calling rtpSender.send() [params:%o]",m),e.next=19,i.send(m);case 19:return v=String(this._nextSendLocalId),this._nextSendLocalId++,this._rtpSenders.set(v,i),e.abrupt("return",{localId:v,rtpParameters:u,rtpSender:i});case 23:case"end":return e.stop()}}),e,this)})))}},{key:"stopSending",value:function(e){return td(this,null,wr().mark((function t(){var n;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(l.debug("stopSending() [localId:%s]",e),n=this._rtpSenders.get(e)){t.next=4;break}throw new Error("RTCRtpSender not found");case 4:this._rtpSenders.delete(e),t.prev=5,l.debug("stopSending() | calling rtpSender.stop()"),n.stop(),t.next=14;break;case 10:throw t.prev=10,t.t0=t.catch(5),l.warn("stopSending() | rtpSender.stop() failed:%o",t.t0),t.t0;case 14:case"end":return t.stop()}}),t,this,[[5,10]])})))}},{key:"replaceTrack",value:function(e,t){return td(this,null,wr().mark((function n(){var r;return wr().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(t?l.debug("replaceTrack() [localId:%s, track.id:%s]",e,t.id):l.debug("replaceTrack() [localId:%s, no track]",e),r=this._rtpSenders.get(e)){n.next=4;break}throw new Error("RTCRtpSender not found");case 4:r.setTrack(t);case 5:case"end":return n.stop()}}),n,this)})))}},{key:"setMaxSpatialLayer",value:function(e,t){return td(this,null,wr().mark((function n(){var r,a;return wr().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(l.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",e,t),r=this._rtpSenders.get(e)){n.next=4;break}throw new Error("RTCRtpSender not found");case 4:return(a=r.getParameters()).encodings.forEach((function(e,n){e.active=n<=t})),n.next=8,r.setParameters(a);case 8:case"end":return n.stop()}}),n,this)})))}},{key:"setRtpEncodingParameters",value:function(e,t){return td(this,null,wr().mark((function n(){var r,a;return wr().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(l.debug("setRtpEncodingParameters() [localId:%s, params:%o]",e,t),r=this._rtpSenders.get(e)){n.next=4;break}throw new Error("RTCRtpSender not found");case 4:return(a=r.getParameters()).encodings.forEach((function(e,n){a.encodings[n]=Jl(Jl({},e),t)})),n.next=8,r.setParameters(a);case 8:case"end":return n.stop()}}),n,this)})))}},{key:"getSenderStats",value:function(e){return td(this,null,wr().mark((function t(){var n;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=this._rtpSenders.get(e)){t.next=3;break}throw new Error("RTCRtpSender not found");case 3:return t.abrupt("return",n.getStats());case 4:case"end":return t.stop()}}),t,this)})))}},{key:"sendDataChannel",value:function(e){return td(this,null,wr().mark((function e(){return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new i.UnsupportedError("not implemented");case 1:case"end":return e.stop()}}),e)})))}},{key:"receive",value:function(e){return td(this,null,wr().mark((function t(){var n,r,a,i,s,o,u,d,p,f,h,m,v,g,b;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=[],r=kr(e);try{for(r.s();!(a=r.n()).done;)i=a.value,s=i.trackId,o=i.kind,l.debug("receive() [trackId:%s, kind:%s]",s,o)}catch(y){r.e(y)}finally{r.f()}if(this._transportReady){t.next=6;break}return t.next=6,this._setupTransport({localDtlsRole:"server"});case 6:u=kr(e),t.prev=7,u.s();case 9:if((d=u.n()).done){t.next=24;break}return p=d.value,f=p.trackId,h=p.kind,m=p.rtpParameters,l.debug("receive() | calling new RTCRtpReceiver()"),(v=new RTCRtpReceiver(this._dtlsTransport,h)).addEventListener("error",(function(e){l.error('rtpReceiver "error" event [event:%o]',e)})),g=c.mangleRtpParameters(m),l.debug("receive() | calling rtpReceiver.receive() [params:%o]",g),t.next=19,v.receive(g);case 19:b=f,this._rtpReceivers.set(b,v),n.push({localId:b,track:v.track,rtpReceiver:v});case 22:t.next=9;break;case 24:t.next=29;break;case 26:t.prev=26,t.t0=t.catch(7),u.e(t.t0);case 29:return t.prev=29,u.f(),t.finish(29);case 32:return t.abrupt("return",n);case 33:case"end":return t.stop()}}),t,this,[[7,26,29,32]])})))}},{key:"stopReceiving",value:function(e){return td(this,null,wr().mark((function t(){var n;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(l.debug("stopReceiving() [localId:%s]",e),n=this._rtpReceivers.get(e)){t.next=4;break}throw new Error("RTCRtpReceiver not found");case 4:this._rtpReceivers.delete(e);try{l.debug("stopReceiving() | calling rtpReceiver.stop()"),n.stop()}catch(r){l.warn("stopReceiving() | rtpReceiver.stop() failed:%o",r)}case 6:case"end":return t.stop()}}),t,this)})))}},{key:"pauseReceiving",value:function(e){return td(this,null,wr().mark((function e(){return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})))}},{key:"resumeReceiving",value:function(e){return td(this,null,wr().mark((function e(){return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})))}},{key:"getReceiverStats",value:function(e){return td(this,null,wr().mark((function t(){var n;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=this._rtpReceivers.get(e)){t.next=3;break}throw new Error("RTCRtpReceiver not found");case 3:return t.abrupt("return",n.getStats());case 4:case"end":return t.stop()}}),t,this)})))}},{key:"receiveDataChannel",value:function(e){return td(this,null,wr().mark((function e(){return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new i.UnsupportedError("not implemented");case 1:case"end":return e.stop()}}),e)})))}},{key:"_setIceGatherer",value:function(e){var t=e.iceServers,n=e.iceTransportPolicy,r=new RTCIceGatherer({iceServers:t||[],gatherPolicy:n||"all"});r.addEventListener("error",(function(e){l.error('iceGatherer "error" event [event:%o]',e)}));try{r.gather()}catch(a){l.debug("_setIceGatherer() | iceGatherer.gather() failed: %s",a.toString())}this._iceGatherer=r}},{key:"_setIceTransport",value:function(){var e=this,t=new RTCIceTransport(this._iceGatherer);t.addEventListener("statechange",(function(){switch(t.state){case"checking":e.emit("@connectionstatechange","connecting");break;case"connected":case"completed":e.emit("@connectionstatechange","connected");break;case"failed":e.emit("@connectionstatechange","failed");break;case"disconnected":e.emit("@connectionstatechange","disconnected");break;case"closed":e.emit("@connectionstatechange","closed")}})),t.addEventListener("icestatechange",(function(){switch(t.state){case"checking":e.emit("@connectionstatechange","connecting");break;case"connected":case"completed":e.emit("@connectionstatechange","connected");break;case"failed":e.emit("@connectionstatechange","failed");break;case"disconnected":e.emit("@connectionstatechange","disconnected");break;case"closed":e.emit("@connectionstatechange","closed")}})),t.addEventListener("candidatepairchange",(function(e){l.debug('iceTransport "candidatepairchange" event [pair:%o]',e.pair)})),this._iceTransport=t}},{key:"_setDtlsTransport",value:function(){var e=this,t=new RTCDtlsTransport(this._iceTransport);t.addEventListener("statechange",(function(){l.debug('dtlsTransport "statechange" event [state:%s]',t.state)})),t.addEventListener("dtlsstatechange",(function(){l.debug('dtlsTransport "dtlsstatechange" event [state:%s]',t.state),"closed"===t.state&&e.emit("@connectionstatechange","closed")})),t.addEventListener("error",(function(e){l.error('dtlsTransport "error" event [event:%o]',e)})),this._dtlsTransport=t}},{key:"_setupTransport",value:function(e){return td(this,arguments,wr().mark((function e(t){var n,r,a,i,s;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.localDtlsRole,l.debug("_setupTransport()"),(r=this._dtlsTransport.getLocalParameters()).role=n,e.next=6,this.safeEmitAsPromise("@connect",{dtlsParameters:r});case 6:this._iceTransport.start(this._iceGatherer,this._remoteIceParameters,"controlling"),a=kr(this._remoteIceCandidates);try{for(a.s();!(i=a.n()).done;)s=i.value,this._iceTransport.addRemoteCandidate(s)}catch(o){a.e(o)}finally{a.f()}this._iceTransport.addRemoteCandidate({}),this._remoteDtlsParameters.fingerprints=this._remoteDtlsParameters.fingerprints.filter((function(e){return"sha-256"===e.algorithm||"sha-384"===e.algorithm||"sha-512"===e.algorithm})),this._dtlsTransport.start(this._remoteDtlsParameters),this._transportReady=!0;case 13:case"end":return e.stop()}}),e,this)})))}}],[{key:"createFactory",value:function(){return function(){return new n}}}]),n}(u.HandlerInterface);e.Edge11=d}}),yp=Zl({"../../node_modules/mediasoup-client/lib/handlers/ReactNative.js":function(e){nd();var t=e&&e.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var a=Object.getOwnPropertyDescriptor(t,n);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,a)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),n=e&&e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=e&&e.__importStar||function(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var a in e)"default"!==a&&Object.prototype.hasOwnProperty.call(e,a)&&t(r,e,a);return n(r,e),r};Object.defineProperty(e,"__esModule",{value:!0}),e.ReactNative=void 0;var a=r(Bd()),i=Wd(),s=Kd(),o=r(Xd()),c=r($d()),u=r(rp()),l=r(dp()),d=ip(),p=op(),f=new i.Logger("ReactNative"),h={OS:1024,MIS:1024},m=function(e){mn(n,e);var t=_n(n);function n(){var e;return St(this,n),(e=t.call(this))._sendStream=new MediaStream,e._mapSendLocalIdTrack=new Map,e._nextSendLocalId=0,e._mapRecvLocalIdInfo=new Map,e._hasDataChannelMediaSection=!1,e._nextSendSctpStreamId=0,e._transportReady=!1,e}return Pt(n,[{key:"name",get:function(){return"ReactNative"}},{key:"close",value:function(){if(f.debug("close()"),this._sendStream.release(!1),this._pc)try{this._pc.close()}catch(e){}}},{key:"getNativeRtpCapabilities",value:function(){return td(this,null,wr().mark((function e(){var t,n,r,i;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return f.debug("getNativeRtpCapabilities()"),t=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"plan-b"}),e.prev=2,e.next=5,t.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0});case 5:n=e.sent;try{t.close()}catch(s){}return r=a.parse(n.sdp),i=u.extractRtpCapabilities({sdpObject:r}),e.abrupt("return",i);case 12:e.prev=12,e.t0=e.catch(2);try{t.close()}catch(o){}throw e.t0;case 16:case"end":return e.stop()}}),e,null,[[2,12]])})))}},{key:"getNativeSctpCapabilities",value:function(){return td(this,null,wr().mark((function e(){return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return f.debug("getNativeSctpCapabilities()"),e.abrupt("return",{numStreams:h});case 2:case"end":return e.stop()}}),e)})))}},{key:"run",value:function(e){var t=this,n=e.direction,r=e.iceParameters,a=e.iceCandidates,i=e.dtlsParameters,s=e.sctpParameters,o=e.iceServers,u=e.iceTransportPolicy,l=e.additionalSettings,d=e.proprietaryConstraints,h=e.extendedRtpCapabilities;f.debug("run()"),this._direction=n,this._remoteSdp=new p.RemoteSdp({iceParameters:r,iceCandidates:a,dtlsParameters:i,sctpParameters:s,planB:!0}),this._sendingRtpParametersByKind={audio:c.getSendingRtpParameters("audio",h),video:c.getSendingRtpParameters("video",h)},this._sendingRemoteRtpParametersByKind={audio:c.getSendingRemoteRtpParameters("audio",h),video:c.getSendingRemoteRtpParameters("video",h)},i.role&&"auto"!==i.role&&(this._forcedLocalDtlsRole="server"===i.role?"client":"server"),this._pc=new RTCPeerConnection(Jl({iceServers:o||[],iceTransportPolicy:u||"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"plan-b"},l),d),this._pc.addEventListener("iceconnectionstatechange",(function(){switch(t._pc.iceConnectionState){case"checking":t.emit("@connectionstatechange","connecting");break;case"connected":case"completed":t.emit("@connectionstatechange","connected");break;case"failed":t.emit("@connectionstatechange","failed");break;case"disconnected":t.emit("@connectionstatechange","disconnected");break;case"closed":t.emit("@connectionstatechange","closed")}}))}},{key:"updateIceServers",value:function(e){return td(this,null,wr().mark((function t(){var n;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:f.debug("updateIceServers()"),(n=this._pc.getConfiguration()).iceServers=e,this._pc.setConfiguration(n);case 4:case"end":return t.stop()}}),t,this)})))}},{key:"restartIce",value:function(e){return td(this,null,wr().mark((function t(){var n,r,a,i;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(f.debug("restartIce()"),this._remoteSdp.updateIceParameters(e),this._transportReady){t.next=4;break}return t.abrupt("return");case 4:if("send"!==this._direction){t.next=17;break}return t.next=7,this._pc.createOffer({iceRestart:!0});case 7:return n=t.sent,f.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",n),t.next=11,this._pc.setLocalDescription(n);case 11:return r={type:"answer",sdp:this._remoteSdp.getSdp()},f.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",r),t.next=15,this._pc.setRemoteDescription(r);case 15:t.next=27;break;case 17:return a={type:"offer",sdp:this._remoteSdp.getSdp()},f.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",a),t.next=21,this._pc.setRemoteDescription(a);case 21:return t.next=23,this._pc.createAnswer();case 23:return i=t.sent,f.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",i),t.next=27,this._pc.setLocalDescription(i);case 27:case"end":return t.stop()}}),t,this)})))}},{key:"getTransportStats",value:function(){return td(this,null,wr().mark((function e(){return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._pc.getStats());case 1:case"end":return e.stop()}}),e,this)})))}},{key:"send",value:function(e){return td(this,arguments,wr().mark((function e(t){var n,r,i,s,d,p,h,m,v,g,b,y,_,w,k;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.track,r=t.encodings,i=t.codecOptions,s=t.codec,this._assertSendDirection(),f.debug("send() [kind:%s, track.id:%s]",n.kind,n.id),s&&f.warn("send() | codec selection is not available in %s handler",this.name),this._sendStream.addTrack(n),this._pc.addStream(this._sendStream),e.next=8,this._pc.createOffer();case 8:if(p=e.sent,h=a.parse(p.sdp),(v=o.clone(this._sendingRtpParametersByKind[n.kind],{})).codecs=c.reduceCodecs(v.codecs),(g=o.clone(this._sendingRemoteRtpParametersByKind[n.kind],{})).codecs=c.reduceCodecs(g.codecs),this._transportReady){e.next=17;break}return e.next=17,this._setupTransport({localDtlsRole:null!==(d=this._forcedLocalDtlsRole)&&void 0!==d?d:"client",localSdpObject:h});case 17:return"video"===n.kind&&r&&r.length>1&&(f.debug("send() | enabling simulcast"),h=a.parse(p.sdp),m=h.media.find((function(e){return"video"===e.type})),l.addLegacySimulcast({offerMediaObject:m,track:n,numStreams:r.length}),p={type:"offer",sdp:a.write(h)}),f.debug("send() | calling pc.setLocalDescription() [offer:%o]",p),e.next=21,this._pc.setLocalDescription(p);case 21:if(h=a.parse(this._pc.localDescription.sdp),m=h.media.find((function(e){return e.type===n.kind})),v.rtcp.cname=u.getCname({offerMediaObject:m}),v.encodings=l.getRtpEncodings({offerMediaObject:m,track:n}),r)for(b=0;b<v.encodings.length;++b)r[b]&&Object.assign(v.encodings[b],r[b]);if(v.encodings.length>1&&("video/vp8"===v.codecs[0].mimeType.toLowerCase()||"video/h264"===v.codecs[0].mimeType.toLowerCase())){y=kr(v.encodings);try{for(y.s();!(_=y.n()).done;)_.value.scalabilityMode="S1T3"}catch(x){y.e(x)}finally{y.f()}}return this._remoteSdp.send({offerMediaObject:m,offerRtpParameters:v,answerRtpParameters:g,codecOptions:i}),w={type:"answer",sdp:this._remoteSdp.getSdp()},f.debug("send() | calling pc.setRemoteDescription() [answer:%o]",w),e.next=32,this._pc.setRemoteDescription(w);case 32:return k=String(this._nextSendLocalId),this._nextSendLocalId++,this._mapSendLocalIdTrack.set(k,n),e.abrupt("return",{localId:k,rtpParameters:v});case 36:case"end":return e.stop()}}),e,this)})))}},{key:"stopSending",value:function(e){return td(this,null,wr().mark((function t(){var n,r,a;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._assertSendDirection(),f.debug("stopSending() [localId:%s]",e),n=this._mapSendLocalIdTrack.get(e)){t.next=5;break}throw new Error("track not found");case 5:return this._mapSendLocalIdTrack.delete(e),this._sendStream.removeTrack(n),this._pc.addStream(this._sendStream),t.next=10,this._pc.createOffer();case 10:return r=t.sent,f.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",r),t.prev=12,t.next=15,this._pc.setLocalDescription(r);case 15:t.next=23;break;case 17:if(t.prev=17,t.t0=t.catch(12),0!==this._sendStream.getTracks().length){t.next=22;break}return f.warn("stopSending() | ignoring expected error due no sending tracks: %s",t.t0.toString()),t.abrupt("return");case 22:throw t.t0;case 23:if("stable"!==this._pc.signalingState){t.next=25;break}return t.abrupt("return");case 25:return a={type:"answer",sdp:this._remoteSdp.getSdp()},f.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",a),t.next=29,this._pc.setRemoteDescription(a);case 29:case"end":return t.stop()}}),t,this,[[12,17]])})))}},{key:"replaceTrack",value:function(e,t){return td(this,null,wr().mark((function e(){return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new s.UnsupportedError("not implemented");case 1:case"end":return e.stop()}}),e)})))}},{key:"setMaxSpatialLayer",value:function(e,t){return td(this,null,wr().mark((function e(){return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new s.UnsupportedError("not implemented");case 1:case"end":return e.stop()}}),e)})))}},{key:"setRtpEncodingParameters",value:function(e,t){return td(this,null,wr().mark((function e(){return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new s.UnsupportedError("not implemented");case 1:case"end":return e.stop()}}),e)})))}},{key:"getSenderStats",value:function(e){return td(this,null,wr().mark((function e(){return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new s.UnsupportedError("not implemented");case 1:case"end":return e.stop()}}),e)})))}},{key:"sendDataChannel",value:function(e){return td(this,arguments,wr().mark((function e(t){var n,r,i,s,o,c,u,l,d,p,m,v,g;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.ordered,r=t.maxPacketLifeTime,i=t.maxRetransmits,s=t.label,o=t.protocol,this._assertSendDirection(),u={negotiated:!0,id:this._nextSendSctpStreamId,ordered:n,maxPacketLifeTime:r,maxRetransmitTime:r,maxRetransmits:i,protocol:o},f.debug("sendDataChannel() [options:%o]",u),l=this._pc.createDataChannel(s,u),this._nextSendSctpStreamId=++this._nextSendSctpStreamId%h.MIS,this._hasDataChannelMediaSection){e.next=24;break}return e.next=9,this._pc.createOffer();case 9:if(d=e.sent,p=a.parse(d.sdp),m=p.media.find((function(e){return"application"===e.type})),this._transportReady){e.next=15;break}return e.next=15,this._setupTransport({localDtlsRole:null!==(c=this._forcedLocalDtlsRole)&&void 0!==c?c:"client",localSdpObject:p});case 15:return f.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",d),e.next=18,this._pc.setLocalDescription(d);case 18:return this._remoteSdp.sendSctpAssociation({offerMediaObject:m}),v={type:"answer",sdp:this._remoteSdp.getSdp()},f.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",v),e.next=23,this._pc.setRemoteDescription(v);case 23:this._hasDataChannelMediaSection=!0;case 24:return g={streamId:u.id,ordered:u.ordered,maxPacketLifeTime:u.maxPacketLifeTime,maxRetransmits:u.maxRetransmits},e.abrupt("return",{dataChannel:l,sctpStreamParameters:g});case 26:case"end":return e.stop()}}),e,this)})))}},{key:"receive",value:function(e){return td(this,null,wr().mark((function t(){var n,r,i,s,c,l,d,p,h,m,v,g,b,y,_,w,k,x,S,R,P=this;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this._assertRecvDirection(),r=[],i=new Map,s=kr(e);try{for(s.s();!(c=s.n()).done;)l=c.value,d=l.trackId,p=l.kind,h=l.rtpParameters,f.debug("receive() [trackId:%s, kind:%s]",d,p),m=p,v=h.rtcp.cname,f.debug("receive() | forcing a random remote streamId to avoid well known bug in react-native-webrtc"),v+="-hack-".concat(o.generateRandomNumber()),i.set(d,v),this._remoteSdp.receive({mid:m,kind:p,offerRtpParameters:h,streamId:v,trackId:d})}catch(C){s.e(C)}finally{s.f()}return g={type:"offer",sdp:this._remoteSdp.getSdp()},f.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",g),t.next=9,this._pc.setRemoteDescription(g);case 9:return t.next=11,this._pc.createAnswer();case 11:b=t.sent,y=a.parse(b.sdp),_=kr(e);try{for(k=function(){var e=w.value,t=e.kind,n=e.rtpParameters,r=t,a=y.media.find((function(e){return String(e.mid)===r}));u.applyCodecParameters({offerRtpParameters:n,answerMediaObject:a})},_.s();!(w=_.n()).done;)k()}catch(C){_.e(C)}finally{_.f()}if(b={type:"answer",sdp:a.write(y)},this._transportReady){t.next=19;break}return t.next=19,this._setupTransport({localDtlsRole:null!==(n=this._forcedLocalDtlsRole)&&void 0!==n?n:"client",localSdpObject:y});case 19:return f.debug("receive() | calling pc.setLocalDescription() [answer:%o]",b),t.next=22,this._pc.setLocalDescription(b);case 22:x=kr(e);try{for(R=function(){var e=S.value,t=e.kind,n=e.trackId,a=e.rtpParameters,s=n,o=t,c=i.get(n),u=P._pc.getRemoteStreams().find((function(e){return e.id===c})).getTrackById(s);if(!u)throw new Error("remote track not found");P._mapRecvLocalIdInfo.set(s,{mid:o,rtpParameters:a}),r.push({localId:s,track:u})},x.s();!(S=x.n()).done;)R()}catch(C){x.e(C)}finally{x.f()}return t.abrupt("return",r);case 25:case"end":return t.stop()}}),t,this)})))}},{key:"stopReceiving",value:function(e){return td(this,null,wr().mark((function t(){var n,r,a,i,s;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this._assertRecvDirection(),f.debug("stopReceiving() [localId:%s]",e),n=this._mapRecvLocalIdInfo.get(e)||{},r=n.mid,a=n.rtpParameters,this._mapRecvLocalIdInfo.delete(e),this._remoteSdp.planBStopReceiving({mid:r,offerRtpParameters:a}),i={type:"offer",sdp:this._remoteSdp.getSdp()},f.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",i),t.next=9,this._pc.setRemoteDescription(i);case 9:return t.next=11,this._pc.createAnswer();case 11:return s=t.sent,f.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",s),t.next=15,this._pc.setLocalDescription(s);case 15:case"end":return t.stop()}}),t,this)})))}},{key:"pauseReceiving",value:function(e){return td(this,null,wr().mark((function e(){return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})))}},{key:"resumeReceiving",value:function(e){return td(this,null,wr().mark((function e(){return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})))}},{key:"getReceiverStats",value:function(e){return td(this,null,wr().mark((function e(){return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new s.UnsupportedError("not implemented");case 1:case"end":return e.stop()}}),e)})))}},{key:"receiveDataChannel",value:function(e){return td(this,arguments,wr().mark((function e(t){var n,r,i,s,o,c,u,l,d,p,h,m,v;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.sctpStreamParameters,r=t.label,i=t.protocol,this._assertRecvDirection(),o=n.streamId,c=n.ordered,u=n.maxPacketLifeTime,l=n.maxRetransmits,d={negotiated:!0,id:o,ordered:c,maxPacketLifeTime:u,maxRetransmitTime:u,maxRetransmits:l,protocol:i},f.debug("receiveDataChannel() [options:%o]",d),p=this._pc.createDataChannel(r,d),this._hasDataChannelMediaSection){e.next=23;break}return this._remoteSdp.receiveSctpAssociation({oldDataChannelSpec:!0}),h={type:"offer",sdp:this._remoteSdp.getSdp()},f.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",h),e.next=12,this._pc.setRemoteDescription(h);case 12:return e.next=14,this._pc.createAnswer();case 14:if(m=e.sent,this._transportReady){e.next=19;break}return v=a.parse(m.sdp),e.next=19,this._setupTransport({localDtlsRole:null!==(s=this._forcedLocalDtlsRole)&&void 0!==s?s:"client",localSdpObject:v});case 19:return f.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",m),e.next=22,this._pc.setLocalDescription(m);case 22:this._hasDataChannelMediaSection=!0;case 23:return e.abrupt("return",{dataChannel:p});case 24:case"end":return e.stop()}}),e,this)})))}},{key:"_setupTransport",value:function(e){return td(this,arguments,wr().mark((function e(t){var n,r,i;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.localDtlsRole,(r=t.localSdpObject)||(r=a.parse(this._pc.localDescription.sdp)),(i=u.extractDtlsParameters({sdpObject:r})).role=n,this._remoteSdp.updateDtlsRole("client"===n?"server":"client"),e.next=7,this.safeEmitAsPromise("@connect",{dtlsParameters:i});case 7:this._transportReady=!0;case 8:case"end":return e.stop()}}),e,this)})))}},{key:"_assertSendDirection",value:function(){if("send"!==this._direction)throw new Error('method can just be called for handlers with "send" direction')}},{key:"_assertRecvDirection",value:function(){if("recv"!==this._direction)throw new Error('method can just be called for handlers with "recv" direction')}}],[{key:"createFactory",value:function(){return function(){return new n}}}]),n}(d.HandlerInterface);e.ReactNative=m}}),_p=Zl({"../../node_modules/mediasoup-client/lib/Device.js":function(e){nd();var t=e&&e.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var a=Object.getOwnPropertyDescriptor(t,n);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,a)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),n=e&&e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=e&&e.__importStar||function(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var a in e)"default"!==a&&Object.prototype.hasOwnProperty.call(e,a)&&t(r,e,a);return n(r,e),r},a=e&&e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(e,"__esModule",{value:!0}),e.Device=e.detectDevice=void 0;var i=a(Hd()),s=Wd(),o=Gd(),c=Kd(),u=r(Xd()),l=r($d()),d=np(),p=up(),f=lp(),h=pp(),m=fp(),v=hp(),g=mp(),b=vp(),y=bp(),_=yp(),w=new s.Logger("Device");function k(){if("object"===typeof navigator&&"ReactNative"===navigator.product)return"undefined"===typeof RTCPeerConnection?void w.warn("this._detectDevice() | unsupported ReactNative without RTCPeerConnection"):(w.debug("this._detectDevice() | ReactNative handler chosen"),"ReactNative");if("object"!==typeof navigator||"string"!==typeof navigator.userAgent)w.warn("this._detectDevice() | unknown device");else{var e=navigator.userAgent,t=i.default.getParser(e),n=t.getEngine();if(t.satisfies({chrome:">=74",chromium:">=74","microsoft edge":">=88"}))return"Chrome74";if(t.satisfies({chrome:">=70",chromium:">=70"}))return"Chrome70";if(t.satisfies({chrome:">=67",chromium:">=67"}))return"Chrome67";if(t.satisfies({chrome:">=55",chromium:">=55"}))return"Chrome55";if(t.satisfies({firefox:">=60"}))return"Firefox60";if(t.satisfies({ios:{OS:">=14.3",firefox:">=30.0"}}))return"Safari12";if(t.satisfies({safari:">=12.0"})&&"undefined"!==typeof RTCRtpTransceiver&&RTCRtpTransceiver.prototype.hasOwnProperty("currentDirection"))return"Safari12";if(t.satisfies({safari:">=11"}))return"Safari11";if(t.satisfies({"microsoft edge":">=11"})&&t.satisfies({"microsoft edge":"<=18"}))return"Edge11";if(n.name&&"blink"===n.name.toLowerCase()){var r=e.match(/(?:(?:Chrome|Chromium))[ /](\w+)/i);if(r){var a=Number(r[1]);return a>=74?"Chrome74":a>=70?"Chrome70":a>=67?"Chrome67":"Chrome55"}return"Chrome74"}w.warn("this._detectDevice() | browser not supported [name:%s, version:%s]",t.getBrowserName(),t.getBrowserVersion())}}e.detectDevice=k;var x=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.handlerName,r=t.handlerFactory,a=t.Handler;if(St(this,e),this._loaded=!1,this._observer=new o.EnhancedEventEmitter,w.debug("constructor()"),a){if(w.warn("constructor() | Handler option is DEPRECATED, use handlerName or handlerFactory instead"),"string"!==typeof a)throw new TypeError("non string Handler option no longer supported, use handlerFactory instead");n=a}if(n&&r)throw new TypeError("just one of handlerName or handlerInterface can be given");if(r)this._handlerFactory=r;else{if(n)w.debug("constructor() | handler given: %s",n);else{if(!(n=k()))throw new c.UnsupportedError("device not supported");w.debug("constructor() | detected handler: %s",n)}switch(n){case"Chrome74":this._handlerFactory=p.Chrome74.createFactory();break;case"Chrome70":this._handlerFactory=f.Chrome70.createFactory();break;case"Chrome67":this._handlerFactory=h.Chrome67.createFactory();break;case"Chrome55":this._handlerFactory=m.Chrome55.createFactory();break;case"Firefox60":this._handlerFactory=v.Firefox60.createFactory();break;case"Safari12":this._handlerFactory=g.Safari12.createFactory();break;case"Safari11":this._handlerFactory=b.Safari11.createFactory();break;case"Edge11":this._handlerFactory=y.Edge11.createFactory();break;case"ReactNative":this._handlerFactory=_.ReactNative.createFactory();break;default:throw new TypeError('unknown handlerName "'.concat(n,'"'))}}var i=this._handlerFactory();this._handlerName=i.name,i.close(),this._extendedRtpCapabilities=void 0,this._recvRtpCapabilities=void 0,this._canProduceByKind={audio:!1,video:!1},this._sctpCapabilities=void 0}return Pt(e,[{key:"handlerName",get:function(){return this._handlerName}},{key:"loaded",get:function(){return this._loaded}},{key:"rtpCapabilities",get:function(){if(!this._loaded)throw new c.InvalidStateError("not loaded");return this._recvRtpCapabilities}},{key:"sctpCapabilities",get:function(){if(!this._loaded)throw new c.InvalidStateError("not loaded");return this._sctpCapabilities}},{key:"observer",get:function(){return this._observer}},{key:"load",value:function(e){return td(this,arguments,wr().mark((function e(t){var n,r,a;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.routerRtpCapabilities,w.debug("load() [routerRtpCapabilities:%o]",n),n=u.clone(n,void 0),e.prev=3,!this._loaded){e.next=6;break}throw new c.InvalidStateError("already loaded");case 6:return l.validateRtpCapabilities(n),r=this._handlerFactory(),e.next=10,r.getNativeRtpCapabilities();case 10:return a=e.sent,w.debug("load() | got native RTP capabilities:%o",a),l.validateRtpCapabilities(a),this._extendedRtpCapabilities=l.getExtendedRtpCapabilities(a,n),w.debug("load() | got extended RTP capabilities:%o",this._extendedRtpCapabilities),this._canProduceByKind.audio=l.canSend("audio",this._extendedRtpCapabilities),this._canProduceByKind.video=l.canSend("video",this._extendedRtpCapabilities),this._recvRtpCapabilities=l.getRecvRtpCapabilities(this._extendedRtpCapabilities),l.validateRtpCapabilities(this._recvRtpCapabilities),w.debug("load() | got receiving RTP capabilities:%o",this._recvRtpCapabilities),e.next=22,r.getNativeSctpCapabilities();case 22:this._sctpCapabilities=e.sent,w.debug("load() | got native SCTP capabilities:%o",this._sctpCapabilities),l.validateSctpCapabilities(this._sctpCapabilities),w.debug("load() succeeded"),this._loaded=!0,r.close(),e.next=34;break;case 30:throw e.prev=30,e.t0=e.catch(3),r&&r.close(),e.t0;case 34:case"end":return e.stop()}}),e,this,[[3,30]])})))}},{key:"canProduce",value:function(e){if(!this._loaded)throw new c.InvalidStateError("not loaded");if("audio"!==e&&"video"!==e)throw new TypeError('invalid kind "'.concat(e,'"'));return this._canProduceByKind[e]}},{key:"createSendTransport",value:function(e){var t=e.id,n=e.iceParameters,r=e.iceCandidates,a=e.dtlsParameters,i=e.sctpParameters,s=e.iceServers,o=e.iceTransportPolicy,c=e.additionalSettings,u=e.proprietaryConstraints,l=e.appData;return w.debug("createSendTransport()"),this._createTransport({direction:"send",id:t,iceParameters:n,iceCandidates:r,dtlsParameters:a,sctpParameters:i,iceServers:s,iceTransportPolicy:o,additionalSettings:c,proprietaryConstraints:u,appData:l})}},{key:"createRecvTransport",value:function(e){var t=e.id,n=e.iceParameters,r=e.iceCandidates,a=e.dtlsParameters,i=e.sctpParameters,s=e.iceServers,o=e.iceTransportPolicy,c=e.additionalSettings,u=e.proprietaryConstraints,l=e.appData;return w.debug("createRecvTransport()"),this._createTransport({direction:"recv",id:t,iceParameters:n,iceCandidates:r,dtlsParameters:a,sctpParameters:i,iceServers:s,iceTransportPolicy:o,additionalSettings:c,proprietaryConstraints:u,appData:l})}},{key:"_createTransport",value:function(e){var t=e.direction,n=e.id,r=e.iceParameters,a=e.iceCandidates,i=e.dtlsParameters,s=e.sctpParameters,o=e.iceServers,u=e.iceTransportPolicy,l=e.additionalSettings,p=e.proprietaryConstraints,f=e.appData;if(!this._loaded)throw new c.InvalidStateError("not loaded");if("string"!==typeof n)throw new TypeError("missing id");if("object"!==typeof r)throw new TypeError("missing iceParameters");if(!Array.isArray(a))throw new TypeError("missing iceCandidates");if("object"!==typeof i)throw new TypeError("missing dtlsParameters");if(s&&"object"!==typeof s)throw new TypeError("wrong sctpParameters");if(f&&"object"!==typeof f)throw new TypeError("if given, appData must be an object");var h=new d.Transport({direction:t,id:n,iceParameters:r,iceCandidates:a,dtlsParameters:i,sctpParameters:s,iceServers:o,iceTransportPolicy:u,additionalSettings:l,proprietaryConstraints:p,appData:f,handlerFactory:this._handlerFactory,extendedRtpCapabilities:this._extendedRtpCapabilities,canProduceByKind:this._canProduceByKind});return this._observer.safeEmit("newtransport",h),h}}]),e}();e.Device=x}}),wp=Zl({"../../node_modules/mediasoup-client/lib/RtpParameters.js":function(e){nd(),Object.defineProperty(e,"__esModule",{value:!0})}}),kp=Zl({"../../node_modules/mediasoup-client/lib/SctpParameters.js":function(e){nd(),Object.defineProperty(e,"__esModule",{value:!0})}}),xp=Zl({"../../node_modules/mediasoup-client/lib/types.js":function(e){nd();var t=e&&e.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var a=Object.getOwnPropertyDescriptor(t,n);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,a)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),n=e&&e.__exportStar||function(e,n){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(n,r)||t(n,e,r)};Object.defineProperty(e,"__esModule",{value:!0}),n(_p(),e),n(np(),e),n(Yd(),e),n(Zd(),e),n(ep(),e),n(tp(),e),n(wp(),e),n(kp(),e),n(ip(),e),n(Kd(),e)}}),Sp=Zl({"../../node_modules/mediasoup-client/lib/index.js":function(e){nd();var t=e&&e.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var a=Object.getOwnPropertyDescriptor(t,n);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,a)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),n=e&&e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=e&&e.__importStar||function(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var a in e)"default"!==a&&Object.prototype.hasOwnProperty.call(e,a)&&t(r,e,a);return n(r,e),r},a=e&&e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(e,"__esModule",{value:!0}),e.debug=e.parseScalabilityMode=e.detectDevice=e.Device=e.version=e.types=void 0;var i=a(Vd());e.debug=i.default;var s=_p();Object.defineProperty(e,"Device",{enumerable:!0,get:function(){return s.Device}}),Object.defineProperty(e,"detectDevice",{enumerable:!0,get:function(){return s.detectDevice}});var o=r(xp());e.types=o,e.version="3.6.52";var c=cp();Object.defineProperty(e,"parseScalabilityMode",{enumerable:!0,get:function(){return c.parse}})}}),Rp=Zl({"../../node_modules/whatwg-fetch/dist/fetch.umd.js":function(e,t){var n,r;nd(),n=e,r=function(e){var t="undefined"!==typeof globalThis&&globalThis||"undefined"!==typeof self&&self||"undefined"!==typeof t&&t,n="URLSearchParams"in t,r="Symbol"in t&&"iterator"in Symbol,a="FileReader"in t&&"Blob"in t&&function(){try{return new Blob,!0}catch(e){return!1}}(),i="FormData"in t,s="ArrayBuffer"in t;if(s)var o=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],c=ArrayBuffer.isView||function(e){return e&&o.indexOf(Object.prototype.toString.call(e))>-1};function u(e){if("string"!==typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(e)||""===e)throw new TypeError('Invalid character in header field name: "'+e+'"');return e.toLowerCase()}function l(e){return"string"!==typeof e&&(e=String(e)),e}function d(e){var t={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return r&&(t[Symbol.iterator]=function(){return t}),t}function p(e){this.map={},e instanceof p?e.forEach((function(e,t){this.append(t,e)}),this):Array.isArray(e)?e.forEach((function(e){this.append(e[0],e[1])}),this):e&&Object.getOwnPropertyNames(e).forEach((function(t){this.append(t,e[t])}),this)}function f(e){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}function h(e){return new Promise((function(t,n){e.onload=function(){t(e.result)},e.onerror=function(){n(e.error)}}))}function m(e){var t=new FileReader,n=h(t);return t.readAsArrayBuffer(e),n}function v(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function g(){return this.bodyUsed=!1,this._initBody=function(e){var t;this.bodyUsed=this.bodyUsed,this._bodyInit=e,e?"string"===typeof e?this._bodyText=e:a&&Blob.prototype.isPrototypeOf(e)?this._bodyBlob=e:i&&FormData.prototype.isPrototypeOf(e)?this._bodyFormData=e:n&&URLSearchParams.prototype.isPrototypeOf(e)?this._bodyText=e.toString():s&&a&&(t=e)&&DataView.prototype.isPrototypeOf(t)?(this._bodyArrayBuffer=v(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):s&&(ArrayBuffer.prototype.isPrototypeOf(e)||c(e))?this._bodyArrayBuffer=v(e):this._bodyText=e=Object.prototype.toString.call(e):this._bodyText="",this.headers.get("content-type")||("string"===typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):n&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},a&&(this.blob=function(){var e=f(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){if(this._bodyArrayBuffer){var e=f(this);return e||(ArrayBuffer.isView(this._bodyArrayBuffer)?Promise.resolve(this._bodyArrayBuffer.buffer.slice(this._bodyArrayBuffer.byteOffset,this._bodyArrayBuffer.byteOffset+this._bodyArrayBuffer.byteLength)):Promise.resolve(this._bodyArrayBuffer))}return this.blob().then(m)}),this.text=function(){var e=f(this);if(e)return e;if(this._bodyBlob)return function(e){var t=new FileReader,n=h(t);return t.readAsText(e),n}(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(function(e){for(var t=new Uint8Array(e),n=new Array(t.length),r=0;r<t.length;r++)n[r]=String.fromCharCode(t[r]);return n.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},i&&(this.formData=function(){return this.text().then(_)}),this.json=function(){return this.text().then(JSON.parse)},this}p.prototype.append=function(e,t){e=u(e),t=l(t);var n=this.map[e];this.map[e]=n?n+", "+t:t},p.prototype.delete=function(e){delete this.map[u(e)]},p.prototype.get=function(e){return e=u(e),this.has(e)?this.map[e]:null},p.prototype.has=function(e){return this.map.hasOwnProperty(u(e))},p.prototype.set=function(e,t){this.map[u(e)]=l(t)},p.prototype.forEach=function(e,t){for(var n in this.map)this.map.hasOwnProperty(n)&&e.call(t,this.map[n],n,this)},p.prototype.keys=function(){var e=[];return this.forEach((function(t,n){e.push(n)})),d(e)},p.prototype.values=function(){var e=[];return this.forEach((function(t){e.push(t)})),d(e)},p.prototype.entries=function(){var e=[];return this.forEach((function(t,n){e.push([n,t])})),d(e)},r&&(p.prototype[Symbol.iterator]=p.prototype.entries);var b=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function y(e,t){if(!(this instanceof y))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');var n=(t=t||{}).body;if(e instanceof y){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new p(e.headers)),this.method=e.method,this.mode=e.mode,this.signal=e.signal,n||null==e._bodyInit||(n=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=t.credentials||this.credentials||"same-origin",!t.headers&&this.headers||(this.headers=new p(t.headers)),this.method=function(e){var t=e.toUpperCase();return b.indexOf(t)>-1?t:e}(t.method||this.method||"GET"),this.mode=t.mode||this.mode||null,this.signal=t.signal||this.signal,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&n)throw new TypeError("Body not allowed for GET or HEAD requests");if(this._initBody(n),("GET"===this.method||"HEAD"===this.method)&&("no-store"===t.cache||"no-cache"===t.cache)){var r=/([?&])_=[^&]*/;r.test(this.url)?this.url=this.url.replace(r,"$1_="+(new Date).getTime()):this.url+=(/\?/.test(this.url)?"&":"?")+"_="+(new Date).getTime()}}function _(e){var t=new FormData;return e.trim().split("&").forEach((function(e){if(e){var n=e.split("="),r=n.shift().replace(/\+/g," "),a=n.join("=").replace(/\+/g," ");t.append(decodeURIComponent(r),decodeURIComponent(a))}})),t}function w(e){var t=new p;return e.replace(/\r?\n[\t ]+/g," ").split("\r").map((function(e){return 0===e.indexOf("\n")?e.substr(1,e.length):e})).forEach((function(e){var n=e.split(":"),r=n.shift().trim();if(r){var a=n.join(":").trim();t.append(r,a)}})),t}function k(e,t){if(!(this instanceof k))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');t||(t={}),this.type="default",this.status=void 0===t.status?200:t.status,this.ok=this.status>=200&&this.status<300,this.statusText=void 0===t.statusText?"":""+t.statusText,this.headers=new p(t.headers),this.url=t.url||"",this._initBody(e)}y.prototype.clone=function(){return new y(this,{body:this._bodyInit})},g.call(y.prototype),g.call(k.prototype),k.prototype.clone=function(){return new k(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new p(this.headers),url:this.url})},k.error=function(){var e=new k(null,{status:0,statusText:""});return e.type="error",e};var x=[301,302,303,307,308];k.redirect=function(e,t){if(-1===x.indexOf(t))throw new RangeError("Invalid status code");return new k(null,{status:t,headers:{location:e}})},e.DOMException=t.DOMException;try{new e.DOMException}catch(R){e.DOMException=function(e,t){this.message=e,this.name=t;var n=Error(e);this.stack=n.stack},e.DOMException.prototype=Object.create(Error.prototype),e.DOMException.prototype.constructor=e.DOMException}function S(n,r){return new Promise((function(i,o){var c=new y(n,r);if(c.signal&&c.signal.aborted)return o(new e.DOMException("Aborted","AbortError"));var u=new XMLHttpRequest;function d(){u.abort()}u.onload=function(){var e={status:u.status,statusText:u.statusText,headers:w(u.getAllResponseHeaders()||"")};e.url="responseURL"in u?u.responseURL:e.headers.get("X-Request-URL");var t="response"in u?u.response:u.responseText;setTimeout((function(){i(new k(t,e))}),0)},u.onerror=function(){setTimeout((function(){o(new TypeError("Network request failed"))}),0)},u.ontimeout=function(){setTimeout((function(){o(new TypeError("Network request failed"))}),0)},u.onabort=function(){setTimeout((function(){o(new e.DOMException("Aborted","AbortError"))}),0)},u.open(c.method,function(e){try{return""===e&&t.location.href?t.location.href:e}catch(n){return e}}(c.url),!0),"include"===c.credentials?u.withCredentials=!0:"omit"===c.credentials&&(u.withCredentials=!1),"responseType"in u&&(a?u.responseType="blob":s&&c.headers.get("Content-Type")&&-1!==c.headers.get("Content-Type").indexOf("application/octet-stream")&&(u.responseType="arraybuffer")),!r||"object"!==typeof r.headers||r.headers instanceof p?c.headers.forEach((function(e,t){u.setRequestHeader(t,e)})):Object.getOwnPropertyNames(r.headers).forEach((function(e){u.setRequestHeader(e,l(r.headers[e]))})),c.signal&&(c.signal.addEventListener("abort",d),u.onreadystatechange=function(){4===u.readyState&&c.signal.removeEventListener("abort",d)}),u.send("undefined"===typeof c._bodyInit?null:c._bodyInit)}))}S.polyfill=!0,t.fetch||(t.fetch=S,t.Headers=p,t.Request=y,t.Response=k),e.Headers=p,e.Request=y,e.Response=k,e.fetch=S,Object.defineProperty(e,"__esModule",{value:!0})},"object"===typeof e&&"undefined"!==typeof t?r(e):"function"===typeof define&&define.amd?define(["exports"],r):r(n.WHATWGFetch={})}}),Pp=Zl({"../../node_modules/isomorphic-fetch/fetch-npm-browserify.js":function(e,t){nd(),Rp(),t.exports=self.fetch.bind(self)}});nd(),nd(),nd(),nd(),nd(),nd();var Cp=function(){function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){};St(this,e),this._onSetListener=n,this._stack=[],this._eventIndex=0,this.emit=function(e){t._stack.forEach((function(t){return t.execute(e)}))},this.removeAllListeners=function(){t._stack=[]},this.pipe=function(e){return t.add((function(t){return e.emit(t)}))},this.add=function(e){var n=t._eventIndex;t._stack.push({execute:e,id:n}),t._eventIndex++;return t._onSetListener(),{removeListener:function(){t._stack=t._stack.filter((function(e){return e.id!==n&&e}))}}},this.once=function(e){var n=t.add((function(t){n.removeListener(),e(t)}))},this.asPromise=function(e){return new Promise((function(n,r){var a=e&&setTimeout((function(){r("Event asPromise timeout : "+e)}),e);t.once((function(e){a&&clearTimeout(a),n(e)}))}))},this.watch=function(e,n){return new Promise((function(r,a){var i=n&&setTimeout((function(){a("Event watch timeout : "+n)}),n),s=t.add((function(t){e(t)&&(i&&clearTimeout(i),s(),r(t))})).removeListener}))}}return Pt(e,[{key:"length",get:function(){return this._stack.length}}]),e}(),Tp=function(){function e(){St(this,e),this.events=[]}return Pt(e,[{key:"make",value:function(){var e=new Cp;return this.events.push(e),e}},{key:"dispose",value:function(){this.events.forEach((function(e){return e.removeAllListeners()})),this.events=[]}}]),e}(),Ep=["error","warn","debug","disable"],Op=function(){function e(t){St(this,e),this.prefix=t}return Pt(e,[{key:"debug",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._log.apply(this,["debug"].concat(t))}},{key:"warn",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._log.apply(this,["warn"].concat(t))}},{key:"error",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._log.apply(this,["error"].concat(t))}},{key:"_log",value:function(t){for(var n,r,a,i=arguments.length,s=new Array(i>1?i-1:0),o=1;o<i;o++)s[o-1]=arguments[o];var c=Ep.indexOf(t),u=Ep.indexOf(e.level);if(u>=c){var l=new Date(Date.now()+324e5).toISOString()+"+JST";s=[this.prefix].concat(xt(s)).map((function(e){return"object"===typeof e?JSON.parse(JSON.stringify(e)):e}));var d=[l,t].concat(xt(s));switch("string"===e.format&&(d=[l+" "+t+" "+JSON.stringify(s)]),t){case"debug":(n=console).info.apply(n,xt(d));break;case"warn":(r=console).warn.apply(r,xt(d));break;case"error":(a=console).error.apply(a,xt(d))}e.onLog.emit({id:e.id,timestamp:l,level:t,message:s})}}}]),e}(),Mp=Op;Mp.level="error",Mp.format="object",Mp.id=Math.random().toString().slice(2,7),Mp.onLog=new Cp;var Ip=new Mp("packages/common/src/error.ts"),Dp=function(e){mn(n,e);var t=_n(n);function n(e){var r,a=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return St(this,n),(r=t.call(this,e.message)).id=Math.random().toString().slice(2,10),Object.assign(bn(r),e),r.name=r.type,a&&(r.payload?Ip.warn("error detail","id:".concat(r.id,", type:").concat(r.type,", message:").concat(r.message),r.payload):Ip.warn("error detail","id:".concat(r.id,", type:").concat(r.type,", message:").concat(r.message))),r}return Pt(n,[{key:"toJSON",value:function(){return{type:this.type,message:this.message,payload:this.payload}}}]),n}(as(Error));nd();var jp=ed(Md()),Lp=new Mp("packages/common/src/http.ts"),Ap=function(){function e(t){St(this,e),this.api=jp.default.create({baseURL:t})}return Pt(e,[{key:"get",value:function(e,t){return td(this,null,wr().mark((function n(){var r,a;return wr().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.api.get(e,t).catch((function(e){return e}));case 2:if(r=n.sent,!jp.default.isAxiosError(r)){n.next=18;break}if(a=Yl(Jl({},r.response),{message:r.message}),!(null==t?void 0:t.retry)){n.next=14;break}return n.next=8,t.retry(a);case 8:if(!n.sent){n.next=13;break}return n.abrupt("return",this.get(e,t));case 13:throw a;case 14:throw Lp.warn("response error",{error:a}),a;case 18:return n.abrupt("return",r.data);case 19:case"end":return n.stop()}}),n,this)})))}},{key:"post",value:function(e,t,n){return td(this,null,wr().mark((function r(){var a,i;return wr().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,this.api.post(e,t,n).catch((function(e){return e}));case 2:if(a=r.sent,!jp.default.isAxiosError(a)){r.next=18;break}if(i=Yl(Jl({},a.response),{message:a.message}),!(null==n?void 0:n.retry)){r.next=14;break}return r.next=8,n.retry(i);case 8:if(!r.sent){r.next=13;break}return r.abrupt("return",this.post(e,t,n));case 13:throw i;case 14:throw Lp.warn("response error",{error:i}),i;case 18:return r.abrupt("return",a.data);case 19:case"end":return r.stop()}}),r,this)})))}},{key:"put",value:function(e,t,n){return td(this,null,wr().mark((function r(){var a,i;return wr().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,this.api.put(e,t,n).catch((function(e){return e}));case 2:if(a=r.sent,!jp.default.isAxiosError(a)){r.next=18;break}if(i=Yl(Jl({},a.response),{message:a.message}),!(null==n?void 0:n.retry)){r.next=14;break}return r.next=8,n.retry(i);case 8:if(!r.sent){r.next=13;break}return r.abrupt("return",this.put(e,t,n));case 13:throw i;case 14:throw Lp.warn("response error",{error:i}),i;case 18:return r.abrupt("return",a.data);case 19:case"end":return r.stop()}}),r,this)})))}},{key:"delete",value:function(e,t){return td(this,null,wr().mark((function n(){var r,a;return wr().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.api.delete(e,t).catch((function(e){return e}));case 2:if(r=n.sent,!jp.default.isAxiosError(r)){n.next=18;break}if(a=Yl(Jl({},r.response),{message:r.message}),!(null==t?void 0:t.retry)){n.next=14;break}return n.next=8,t.retry(a);case 8:if(!n.sent){n.next=13;break}return n.abrupt("return",this.delete(e,t));case 13:throw a;case 14:throw Lp.warn("response error",{error:a}),a;case 18:return n.abrupt("return",r.data);case 19:case"end":return n.stop()}}),n,this)})))}}]),e}();nd();new Mp("packages/common/src/promise.ts");var Fp=function(){function e(){var t=this;St(this,e),this.id=Math.random().toString().slice(2),this.queue=[],this.running=!1,this.push=function(e){return new Promise((function(n,r){t.queue.push({promise:e,done:n,failed:r}),t.running||t.run()}))}}return Pt(e,[{key:"run",value:function(){return td(this,null,wr().mark((function e(){var t,n;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=this.queue.shift())){e.next=17;break}return this.running=!0,e.prev=3,e.next=6,t.promise();case 6:n=e.sent,t.done(n),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(3),t.failed(e.t0);case 13:return e.next=15,this.run();case 15:e.next=18;break;case 17:this.running=!1;case 18:case"end":return e.stop()}}),e,this,[[3,10]])})))}}]),e}();nd(),nd(),nd(),nd(),nd();new Mp("packages/core/src/publication/index.ts");nd(),nd();new Mp("packages/core/src/subscription/index.ts"),new Mp("packages/core/src/channel/index.ts");nd(),nd(),nd(),nd(),nd(),nd(),nd(),nd();ed(Id()),new Mp("packages/rtc-rpc-api-client/src/rpc.ts"),new Mp("packages/rtc-rpc-api-client/src/client.ts");nd(),nd();ed(Dd());nd();new Mp("packages/rtc-api-client/src/infrastructure/api.ts"),new Mp("packages/rtc-api-client/src/client.ts");nd(),nd(),nd();new Mp("packages/rtc-api-client/src/infrastructure/eventObserver.ts"),new Mp("packages/rtc-api-client/src/domain/channel.ts"),ed(Dd());function Np(e){this.message=e}nd(),nd(),nd(),nd(),Np.prototype=new Error,Np.prototype.name="InvalidCharacterError";"undefined"!=typeof window&&window.atob&&window.atob.bind(window);function Bp(e){this.message=e}Bp.prototype=new Error,Bp.prototype.name="InvalidTokenError";ed(Ld());nd(),nd(),nd(),nd(),nd();var Up=function(){function e(){St(this,e),this._onContextAttached=new Cp}return Pt(e,[{key:"_attachContext",value:function(e){this._context=e,this._onContextAttached.emit(e)}}]),e}();nd();new Mp("packages/core/src/plugin/internal/person/connection/messageBuffer.ts");nd(),nd();var zp=function(){function e(t){St(this,e),this._status="joined",this._events=new Tp,this.onLeft=this._events.make(),this.onMetadataUpdated=this._events.make(),this.channel=t.channel,this.id=t.id,this.name=t.name,this._metadata=t.metadata}return Pt(e,[{key:"metadata",get:function(){return this._metadata}},{key:"status",get:function(){return this._status}},{key:"publications",get:function(){var e=this;return this.channel.publications.filter((function(t){return t.publisher.id===e.id}))}},{key:"subscriptions",get:function(){var e=this;return this.channel.subscriptions.filter((function(t){return t.subscriber.id===e.id}))}},{key:"toJSON",value:function(){return{id:this.id,name:this.name,type:this.type,subtype:this.subtype,metadata:this.metadata}}},{key:"_left",value:function(){this._status="left",this.onLeft.emit(),this._events.dispose()}},{key:"_metadataUpdated",value:function(e){this._metadata=e,this.onMetadataUpdated.emit(e)}},{key:"updateMetadata",value:function(e){return td(this,null,wr().mark((function t(){return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.channel._updateMemberMetadata(this.id,e);case 2:case"end":return t.stop()}}),t,this)})))}}]),e}();nd(),nd();ed(Bd());function Vp(e,t){var n;if(void 0===(null==(n=null!=e?e:{})?void 0:n.srcObject))throw new Dp({type:"invalidType",message:"invalid element was passed",payload:{element:e}});e.srcObject?e.srcObject.addTrack(t):e.srcObject=new MediaStream([t])}function Hp(e,t){var n;if(void 0===(null==(n=null!=e?e:{})?void 0:n.srcObject))throw new Dp({type:"invalidType",message:"invalid element was passed",payload:{element:e}});var r=e.srcObject;r.getTracks().length>0&&r.removeTrack(t),0===r.getTracks().length&&(e.srcObject=null)}nd(),nd(),nd(),nd();var Wp,qp=Pt((function e(t,n,r){St(this,e),this.id=t,this.label=n,this.contentType=r,this.side="remote"})),Gp=function(e){mn(n,e);var t=_n(n);function n(e,r,a){var i;return St(this,n),(i=t.call(this,e,r,"audio")).track=a,i.contentType="audio",i}return Pt(n,[{key:"attach",value:function(e){this._element=e,Vp(e,this.track)}},{key:"detach",value:function(){this._element&&(Hp(this._element,this.track),this._element=void 0)}}]),n}(qp);nd(),nd(),nd(),nd(),nd();var Kp=new Uint8Array(16);function Xp(){if(!Wp&&!(Wp="undefined"!==typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!==typeof msCrypto&&"function"===typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Wp(Kp)}nd(),nd(),nd();var Qp=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;var $p,Jp=function(e){return"string"===typeof e&&Qp.test(e)},Yp=[];for($p=0;$p<256;++$p)Yp.push(($p+256).toString(16).substr(1));var Zp=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(Yp[e[t+0]]+Yp[e[t+1]]+Yp[e[t+2]]+Yp[e[t+3]]+"-"+Yp[e[t+4]]+Yp[e[t+5]]+"-"+Yp[e[t+6]]+Yp[e[t+7]]+"-"+Yp[e[t+8]]+Yp[e[t+9]]+"-"+Yp[e[t+10]]+Yp[e[t+11]]+Yp[e[t+12]]+Yp[e[t+13]]+Yp[e[t+14]]+Yp[e[t+15]]).toLowerCase();if(!Jp(n))throw TypeError("Stringified UUID is invalid");return n};nd();var ef=function(e,t,n){var r=(e=e||{}).random||(e.rng||Xp)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t){n=n||0;for(var a=0;a<16;++a)t[n+a]=r[a];return t}return Zp(r)},tf=function(){function e(t,n){St(this,e),this.label=t,this.contentType=n,this.side="local",this.id=ef(),this._muted=!1,this._onMuted=new Cp,this._onUnmuted=new Cp}return Pt(e,[{key:"muted",get:function(){return this._muted}},{key:"mute",value:function(){this.muted||(this._muted=!0,this._onMuted.emit())}},{key:"unmute",value:function(){this.muted&&(this._muted=!1,this._onUnmuted.emit())}}]),e}(),nf=function(e){mn(n,e);var t=_n(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return St(this,n),(e=t.call(this,"datachannel","data"))._options=r,e.contentType="data",e._onWriteData=new Cp,e}return Pt(n,[{key:"write",value:function(e){ArrayBuffer.isView(e)||"string"===typeof e||(e=rf+JSON.stringify(e)),this._onWriteData.emit(e)}}]),n}(tf),rf="skyway_object:",af=function(e){mn(n,e);var t=_n(n);function n(e,r,a){var i;return St(this,n),(i=t.call(this,e,r,"data"))._datachannel=a,i.contentType="data",i.onData=new Cp,a.onmessage=function(e){var t=e.data;"string"===typeof t&&t.includes(rf)&&(t=JSON.parse(t.slice(rf.length))),i.onData.emit(t)},i}return Pt(n)}(qp);nd();var sf=function(e){mn(n,e);var t=_n(n);function n(e,r,a){var i;return St(this,n),(i=t.call(this,e,r,"video")).track=a,i.contentType="video",i}return Pt(n,[{key:"attach",value:function(e){this._element=e,Vp(e,this.track)}},{key:"detach",value:function(){this._element&&(Hp(this._element,this.track),this._element=void 0)}}]),n}(qp),of=function(e,t,n,r){if(n instanceof RTCDataChannel){var a=new af(e,t,n);return a.codec=r,a}if("audio"===n.kind){var i=new Gp(e,t,n);return i.codec=r,i}if("video"===n.kind){var s=new sf(e,t,n);return s.codec=r,s}throw new Dp({type:"notImplemented",message:"invalid stream type"})};nd(),nd();new Mp("src/core/dataPlane/peerConnection/peer.ts"),new Mp("packages/core/src/plugin/internal/person/connection/receiver.ts");nd();ed(Bd());nd();var cf=ed(Sp()),uf=function(e,t){return td(void 0,null,wr().mark((function n(){var r;return wr().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return void 0==(r=e.getParameters()).encodings&&(r.encodings=[]),r.encodings=t.map((function(e,t){return Jl(Jl({},r.encodings[t]||{}),e)})),n.next=5,e.setParameters(r);case 5:case"end":return n.stop()}}),n)})))};new Mp("packages/core/src/plugin/internal/person/connection/sender.ts"),new Mp("packages/core/src/plugin/internal/person/connection/index.ts");nd();new Mp("packages/core/src/plugin/internal/person/member.ts");nd(),nd(),nd();new Mp("packages/core/src/plugin/internal/unknown/connection.ts"),new Mp("packages/core/src/plugin/internal/person/member.ts"),new Mp("packages/core/src/context.ts");nd();new Mp("packages/core/src/external/ice.ts");nd(),nd(),nd(),nd();var lf=function(e){mn(n,e);var t=_n(n);function n(e,r){var a;if(St(this,n),(a=t.call(this,e,"audio")).track=r,a.contentType="audio",a._mutedTrack=function(){var e=(new(window.AudioContext||window.webkitAudioContext)).createMediaStreamDestination();return Object.assign(e.stream.getAudioTracks()[0],{enabled:!1})}(),a._onReplaceTrack=new Cp,"audio"!==r.kind)throw new Dp({type:"invalidParameter",message:"invalid track kind",payload:{track:r}});return a}return Pt(n,[{key:"attach",value:function(e){this._element=e,Vp(e,this.track)}},{key:"detach",value:function(){this._element&&(Hp(this._element,this.track),this._element=void 0)}},{key:"replaceTrack",value:function(e){this._onReplaceTrack.emit(e)}},{key:"release",value:function(){this.track.stop()}}]),n}(tf);nd(),nd();var df=function(e){mn(n,e);var t=_n(n);function n(e,r){var a;if(St(this,n),(a=t.call(this,e,"video")).track=r,a.contentType="video",a._mutedTrack=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.width,n=void 0===t?640:t,r=e.height,a=void 0===r?480:r,i=Object.assign(document.createElement("canvas"),{width:n,height:a});return i.getContext("2d").fillRect(0,0,n,a),i.captureStream().getVideoTracks()[0]}({width:a.track.getSettings().width,height:a.track.getSettings().height}),a._onReplaceTrack=new Cp,"video"!==r.kind)throw new Dp({type:"invalidParameter",message:"invalid track kind",payload:{track:r}});return a}return Pt(n,[{key:"attach",value:function(e){this._element=e,Vp(e,this.track)}},{key:"detach",value:function(){this._element&&(Hp(this._element,this.track),this._element=void 0)}},{key:"replaceTrack",value:function(e){this._onReplaceTrack.emit(e)}},{key:"release",value:function(){this.track.stop()}}]),n}(tf),pf=function(){function e(){var t=this;if(St(this,e),this.onDeviceChange=new Cp,this._devices=[],!(null==navigator?void 0:navigator.mediaDevices))throw new Dp({type:"forbidden",message:"mediaDevices not exist. maybe not under https or localhost or 127.0.0.1 environment"});navigator.mediaDevices.addEventListener("devicechange",(function(){return td(t,null,wr().mark((function e(){var t,n,r,a=this;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._enumerateDevicesArray();case 2:t=e.sent,n=[],this._devices.forEach((function(e){t.map((function(e){return e.id})).includes(e.id)||n.push(e)})),r=[],t.map((function(e){return e.id})).forEach((function(e){a._devices.map((function(e){return e.id})).includes(e)||r.push(t.find((function(t){return t.id===e})))})),n.forEach((function(e){a.onDeviceChange.emit({state:"removed",device:e})})),r.forEach((function(e){a.onDeviceChange.emit({state:"added",device:e})})),this._devices=t;case 10:case"end":return e.stop()}}),e,this)})))}))}return Pt(e,[{key:"_enumerateDevicesArray",value:function(){return td(this,null,wr().mark((function e(){var t;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,navigator.mediaDevices.enumerateDevices();case 2:return t=e.sent,e.abrupt("return",t.map((function(e){return new ff(e)})).filter((function(e){return e.id.length>0})));case 4:case"end":return e.stop()}}),e)})))}},{key:"_enumerateDevicesWithAuth",value:function(){return td(this,arguments,wr().mark((function e(){var t,n,r,a=arguments;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=a.length>0&&void 0!==a[0]?a[0]:{audio:!0,video:!0},n=t.video,r=t.audio,!n&&!r){e.next=4;break}return e.next=4,navigator.mediaDevices.getUserMedia({video:n,audio:r});case 4:return e.next=6,this._enumerateDevicesArray();case 6:return this._devices=e.sent,e.abrupt("return",this._devices);case 8:case"end":return e.stop()}}),e,this)})))}},{key:"enumerateDevices",value:function(){return td(this,null,wr().mark((function e(){var t;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._enumerateDevicesWithAuth();case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}}),e,this)})))}},{key:"enumerateInputVideoDevices",value:function(){return td(this,null,wr().mark((function e(){var t;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._enumerateDevicesWithAuth({video:!0});case 2:return t=e.sent,e.abrupt("return",t.filter((function(e){return"videoinput"===e.kind})));case 4:case"end":return e.stop()}}),e,this)})))}},{key:"enumerateInputAudioDevices",value:function(){return td(this,null,wr().mark((function e(){var t;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._enumerateDevicesWithAuth({audio:!0});case 2:return t=e.sent,e.abrupt("return",t.filter((function(e){return"audioinput"===e.kind})));case 4:case"end":return e.stop()}}),e,this)})))}},{key:"enumerateOutputAudioDevices",value:function(){return td(this,null,wr().mark((function e(){var t;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._enumerateDevicesWithAuth({audio:!0});case 2:return t=e.sent,e.abrupt("return",t.filter((function(e){return"audiooutput"===e.kind})));case 4:case"end":return e.stop()}}),e,this)})))}},{key:"createCameraVideoStream",value:function(){return td(this,arguments,wr().mark((function e(){var t,n,r,a,i=arguments;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=i.length>0&&void 0!==i[0]?i[0]:{},e.next=3,navigator.mediaDevices.getUserMedia({video:t});case 3:return n=e.sent.getTracks(),r=s(n,1),a=r[0],e.abrupt("return",new df("camera",a));case 7:case"end":return e.stop()}}),e)})))}},{key:"createMicrophoneAudioStream",value:function(){return td(this,arguments,wr().mark((function e(){var t,n,r,a,i=arguments;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=i.length>0&&void 0!==i[0]?i[0]:{},e.next=3,navigator.mediaDevices.getUserMedia({audio:t});case 3:return n=e.sent.getTracks(),r=s(n,1),a=r[0],e.abrupt("return",new lf("microphone",a));case 7:case"end":return e.stop()}}),e)})))}},{key:"createDataStream",value:function(){return td(this,arguments,wr().mark((function e(){var t,n=arguments;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.length>0&&void 0!==n[0]?n[0]:{},e.abrupt("return",new nf(t));case 2:case"end":return e.stop()}}),e)})))}},{key:"createMicrophoneAudioAndCameraStream",value:function(){return td(this,arguments,wr().mark((function e(){var t,n,r,a,i,o,c,u,l,d,p=arguments;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=p.length>0&&void 0!==p[0]?p[0]:{},n=t.audio,r=t.video,e.next=3,navigator.mediaDevices.getUserMedia({audio:null==n||n,video:null==r||r});case 3:return a=e.sent,i=a.getAudioTracks(),o=s(i,1),c=o[0],u=a.getVideoTracks(),l=s(u,1),d=l[0],e.abrupt("return",{audio:new lf("microphone",c),video:new df("camera",d)});case 7:case"end":return e.stop()}}),e)})))}}]),e}(),ff=(new pf,Pt((function e(t){St(this,e),this.id=t.deviceId,this.label=t.label,this.kind=t.kind})));nd(),nd(),nd(),nd(),nd();new Mp("packages/core/src/dataPlane/agent/publishing.ts");nd(),nd(),nd(),nd(),nd();ed(Pp());nd(),nd(),nd();ed(Id());nd(),nd(),nd(),nd();new Mp("packages/core/src/member/person/local/factory.ts"),new Mp("packages/core/src/member/person/local/index.ts");nd(),nd(),nd();var hf=new Mp("packages/sfu-client/src/connection/receiver.ts"),mf=function(){function e(t,n,r,a,i){St(this,e),this.subscription=t,this._api=n,this._transportRepository=r,this._bot=a,this._iceManager=i}return Pt(e,[{key:"consume",value:function(){return td(this,null,wr().mark((function e(){var t,n,r,a,i,s,o;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this._transportRepository.rtpCapabilities){e.next=9;break}return hf.debug("[start] getCapabilities"),e.next=5,this._api.getRtpCapabilities({botId:this._bot.id,forwardingId:this.subscription.publication.id});case 5:return t=e.sent,hf.debug("[end] getCapabilities"),e.next=9,this._transportRepository.loadDevice(t);case 9:return hf.debug("[start] createConsumer",{subscription:this.subscription}),e.next=12,this._api.createConsumer({botId:this._bot.id,forwardingId:this.subscription.publication.id,rtpCapabilities:t,subscriptionId:this.subscription.id,subscriberId:this.subscription.subscriber.id});case 12:if(n=e.sent,r=n.consumerOptions,a=n.transportOptions,i=n.transportId,s=n.producerId,a&&this._transportRepository.createTransport(a,"recv",this._iceManager.iceServers),this._transport=this._transportRepository.getTransport(i),this._transport){e.next=21;break}throw new Dp({type:"notFound",message:"receiver sfuTransport not found",payload:{transportOptions:a},path:hf.prefix});case 21:return hf.debug("[end] createConsumer"),e.next=24,this._transport.msTransport.consume(Yl(Jl({},r),{producerId:s}));case 24:return o=e.sent,this._consumer=o,e.abrupt("return",{track:o.track,codecs:o.rtpParameters.codecs});case 27:case"end":return e.stop()}}),e,this)})))}},{key:"unconsume",value:function(){this._consumer?(this._consumer.close(),this._consumer=void 0):hf.debug("unconsume failed, consumer not exist",{subscription:this.subscription})}},{key:"getStats",value:function(){return td(this,null,wr().mark((function e(){var t,n;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",null!=(n=null==(t=this._transport)?void 0:t.msTransport.getStats())?n:{});case 1:case"end":return e.stop()}}),e,this)})))}},{key:"pc",get:function(){var e;return null==(e=this._transport)?void 0:e.pc}}]),e}();nd();var vf=new Mp("packages/sfu-client/src/connection/sender.ts"),gf=function(){function e(t,n,r,a,i){St(this,e),this.publication=t,this._api=n,this._transportRepository=r,this._bot=a,this._iceManager=i,this._disposer=[]}return Pt(e,[{key:"startForwarding",value:function(t){return td(this,null,wr().mark((function n(){var r,a,i,s,o,c=this;return wr().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if("data"!==this.publication.contentType){n.next=2;break}throw new Dp({type:"invalidParameter",message:"sfu not support dataStream",path:vf.prefix});case 2:return vf.debug("[start] Sender startForwarding",{botId:this._bot.id,publicationId:this.publication.id,contentType:this.publication.contentType,maxSubscribers:t.maxSubscribers}),n.next=5,this._api.startForwarding({botId:this._bot.id,publicationId:this.publication.id,contentType:this.publication.contentType,maxSubscribers:t.maxSubscribers,publisherId:this.publication.publisher.id});case 5:if(r=n.sent,a=r.rtpCapabilities,i=r.transportOptions,s=r.forwardingId,o=r.transportId,this.forwardingId=s,!a){n.next=14;break}return n.next=14,this._transportRepository.loadDevice(a);case 14:if(i&&(this._transport=this._transportRepository.createTransport(i,"send",this._iceManager.iceServers),this._transport.msTransport.on("produce",(function(t,n,r){return e._onProduce(c._transport.id,c._api,c._bot.id)(t,n,r)}))),this._transport=this._transportRepository.getTransport(o),this._transport){n.next=18;break}throw new Dp({type:"notFound",message:"sender sfuTransport not found",payload:{transportOptions:i},path:vf.prefix});case 18:return n.next=20,this._produce(this._transport.msTransport);case 20:return vf.debug("[end] Sender startForwarding",{forwardingId:s}),n.abrupt("return",s);case 22:case"end":return n.stop()}}),n,this)})))}},{key:"_produce",value:function(e){return td(this,null,wr().mark((function t(){var n,r,a,i,s,o,c,u,l,d,p,f,h,m,v,g=this;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(c=this.publication.stream){t.next=3;break}throw new Dp({type:"notFound",message:"publication not have stream",path:vf.prefix});case 3:return this._disposer=[].concat(xt(this._disposer),[c._onReplaceTrack.add((function(e){return td(g,null,wr().mark((function t(){return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._replaceTrack(e.clone());case 2:case"end":return t.stop()}}),t,this)})))})).removeListener,c._onMuted.add((function(){return td(g,null,wr().mark((function e(){return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._replaceTrack(c._mutedTrack.clone());case 2:case"end":return e.stop()}}),e,this)})))})).removeListener,c._onUnmuted.add((function(){return td(g,null,wr().mark((function e(){return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._replaceTrack(c.track.clone());case 2:case"end":return e.stop()}}),e,this)})))})).removeListener]),u=c.muted?c._mutedTrack.clone():c.track.clone(),l={track:u,appData:{forwardingId:this.forwardingId}},(d=this.publication.encodings)&&(l.encodings=d),this.publication._onEncodingsChanged.add((function(e){return td(g,null,wr().mark((function t(){return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,uf(v.rtpSender,e).catch((function(e){vf.error("_onEncodingsChanged failed",e)}));case 2:case"end":return t.stop()}}),t)})))})),p=this.publication.codecCapabilities,f=null!=(r=null==(n=this._transportRepository.rtpCapabilities)?void 0:n.codecs)?r:[],h=null!=(i=null==(a=p.find((function(e){return f.map((function(e){return e.mimeType.toLowerCase()})).includes(e.mimeType.toLowerCase())})))?void 0:a.mimeType)?i:"",(m=f.find((function(e){return e.mimeType.toLowerCase()===h.toLocaleLowerCase()})))&&(l.codec=m),!1!==(null==(o=null==(s=p.find((function(e){return"audio/opus"===e.mimeType.toLowerCase()})))?void 0:s.parameters)?void 0:o.usedtx)&&(l.codecOptions=Yl(Jl({},l.codecOptions),{opusDtx:!0})),t.next=18,e.produce(l);case 18:if(v=t.sent,this._producer=v,"Safari12"!==(0,cf.detectDevice)()&&"Safari11"!==(0,cf.detectDevice)()){t.next=24;break}if(!(d.length>0)){t.next=24;break}return t.next=24,uf(v.rtpSender,d).catch((function(e){vf.error("_onEncodingsChanged failed",e)}));case 24:case"end":return t.stop()}}),t,this)})))}},{key:"unproduce",value:function(){if(!this._producer)throw new Dp({type:"notFound",message:"producer not exist",path:vf.prefix});this._producer.close(),this._producer=void 0}},{key:"_replaceTrack",value:function(e){return td(this,null,wr().mark((function t(){var n,r;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,null==(r=null==(n=this._producer)?void 0:n.replaceTrack)?void 0:r.call(n,{track:e});case 2:case"end":return t.stop()}}),t,this)})))}},{key:"getStats",value:function(){return td(this,null,wr().mark((function e(){var t,n;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",null!=(n=null==(t=this._transport)?void 0:t.msTransport.getStats())?n:{});case 1:case"end":return e.stop()}}),e,this)})))}},{key:"close",value:function(){this._disposer.forEach((function(e){return e()})),this._disposer=[]}},{key:"pc",get:function(){var e;return null==(e=this._transport)?void 0:e.pc}}]),e}(),bf=gf;bf._onProduce=function(e,t,n){return function(r,a,i){return td(gf,null,wr().mark((function s(){var o;return wr().wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return s.prev=0,vf.debug("[start] createProducer",{producerOptions:r}),s.next=4,t.createProducer({botId:n,forwardingId:r.appData.forwardingId,transportId:e,producerOptions:r});case 4:o=s.sent,vf.debug("[end] createProducer",{producerOptions:r}),a({id:o}),s.next=13;break;case 9:s.prev=9,s.t0=s.catch(0),vf.error("[failed] createProducer",{error:s.t0,producerOptions:r}),i(s.t0);case 13:case"end":return s.stop()}}),s,null,[[0,9]])})))}};var yf=new Mp("packages/sfu-client/src/connection/index.ts"),_f=function(){function e(t,n,r,a,i){St(this,e),this._api=t,this.channelId=n,this.localPerson=r,this.remoteMember=a,this._transportRepository=i,this.type="sfu",this.onDisconnect=new Cp,this.onClose=new Cp,this.closed=!1,this._receivers={},this._senders={},this._consumeQueue=new Fp}return Pt(e,[{key:"addSender",value:function(e){var t=new bf(e,this._api,this._transportRepository,this.remoteMember,this.localPerson.iceManager);return this._senders[e.id]=t,t}},{key:"removeSender",value:function(e){yf.debug("removeSender",e);var t=this._senders[e];t&&(t.unproduce(),delete this._senders[e])}},{key:"startSubscribing",value:function(e){return td(this,null,wr().mark((function t(){var n=this;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this._consumeQueue.push((function(){return n._startSubscribing(e)})));case 1:case"end":return t.stop()}}),t,this)})))}},{key:"_startSubscribing",value:function(e){return td(this,null,wr().mark((function t(){var n,r,a,i,o,c,u;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=new mf(e,this._api,this._transportRepository,this.remoteMember,this.localPerson.iceManager),this._receivers[e.id]=n,t.next=4,n.consume();case 4:r=t.sent,a=r.codecs,i=r.track,o=s(a,1),c=o[0],u=of("","",i,c),e.codec={mimeType:c.mimeType,parameters:c.parameters},e.stream=u;case 11:case"end":return t.stop()}}),t,this)})))}},{key:"stopSubscribing",value:function(e){return td(this,null,wr().mark((function t(){var n;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=this._receivers[e.id]){t.next=3;break}throw new Dp({type:"notFound",message:"not exist connection",payload:{subscription:e},path:yf.prefix});case 3:n.unconsume(),delete this._receivers[e.id];case 5:case"end":return t.stop()}}),t,this)})))}},{key:"stopPublishing",value:function(e){return td(this,null,wr().mark((function t(){return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.removeSender(e.id);case 1:case"end":return t.stop()}}),t,this)})))}},{key:"close",value:function(){this.closed||(this.closed=!0,Object.values(this._senders).forEach((function(e){e.close()})),this._senders={},this._receivers={},this._transportRepository.close(),this.onClose.emit())}},{key:"getReceiver",value:function(e){return this._receivers[e]}},{key:"getSender",value:function(e){return this._senders[e]}},{key:"getRTCPeerConnection",value:function(e){var t,n=e,r=null!=(t=this.getReceiver(n))?t:this.getSender(n);return null==r?void 0:r.pc}}]),e}();nd();var wf=function(){function e(t,n,r){St(this,e),this.configure=t,this.originPublication=n,this.relayingPublication=r,this.status="started",this.onStopped=new Cp}return Pt(e,[{key:"id",get:function(){return this.relayingPublication.id}},{key:"stop",value:function(){this.status="stopped",this.onStopped.emit()}},{key:"toJSON",value:function(){return{id:this.id,configure:this.configure,originPublication:this.originPublication,relayingPublication:this.relayingPublication}}}]),e}();nd();var kf=new Mp("packages/sfu-client/src/member.ts"),xf=function(e){mn(n,e);var t=_n(n);function n(e){var r;return St(this,n),(r=t.call(this,e)).side="remote",r.subtype=n.subtype,r.type="bot",r._connections={},r.onForwardingStarted=new Cp,r.onForwardingStopped=new Cp,r.onForwardingStateChanged=new Cp,r._startForwardQueue=new Fp,r._forwardings={},r.stopForwarding=function(e){return new Promise((function(t,n){if(kf.debug("[start] stopForwarding"),"joined"===r.status){var a="string"===typeof e?e:e.id,i=r._forwardings[a];if(i){delete r._forwardings[i.id];var s=r._api.stopForwarding({botId:r.id,forwardingId:a}),o=s.promise,c=s.fulfilled;o.catch(n),r.onForwardingStopped.watch((function(e){return e.forwarding.id===a}),r._context.config.rtcApi.timeout).catch((function(e){n(new Dp({type:"timeout",message:"onForwardingStopped",payload:{error:e,fulfilled:c},path:kf.prefix}))})).then((function(){kf.debug("[end] stopForwarding"),t()}))}else n(new Dp({type:"notFound",message:"forwarding not found",payload:{forwardingId:a}}))}else n(new Dp({type:"forbidden",message:"sfuBot not in channel",payload:{status:r.status},path:kf.prefix}))}))},r._api=e.api,r._context=e.context,r._transportRepository=e.transportRepository,r.onLeft.once((function(){kf.debug("SfuBotMember left: ",{id:r.id}),Object.values(r._connections).forEach((function(e){e.close()})),r._connections={}})),r}return Pt(n,[{key:"forwardings",get:function(){return Object.values(this._forwardings)}},{key:"_getConnection",value:function(e){return this._connections[e]}},{key:"_getOrCreateConnection",value:function(e){var t;return null!=(t=this._getConnection(e.id))?t:this._createConnection(this.channel,e,this)}},{key:"_createConnection",value:function(e,t,n){var r=this;if(!t)throw new Dp({type:"notFound",message:"LocalPerson not found in channel instance.",path:kf.prefix});var a=new _f(n._api,e.id,t,n,this._transportRepository);return a.onClose.once((function(){delete r._connections[t.id]})),this._connections[t.id]=a,a}},{key:"startForwarding",value:function(e){return td(this,arguments,wr().mark((function e(t){var n,r=this,a=arguments;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.length>1&&void 0!==a[1]?a[1]:{maxSubscribers:4},e.abrupt("return",this._startForwardQueue.push((function(){return r._startForwarding(t,n)})));case 2:case"end":return e.stop()}}),e,this)})))}},{key:"_startForwarding",value:function(e){return td(this,arguments,wr().mark((function e(t){var n,r,a,i,s,o,c,u,l=arguments;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=l.length>1&&void 0!==l[1]?l[1]:{maxSubscribers:4},"joined"===this.status){e.next=3;break}throw new Dp({type:"notFound",message:"sfuBot not in channel",payload:{status:this.status},path:kf.prefix});case 3:if(this.channel._getPublication(t.id)){e.next=5;break}throw new Dp({type:"notFound",message:"publication not in channel",payload:{status:this.status},path:kf.prefix});case 5:return r=t,kf.debug("[start] SfuBotMember startForwarding",{publication:r.toJSON(),configure:n}),e.prev=7,a=this.channel._getPerson(r.publisherId),i=this._getOrCreateConnection(a),s=i.addSender(r),e.next=13,s.startForwarding(n);case 13:if(o=e.sent,c=this.channel._getPublication(o)){e.next=19;break}return e.next=18,this.channel.onStreamPublished.watch((function(e){return e.publication.id===o}),this._context.config.rtcApi.timeout).catch((function(){throw new Dp({type:"timeout",message:"SfuBotMember onStreamPublished",payload:{forwardingId:o},path:kf.prefix})}));case 18:c=e.sent.publication;case 19:return u=new wf(n,r,c),this._forwardings[u.id]=u,this.listenStopForwardEvent(u),this.onForwardingStarted.emit({forwarding:u}),this.onForwardingStateChanged.emit(),kf.debug("[end] SfuBotMember startForwarding",{forwarding:u.toJSON()}),e.abrupt("return",u);case 28:throw e.prev=28,e.t0=e.catch(7),new Dp({type:"internalError",message:"[failed] SfuBotMember startForwarding",payload:{error:e.t0,publication:t},path:kf.prefix});case 31:case"end":return e.stop()}}),e,this,[[7,28]])})))}},{key:"listenStopForwardEvent",value:function(e){var t=this,n=this.channel.onStreamUnpublished.add((function(r){if(r.publication.id===e.id){n(),e.stop();var a=e.originPublication,i=t._getConnection(a.publisherId);i&&i.removeSender(a.id),t.onForwardingStopped.emit({forwarding:e}),t.onForwardingStateChanged.emit()}})).removeListener}}]),n}(zp),Sf=xf;Sf.subtype="sfu",Sf.IsSfuBotMember=function(e){return e.subtype===xf.subtype},nd(),nd(),nd(),nd();var Rf={domain:"b-sbs.beta.skyway.ntt.com",secure:!0,version:2,log:{level:"error",format:"object"}},Pf=new Mp("packages/sfu-client/src/api.ts"),Cf=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};St(this,e),this._token=t,this.options=Jl(Jl({},Rf),n),this.endpoint="http".concat(this.options.secure?"s":"","://").concat(this.options.domain,"/v").concat(this.options.version),this.http=new Ap(this.endpoint),Mp.level=this.options.log.level,Mp.format=this.options.log.format,Pf.debug("SfuRestApiClient spawned",{endpoint:this.endpoint})}return Pt(e,[{key:"updateToken",value:function(e){this._token=e}},{key:"createBot",value:function(e){return td(this,arguments,wr().mark((function e(t){var n,r,a;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.appId,r=t.channelId,e.next=3,this.http.post("/bots",{appId:n,channelId:r},{headers:{authorization:"Bearer ".concat(this._token)}}).catch((function(e){if(403===(null==e?void 0:e.status))throw new Dp({type:"insufficientPermissions",message:"createBot failed",payload:{data:null==e?void 0:e.data,status:null==e?void 0:e.status},path:Pf.prefix});throw new Dp({type:"backendError",message:"createBot failed",payload:{data:e.message},path:Pf.prefix})}));case 3:return a=e.sent,e.abrupt("return",a.id);case 5:case"end":return e.stop()}}),e,this)})))}},{key:"deleteBot",value:function(e){return td(this,arguments,wr().mark((function e(t){var n;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.botId,e.next=3,this.http.delete("/bots/".concat(n),{headers:{authorization:"Bearer ".concat(this._token)}}).catch((function(e){if(403===(null==e?void 0:e.status))throw new Dp({type:"insufficientPermissions",message:"deleteBot failed",payload:{data:null==e?void 0:e.data,status:null==e?void 0:e.status},path:Pf.prefix});throw new Dp({type:"backendError",message:"deleteBot failed",payload:{data:e.message},path:Pf.prefix})}));case 3:case"end":return e.stop()}}),e,this)})))}},{key:"startForwarding",value:function(e){return td(this,arguments,wr().mark((function e(t){var n,r,a,i,s,o,c,u,l=this;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.botId,r=t.publicationId,a=t.maxSubscribers,i=t.contentType,s=t.publisherId,o=new Tf,c={publicationId:r,maxSubscribers:a,contentType:i[0].toUpperCase()+i.slice(1),publisherId:s},e.next=5,this.http.post("/bots/".concat(n,"/forwardings"),c,{headers:{authorization:"Bearer ".concat(this._token)},retry:function(e){return td(l,null,wr().mark((function t(){return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(403!==e.status){t.next=2;break}return t.abrupt("return",!1);case 2:return t.next=4,o.wait();case 4:return t.abrupt("return",t.sent);case 5:case"end":return t.stop()}}),t)})))}}).catch((function(e){if(403===(null==e?void 0:e.status))throw new Dp({type:"insufficientPermissions",message:"startForwarding failed",payload:{data:null==e?void 0:e.data,message:null==e?void 0:e.message,status:null==e?void 0:e.status},path:Pf.prefix});throw new Dp({type:"backendError",message:"startForwarding failed",payload:{data:null==e?void 0:e.data,message:null==e?void 0:e.message,status:null==e?void 0:e.status,retry:o.retry},path:Pf.prefix})}));case 5:return u=e.sent,o.retry>0&&Pf.warn("success to retry startForwarding",{botId:n,publicationId:r,retry:o.retry}),e.abrupt("return",u);case 8:case"end":return e.stop()}}),e,this)})))}},{key:"createProducer",value:function(e){return td(this,arguments,wr().mark((function e(t){var n,r,a,i,s,o,c=this;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.botId,r=t.forwardingId,a=t.transportId,i=t.producerOptions,s=new Tf,e.next=4,this.http.put("/bots/".concat(n,"/forwardings/").concat(r,"/transport/producer"),{transportId:a,producerOptions:i},{headers:{authorization:"Bearer ".concat(this._token)},retry:function(){return td(c,null,wr().mark((function e(){return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.wait();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))}}).catch((function(e){if(403===(null==e?void 0:e.status))throw new Dp({type:"insufficientPermissions",message:"createProducer failed",payload:{data:null==e?void 0:e.data,message:null==e?void 0:e.message,status:null==e?void 0:e.status},path:Pf.prefix});throw new Dp({type:"backendError",message:"createProducer failed",payload:{data:null==e?void 0:e.data,message:null==e?void 0:e.message,status:null==e?void 0:e.status,retry:s.retry},path:Pf.prefix})}));case 4:return o=e.sent,s.retry>0&&Pf.warn("success to retry createProducer",{botId:n,forwardingId:r,transportId:a,retry:s.retry}),e.abrupt("return",o.producerId);case 7:case"end":return e.stop()}}),e,this)})))}},{key:"createConsumer",value:function(e){return td(this,arguments,wr().mark((function e(t){var n,r,a,i,s,o,c,u,l=this;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.botId,r=t.forwardingId,a=t.rtpCapabilities,i=t.subscriptionId,s=t.subscriberId,o=new Tf,c={rtpCapabilities:a,subscriptionId:i,subscriberId:s},e.next=5,this.http.post("/bots/".concat(n,"/forwardings/").concat(r,"/transport/consumers"),c,{retry:function(e){return td(l,null,wr().mark((function t(){return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(400!==e.status&&429!==e.status){t.next=2;break}return t.abrupt("return",!1);case 2:return t.next=4,o.wait();case 4:return t.abrupt("return",t.sent);case 5:case"end":return t.stop()}}),t)})))},headers:{authorization:"Bearer ".concat(this._token)}}).catch((function(e){if(403===(null==e?void 0:e.status))throw new Dp({type:"insufficientPermissions",message:"createConsumer failed",payload:{data:null==e?void 0:e.data,message:null==e?void 0:e.message,status:null==e?void 0:e.status},path:Pf.prefix});throw new Dp({type:"backendError",message:"createConsumer failed",payload:{data:null==e?void 0:e.data,message:null==e?void 0:e.message,status:null==e?void 0:e.status,retry:o.retry},path:Pf.prefix})}));case 5:return u=e.sent,o.retry>0&&Pf.warn("success to retry createConsumer",{botId:n,forwardingId:r,retry:o.retry}),e.abrupt("return",u);case 8:case"end":return e.stop()}}),e,this)})))}},{key:"connect",value:function(e){return td(this,arguments,wr().mark((function e(t){var n,r,a,i,s,o=this;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.transportId,r=t.dtlsParameters,a=new Tf,i={transportId:n,dtlsParameters:r},e.next=5,this.http.put("/transport/connection",i,{headers:{authorization:"Bearer ".concat(this._token)},retry:function(){return td(o,null,wr().mark((function e(){return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.wait();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))}}).catch((function(e){if(403===(null==e?void 0:e.status))throw new Dp({type:"insufficientPermissions",message:"connect failed",payload:{data:null==e?void 0:e.data,message:null==e?void 0:e.message,status:null==e?void 0:e.status},path:Pf.prefix});throw new Dp({type:"backendError",message:"connect failed",payload:{data:null==e?void 0:e.data,message:null==e?void 0:e.message,status:null==e?void 0:e.status,retry:a.retry},path:Pf.prefix})}));case 5:return s=e.sent,a.retry>0&&Pf.warn("success to retry connect",{transportId:n,retry:a.retry}),e.abrupt("return",s);case 8:case"end":return e.stop()}}),e,this)})))}},{key:"stopForwarding",value:function(e){var t=e.botId,n=e.forwardingId,r=!1,a=this.http.delete("/bots/".concat(t,"/forwardings/").concat(n),{headers:{authorization:"Bearer ".concat(this._token)}}).catch((function(e){if(403===(null==e?void 0:e.status))throw new Dp({type:"insufficientPermissions",message:"stopForwarding failed",payload:{data:null==e?void 0:e.data,status:null==e?void 0:e.status},path:Pf.prefix});throw new Dp({type:"backendError",message:"stopForwarding failed",payload:{data:e.message},path:Pf.prefix})})).then((function(e){r=e}));return{promise:a,fulfilled:r}}},{key:"getRtpCapabilities",value:function(e){return td(this,arguments,wr().mark((function e(t){var n,r,a,i,s=this;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.botId,r=t.forwardingId,a=new Tf,e.next=4,this.http.get("/bots/".concat(n,"/forwardings/").concat(r,"/transport/rtp_capabilities"),{headers:{authorization:"Bearer ".concat(this._token)},retry:function(){return td(s,null,wr().mark((function e(){return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.wait();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))}}).catch((function(e){if(403===(null==e?void 0:e.status))throw new Dp({type:"insufficientPermissions",message:"getCapabilities failed",payload:{data:null==e?void 0:e.data,message:null==e?void 0:e.message,status:null==e?void 0:e.status},path:Pf.prefix});throw new Dp({type:"backendError",message:"getCapabilities failed",payload:{data:null==e?void 0:e.data,message:null==e?void 0:e.message,status:null==e?void 0:e.status,retry:a.retry},path:Pf.prefix})}));case 4:return i=e.sent,a.retry>0&&Pf.warn("getCapabilities to retry connect",{botId:n,forwardingId:r,retry:a.retry}),e.abrupt("return",i.rtpCapabilities);case 7:case"end":return e.stop()}}),e,this)})))}}]),e}(),Tf=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:8;St(this,e),this.times=t,this.retry=0}return Pt(e,[{key:"wait",value:function(){return td(this,null,wr().mark((function e(){var t;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.retry++>this.times)){e.next=2;break}return e.abrupt("return",!1);case 2:return t=100*Ql(this.retry,2),e.next=5,new Promise((function(e){return setTimeout(e,t)}));case 5:return e.abrupt("return",!0);case 6:case"end":return e.stop()}}),e,this)})))}}]),e}();nd();var Ef=ed(Sp());nd();var Of=new Mp("packages/sfu-client/src/connection/transport/transport.ts"),Mf=function(){function e(t,n){var r=this;St(this,e),this.msTransport=t,this._api=n,this._onConnectionStateChange=function(e){return td(r,null,wr().mark((function t(){return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:t.t0=e,t.next="connected"===t.t0?3:"failed"===t.t0?4:"disconnected"===t.t0?5:6;break;case 3:case 4:case 5:return t.abrupt("break",6);case 6:case"end":return t.stop()}}),t)})))},this._onConnect=function(e){return function(t,n,a){return td(r,[t,n,a],wr().mark((function t(n,r,a){var i;return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=n.dtlsParameters,t.prev=1,Of.debug("[start] Sender connect",{transportId:e}),t.next=5,this._api.connect({transportId:e,dtlsParameters:i});case 5:Of.debug("[end] Sender connect",{transportId:e}),r(),t.next=13;break;case 9:t.prev=9,t.t0=t.catch(1),Of.error("Sender connect failed",{error:t.t0,transportId:e}),a(t.t0);case 13:case"end":return t.stop()}}),t,this,[[1,9]])})))}},t.on("connect",(function(){return r._onConnect(t.id)(arguments.length<=0?void 0:arguments[0],arguments.length<=1?void 0:arguments[1],arguments.length<=2?void 0:arguments[2])})),t.on("connectionstatechange",this._onConnectionStateChange)}return Pt(e,[{key:"pc",get:function(){var e,t;return null==(t=null==(e=this.msTransport)?void 0:e._handler)?void 0:t._pc}},{key:"id",get:function(){return this.msTransport.id}},{key:"close",value:function(){var e;this.msTransport.removeListener("connectionstatechange",this._onConnectionStateChange),(null==(e=this.pc)?void 0:e.peerIdentity)&&this.pc.peerIdentity.catch((function(){})),this.msTransport.close()}}]),e}(),If=new Mp("packages/sfu-client/src/connection/transport/transportRepository.ts"),Df=function(){function e(t,n){var r=this;St(this,e),this._context=t,this._api=n,this._device=new Ef.Device,this._transports={},this.getTransport=function(e){return r._transports[e]}}return Pt(e,[{key:"rtpCapabilities",get:function(){if(this._device.loaded)return this._device.rtpCapabilities}},{key:"loadDevice",value:function(e){return td(this,null,wr().mark((function t(){return wr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._device.loaded){t.next=4;break}return t.next=3,this._device.load({routerRtpCapabilities:e}).catch((function(t){throw new Dp({type:"internalError",message:"loadDevice failed",payload:{rtpCapabilities:e,err:t},path:If.prefix})}));case 3:If.debug("device loaded",{rtpCapabilities:this._device.rtpCapabilities});case 4:case"end":return t.stop()}}),t,this)})))}},{key:"createTransport",value:function(e,t,n){var r=this,a="send"===t?function(e){return r._device.createSendTransport(e)}:function(e){return r._device.createRecvTransport(e)},i=a(Yl(Jl({},e),{iceServers:n,iceTransportPolicy:"turnOnly"===this._context.config.rtcConfig.turnPolicy?"relay":void 0,additionalSettings:this._context.config.rtcConfig})),s=new Mf(i,this._api);return this._transports[i.id]=s,s}},{key:"close",value:function(){Object.values(this._transports).forEach((function(e){e.close()})),this._transports={}}}]),e}();nd();var jf=Yl(Jl({},Rf),{endpointTimeout:3e4}),Lf=new Mp("packages/sfu-client/src/plugin.ts"),Af=function(e){mn(n,e);var t=_n(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return St(this,n),(e=t.call(this)).subtype=Sf.subtype,e._createRemoteMember=function(t,n){return new Sf(Yl(Jl({},e._context),{channel:t,id:n.id,name:n.name,metadata:n.metadata,plugin:bn(e),api:e._api,context:e._context,transportRepository:e._transportRepository}))},e.createBot=function(t){return td(bn(e),null,wr().mark((function e(){var n,r,a;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._api.createBot({appId:this._context.authToken.scope.app.id,channelId:t.id});case 2:if(r=e.sent,null==(n=t._getMember(r))){e.next=7;break}e.t0=n,e.next=10;break;case 7:return e.next=9,t.onMemberJoined.watch((function(e){return e.member.id===r}),this._context.config.rtcApi.timeout).catch((function(e){throw new Dp({type:"timeout",message:"SfuClientPlugin onMemberJoined",payload:{error:e},path:Lf.prefix})}));case 9:e.t0=e.sent.member;case 10:return a=e.t0,e.abrupt("return",a);case 12:case"end":return e.stop()}}),e,this)})))},e.deleteBot=function(t,n){return td(bn(e),null,wr().mark((function e(){var r=this;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,a){r._api.deleteBot({botId:n}).catch(a),t.onMemberLeft.watch((function(e){return e.member.id===n}),r._context.config.rtcApi.timeout).catch((function(){a(new Dp({type:"timeout",message:"onMemberLeft",path:Lf.prefix}))})).then((function(){return e()}))})));case 1:case"end":return e.stop()}}),e)})))},e.options=Jl(Jl({},jf),r),e._onContextAttached.once((function(t){e._api=new Cf(t.authTokenString,Yl(Jl({},e.options),{log:t.config.log})),e._transportRepository=new Df(t,e._api),t._onTokenUpdated.add((function(t){e._api.updateToken(t)}))})),e}return Pt(n)}(Up),Ff={jti:ru(),iat:Math.floor(Date.now()/1e3),exp:Math.floor(Date.now()/1e3)+600,scope:{app:{id:"d2338de3-2bd7-4d5c-b667-c5430319fcaf",turn:!0,actions:["read"],channels:[{id:"*",name:"*",actions:["write"],members:[{id:"*",name:"*",actions:["write"],publication:{actions:["write"]},subscription:{actions:["write"]}}],sfuBots:[{actions:["write"],forwardings:[{actions:["write"]}]}]}]}}},Nf=new uu(Ff).encode("2Jy1ONotibhyTrQwokTBYpdTbswmpb5wiKfKvkKmor8="),Bf=function(e){var n=s((0,t.useState)(null),2),r=n[0],a=(n[1],s((0,t.useState)(null),2)),i=a[0],o=(a[1],s((0,t.useState)(null),2)),c=o[0],u=(o[1],s((0,t.useState)(null),2)),l=u[0],d=u[1],p=s((0,t.useState)(null),2),f=(p[0],p[1]),h=s((0,t.useState)(null),2),m=h[0],v=h[1],g=s((0,t.useState)(new $i),2),b=g[0],y=(g[1],s((0,t.useState)({}),2)),_=y[0],w=y[1],k=s((0,t.useState)(null),2),x=k[0],S=k[1];console.log("re-rendar:autoVR:");var R=(0,t.useCallback)((function(e){console.log("AddStatus:"+e)}),[]);new Af;function P(){return P=Sr(wr().mark((function e(){var t,n,r,a;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t="uclab-xvr",e.next=3,nl.Create(Nf,{logLevel:"debug"});case 3:return n=e.sent,r=new Af,n.registerPlugin(r),a=function(){var e=Sr(wr().mark((function e(){var a,i,s;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return R("Joining!"+t),e.next=3,hc.FindOrCreate(n,{name:t});case 3:return a=e.sent,e.next=6,a.join({});case 6:if(i=e.sent,S(i),R("Joined:"+t),a.bots.find((function(e){return e.subtype===Sf.subtype}))){e.next=14;break}return e.next=13,r.createBot(a);case 13:e.sent;case 14:i.onStreamSubscribed.add(function(){var e=Sr(wr().mark((function e(t){var n,r,a,i,s;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.stream,r=t.subscription,a=r.publication.origin.publisher.id,console.log("Stream",n,r),R("OnStream:"),!(n instanceof Ou)){e.next=6;break}return e.abrupt("return");case 6:_[a]||(console.log("LastNewVideo",m),v(document.createElement("video")),console.log("NextNewVideo",m),m.playsInline=!0,m.setAttribute("data-member-id",r.publication.publisher.id),m.autoplay=!0,n.attach(m),i=document.getElementById("js-remote-streams"),m.setAttribute("width",""+window.innerWidth),m.setAttribute("height",""+window.innerHeight),console.log("VideoState",m.videoState),m.addEventListener("loadeddata",(function(){i.append(m),b.addNode(new es({video:m}))})),console.log("Appending!",m),(s={})[a]=m,w(s));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),s=function(){var e=Sr(wr().mark((function e(t){return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.origin||t.origin.publisher.id===i.id){e.next=3;break}return e.next=3,i.subscribe(t.id);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.onStreamPublished.add(function(){var e=Sr(wr().mark((function e(t){return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return R("OnStreamPublished!"),e.next=3,s(t.publication);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),a.publications.forEach(function(){var e=Sr(wr().mark((function e(t){return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return R("OnStreamPublications!"),e.next=3,s(t);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),a.onMemberLeft.add((function(e){R("OnMemberLeft!"),e.member.id!==i.id&&console.log("should stop remote video")})),i.onLeft.once((function(){a.dispose()}));case 20:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),e.next=9,a();case 9:case"end":return e.stop()}}),e)}))),P.apply(this,arguments)}function C(){return navigator.xr.requestSession("immersive-vr").then((function(e){r.setSession(e),e.isImmersive=!0,T(e)}))}function T(e){e.addEventListener("end",O),function(){if(!l){ni({xrCompatible:!0}),Rr("gl"),d(l),document.body.appendChild(l.canvas),window.addEventListener("resize",t),t();var e=new fi(l);f(e),b.setRenderer(e)}function t(){l.canvas.width=l.canvas.clientWidth*window.devicePixelRatio,l.canvas.height=l.canvas.clientHeight*window.devicePixelRatio,m&&(m.setAttribute("width",""+window.innerWidth),m.setAttribute("height",""+window.innerHeight))}}(),b.inputRenderer.useProfileControllerMeshes(e);var t=new XRWebGLLayer(e,l);e.updateRenderState({baseLayer:t});var n=e.isImmersive?"local":"viewer";e.requestReferenceSpace(n).then((function(t){e.isImmersive?Rr("xrImmersiveRefSpace"):(new ns(l.canvas,t),Rr("inlineViewerHelper")),e.requestAnimationFrame(M)}))}function E(e){e.end()}function O(e){e.session.isImmersive&&r.setSession(null)}function M(e,t){var n=t.session,r=n.isImmersive?i:c.referenceSpace,a=t.getViewerPose(r);b.startFrame(),n.requestAnimationFrame(M);var s=n.renderState.baseLayer;if(l.bindFramebuffer(l.FRAMEBUFFER,s.framebuffer),l.clear(l.COLOR_BUFFER_BIT|l.DEPTH_BUFFER_BIT),a){var o,u=[],d=kr(a.views);try{for(d.s();!(o=d.n()).done;){var p=o.value,f=new Qi(p,s);f.eye=p.eye,u.push(f)}}catch(h){d.e(h)}finally{d.f()}b.updateInputSources(t,r),b.drawViewArray(u)}b.endFrame()}return(0,t.useEffect)((function(){return console.log("Set Skyway"),function(){P.apply(this,arguments)}(),console.log("VR page loaded"),new Ir({onRequestSession:C,onEndSession:E}),Rr("xrButton"),document.querySelector("header").appendChild(r.domElement),navigator.xr&&(navigator.xr.isSessionSupported("immersive-vr").then((function(e){r.enabled=e})),navigator.xr.requestSession("inline").then(T)),function(){console.log("Leave AutoVR",x)}}),[]),(0,ne.jsxs)(ne.Fragment,{children:[(0,ne.jsx)("header",{children:(0,ne.jsxs)("details",{open:!0,children:[(0,ne.jsx)("summary",{children:" VR Page"}),"Enjoy VR view!!  ",(0,ne.jsx)("a",{href:"./",className:"back",children:" Back"})]})}),(0,ne.jsx)("div",{id:"js-remote-streams"})]})},Uf=["bsPrefix","className","as"],zf=t.forwardRef((function(e,t){var n=e.bsPrefix,r=e.className,a=e.as,i=void 0===a?"div":a,s=W(e,Uf),o=ie(n,"row"),c=se(),u="".concat(o,"-cols"),l=[];return c.forEach((function(e){var t,n=s[e];delete s[e],t=null!=n&&"object"===typeof n?n.cols:n;var r="xs"!==e?"-".concat(e):"";null!=t&&l.push("".concat(u).concat(r,"-").concat(t))})),(0,ne.jsx)(i,V(V({ref:t},s),{},{className:G().apply(void 0,[r,o].concat(l))}))}));zf.displayName="Row";var Vf=zf,Hf=["as","bsPrefix","className"],Wf=["className"];var qf=t.forwardRef((function(e,t){var n=function(e){var t=e.as,n=e.bsPrefix,r=e.className,a=W(e,Hf);n=ie(n,"col");var i=se(),s=[],o=[];return i.forEach((function(e){var t,r,i,c=a[e];delete a[e],"object"===typeof c&&null!=c?(t=c.span,r=c.offset,i=c.order):t=c;var u="xs"!==e?"-".concat(e):"";t&&s.push(!0===t?"".concat(n).concat(u):"".concat(n).concat(u,"-").concat(t)),null!=i&&o.push("order".concat(u,"-").concat(i)),null!=r&&o.push("offset".concat(u,"-").concat(r))})),[V(V({},a),{},{className:G().apply(void 0,[r].concat(s,o))}),{as:t,bsPrefix:n,spans:s}]}(e),r=s(n,2),a=r[0],i=a.className,o=W(a,Wf),c=r[1],u=c.as,l=void 0===u?"div":u,d=c.bsPrefix,p=c.spans;return(0,ne.jsx)(l,V(V({},o),{},{ref:t,className:G()(i,!p.length&&d)}))}));qf.displayName="Col";var Gf=qf,Kf=["as","className","type","tooltip"],Xf={type:Yt().string,tooltip:Yt().bool,as:Yt().elementType},Qf=t.forwardRef((function(e,t){var n=e.as,r=void 0===n?"div":n,a=e.className,i=e.type,s=void 0===i?"valid":i,o=e.tooltip,c=void 0!==o&&o,u=W(e,Kf);return(0,ne.jsx)(r,V(V({},u),{},{ref:t,className:G()(a,"".concat(s,"-").concat(c?"tooltip":"feedback"))}))}));Qf.displayName="Feedback",Qf.propTypes=Xf;var $f=Qf,Jf=t.createContext({}),Yf=["id","bsPrefix","className","type","isValid","isInvalid","as"],Zf=t.forwardRef((function(e,n){var r=e.id,a=e.bsPrefix,i=e.className,s=e.type,o=void 0===s?"checkbox":s,c=e.isValid,u=void 0!==c&&c,l=e.isInvalid,d=void 0!==l&&l,p=e.as,f=void 0===p?"input":p,h=W(e,Yf),m=(0,t.useContext)(Jf).controlId;return a=ie(a,"form-check-input"),(0,ne.jsx)(f,V(V({},h),{},{ref:n,type:o,id:r||m,className:G()(i,a,u&&"is-valid",d&&"is-invalid")}))}));Zf.displayName="FormCheckInput";var eh=Zf,th=["bsPrefix","className","htmlFor"],nh=t.forwardRef((function(e,n){var r=e.bsPrefix,a=e.className,i=e.htmlFor,s=W(e,th),o=(0,t.useContext)(Jf).controlId;return r=ie(r,"form-check-label"),(0,ne.jsx)("label",V(V({},s),{},{ref:n,htmlFor:i||o,className:G()(a,r)}))}));nh.displayName="FormCheckLabel";var rh=nh;var ah=["id","bsPrefix","bsSwitchPrefix","inline","disabled","isValid","isInvalid","feedbackTooltip","feedback","feedbackType","className","style","title","type","label","children","as"],ih=t.forwardRef((function(e,n){var r=e.id,a=e.bsPrefix,i=e.bsSwitchPrefix,s=e.inline,o=void 0!==s&&s,c=e.disabled,u=void 0!==c&&c,l=e.isValid,d=void 0!==l&&l,p=e.isInvalid,f=void 0!==p&&p,h=e.feedbackTooltip,m=void 0!==h&&h,v=e.feedback,g=e.feedbackType,b=e.className,y=e.style,_=e.title,w=void 0===_?"":_,k=e.type,x=void 0===k?"checkbox":k,S=e.label,R=e.children,P=e.as,C=void 0===P?"input":P,T=W(e,ah);a=ie(a,"form-check"),i=ie(i,"form-switch");var E=(0,t.useContext)(Jf).controlId,O=(0,t.useMemo)((function(){return{controlId:r||E}}),[E,r]),M=!R&&null!=S&&!1!==S||function(e,n){return t.Children.toArray(e).some((function(e){return t.isValidElement(e)&&e.type===n}))}(R,rh),I=(0,ne.jsx)(eh,V(V({},T),{},{type:"switch"===x?"checkbox":x,ref:n,isValid:d,isInvalid:f,disabled:u,as:C}));return(0,ne.jsx)(Jf.Provider,{value:O,children:(0,ne.jsx)("div",{style:y,className:G()(b,M&&a,o&&"".concat(a,"-inline"),"switch"===x&&i),children:R||(0,ne.jsxs)(ne.Fragment,{children:[I,M&&(0,ne.jsx)(rh,{title:w,children:S}),v&&(0,ne.jsx)($f,{type:g,tooltip:m,children:v})]})})})}));ih.displayName="FormCheck";var sh=Object.assign(ih,{Input:eh,Label:rh}),oh=(n(391),["bsPrefix","type","size","htmlSize","id","className","isValid","isInvalid","plaintext","readOnly","as"]),ch=t.forwardRef((function(e,n){var r,a,i=e.bsPrefix,s=e.type,o=e.size,c=e.htmlSize,u=e.id,l=e.className,d=e.isValid,p=void 0!==d&&d,f=e.isInvalid,h=void 0!==f&&f,m=e.plaintext,v=e.readOnly,g=e.as,b=void 0===g?"input":g,y=W(e,oh),_=(0,t.useContext)(Jf).controlId;(i=ie(i,"form-control"),m)?r=U({},"".concat(i,"-plaintext"),!0):(U(a={},i,!0),U(a,"".concat(i,"-").concat(o),o),r=a);return(0,ne.jsx)(b,V(V({},y),{},{type:s,size:c,ref:n,readOnly:v,id:u||_,className:G()(l,r,p&&"is-valid",h&&"is-invalid","color"===s&&"".concat(i,"-color"))}))}));ch.displayName="FormControl";var uh=Object.assign(ch,{Feedback:$f}),lh=ue("form-floating"),dh=["controlId","as"],ph=t.forwardRef((function(e,n){var r=e.controlId,a=e.as,i=void 0===a?"div":a,s=W(e,dh),o=(0,t.useMemo)((function(){return{controlId:r}}),[r]);return(0,ne.jsx)(Jf.Provider,{value:o,children:(0,ne.jsx)(i,V(V({},s),{},{ref:n}))})}));ph.displayName="FormGroup";var fh=ph,hh=["as","bsPrefix","column","visuallyHidden","className","htmlFor"],mh=t.forwardRef((function(e,n){var r=e.as,a=void 0===r?"label":r,i=e.bsPrefix,s=e.column,o=e.visuallyHidden,c=e.className,u=e.htmlFor,l=W(e,hh),d=(0,t.useContext)(Jf).controlId;i=ie(i,"form-label");var p="col-form-label";"string"===typeof s&&(p="".concat(p," ").concat(p,"-").concat(s));var f=G()(c,i,o&&"visually-hidden",s&&p);return u=u||d,s?(0,ne.jsx)(Gf,V({ref:n,as:"label",className:f,htmlFor:u},l)):(0,ne.jsx)(a,V({ref:n,className:f,htmlFor:u},l))}));mh.displayName="FormLabel",mh.defaultProps={column:!1,visuallyHidden:!1};var vh=mh,gh=["bsPrefix","className","id"],bh=t.forwardRef((function(e,n){var r=e.bsPrefix,a=e.className,i=e.id,s=W(e,gh),o=(0,t.useContext)(Jf).controlId;return r=ie(r,"form-range"),(0,ne.jsx)("input",V(V({},s),{},{type:"range",ref:n,className:G()(a,r),id:i||o}))}));bh.displayName="FormRange";var yh=bh,_h=["bsPrefix","size","htmlSize","className","isValid","isInvalid","id"],wh=t.forwardRef((function(e,n){var r=e.bsPrefix,a=e.size,i=e.htmlSize,s=e.className,o=e.isValid,c=void 0!==o&&o,u=e.isInvalid,l=void 0!==u&&u,d=e.id,p=W(e,_h),f=(0,t.useContext)(Jf).controlId;return r=ie(r,"form-select"),(0,ne.jsx)("select",V(V({},p),{},{size:i,ref:n,className:G()(s,r,a&&"".concat(r,"-").concat(a),c&&"is-valid",l&&"is-invalid"),id:d||f}))}));wh.displayName="FormSelect";var kh=wh,xh=["bsPrefix","className","as","muted"],Sh=t.forwardRef((function(e,t){var n=e.bsPrefix,r=e.className,a=e.as,i=void 0===a?"small":a,s=e.muted,o=W(e,xh);return n=ie(n,"form-text"),(0,ne.jsx)(i,V(V({},o),{},{ref:t,className:G()(r,n,s&&"text-muted")}))}));Sh.displayName="FormText";var Rh=Sh,Ph=t.forwardRef((function(e,t){return(0,ne.jsx)(sh,V(V({},e),{},{ref:t,type:"switch"}))}));Ph.displayName="Switch";var Ch=Object.assign(Ph,{Input:sh.Input,Label:sh.Label}),Th=["bsPrefix","className","children","controlId","label"],Eh=t.forwardRef((function(e,t){var n=e.bsPrefix,r=e.className,a=e.children,i=e.controlId,s=e.label,o=W(e,Th);return n=ie(n,"form-floating"),(0,ne.jsxs)(fh,V(V({ref:t,className:G()(r,n),controlId:i},o),{},{children:[a,(0,ne.jsx)("label",{htmlFor:i,children:s})]}))}));Eh.displayName="FloatingLabel";var Oh=Eh,Mh=["className","validated","as"],Ih={_ref:Yt().any,validated:Yt().bool,as:Yt().elementType},Dh=t.forwardRef((function(e,t){var n=e.className,r=e.validated,a=e.as,i=void 0===a?"form":a,s=W(e,Mh);return(0,ne.jsx)(i,V(V({},s),{},{ref:t,className:G()(n,r&&"was-validated")}))}));Dh.displayName="Form",Dh.propTypes=Ih;var jh=Object.assign(Dh,{Group:fh,Control:uh,Floating:lh,Check:sh,Switch:Ch,Label:vh,Text:Rh,Range:yh,Select:kh,FloatingLabel:Oh}),Lh=["as","bsPrefix","variant","size","active","className"],Ah=t.forwardRef((function(e,t){var n=e.as,r=e.bsPrefix,a=e.variant,i=e.size,o=e.active,c=e.className,u=W(e,Lh),l=ie(r,"btn"),d=s(Qn(V({tagName:n},u)),2),p=d[0],f=d[1].tagName;return(0,ne.jsx)(f,V(V(V({},p),u),{},{ref:t,className:G()(c,l,o&&"active",a&&"".concat(l,"-").concat(a),i&&"".concat(l,"-").concat(i),u.href&&u.disabled&&"disabled")}))}));Ah.displayName="Button",Ah.defaultProps={variant:"primary",active:!1,disabled:!1};var Fh,Nh=Ah,Bh={jti:ru(),iat:Math.floor(Date.now()/1e3),exp:Math.floor(Date.now()/1e3)+600,scope:{app:{id:"d2338de3-2bd7-4d5c-b667-c5430319fcaf",turn:!0,actions:["read"],channels:[{id:"*",name:"*",actions:["write"],members:[{id:"*",name:"*",actions:["write"],publication:{actions:["write"]},subscription:{actions:["write"]}}],sfuBots:[{actions:["write"],forwardings:[{actions:["write"]}]}]}]}}},Uh=new uu(Bh).encode("2Jy1ONotibhyTrQwokTBYpdTbswmpb5wiKfKvkKmor8="),zh=function(e){var n=s((0,t.useState)("None"),2),r=n[0],a=n[1],i=s((0,t.useState)("None"),2),o=i[0],c=i[1],u=s((0,t.useState)([]),2),l=u[0],d=u[1],p=s((0,t.useState)([]),2),f=p[0],h=p[1],m=s((0,t.useState)(null),2),v=m[0],g=m[1],b=s((0,t.useState)(null),2),y=b[0],_=b[1],w=s((0,t.useState)(null),2),k=w[0],x=w[1];console.log("re-rendar:SkywayClient");var S=(0,t.useCallback)((function(e){var t=r+"\n"+e;console.log(t),a(t)}),[r]),R=(0,t.useCallback)((function(e){console.log("OnChange Select:",e.target.value,o),c(e.target.value)}),[o]);function P(){return P=Sr(wr().mark((function e(t){var n,r,a,i,s;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=document.getElementById("js-local-stream"),r={deviceId:{exact:t.id}},e.next=4,cl.createCameraVideoStream(r);case 4:if(a=e.sent,x(a),console.log(a),a.attach(n),n.play().catch(console.error),console.log("Attached",n),S("Working!"),i=null,!v){e.next=18;break}if(i=v.bots.find((function(e){return e.subtype===Sf.subtype})),!(v&!i)){e.next=18;break}return e.next=17,T.createBot(v);case 17:i=e.sent;case 18:if(!i){e.next=25;break}return e.next=21,y.publish(a);case 21:return s=e.sent,e.next=24,i.startForwarding(s);case 24:S("Do Forward!");case 25:case"end":return e.stop()}}),e)}))),P.apply(this,arguments)}var C=(0,t.useCallback)((function(e){if(console.log("Click",e.target),"Stop"==e.target.innerText){var t=document.getElementById("js-local-stream");console.log("Stopiing!",t),t.pause(),k.detach(),k.release(),x(null);var n=document.getElementById("js-video-parent");n.removeChild(t);var r=document.createElement("video");r.setAttribute("id","js-local-stream"),n.appendChild(r),e.target.innerText="Start"}else{!function(e){P.apply(this,arguments)}(f[l.indexOf(o)]),console.log("in start Channel",v),e.target.innerText="Stop"}}),[o,l,f,v,y,k]),T=new Af;function E(){return E=Sr(wr().mark((function e(){var t,n,r,i,s,o,u,l;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=document.getElementById("js-local-stream"),n=document.getElementById("js-join-trigger"),r=document.getElementById("js-leave-trigger"),i=document.getElementById("js-remote-streams"),s=document.getElementById("js-room-id"),e.next=7,nl.Create(Uh,{logLevel:"debug"});case 7:return(o=e.sent).registerPlugin(T),console.log("doit work:SkywayClient"),e.next=12,cl.enumerateInputVideoDevices();case 12:u=e.sent,console.log("VideoDevs",u),l=[],u.map((function(e){l.push(e.label)})),d(l),c(l[0]),h(u),t.muted=!0,t.playsInline=!0,n.addEventListener("click",Sr(wr().mark((function e(){var t,n,c,u;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return S("Joining!"),e.next=3,hc.FindOrCreate(o,{name:s.value});case 3:return t=e.sent,g(t),console.log("Set Skyway Channel!",t),e.next=8,t.join({});case 8:n=e.sent,_(n),c={},n.onStreamSubscribed.add(function(){var e=Sr(wr().mark((function e(t){var n,r,a,s,o;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.stream,r=t.subscription,a=r.publication.origin.publisher.id,s="Unknown",n instanceof Ou?s="Data":n instanceof sl?s="LocalVideo":n instanceof Mu&&(s="RemoteVideo"+a),console.log(n,r),S("OnStream:"+s),!(n instanceof Ou)){e.next=8;break}return e.abrupt("return");case 8:c[a]||((o=document.createElement("video")).playsInline=!0,o.setAttribute("data-member-id",r.publication.publisher.id),o.autoplay=!0,i.append(o),console.log("Appending!",o),c[a]=o);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),u=function(){var e=Sr(wr().mark((function e(t){return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.origin||t.origin.publisher.id===n.id){e.next=3;break}return e.next=3,n.subscribe(t.id);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.onStreamPublished.add(function(){var e=Sr(wr().mark((function e(t){return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return S("OnStreamPublished!"),e.next=3,u(t.publication);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),t.publications.forEach(function(){var e=Sr(wr().mark((function e(t){return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return S("OnStreamPublications!"),e.next=3,u(t);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),t.onMemberLeft.add((function(e){if(S("OnMemberLeft!"),e.member.id!==n.id){var t=i.querySelector('[data-member-id="'.concat(e.member.id,'"]'));if(t)t.srcObject.getTracks().forEach((function(e){return e.stop()})),t.srcObject=null,t.remove()}})),n.onLeft.once((function(){Array.from(i.children).forEach((function(e){var t=e;t.srcObject.getTracks().forEach((function(e){return e.stop()})),t.srcObject=null,t.remove()})),t.dispose()})),r.addEventListener("click",Sr(wr().mark((function e(){return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a("Leave"),e.next=3,n.leave();case 3:case"end":return e.stop()}}),e)}))),{once:!0});case 18:case"end":return e.stop()}}),e)}))));case 22:case"end":return e.stop()}}),e)}))),E.apply(this,arguments)}return(0,t.useEffect)((function(){!function(){E.apply(this,arguments)}()}),[]),(0,ne.jsxs)(ne.Fragment,{children:[(0,ne.jsx)(yr,{}),(0,ne.jsxs)(Wn,{children:[(0,ne.jsxs)(Vf,{children:[(0,ne.jsx)(Gf,{xs:12,md:6,children:(0,ne.jsx)(jh.Select,{id:"cam",value:o,onChange:R,children:l.map((function(e){return(0,ne.jsx)("option",{value:e,children:e},e)}))})}),(0,ne.jsx)(Gf,{xs:12,md:4,children:(0,ne.jsx)(Nh,{onClick:C,children:"Start"})})]}),(0,ne.jsx)(Vf,{children:(0,ne.jsx)(Gf,{md:2,children:(0,ne.jsx)("div",{id:"js-video-parent",children:(0,ne.jsx)("video",{id:"js-local-stream"})})})}),(0,ne.jsx)(Vf,{children:(0,ne.jsxs)(Gf,{children:[(0,ne.jsx)("input",{type:"text",placeholder:"Room Name",id:"js-room-id"}),(0,ne.jsx)("button",{id:"js-join-trigger",children:"Join"}),(0,ne.jsx)("button",{id:"js-leave-trigger",children:"Leave"})]})}),(0,ne.jsx)("div",{id:"js-remote-streams"}),(0,ne.jsx)("br",{}),(0,ne.jsxs)(Gf,{children:["Logs:",(0,ne.jsx)("pre",{children:r})]})]})]})},Vh=null,Hh=null,Wh=null,qh=null,Gh=function(e){var n=s((0,t.useState)("None"),2),r=n[0],a=n[1],i=s((0,t.useState)("None"),2),o=i[0],c=i[1],u=s((0,t.useState)([]),2),l=u[0],d=u[1],p=s((0,t.useState)([]),2),f=p[0],h=p[1];console.log("re-rendar:autoSend:"+r);var m=(0,t.useCallback)((function(e){var t=r+"\n"+e;console.log(t),a(t)}),[r]);(0,t.useEffect)((function(){return function(){w.apply(this,arguments)}(),Sr(wr().mark((function e(){return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("Leave AutoSend",Wh),!Wh){e.next=5;break}return e.next=4,Wh.leave();case 4:Wh=null;case 5:case"end":return e.stop()}}),e)})))}),[]);var v=(0,t.useCallback)((function(e){console.log("OnChange Select:",e.target.value,o),c(e.target.value)}),[o]);function g(e){return b.apply(this,arguments)}function b(){return(b=Sr(wr().mark((function e(t){var n,r,a;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=document.getElementById("js-local-stream"),r={deviceId:{exact:t.id}},e.next=4,cl.createCameraVideoStream(r);case 4:if((Vh=e.sent).attach(n),n.play().catch(console.error),console.log("Attached",n),m("Working!"),a=null,!Hh){e.next=18;break}if(a=Hh.bots.find((function(e){return e.subtype===Sf.subtype})),!(Hh&!a)){e.next=16;break}return e.next=15,_.createBot(Hh);case 15:a=e.sent;case 16:e.next=19;break;case 18:console.log("Chan null",Hh);case 19:if(!a){e.next=27;break}if(qh){e.next=27;break}return e.next=23,Wh.publish(Vh);case 23:return qh=e.sent,e.next=26,a.startForwarding(qh);case 26:m("Do Forward!");case 27:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var y=(0,t.useCallback)(function(){var e=Sr(wr().mark((function e(t){var n,r,a;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("Click",t.target),"Stop"!=t.target.innerText){e.next=19;break}return n=document.getElementById("js-local-stream"),console.log("Stopiing!",n),n.pause(),Vh.detach(),Vh.release(),Vh=null,e.next=10,qh.cancel();case 10:qh=null,(r=document.getElementById("js-video-parent")).removeChild(n),(a=document.createElement("video")).setAttribute("id","js-local-stream"),r.appendChild(a),t.target.innerText="Start",e.next=23;break;case 19:g(f[l.indexOf(o)]),console.log("in start Channel",Hh),t.target.innerText="Stop";case 23:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[o,l,f]),_=new Af;function w(){return w=Sr(wr().mark((function e(){var t,n,r,a,i;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t="uclab-xvr",console.log("doit:autoSend"),e.next=4,cl.enumerateInputVideoDevices();case 4:return n=e.sent,console.log("VideoDevs",n),r=[],n.map((function(e){r.push(e.label)})),d(r),c(r[0]),h(n),e.next=13,nl.Create(Nf,{logLevel:"debug"});case 13:return(a=e.sent).registerPlugin(_),i=function(){var e=Sr(wr().mark((function e(){return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return m("Joining!"+t),e.next=3,hc.FindOrCreate(a,{name:t});case 3:return Hh=e.sent,e.next=6,Hh.join({});case 6:Wh=e.sent,m("Joined:"+t);case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),e.next=18,i();case 18:case"end":return e.stop()}}),e)}))),w.apply(this,arguments)}return(0,ne.jsxs)(ne.Fragment,{children:[(0,ne.jsx)(yr,{}),(0,ne.jsxs)(Wn,{fluid:!0,children:[(0,ne.jsxs)(Vf,{children:[(0,ne.jsx)(Gf,{xs:12,md:6,children:(0,ne.jsx)(jh.Select,{id:"cam",value:o,onChange:v,children:l.map((function(e){return(0,ne.jsx)("option",{value:e,children:e},e)}))})}),(0,ne.jsx)(Gf,{xs:12,md:4,children:(0,ne.jsx)(Nh,{onClick:y,children:"Start"})})]}),(0,ne.jsx)(Vf,{children:(0,ne.jsx)(Gf,{md:2,children:(0,ne.jsx)("div",{id:"js-video-parent",children:(0,ne.jsx)("video",{id:"js-local-stream"})})})}),(0,ne.jsx)("br",{}),(0,ne.jsx)(Vf,{children:(0,ne.jsxs)(Gf,{children:["Logs:",(0,ne.jsx)("pre",{children:r})]})})]})]})},Kh={jti:ru(),iat:Math.floor(Date.now()/1e3),exp:Math.floor(Date.now()/1e3)+600,scope:{app:{id:"d2338de3-2bd7-4d5c-b667-c5430319fcaf",turn:!0,actions:["read"],channels:[{id:"*",name:"*",actions:["write"],members:[{id:"*",name:"*",actions:["write"],publication:{actions:["write"]},subscription:{actions:["write"]}}],sfuBots:[{actions:["write"],forwardings:[{actions:["write"]}]}]}]}}},Xh=new uu(Kh).encode("2Jy1ONotibhyTrQwokTBYpdTbswmpb5wiKfKvkKmor8="),Qh=function(e){var n=s((0,t.useState)("None"),2),r=n[0],a=n[1];console.log("re-rendar:swrecv:"+r);var i=(0,t.useCallback)((function(e){var t=r+"\n"+e;console.log(t),a(t)}),[r]);function o(){return o=Sr(wr().mark((function e(){var t,n,r,s,o,c;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=document.getElementById("js-join-trigger"),n=document.getElementById("js-leave-trigger"),r=document.getElementById("js-remote-streams"),s=document.getElementById("js-room-id"),console.log("doit:swrecv",r),e.next=7,nl.Create(Xh,{logLevel:"debug"});case 7:o=e.sent,c=new Af,o.registerPlugin(c),t.addEventListener("click",Sr(wr().mark((function e(){var t,u,l,d;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i("Joining!"+s.value),e.next=3,hc.FindOrCreate(o,{name:s.value});case 3:return t=e.sent,e.next=6,t.join({});case 6:if(u=e.sent,i("Joined"+s.value),t.bots.find((function(e){return e.subtype===Sf.subtype}))){e.next=13;break}return e.next=12,c.createBot(t);case 12:e.sent;case 13:l={},u.onStreamSubscribed.add(function(){var e=Sr(wr().mark((function e(t){var n,a,s,o,c,u;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.stream,a=t.subscription,s=a.publication.origin.publisher.id,o="Unknown",n instanceof Ou?o="Data":n instanceof sl?o="LocalVideo":n instanceof Mu&&(o="RemoteVideo"+s),console.log(n,a),i("OnStream:"+o),!(n instanceof Ou)){e.next=8;break}return e.abrupt("return");case 8:l[s]||((c=document.createElement("video")).playsInline=!0,c.setAttribute("data-member-id",a.publication.publisher.id),c.autoplay=!0,r.append(c),console.log("Appending!",c),l[s]=c),u=l[s],n.attach(u);case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),d=function(){var e=Sr(wr().mark((function e(t){return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.origin||t.origin.publisher.id===u.id){e.next=3;break}return e.next=3,u.subscribe(t.id);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.onStreamPublished.add(function(){var e=Sr(wr().mark((function e(t){return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i("OnStreamPublished!"),e.next=3,d(t.publication);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),t.publications.forEach(function(){var e=Sr(wr().mark((function e(t){return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i("OnStreamPublications!"),e.next=3,d(t);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),t.onMemberLeft.add((function(e){if(i("OnMemberLeft!"),e.member.id!==u.id){var t=r.querySelector('[data-member-id="'.concat(e.member.id,'"]'));t.srcObject.getTracks().forEach((function(e){return e.stop()})),t.srcObject=null,t.remove()}})),u.onLeft.once((function(){Array.from(r.children).forEach((function(e){var t=e;t.srcObject.getTracks().forEach((function(e){return e.stop()})),t.srcObject=null,t.remove()})),t.dispose()})),n.addEventListener("click",Sr(wr().mark((function e(){return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a("Leave"),e.next=3,u.leave();case 3:case"end":return e.stop()}}),e)}))),{once:!0});case 21:case"end":return e.stop()}}),e)}))));case 11:case"end":return e.stop()}}),e)}))),o.apply(this,arguments)}return(0,t.useEffect)((function(){!function(){o.apply(this,arguments)}()}),[]),(0,ne.jsxs)(ne.Fragment,{children:[(0,ne.jsx)(yr,{}),(0,ne.jsxs)(Wn,{fluid:!0,children:[(0,ne.jsx)(Vf,{children:(0,ne.jsxs)(Gf,{children:[(0,ne.jsx)("input",{type:"text",placeholder:"Room Name",id:"js-room-id"}),(0,ne.jsx)("button",{id:"js-join-trigger",children:"Join"}),(0,ne.jsx)("button",{id:"js-leave-trigger",children:"Leave"})]})}),(0,ne.jsx)(Vf,{children:(0,ne.jsx)("div",{id:"js-remote-streams"})}),(0,ne.jsx)("br",{}),(0,ne.jsx)(Vf,{children:(0,ne.jsxs)(Gf,{children:["Logs:",(0,ne.jsx)("pre",{children:r})]})})]})]})},$h=Nf,Jh=function(e){var n=s((0,t.useState)("None"),2),r=n[0],a=n[1],i=s((0,t.useState)({}),2),o=i[0],c=i[1];console.log("re-rendar:autoecv:"+r);var u=(0,t.useCallback)((function(e){var t=r+"\n"+e;console.log(t),a(t)}),[r]);function l(){return l=Sr(wr().mark((function e(){var t,n,r,a,i;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=document.getElementById("auto-remote-streams"),n="uclab-xvr",console.log("doit:swrecv",t),e.next=5,nl.Create($h,{logLevel:"debug"});case 5:r=e.sent,a=new Af,r.registerPlugin(a),i=function(){var e=Sr(wr().mark((function e(){var i,s;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u("Joining!"+n),e.next=3,hc.FindOrCreate(r,{name:n});case 3:return i=e.sent,e.next=6,i.join({});case 6:if(Fh=e.sent,u("Joined:"+n),i.bots.find((function(e){return e.subtype===Sf.subtype}))){e.next=13;break}return e.next=12,a.createBot(i);case 12:e.sent;case 13:Fh.onStreamSubscribed.add(function(){var e=Sr(wr().mark((function e(n){var r,a,i,s,l,d;return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.stream,a=n.subscription,i=a.publication.origin.publisher.id,console.log(r,a),u("OnStream:"),!(r instanceof Ou)){e.next=6;break}return e.abrupt("return");case 6:o[i]?(d=o[i],r.attach(d)):((s=document.createElement("video")).playsInline=!0,s.setAttribute("data-member-id",a.publication.publisher.id),s.autoplay=!0,t.append(s),console.log("Appending!",s),(l=V({},o))[i]=s,c(l),r.attach(s),a.onCanceled.add((function(){t.removeChild(s),delete o[i]})));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),Fh.onSubscriptionChanged.add((function(){console.log("Subscription Changed:"),console.log(Fh.subscriptions)})),s=function(){var e=Sr(wr().mark((function e(t){return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.origin||t.origin.publisher.id===Fh.id){e.next=3;break}return e.next=3,Fh.subscribe(t.id);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),i.onStreamPublished.add(function(){var e=Sr(wr().mark((function e(t){return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u("OnStreamPublished!",t),e.next=3,s(t.publication);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),i.publications.forEach(function(){var e=Sr(wr().mark((function e(t){return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u("OnStreamPublications!".p),e.next=3,s(t);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),i.onMemberLeft.add((function(e){if(console.log("on member left",e),e.person.id!==Fh.id){var t=document.getElementById("auto-remote-streams").querySelector('[data-member-id="'.concat(e.person.id,'"]'));if(t){var n=t.srcObject;n&&n.getTracks().forEach((function(e){return e.stop()})),t.srcObject=null,t.remove()}else console.log("remove not working")}})),Fh.onLeft.once((function(){console.log("I'm leaving!",Fh),Array.from(t.children).forEach((function(e){var t=e,n=t.srcObject;n&&(console.log("Stopping videos",n),n.getTracks().forEach((function(e){return e.stop()}))),t.srcObject=null,t.remove()})),i.dispose()}));case 20:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),i();case 10:case"end":return e.stop()}}),e)}))),l.apply(this,arguments)}return(0,t.useEffect)((function(){return function(){l.apply(this,arguments)}(),Sr(wr().mark((function e(){return wr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("Leave AutoReceive",Fh),!Fh){e.next=4;break}return e.next=4,Fh.leave();case 4:case"end":return e.stop()}}),e)})))}),[]),(0,ne.jsxs)(ne.Fragment,{children:[(0,ne.jsx)(yr,{}),(0,ne.jsxs)(Wn,{children:[(0,ne.jsx)(Vf,{children:(0,ne.jsx)("div",{id:"auto-remote-streams"})}),(0,ne.jsx)(Vf,{children:(0,ne.jsxs)(Gf,{children:["Logs:",(0,ne.jsx)("pre",{children:r})]})})]})]})};r.createRoot(document.getElementById("root")).render((0,ne.jsx)(N,{children:(0,ne.jsxs)(A,{children:[(0,ne.jsx)(j,{path:"/",element:(0,ne.jsx)(_r,{})}),(0,ne.jsx)(j,{path:"/autovr",element:(0,ne.jsx)(Bf,{})}),(0,ne.jsx)(j,{path:"/skyway",element:(0,ne.jsx)(zh,{})}),(0,ne.jsx)(j,{path:"/swrecv",element:(0,ne.jsx)(Qh,{})}),(0,ne.jsx)(j,{path:"/autorecv",element:(0,ne.jsx)(Jh,{})}),(0,ne.jsx)(j,{path:"/autosend",element:(0,ne.jsx)(Gh,{})})]})})),B()}()}();
//# sourceMappingURL=main.3d91abd3.js.map